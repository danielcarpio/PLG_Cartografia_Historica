{"version":3,"sources":["webpack:///webpack/bootstrap 441f52bb4990bf38b093","webpack:///./compile-utils/util/decorator.js","webpack:///./node_modules/jquery/dist/jquery.js","webpack:///./plugins/plg_cartografia_historica/src/facade/js/plg_cartografia_historica.js","webpack:///./plugins/plg_cartografia_historica/src/facade/js/visorcontrol.js","webpack:///./plugins/plg_cartografia_historica/src/impl/ol/js/visorcontrol.js","webpack:///./plugins/plg_cartografia_historica/src/facade/js/catastrocontrol.js","webpack:///./plugins/plg_cartografia_historica/src/impl/ol/js/catastrocontrol.js","webpack:///./node_modules/flatpickr/dist/flatpickr.js","webpack:///./node_modules/flatpickr/dist/l10n/es.js","webpack:///./node_modules/openlayers-ext/dist/ol-ext.js","webpack:///./node_modules/flatpickr/dist/themes/airbnb.css?5a2a","webpack:///./plugins/plg_cartografia_historica/src/facade/assets/css/plg_cartografia_historica.css?d038","webpack:///./node_modules/@fortawesome/fontawesome-free/css/all.css?bff6"],"names":["namespace","target","namespaceArray","split","constructObject","obj","length","name","splice","mainPath","window","module","exports","PLG_Cartografia_Historica","params","map_","controls_","html_","layers_","layers","posx_","posy_","sizex_","sizey_","map","visor","M","control","visorControl","catastro","catastroControl","push","panel_","ui","Panel","collapsible","position","TR","className","collapsedButtonClass","addControls","addPanels","on","evt","COMPLETED","setTimeout","document","querySelector","addEventListener","classList","contains","activated","activate","posx","posy","sizex","sizey","Plugin","d","utils","isUndefined","impl","exception","smap_","mainClass_","Promise","success","fail","template","compile","then","html","initControl","_this","getImpl","fixZoom","div","createElement","id","style","getPosX","setSizeX","gf","mb","offsetWidth","setSizeY","offsetHeight","setPosX","getSizeX","setPosY","getSizeY","top","getPosY","left","width","height","border","borderRadius","userSelect","webkitBoxShadow","MozBoxShadow","boxShadow","mousePositionX","mousePositionY","relativeX","relativeY","divResize","right","bottom","cursor","backgroundImage","backgroundSize","divClose","filter","deactivate","lockedResize","coordsResizeX","coordsResizeY","unlockResizeFunc","unlockResize","coords","clientX","clientY","touches","screenX","screenY","lockFunc","lock","locked","moveResizeFunc","coord","newCoordX","newCoordY","oldSizeX","oldSizeY","parseInt","borderWidth","resizeBoth","resizeX","resizeY","updateZoom","secondmap","newCoordMap","coordinatesFromPixel","setCenter","x","y","draw","updateSize","unlockMoveFunc","moveFunct","coordMap","getContainer","appendChild","container","htmlSelect","display","firstOnDic","Object","keys","selected","changeLayer","resize","oldCoord","setResolutions","getResolutions","interactionInMap","noInteractions","filters","getElementById","removeChild","getElementsByClassName","remove","add","deactivateFilters","layer","removeLayers","getLayers","addWMS","WMS","url","tiled","addWMTS","WMTS","matrixSet","l","findLayer","innerHTML","find","click","e","parent","toggle","entries","cat","lay","nameLa","values","enhance","ol","Colorize","operation","addFilter","setActive","prop","setFilter","f","val","red","Number","green","blue","value","Control","removeControls","getControls","getMapImpl","getInteractions","forEach","i","getCoordinateFromPixel","mapToChange","mapOrigin","setZoom","getZoom","_thisClass","getView","Math","round","require","Spanish","inline","onChange","selectedDates","dateStr","instance","minDate","maxDate","brightness","invert","contrast","css"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;AC7DE,IAAMA,YAAY,mBAACA,UAAD,EAAe;AAC/B,SAAO,UAACC,MAAD,EAAY;AACjB,QAAIC,iBAAiBF,WAAUG,KAAV,CAAgB,GAAhB,CAArB;AACA,QAAMC,kBAAkB,SAAlBA,eAAkB,CAACF,cAAD,EAAiBG,GAAjB,EAAyB;AAC/C,UAAIH,eAAeI,MAAf,GAAwB,CAA5B,EAA+B;AAC7B,YAAIC,OAAOL,eAAe,CAAf,CAAX;AACA,YAAI,CAACG,IAAIE,IAAJ,CAAL,EAAgB;AACdF,cAAIE,IAAJ,IAAY,EAAZ;AACD;AACDH,wBAAgBF,eAAeM,MAAf,CAAsB,CAAtB,CAAhB,EAA0CH,IAAIE,IAAJ,CAA1C;AACD,OAND,MAOK;AACHF,YAAIJ,OAAOM,IAAX,IAAmBN,MAAnB;AACD;AACD,aAAOI,GAAP;AACD,KAZD;AAaA,QAAII,WAAWP,eAAe,CAAf,CAAf;AACA,QAAI,CAACQ,OAAOD,QAAP,CAAL,EAAuB;AACrBC,aAAOD,QAAP,IAAmB,EAAnB;AACD;AACDL,oBAAgBF,eAAeM,MAAf,CAAsB,CAAtB,CAAhB,EAA0CE,OAAOD,QAAP,CAA1C;AACD,GApBD;AAqBD,CAtBD;;AAwBAE,OAAOC,OAAP,GAAiBZ,SAAjB,C;;;;;;ACxBF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA,GAAG;AACH,EAAE;;AAEF;AACA;AACA,EAAE;;AAEF;AACA;AACA,EAAE;;AAEF;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,QAAQ,YAAY;;AAEpB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,EAAE;;AAEF,oBAAoB;;AAEpB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA,kBAAkB,kCAAkC;AACpD,EAAE;;AAEF;AACA;;AAEA;AACA;AACA,UAAU,YAAY;AACtB;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS,SAAS;AAClB;AACA;;AAEA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS,YAAY;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAU,YAAY;AACtB;;AAEA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,SAAS;AAClB;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;;AAEA,gBAAgB,IAAI;;AAEpB;AACA;;AAEA;;AAEA;AACA;AACA,wCAAwC,IAAI;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA,GAAG;AACH,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,SAAS;;AAET;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA,MAAM;;AAEN;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;;AAEA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,aAAa,yBAAyB;AACtC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,QAAQ,6BAA6B;AAChD;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF;;AAEA;AACA;AACA,WAAW,gBAAgB;AAC3B,aAAa,uBAAuB;AACpC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,WAAW,eAAe;AAC1B,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,eAAe;AAC1B,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAI;AACJ;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,WAAW,UAAU;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,WAAW,cAAc;AACzB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,gCAAgC,MAAM;AACtC;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA,eAAe;;AAEf,SAAS;;AAET;AACA,QAAQ,iCAAiC;AACzC,QAAQ,oBAAoB;AAC5B,QAAQ,sCAAsC;AAC9C,QAAQ;AACR,EAAE;;AAEF;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,IAAI;AACJ;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;;AAEA;AACA;AACA;AACA,gBAAgB,aAAa,EAAE;AAC/B;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,4DAA4D;;AAE5D;AACA;AACA;AACA,yCAAyC;;AAEzC;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO;AACP;AACA;AACA;AACA;AACA,6DAA6D;;AAE7D;AACA;AACA;AACA,0CAA0C;;AAE1C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,gEAAgE;;AAEhE;AACA;AACA;AACA,6CAA6C;;AAE7C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;AACA,iEAAiE,UAAU;AAC3E,sCAAsC,2BAA2B;AACjE;AACA,gCAAgC,MAAM;AACtC;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA,UAAU,YAAY;AACtB;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,UAAU,YAAY;AACtB;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,UAAU;AACpB;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,UAAU,cAAc;AACxB;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA;AACA,YAAY,uEAAuE;AACnF;AACA;AACA,YAAY,4BAA4B;AACxC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAQ,SAAS;AACjB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,2DAA2D;;AAE3D;AACA;AACA,oFAAoF;;AAEpF;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA,OAAO;AACP;AACA;;AAEA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,QAAQ,SAAS;AACjB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAQ,SAAS;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH,QAAQ,SAAS;AACjB;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,iDAAiD;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iDAAiD;AACjD,UAAU,wCAAwC;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B;AACA,WAAW,QAAQ;AACnB,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;;AAEA,CAAC;;;;AAID;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA,QAAQ,GAAG;AACX;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;;;;AAIA;;AAEA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,gBAAgB,SAAS;AACzB;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;;AAEA,cAAc,SAAS;AACvB;AACA;;AAEA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,IAAI;AACJ;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;;AAEA;AACA,KAAK;AACL;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,IAAI;AACJ;;AAEA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU,OAAO;AACjB;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU,OAAO;AACjB,0BAA0B,wBAAwB;;AAElD;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA,0CAA0C;AAC1C,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;AACD;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;AACD;;;;AAIA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB;;AAEnB;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,UAAU,cAAc;AACxB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;;AAER;AACA;AACA;AACA,OAAO;AACP,MAAM;;AAEN;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA,wCAAwC,sCAAsC;AAC9E,oCAAoC,uCAAuC;AAC3E,oCAAoC,sCAAsC;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR,OAAO;AACP;AACA,MAAM;AACN,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW;;AAEX;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAU;;AAEV;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;;AAER;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAM;;AAEN;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,oCAAoC;AACpC,qCAAqC;AACrC,oCAAoC;AACpC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;;;AAGD;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA,EAAE;AACF;;;;;AAKA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,CAAC;;AAED;AACA;;AAEA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE;AACF;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,UAAU,SAAS;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,uBAAuB,aAAa;AACpC,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAAoB,SAAS;AAC7B;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA,EAAE;;AAEF;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,IAAI;AACJ,GAAG;AACH,EAAE;;AAEF;AACA;AACA;AACA,GAAG;AACH;AACA,CAAC;;;AAGD;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ,EAAE;AACF;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;AAEA;;;AAGA;;AAEA;;;;AAIA;AACA;AACA,GAAG;AACH,cAAc;;AAEd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,QAAQ,gBAAgB;AACxB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,iBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA,CAAC;AACD;;AAEA;;AAEA;;;;AAIA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;AAGA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,EAAE;AACF;;AAEA,EAAE;AACF;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA,QAAQ,OAAO;AACf;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,sBAAsB;;AAEtB;AACA;AACA;AACA;AACA;AACA;;AAEA,QAAQ,OAAO;AACf;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,IAAI;AACJ;;AAEA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,gBAAgB;AAClB;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;;AAEA,WAAW;;AAEX;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;;AAEA,EAAE;;AAEF;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;;AAEF;;AAEA;AACA;;AAEA;AACA;AACA,oDAAoD;AACpD;;AAEA;AACA;;AAEA,cAAc,sBAAsB;AACpC;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,yBAAyB;AACzB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,+DAA+D;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,UAAU,cAAc;;AAExB;AACA;AACA;AACA;AACA;AACA,iBAAiB,mBAAmB;AACpC;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,uCAAuC;AACjE;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,uBAAuB,uDAAuD;AAC9E;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH,EAAE;;AAEF;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,+CAA+C;AACpD;AACA;;AAEA;AACA;AACA,IAAI;;AAEJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,sCAAsC;AACtC;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,qCAAqC,cAAc;AACnD;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,CAAC;;AAED,cAAc,qCAAqC;AACnD;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,CAAC;;;AAGD;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,2CAA2C,OAAO;AAClD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8BAA8B;;AAE9B;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,EAAE;AACF;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,UAAU,OAAO;AACjB;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,gBAAgB,gBAAgB;AAChC;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,QAAQ,+BAA+B;AACvC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,uCAAuC,OAAO;AAC9C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,wCAAwC,OAAO;AAC/C;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;;AAEA,SAAS,qCAAqC;AAC9C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,QAAQ;AACR;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;;AAEF;AACA;AACA;;AAEA,SAAS,8BAA8B;AACvC;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH,EAAE;;AAEF;AACA;AACA,6BAA6B;AAC7B;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,YAAY,OAAO;AACnB;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,GAAG;AACH,EAAE;;AAEF;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS,WAAW;AACpB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;AACD;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;;;AAIA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,+CAA+C,cAAc,WAAW;AACxE,mBAAmB,UAAU;AAC7B;AACA,sBAAsB,cAAc,sBAAsB,gBAAgB;AAC1E,gBAAgB,WAAW,YAAY;AACvC,cAAc;AACd;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,EAAE;AACF,CAAC;;;AAGD;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,kBAAkB;AAClB;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY,+DAA+D;AAC3E;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,QAAQ,OAAO;;AAEf;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA,aAAa;;AAEb;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,kBAAkB,gBAAgB;AAClC;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;;AAEA,UAAU,OAAO;AACjB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA,YAAY;AACZ;;AAEA;AACA;AACA;;AAEA,WAAW,SAAS;AACpB;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,CAAC;;;AAGD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;;AAEA;;AAEA;AACA;;;;;AAKA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA;AACA;AACA,QAAQ,OAAO;AACf;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAQ,gBAAgB;AACxB;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,iDAAiD,0BAA0B;AAC3E;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,UAAU,gBAAgB;AAC1B;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,2BAA2B;AAC3B;AACA,qBAAqB;AACrB;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B;AACA;;AAEA,6CAA6C;AAC7C;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA,QAAQ,gBAAgB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;;AAEF;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA,SAAS,gBAAgB;AACzB;AACA;AACA;AACA;AACA,EAAE;;AAEF;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,CAAC;;AAED;AACA,iEAAiE;AACjE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,EAAE;AACF;AACA;AACA;;AAEA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,oBAAoB,cAAc;AAClC,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA,iDAAiD;;AAEjD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;;AAEA,+BAA+B,SAAS;AACxC;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,+BAA+B,SAAS;AACxC;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAmB,gBAAgB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,UAAU,kBAAkB;AAC5B,WAAW,kBAAkB;AAC7B,cAAc;AACd,CAAC;AACD;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;;AAEA;;AAEA,QAAQ,mBAAmB;AAC3B;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;;;AAGA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA,GAAG;AACH;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;AAKD;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA,GAAG;AACH;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;AAKD;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;;AAEA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;;AAEF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;;;;;AAKD;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;AACA;;AAEA,iCAAiC;AACjC;AACA;;AAEA,IAAI;AACJ;;AAEA,IAAI;AACJ;AACA;AACA,KAAK;AACL;;AAEA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,CAAC;;AAED;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,KAAK;AACL;AACA;;AAEA;AACA,WAAW,SAAS;AACpB;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;AAKD;;;AAGA;;;AAGA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA,sCAAsC;AACtC;AACA;AACA;;AAEA;;AAEA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,2CAA2C;AAC3C;;AAEA;AACA;AACA;AACA;AACA,UAAU,KAAK;AACf;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,iDAAiD;AACjD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,CAAC;;AAED;;AAEA;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,qCAAqC;;AAEpD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA;;AAEA,KAAK;AACL;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;;AAEA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH,EAAE;;AAEF;AACA;AACA;AACA;;AAEA,EAAE;;AAEF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb,KAAK;AACL;;AAEA,WAAW;AACX,GAAG;AACH;AACA,CAAC;;;AAGD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;;AAEhB;AACA;AACA;AACA;AACA;AACA,gBAAgB;;AAEhB,gDAAgD;AAChD;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,mBAAmB;AACnB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,wDAAwD;AACxD;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;AACA,IAAI;;AAEJ;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS;AACT;;AAEA;;AAEA;AACA;;AAEA;AACA,iBAAiB;AACjB,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD;;AAElD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,2BAA2B;;AAE3B;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kCAAkC;;AAElC;AACA,sBAAsB;AACtB,2BAA2B;;AAE3B;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sDAAsD;AACtD;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK;AACL;;AAEA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAE;;AAEF;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,CAAC;;;AAGD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE;AACF;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,IAAI;AACJ;;AAEA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,IAAI;AACJ;AACA;AACA,GAAG;AACH,EAAE;;AAEF;AACA;;AAEA;AACA;AACA,GAAG;AACH,EAAE;;AAEF;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,CAAC;;;AAGD;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA,EAAE;AACF;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;;AAER;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA,mDAAmD;AACnD;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,uBAAuB;AAClC,WAAW,yBAAyB;AACpC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,IAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;AAKD;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B,aAAa,uCAAuC;AACpD;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;;AAEN;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;AAKD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;AACA,CAAC;;;;;AAKD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,IAAI;AACJ,GAAG;AACH;;AAEA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;AAKD;AACA;AACA;AACA,EAAE;AACF;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA,qDAAqD;AACrD;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB;;AAEnB;AACA;;AAEA;AACA;;AAEA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA,CAAC;;AAED;AACA,cAAc,sDAAsD;AACpE;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;AACA,cAAc,mCAAmC;AACjD,eAAe,6DAA6D;AAC5E;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA,IAAI;AACJ;AACA,EAAE;AACF,CAAC;;;AAGD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA,CAAC;;;;;AAKD;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;;AAEF;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AAAA;AACF;;;;;AAKA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA,CAAC;;;;;;;;;;;;;;AC31UD;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;;;IAGMa,yB,WADL,yBAAU,UAAV,C;;;AAGC;;;;;;;;;;AAUA,qCAAYC,MAAZ,EAAoB;AAAA;;AAGlB;;;;;AAHkB;;AAQlB,UAAKC,IAAL,GAAY,IAAZ;;AAEA;;;;;AAKA,UAAKC,SAAL,GAAiB,EAAjB;;AAEA;;;;AAIA,UAAKC,KAAL,GAAa,IAAb;AACA,UAAKC,OAAL,GAAeJ,OAAOK,MAAtB;;AAEA,UAAKC,KAAL,GAAa,IAAb;AACA,UAAKC,KAAL,GAAa,IAAb;AACA,UAAKC,MAAL,GAAc,IAAd;AACA,UAAKC,MAAL,GAAc,IAAd;AA3BkB;AA4BnB;;AAED;;;;;;;;;;;;0BAQMC,G,EAAK;AACT,UAAIC,QAAQ,IAAIC,EAAEC,OAAF,CAAUC,YAAd,CAA2B,KAAKV,OAAhC,EAAyC,IAAzC,CAAZ;AACA,UAAIW,WAAW,IAAIH,EAAEC,OAAF,CAAUG,eAAd,CAA8B,IAA9B,CAAf;AACA,WAAKd,SAAL,CAAee,IAAf,CAAoBN,KAApB;AACA,WAAKT,SAAL,CAAee,IAAf,CAAoBF,QAApB;AACA,WAAKd,IAAL,GAAYS,GAAZ;AACA,WAAKP,KAAL,GAAa,IAAb;AACA;AACA,WAAKe,MAAL,GAAc,IAAIN,EAAEO,EAAF,CAAKC,KAAT,CAAe,YAAf,EAA6B;AACzCC,qBAAa,IAD4B;AAEzCC,kBAAUV,EAAEO,EAAF,CAAKG,QAAL,CAAcC,EAFiB;AAGzCC,mBAAW,SAH8B;AAIzCC,8BAAsB;AAJmB,OAA7B,CAAd;AAMA,WAAKP,MAAL,CAAYQ,WAAZ,CAAwB,KAAKxB,SAA7B;AACAQ,UAAIiB,SAAJ,CAAc,KAAKT,MAAnB;;AAEAR,UAAIkB,EAAJ,CAAOhB,EAAEiB,GAAF,CAAMC,SAAb,EAAwB,YAAU;AAChCC,mBAAW,YAAU;AACnBC,mBAASC,aAAT,CAAuB,uBAAvB,EAAgDC,gBAAhD,CAAiE,OAAjE,EAA0E,YAAU;AAClF,gBAAGF,SAASC,aAAT,CAAuB,UAAvB,EAAmCE,SAAnC,CAA6CC,QAA7C,CAAsD,QAAtD,KAAmE,CAACzB,MAAM0B,SAA1E,IAAuF,CAACtB,SAASsB,SAApG,EAA8G;AAC5G1B,oBAAM2B,QAAN;AACD;AACF,WAJD;AAKD,SAND,EAMG,GANH;AAOD,OARD;AASD;;;8BAEQ;AACP,aAAO,KAAKhC,KAAZ;AACD;;;8BACQ;AACP,aAAO,KAAKC,KAAZ;AACD;;;4BACOgC,I,EAAK;AACX,WAAKjC,KAAL,GAAaiC,IAAb;AACD;;;4BACOC,I,EAAK;AACX,WAAKjC,KAAL,GAAaiC,IAAb;AACD;;;+BAES;AACR,aAAO,KAAKhC,MAAZ;AACD;;;+BACS;AACR,aAAO,KAAKC,MAAZ;AACD;;;6BACQgC,K,EAAM;AACb,WAAKjC,MAAL,GAAciC,KAAd;AACD;;;6BACQC,K,EAAM;AACb,WAAKjC,MAAL,GAAciC,KAAd;AACD;;;;EAtGqC9B,EAAE+B,M;;;;;;;;;;;;;;;;;;;;;;ACP1C;;;;AACA;;;;AACA;;;;;;;;;;;;IAGa7B,Y,WAAAA,Y,WADZ,yBAAU,WAAV,C;;;AAGC;;;;;;;;;AASA,wBAAYT,MAAZ,EAAoBuC,CAApB,EAAuB;AAAA;;AACrB;AACA,QAAIhC,EAAEiC,KAAF,CAAQC,WAAR,CAAoBlC,EAAEmC,IAAF,CAAOlC,OAAP,CAAeC,YAAnC,CAAJ,EAAsD;AACpDF,QAAEoC,SAAF,CAAY,+DAAZ;AACD;AACD;AACA,QAAID,OAAO,IAAInC,EAAEmC,IAAF,CAAOlC,OAAP,CAAeC,YAAnB,EAAX;;AANqB,6HAOfiC,IAPe,EAOT,OAPS;;AAQrB,WAAK3C,OAAL,GAAeC,MAAf;AACA,WAAK4C,KAAL,GAAa,IAAb;AACA,WAAK9C,KAAL,GAAa,IAAb;AACA,WAAK+C,UAAL,GAAkBN,CAAlB;AAXqB;AAYtB;AACD;;;;;;;;;;;;+BAQYlC,G,EAAK;AAAA;;AACd,aAAO,IAAIyC,OAAJ,CAAY,UAACC,OAAD,EAAUC,IAAV,EAAmB;AACrC,eAAOzC,EAAE0C,QAAF,CAAWC,OAAX,CAAmB,YAAnB,EAAiC;AACtC,kBAAQ,EAAC,UAAU,OAAKnD,OAAhB;AAD8B,SAAjC,EAEJoD,IAFI,CAEC,gBAAQ;AACd;AACA,iBAAKrD,KAAL,GAAasD,IAAb;AACA,iBAAKR,KAAL,GAAa,IAAb;AACA,iBAAKS,WAAL;AACAN,kBAAQK,IAAR;AACD,SARM,CAAP;AASD,OAVO,CAAP;AAWD;AACF;;;;;;;;;;+BAOW;AACT,UAAIE,QAAQ,IAAZ;AACA,2HAFS,CAES;AAClB;AACA,WAAKC,OAAL,GAAeC,OAAf,CAAuBF,MAAM1D,IAA7B;AACA,UAAI6D,MAAM9B,SAAS+B,aAAT,CAAuB,KAAvB,CAAV;AACAD,UAAIE,EAAJ,GAAS,OAAT;AACAF,UAAIG,KAAJ,CAAU3C,QAAV,GAAqB,UAArB;AACA,UAAGqC,MAAMO,OAAN,MAAmB,IAAtB,EAA2B;AACzBP,cAAMQ,QAAN,CAAeR,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBC,WAAtB,GAAkC,CAAjD;AACAX,cAAMY,QAAN,CAAeZ,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBG,YAAtB,GAAmC,CAAlD;AACAb,cAAMc,OAAN,CAAcd,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBC,WAAtB,GAAkC,CAAlC,GAAsCX,MAAMe,QAAN,KAAiB,CAArE;AACAf,cAAMgB,OAAN,CAAchB,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBG,YAAtB,GAAmC,CAAnC,GAAuCb,MAAMiB,QAAN,KAAiB,CAAtE;AACD;AACDd,UAAIG,KAAJ,CAAUY,GAAV,GAAgBlB,MAAMmB,OAAN,KAAkB,IAAlC;AACAhB,UAAIG,KAAJ,CAAUc,IAAV,GAAiBpB,MAAMO,OAAN,KAAkB,IAAnC;AACAJ,UAAIG,KAAJ,CAAUe,KAAV,GAAkBrB,MAAMe,QAAN,KAAiB,IAAnC;AACAZ,UAAIG,KAAJ,CAAUgB,MAAV,GAAmBtB,MAAMiB,QAAN,KAAiB,IAApC;AACAd,UAAIG,KAAJ,CAAUiB,MAAV,GAAmB,8BAAnB;AACApB,UAAIG,KAAJ,CAAUkB,YAAV,GAAyB,KAAzB;AACArB,UAAIG,KAAJ,CAAUmB,UAAV,GAAuB,MAAvB;;AAEAtB,UAAIG,KAAJ,CAAUoB,eAAV,GAA4B,mCAA5B;AACAvB,UAAIG,KAAJ,CAAUqB,YAAV,GAAyB,mCAAzB;AACAxB,UAAIG,KAAJ,CAAUsB,SAAV,GAAsB,oCAAtB;;AAEA,UAAIC,iBAAiB,IAArB;AACA,UAAIC,iBAAiB,IAArB;AACA,UAAIC,YAAY,IAAhB;AACA,UAAIC,YAAY,IAAhB;;AAEA;AACA,UAAIC,YAAY5D,SAAS+B,aAAT,CAAuB,KAAvB,CAAhB;AACA6B,gBAAU3B,KAAV,CAAgB3C,QAAhB,GAA2B,UAA3B;AACAsE,gBAAU3B,KAAV,CAAgB4B,KAAhB,GAAsB,KAAtB;AACAD,gBAAU3B,KAAV,CAAgB6B,MAAhB,GAAuB,KAAvB;AACAF,gBAAU3B,KAAV,CAAgBe,KAAhB,GAAsB,MAAtB;AACAY,gBAAU3B,KAAV,CAAgBgB,MAAhB,GAAuB,MAAvB;AACAW,gBAAU3B,KAAV,CAAgB8B,MAAhB,GAAuB,aAAvB;AACAH,gBAAU3B,KAAV,CAAgB+B,eAAhB,GAAkC,6GAAlC;AACAJ,gBAAU3B,KAAV,CAAgBgC,cAAhB,GAAiC,MAAjC;;AAEA;AACA,UAAIC,WAAWlE,SAAS+B,aAAT,CAAuB,KAAvB,CAAf;AACAmC,eAASjC,KAAT,CAAe3C,QAAf,GAA0B,UAA1B;AACA4E,eAASjC,KAAT,CAAe4B,KAAf,GAAqB,KAArB;AACAK,eAASjC,KAAT,CAAeY,GAAf,GAAmB,KAAnB;AACAqB,eAASjC,KAAT,CAAee,KAAf,GAAqB,MAArB;AACAkB,eAASjC,KAAT,CAAegB,MAAf,GAAsB,MAAtB;AACAiB,eAASjC,KAAT,CAAekC,MAAf,GAAwB,cAAxB;AACAD,eAASjC,KAAT,CAAe8B,MAAf,GAAsB,SAAtB;AACAG,eAASjC,KAAT,CAAe+B,eAAf,GAAiC,6GAAjC;AACAE,eAASjC,KAAT,CAAegC,cAAf,GAAgC,MAAhC;;AAEAC,eAAShE,gBAAT,CAA0B,OAA1B,EAAmC,YAAU;AAC3CyB,cAAMyC,UAAN;AACD,OAFD;;AAIA;AACA,UAAIC,eAAe,CAAnB;AACA,UAAIC,gBAAgB,IAApB;AACA,UAAIC,gBAAgB,IAApB;;AAEA,UAAIC,mBAAmB,SAASC,YAAT,CAAsBC,MAAtB,EAA6B;AAClDL,uBAAe,CAAf;AACAC,wBAAgBI,OAAOC,OAAvB;AACAJ,wBAAgBG,OAAOE,OAAvB;AACA,YAAGN,iBAAiB,IAApB,EAAyB;AACvBA,0BAAgBI,OAAOG,OAAP,CAAe,CAAf,EAAkBC,OAAlC;AACAP,0BAAgBG,OAAOG,OAAP,CAAe,CAAf,EAAkBE,OAAlC;AACD;AACF,OARD;AASA,UAAIC,WAAW,SAASC,IAAT,GAAe;AAC5BZ,uBAAe,CAAf;AACAa,iBAAS,CAAT;AACD,OAHD;AAIAtB,gBAAU1D,gBAAV,CAA2B,WAA3B,EAAwCsE,gBAAxC;AACAZ,gBAAU1D,gBAAV,CAA2B,YAA3B,EAAyCsE,gBAAzC;AACA7C,YAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBnC,gBAAtB,CAAuC,SAAvC,EAAkD8E,QAAlD;AACArD,YAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBnC,gBAAtB,CAAuC,YAAvC,EAAqD8E,QAArD;;AAEA,UAAIG,iBAAiB,SAAjBA,cAAiB,CAASC,KAAT,EAAe;AAClC,YAAGf,gBAAgB,CAAnB,EAAqB;AACnB,cAAIgB,YAAYD,MAAMT,OAAtB;AACA,cAAIW,YAAYF,MAAMR,OAAtB;AACA,cAAGS,aAAa,IAAhB,EAAqB;AACnBA,wBAAYD,MAAMP,OAAN,CAAc,CAAd,EAAiBC,OAA7B;AACAQ,wBAAYF,MAAMP,OAAN,CAAc,CAAd,EAAiBE,OAA7B;AACD;AACD,cAAIQ,WAAW5D,MAAMe,QAAN,EAAf;AACA,cAAI8C,WAAW7D,MAAMiB,QAAN,EAAf;AACAjB,gBAAMQ,QAAN,CAAeR,MAAMe,QAAN,MAAoB2C,YAAYf,aAAhC,CAAf;AACA3C,gBAAMY,QAAN,CAAeZ,MAAMiB,QAAN,MAAoB0C,YAAYf,aAAhC,CAAf;AACA,cAAG5C,MAAMe,QAAN,KAAmB,EAAtB,EAA0Bf,MAAMQ,QAAN,CAAe,EAAf;AAC1B,cAAGR,MAAMiB,QAAN,KAAmB,EAAtB,EAA0BjB,MAAMY,QAAN,CAAe,EAAf;AAC1B,cAAGZ,MAAMO,OAAN,KAAkB,IAAEuD,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAApB,GAAoD/D,MAAMe,QAAN,EAApD,GAAuEf,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBC,WAAhG,EACEX,MAAMQ,QAAN,CAAeR,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBC,WAAtB,GAAkCX,MAAMO,OAAN,EAAlC,GAAkD,IAAEuD,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAnE;AACF,cAAG/D,MAAMmB,OAAN,KAAkB,IAAE2C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAApB,GAAoD/D,MAAMiB,QAAN,EAApD,GAAuEjB,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBG,YAAhG,EACEb,MAAMY,QAAN,CAAeZ,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBG,YAAtB,GAAmCb,MAAMmB,OAAN,EAAnC,GAAmD,IAAE2C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAApE;AACF,cAAGH,WAAW,EAAX,IAAiBC,WAAW,EAA/B,EAAkC;AAChC,gBAAG7D,MAAMe,QAAN,KAAmB6C,QAAnB,IAA+B5D,MAAMiB,QAAN,KAAmB4C,QAArD,EAA8D;AAC5DG;AACD,aAFD,MAEM,IAAGhE,MAAMe,QAAN,KAAmB6C,QAAtB,EAA+B;AACnCK;AACAjE,oBAAMY,QAAN,CAAeiD,QAAf;AACD,aAHK,MAGC,IAAG7D,MAAMiB,QAAN,KAAmB4C,QAAtB,EAA+B;AACpCK;AACAlE,oBAAMQ,QAAN,CAAeoD,QAAf;AACD,aAHM,MAGA;AACL5D,oBAAMQ,QAAN,CAAeoD,QAAf;AACA5D,oBAAMY,QAAN,CAAeiD,QAAf;AACD;AACF,WAbD,MAaO,IAAGD,WAAW,EAAd,EAAiB;AACtBM;AACA,gBAAGN,WAAW5D,MAAMe,QAAN,EAAd,EAA+B;AAC7BkD;AACD,aAFD,MAEO;AACLjE,oBAAMQ,QAAN,CAAeoD,QAAf;AACD;AACF,WAPM,MAOA,IAAGC,WAAW,EAAd,EAAiB;AACtBI;AACA,gBAAGJ,WAAW7D,MAAMmB,OAAN,EAAd,EAA8B;AAC5B+C;AACD,aAFD,MAEK;AACHlE,oBAAMY,QAAN,CAAeiD,QAAf;AACD;AACF,WAPM,MAOA;AACLG;AACD;AACDhE,gBAAMC,OAAN,GAAgBkE,UAAhB,CAA2BC,SAA3B,EAAsCpE,MAAM1D,IAA5C;AACA,cAAI+H,cAAcrE,MAAMC,OAAN,GAAgBqE,oBAAhB,CAAqCtE,MAAM1D,IAA3C,EAAiD0D,MAAMO,OAAN,KAAgBuD,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAhB,GAAiD/D,MAAMe,QAAN,KAAiB,CAAnH,EAAuHf,MAAMmB,OAAN,KAAgB2C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAhB,GAAiD/D,MAAMiB,QAAN,KAAiB,CAAzL,CAAlB;AACAmD,oBAAUG,SAAV,CAAoB;AAClBC,eAAGH,YAAY,CAAZ,CADe;AAElBI,eAAGJ,YAAY,CAAZ,CAFe;AAGlBK,kBAAM;AAHY,WAApB;AAKA1E,gBAAMC,OAAN,GAAgB0E,UAAhB,CAA2BP,SAA3B;AACD;;AAED,iBAASH,OAAT,GAAkB;AAChB9D,cAAIG,KAAJ,CAAUe,KAAV,GAAkBrB,MAAMe,QAAN,KAAiB,IAAnC;AACA4B,0BAAgBe,SAAhB;AACD;;AAED,iBAASQ,OAAT,GAAkB;AAChB/D,cAAIG,KAAJ,CAAUgB,MAAV,GAAmBtB,MAAMiB,QAAN,KAAiB,IAApC;AACA2B,0BAAgBe,SAAhB;AACD;;AAED,iBAASK,UAAT,GAAqB;AACnB7D,cAAIG,KAAJ,CAAUe,KAAV,GAAkBrB,MAAMe,QAAN,KAAiB,IAAnC;AACAZ,cAAIG,KAAJ,CAAUgB,MAAV,GAAmBtB,MAAMiB,QAAN,KAAiB,IAApC;AACA0B,0BAAgBe,SAAhB;AACAd,0BAAgBe,SAAhB;AACD;AACF,OA1ED;;AA4EA3D,YAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBnC,gBAAtB,CAAuC,WAAvC,EAAoDiF,cAApD;AACAxD,YAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBnC,gBAAtB,CAAuC,WAAvC,EAAoDiF,cAApD;;AAEA;AACA,UAAID,SAAS,CAAb;;AAEA,UAAIqB,iBAAiB,SAAjBA,cAAiB,CAASnB,KAAT,EAAe;AAClCF,iBAAS,CAAT;AACA,YAAGE,MAAMT,OAAN,IAAiB,IAApB,EAAyB;AACvBjB,sBAAY0B,MAAMT,OAAN,GAAgBhD,MAAMO,OAAN,EAA5B;AACAyB,sBAAYyB,MAAMR,OAAN,GAAgBjD,MAAMmB,OAAN,EAA5B;AACD,SAHD,MAGK;AACHY,sBAAY0B,MAAMP,OAAN,CAAc,CAAd,EAAiBC,OAAjB,GAA2BnD,MAAMO,OAAN,EAAvC;AACAyB,sBAAYyB,MAAMP,OAAN,CAAc,CAAd,EAAiBE,OAAjB,GAA2BpD,MAAMmB,OAAN,EAAvC;AACD;AACF,OATD;AAUAhB,UAAI5B,gBAAJ,CAAqB,WAArB,EAAkCqG,cAAlC;AACAzE,UAAI5B,gBAAJ,CAAqB,YAArB,EAAmCqG,cAAnC;;AAEAzE,UAAI5B,gBAAJ,CAAqB,SAArB,EAAgC8E,QAAhC;AACAlD,UAAI5B,gBAAJ,CAAqB,UAArB,EAAiC8E,QAAjC;;AAEA,UAAIwB,YAAY,SAAZA,SAAY,CAASpB,KAAT,EAAe;AAC7B,YAAGF,UAAU,CAAV,IAAeb,gBAAgB,CAAlC,EAAoC;AAClCb,2BAAiB4B,MAAMT,OAAvB;AACAlB,2BAAiB2B,MAAMR,OAAvB;AACA,cAAGpB,kBAAkB,IAArB,EAA0B;AACxBA,6BAAiB4B,MAAMP,OAAN,CAAc,CAAd,EAAiBC,OAAlC;AACArB,6BAAiB2B,MAAMP,OAAN,CAAc,CAAd,EAAiBE,OAAlC;AACD;AACDpD,gBAAMc,OAAN,CAAce,iBAAiBE,SAA/B;AACA/B,gBAAMgB,OAAN,CAAcc,iBAAiBE,SAA/B;AACA,cAAGhC,MAAMO,OAAN,KAAkB,CAArB,EAAwBP,MAAMc,OAAN,CAAc,CAAd;AACxB,cAAGd,MAAMO,OAAN,KAAgBP,MAAMe,QAAN,EAAhB,GAAiC,IAAE+C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAnC,GAAqE/D,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBC,WAA9F,EACEX,MAAMc,OAAN,CAAcd,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBC,WAAtB,GAAoC,IAAEmD,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAtC,GAAwE/D,MAAMe,QAAN,EAAtF;AACF,cAAGf,MAAMmB,OAAN,KAAkB,CAArB,EAAwBnB,MAAMgB,OAAN,CAAc,CAAd;AACxB,cAAGhB,MAAMmB,OAAN,KAAgBnB,MAAMiB,QAAN,EAAhB,GAAiC,IAAE6C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAnC,GAAqE/D,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBG,YAA9F,EACEb,MAAMgB,OAAN,CAAchB,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBG,YAAtB,GAAqC,IAAEiD,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAvC,GAAyE/D,MAAMiB,QAAN,EAAvF;;AAEFd,cAAIG,KAAJ,CAAUY,GAAV,GAAgBlB,MAAMmB,OAAN,KAAgB,IAAhC;AACAhB,cAAIG,KAAJ,CAAUc,IAAV,GAAiBpB,MAAMO,OAAN,KAAgB,IAAjC;AACAP,gBAAMC,OAAN,GAAgBkE,UAAhB,CAA2BC,SAA3B,EAAsCpE,MAAM1D,IAA5C;AACA,cAAIwI,WAAW9E,MAAMC,OAAN,GAAgBqE,oBAAhB,CAAqCtE,MAAM1D,IAA3C,EAAiD0D,MAAMO,OAAN,KAAgBP,MAAMe,QAAN,KAAiB,CAAjC,GAAmC+C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAApF,EAAqH/D,MAAMmB,OAAN,KAAgBnB,MAAMiB,QAAN,KAAiB,CAAjC,GAAmC6C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAxJ,CAAf;AACAK,oBAAUG,SAAV,CAAoB;AAClBC,eAAGM,SAAS,CAAT,CADe;AAElBL,eAAGK,SAAS,CAAT,CAFe;AAGlBJ,kBAAM;AAHY,WAApB;AAKD;AACF,OA3BD;;AA6BAvE,UAAI5B,gBAAJ,CAAqB,WAArB,EAAkCsG,SAAlC;AACA1E,UAAI5B,gBAAJ,CAAqB,WAArB,EAAkCsG,SAAlC;AACA7E,YAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBnC,gBAAtB,CAAuC,WAAvC,EAAoDsG,SAApD;AACA7E,YAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBnC,gBAAtB,CAAuC,WAAvC,EAAoDsG,SAApD;;AAEA;AACA,WAAKvI,IAAL,CAAUyI,YAAV,GAAyBC,WAAzB,CAAqC7E,GAArC;AACA,UAAIiE,YAAYnH,EAAEF,GAAF,CAAM;AACpBkI,mBAAU;AADU,OAAN,CAAhB;;AAIA;AACA,UAAIC,aAAa,KAAK1I,KAAL,CAAW8B,aAAX,CAAyB,wBAAzB,CAAjB;AACA4G,iBAAW5E,KAAX,CAAiB6E,OAAjB,GAA2B,OAA3B;;AAEA,UAAIC,aAAapF,MAAMvD,OAAN,CAAc4I,OAAOC,IAAP,CAAYtF,MAAMvD,OAAlB,EAA2B,CAA3B,CAAd,CAAjB;AACA,UAAI8I,WAAWH,WAAWC,OAAOC,IAAP,CAAYF,UAAZ,EAAwB,CAAxB,CAAX,CAAf;AACApF,YAAMwF,WAAN,CAAkBpB,SAAlB,EAA6BmB,QAA7B;;AAEA,4BAAEtJ,MAAF,EAAUwJ,MAAV,CAAiB,YAAU;AACzBrH,mBAAW,YAAU;AACnB4B,gBAAMQ,QAAN,CAAeR,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBC,WAAtB,GAAkC,CAAjD;AACAX,gBAAMY,QAAN,CAAeZ,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBG,YAAtB,GAAmC,CAAlD;AACAb,gBAAMc,OAAN,CAAcd,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBC,WAAtB,GAAkC,CAAlC,GAAsCX,MAAMe,QAAN,KAAiB,CAArE;AACAf,gBAAMgB,OAAN,CAAchB,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBG,YAAtB,GAAmC,CAAnC,GAAuCb,MAAMiB,QAAN,KAAiB,CAAtE;;AAEAd,cAAIG,KAAJ,CAAUe,KAAV,GAAkBrB,MAAMe,QAAN,KAAiB,IAAnC;AACAZ,cAAIG,KAAJ,CAAUc,IAAV,GAAiBpB,MAAMO,OAAN,KAAgB,IAAjC;AACAJ,cAAIG,KAAJ,CAAUgB,MAAV,GAAmBtB,MAAMiB,QAAN,KAAiB,IAApC;AACAd,cAAIG,KAAJ,CAAUY,GAAV,GAAgBlB,MAAMmB,OAAN,KAAgB,IAAhC;;AAEAnB,gBAAMC,OAAN,GAAgBkE,UAAhB,CAA2BC,SAA3B,EAAsCpE,MAAM1D,IAA5C;AACA,cAAIwI,WAAW9E,MAAMC,OAAN,GAAgBqE,oBAAhB,CAAqCtE,MAAM1D,IAA3C,EAAiD0D,MAAMO,OAAN,KAAgBP,MAAMe,QAAN,KAAiB,CAAjC,GAAmC+C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAApF,EAAqH/D,MAAMmB,OAAN,KAAgBnB,MAAMiB,QAAN,KAAiB,CAAjC,GAAmC6C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAxJ,CAAf;AACAK,oBAAUG,SAAV,CAAoB;AAClBC,eAAGM,SAAS,CAAT,CADe;AAElBL,eAAGK,SAAS,CAAT,CAFe;AAGlBJ,kBAAM;AAHY,WAApB;AAKA1E,gBAAMC,OAAN,GAAgB0E,UAAhB,CAA2BP,SAA3B;AACD,SAnBD,EAmBG,GAnBH;AAoBD,OArBD;;AAuBAA,gBAAUnG,EAAV,CAAahB,EAAEiB,GAAF,CAAMC,SAAnB,EAA8B,YAAU;AACtC,YAAIuH,WAAW1F,MAAMC,OAAN,GAAgBqE,oBAAhB,CAAqCtE,MAAM1D,IAA3C,EAAiD0D,MAAMO,OAAN,KAAgBP,MAAMe,QAAN,KAAiB,CAAjC,GAAmC+C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAApF,EAAqH/D,MAAMmB,OAAN,KAAgBnB,MAAMiB,QAAN,KAAiB,CAAjC,GAAmC6C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAxJ,CAAf;AACAK,kBAAUuB,cAAV,CAAyB3F,MAAM1D,IAAN,CAAWsJ,cAAX,EAAzB;AACA5F,cAAMC,OAAN,GAAgBkE,UAAhB,CAA2BC,SAA3B,EAAsCpE,MAAM1D,IAA5C;AACA8H,kBAAUG,SAAV,CAAoB,EAACC,GAAGkB,SAAS,CAAT,CAAJ,EAAiBjB,GAAGiB,SAAS,CAAT,CAApB,EAAiChB,MAAM,KAAvC,EAApB;AACD,OALD;AAMA,WAAKpF,KAAL,GAAa8E,SAAb;;AAEA;AACApE,YAAMC,OAAN,GAAgB4F,gBAAhB,CAAiC,IAAjC,EAAuC7F,MAAM1D,IAA7C,EAAmD8H,SAAnD,EAA8DjE,GAA9D;;AAEAiE,gBAAUW,YAAV,GAAyBC,WAAzB,CAAqC/C,SAArC;AACAmC,gBAAUW,YAAV,GAAyBC,WAAzB,CAAqCzC,QAArC;;AAEA,WAAKtC,OAAL,GAAe6F,cAAf,CAA8B1B,SAA9B;AACA,WAAK2B,OAAL;;AAEA;AACD;;AAED;;;;;;;;;;iCAOa;AACX,6HADW,CACS;AACpB,UAAI5F,MAAM9B,SAAS2H,cAAT,CAAwB,OAAxB,CAAV;AACA,WAAK1J,IAAL,CAAUyI,YAAV,GAAyBkB,WAAzB,CAAqC9F,GAArC;AACA,UAAI+E,aAAa,KAAK1I,KAAL,CAAW8B,aAAX,CAAyB,iBAAzB,CAAjB;AACA4G,iBAAWgB,sBAAX,CAAkC,eAAlC,EAAmD,CAAnD,EAAsD1H,SAAtD,CAAgE2H,MAAhE,CAAuE,eAAvE;AACAjB,iBAAW5G,aAAX,CAAyB,UAAzB,EAAqCE,SAArC,CAA+C4H,GAA/C,CAAmD,eAAnD;AACA/H,eAASC,aAAT,CAAuB,wBAAvB,EAAiDgC,KAAjD,CAAuD6E,OAAvD,GAAiE,MAAjE;;AAEA,WAAKkB,iBAAL;AACA;AACD;AACA;;;;;;;;;;;wCAQmBvG,I,EAAM;AACxB,aAAOA,KAAKxB,aAAL,CAAmB,2BAAnB,CAAP;AACD;;;;;AAED;;;;;;;;2BAQOpB,O,EAAS;AACd,aAAOA,mBAAmBC,YAA1B;AACD;;AAED;;;;gCAEYiH,S,EAAWkC,K,EAAM;AAC3B,UAAGA,MAAM,MAAN,MAAkB,KAArB,EAA2B;AACzBlC,kBAAUmC,YAAV,CAAuBnC,UAAUoC,SAAV,EAAvB;AACApC,kBAAUqC,MAAV,CAAiB,IAAIxJ,EAAEqJ,KAAF,CAAQI,GAAZ,CAAgB;AAC/BC,eAAKL,MAAM,KAAN,CAD0B;AAE/BxK,gBAAMwK,MAAM,MAAN,CAFyB;AAG/BM,iBAAO;AAHwB,SAAhB,CAAjB;AAKD,OAPD,MAOM,IAAGN,MAAM,MAAN,MAAkB,MAArB,EAA4B;AAChClC,kBAAUmC,YAAV,CAAuBnC,UAAUoC,SAAV,EAAvB;AACApC,kBAAUyC,OAAV,CAAkB,IAAI5J,EAAEqJ,KAAF,CAAQQ,IAAZ,CAAiB;AACjCH,eAAKL,MAAM,KAAN,CAD4B;AAEjCxK,gBAAMwK,MAAM,MAAN,CAF2B;AAGjCS,qBAAW;AAHsB,SAAjB,CAAlB;AAKD;AACF;;;kCAEY;AACX,UAAI/G,QAAQ,IAAZ;AADW;AAAA;AAAA;;AAAA;AAAA;AAAA,cAEDgH,CAFC;;AAGTA,YAAEzI,gBAAF,CAAmB,OAAnB,EAA4B,YAAU;AACpCyB,kBAAMwF,WAAN,CAAkBxF,MAAMV,KAAxB,EAA+BU,MAAMiH,SAAN,CAAgBD,EAAEE,SAAlB,CAA/B;AACA7I,qBAAS6H,sBAAT,CAAgC,eAAhC,EAAiD,CAAjD,EAAoD1H,SAApD,CAA8D2H,MAA9D,CAAqE,eAArE;AACAa,cAAExI,SAAF,CAAY4H,GAAZ,CAAgB,eAAhB;AACD,WAJD;AAHS;;AAEX,6BAAepG,MAAMxD,KAAN,CAAY0J,sBAAZ,CAAmC,yBAAnC,CAAf,8HAA6E;AAAA;AAM5E;AARU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AASX,4BAAElG,MAAMxD,KAAR,EAAe2K,IAAf,CAAoB,mBAApB,EAAyCA,IAAzC,CAA8C,cAA9C,EAA8DC,KAA9D,CAAoE,UAASC,CAAT,EAAW;AAC7E,8BAAE,IAAF,EAAQC,MAAR,GAAiBH,IAAjB,CAAsB,kBAAtB,EAA0CI,MAA1C;AACD,OAFD;;AAIA,4BAAEvH,MAAMxD,KAAR,EAAe2K,IAAf,CAAoB,oBAApB,EAA0CI,MAA1C;AACA,4BAAEvH,MAAMxD,KAAR,EAAe2K,IAAf,CAAoB,sBAApB,EAA4CC,KAA5C,CAAkD,YAAU;AAC1D,8BAAEpH,MAAMxD,KAAR,EAAe2K,IAAf,CAAoB,oBAApB,EAA0CI,MAA1C;AACD,OAFD;AAGD;;;8BAESzL,I,EAAK;AACb,UAAIkE,QAAQ,IAAZ;AADa;AAAA;AAAA;;AAAA;AAEb,8BAAwBqF,OAAOmC,OAAP,CAAexH,MAAMvD,OAArB,CAAxB,mIAAsD;AAAA;AAAA,cAA3CgL,GAA2C;AAAA,cAAtCC,GAAsC;;AAAA;AAAA;AAAA;;AAAA;AACpD,kCAA8BrC,OAAOmC,OAAP,CAAeE,GAAf,CAA9B,mIAAkD;AAAA;AAAA,kBAAvCC,MAAuC;AAAA,kBAA/BC,MAA+B;;AAChD,kBAAGD,WAAW7L,IAAd,EAAmB;AACjB,uBAAO8L,MAAP;AACD;AACF;AALmD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMrD;AARY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASd;;;8BAEQ;AACP,aAAO,KAAKrI,UAAL,CAAgBgB,OAAhB,EAAP;AACD;;;8BACQ;AACP,aAAO,KAAKhB,UAAL,CAAgB4B,OAAhB,EAAP;AACD;;;4BACOvC,I,EAAK;AACX,WAAKW,UAAL,CAAgBuB,OAAhB,CAAwBlC,IAAxB;AACD;;;4BACOC,I,EAAK;AACX,WAAKU,UAAL,CAAgByB,OAAhB,CAAwBnC,IAAxB;AACD;;;+BAES;AACR,aAAO,KAAKU,UAAL,CAAgBwB,QAAhB,EAAP;AACD;;;+BACS;AACR,aAAO,KAAKxB,UAAL,CAAgB0B,QAAhB,EAAP;AACD;;;6BACQnC,K,EAAM;AACb,WAAKS,UAAL,CAAgBiB,QAAhB,CAAyB1B,KAAzB;AACD;;;6BACQC,K,EAAM;AACb,WAAKQ,UAAL,CAAgBqB,QAAhB,CAAyB7B,KAAzB;AACD;;;8BAEQ;AACP,UAAIiB,QAAQ,IAAZ;AACA,UAAI6H,UAAU,IAAIC,GAAGtF,MAAH,CAAUuF,QAAd,CAAuB,EAAEC,WAAU,SAAZ,EAAvB,CAAd;AACAhI,YAAMC,OAAN,GAAgBgI,SAAhB,CAA0BjI,MAAMV,KAAhC,EAAuCuI,OAAvC;;AAEA,UAAIrF,SAAS,IAAIsF,GAAGtF,MAAH,CAAUuF,QAAd,EAAb;AACA/H,YAAMC,OAAN,GAAgBgI,SAAhB,CAA0BjI,MAAMV,KAAhC,EAAuCkD,MAAvC;;AAEAqF,cAAQK,SAAR,CAAkB,sBAAE,YAAF,EAAgBf,IAAhB,CAAqB,oBAArB,EAA2CA,IAA3C,CAAgD,UAAhD,EAA4DgB,IAA5D,CAAiE,SAAjE,CAAlB;AACA3F,aAAO0F,SAAP,CAAiB,sBAAE,YAAF,EAAgBf,IAAhB,CAAqB,oBAArB,EAA2CA,IAA3C,CAAgD,SAAhD,EAA2DgB,IAA3D,CAAgE,SAAhE,CAAjB;;AAEA,eAASC,SAAT,GAAoB;AAClBP,gBAAQK,SAAR,CAAkB,sBAAE,YAAF,EAAgBf,IAAhB,CAAqB,oBAArB,EAA2CA,IAA3C,CAAgD,UAAhD,EAA4DgB,IAA5D,CAAiE,SAAjE,CAAlB;AACA3F,eAAO0F,SAAP,CAAiB,sBAAE,YAAF,EAAgBf,IAAhB,CAAqB,oBAArB,EAA2CA,IAA3C,CAAgD,SAAhD,EAA2DgB,IAA3D,CAAgE,SAAhE,CAAjB;;AAEA,YAAIE,IAAI,sBAAE,YAAF,EAAgBlB,IAAhB,CAAqB,oBAArB,EAA2CA,IAA3C,CAAgD,SAAhD,EAA2DmB,GAA3D,EAAR;AACA,gBAAOD,CAAP;AACE,eAAK,WAAL;AACJ,eAAK,QAAL;AACA,eAAK,OAAL;AACM7F,mBAAO4F,SAAP,CAAiBC,CAAjB;AACArI,kBAAMxD,KAAN,CAAY8B,aAAZ,CAA0B,gBAA1B,EAA4CgC,KAA5C,CAAkD6E,OAAlD,GAA2D,MAA3D;AACN;AACI;AACE3C,mBAAO4F,SAAP,CAAiB;AACfJ,yBAAWK,CADI;AAEfE,mBAAKC,OAAO,sBAAE,YAAF,EAAgBrB,IAAhB,CAAqB,oBAArB,EAA2CA,IAA3C,CAAgD,cAAhD,EAAgEmB,GAAhE,EAAP,CAFU;AAGfG,qBAAOD,OAAO,sBAAE,YAAF,EAAgBrB,IAAhB,CAAqB,oBAArB,EAA2CA,IAA3C,CAAgD,gBAAhD,EAAkEmB,GAAlE,EAAP,CAHQ;AAIfI,oBAAMF,OAAO,sBAAE,YAAF,EAAgBrB,IAAhB,CAAqB,oBAArB,EAA2CA,IAA3C,CAAgD,eAAhD,EAAiEmB,GAAjE,EAAP,CAJS;AAKfK,qBAAOH,OAAO,sBAAE,YAAF,EAAgBrB,IAAhB,CAAqB,oBAArB,EAA2CA,IAA3C,CAAgD,cAAhD,EAAgEmB,GAAhE,EAAP;AALQ,aAAjB;AAOAtI,kBAAMxD,KAAN,CAAY8B,aAAZ,CAA0B,gBAA1B,EAA4CgC,KAA5C,CAAkD6E,OAAlD,GAA2D,OAA3D;AACF;AAhBF;AAkBD;AACDiD;AACA,4BAAE,eAAF,EAAmBnK,EAAnB,CAAsB,OAAtB,EAA+BmK,SAA/B;AACD;;;wCAEkB;AACjB,4BAAE,YAAF,EAAgBjB,IAAhB,CAAqB,oBAArB,EAA2CA,IAA3C,CAAgD,UAAhD,EAA4DgB,IAA5D,CAAiE,SAAjE,EAA4E,KAA5E;AACA,4BAAE,YAAF,EAAgBhB,IAAhB,CAAqB,oBAArB,EAA2CA,IAA3C,CAAgD,SAAhD,EAA2DgB,IAA3D,CAAgE,SAAhE,EAA2E,KAA3E;AACD;;;;EAne+BlL,EAAE2L,O;;;;;;;;;;;;;;;;;;;;ACLpC;;;;;;;;;;;;IAGazL,Y,WAAAA,Y,WADZ,yBAAU,gBAAV,C;;;AAEC;;;;;;;;AAQA,0BAAc;AAAA;;AAAA;AAEb;AACD;;;;;;;;;;;;;0BASMJ,G,EAAK+C,I,EAAM;AACf,wHAAY/C,GAAZ,EAAiB+C,IAAjB;AACD;;AAEA;;;;mCAEc/C,G,EAAI;AACjBA,UAAIkB,EAAJ,CAAOhB,EAAEiB,GAAF,CAAMC,SAAb,EAAwB,YAAU;AAChCpB,YAAI8L,cAAJ,CAAmB9L,IAAI+L,WAAJ,EAAnB;AACA/L,YAAIgM,UAAJ,GAAiBC,eAAjB,GAAmCC,OAAnC,CAA2C,UAACC,CAAD,EAAO;AAChDA,YAAEhB,SAAF,CAAY,KAAZ;AACD,SAFD;AAGD,OALD;AAMD;;;yCAEoBnL,G,EAAKyH,C,EAAGC,C,EAAE;AAC7B,aAAO1H,IAAIgM,UAAJ,GAAiBI,sBAAjB,CAAwC,CAAC3E,CAAD,EAAIC,CAAJ,CAAxC,CAAP;AACD;;;+BAEU1H,G,EAAI;AACbA,UAAIgM,UAAJ,GAAiBpE,UAAjB;AACD;;;+BAEUyE,W,EAAaC,S,EAAU;AAChCD,kBAAYE,OAAZ,CAAoBD,UAAUE,OAAV,EAApB;AACA;AACD;;;qCAEgBtK,C,EAAGlC,G,EAAKqH,S,EAAWjE,G,EAAI;AACtC,UAAIH,QAAQf,CAAZ;AACA,UAAIuK,aAAa,IAAjB;;AAEAzM,UAAIgM,UAAJ,GAAiBU,OAAjB,GAA2BxL,EAA3B,CAA8B,gBAA9B,EAAgD,UAASoJ,CAAT,EAAY;AACxD,YAAItE,SAASyG,WAAWlF,oBAAX,CAAgCvH,GAAhC,EAAqCiD,MAAMO,OAAN,KAAgBP,MAAMe,QAAN,KAAiB,CAAjC,GAAmC+C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAxE,EAAyG/D,MAAMmB,OAAN,KAAgBnB,MAAMiB,QAAN,KAAiB,CAAjC,GAAmC6C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAA5I,CAAb;AACAK,kBAAUG,SAAV,CAAoB;AAClBC,aAAGzB,OAAO,CAAP,CADe;AAElB0B,aAAG1B,OAAO,CAAP,CAFe;AAGlB2B,gBAAM;AAHY,SAApB;AAKA;AACA8E,mBAAWrF,UAAX,CAAsBC,SAAtB,EAAiCrH,GAAjC;AACH,OATD;AAUD;;;4BAEOA,G,EAAI;AACVA,UAAIgM,UAAJ,GAAiBU,OAAjB,GAA2BH,OAA3B,CAAmCI,KAAKC,KAAL,CAAW5M,IAAIgM,UAAJ,GAAiBU,OAAjB,GAA2BF,OAA3B,EAAX,CAAnC;AACD;;;8BAESxM,G,EAAKyF,M,EAAO;AACpBzF,UAAIgM,UAAJ,GAAiBd,SAAjB,CAA2BzF,MAA3B;AACD;;;;EAvE+BvF,EAAEmC,IAAF,CAAOwJ,O;;;;;;;;;;;;;;;;;;;;ACHzC;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;;;;;;;;;;;AACA,mBAAAgB,CAAQ,EAAR;;IAGavM,e,WAAAA,e,WADZ,yBAAU,WAAV,C;;;AAGC;;;;;;;;;AASA,2BAAY4B,CAAZ,EAAe;AAAA;;AACb;AACA,QAAIhC,EAAEiC,KAAF,CAAQC,WAAR,CAAoBlC,EAAEmC,IAAF,CAAOlC,OAAP,CAAeG,eAAnC,CAAJ,EAAyD;AACvDJ,QAAEoC,SAAF,CAAY,kEAAZ;AACD;AACD;AACA,QAAID,OAAO,IAAInC,EAAEmC,IAAF,CAAOlC,OAAP,CAAeG,eAAnB,EAAX;;AANa,mIAOP+B,IAPO,EAOD,OAPC;;AAQb,WAAK5C,KAAL,GAAa,IAAb;AACA,WAAK+C,UAAL,GAAkBN,CAAlB;AATa;AAUd;AACD;;;;;;;;;;;;+BAQYlC,G,EAAK;AAAA;;AACd,aAAO,IAAIyC,OAAJ,CAAY,UAACC,OAAD,EAAUC,IAAV,EAAmB;AACrC,eAAOzC,EAAE0C,QAAF,CAAWC,OAAX,CAAmB,eAAnB,EAAoCC,IAApC,CAAyC,gBAAQ;AACrD;AACC,iBAAKrD,KAAL,GAAasD,IAAb;AACA,iBAAKC,WAAL;AACAN,kBAAQK,IAAR;AACD,SALI,CAAP;AAMD,OAPO,CAAP;AAQD;AACF;;;;;;;;;;+BAOW;AACT,UAAIE,QAAQ,IAAZ;AACA,iIAFS,CAES;AAClB;AACA,WAAKC,OAAL,GAAeC,OAAf,CAAuBF,MAAM1D,IAA7B;AACA,UAAI6D,MAAM9B,SAAS+B,aAAT,CAAuB,KAAvB,CAAV;AACAD,UAAIE,EAAJ,GAAS,UAAT;AACAF,UAAIG,KAAJ,CAAU3C,QAAV,GAAqB,UAArB;AACA,UAAGqC,MAAMO,OAAN,MAAmB,IAAtB,EAA2B;AACzBP,cAAMQ,QAAN,CAAeR,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBC,WAAtB,GAAkC,CAAjD;AACAX,cAAMY,QAAN,CAAeZ,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBG,YAAtB,GAAmC,CAAlD;AACAb,cAAMc,OAAN,CAAcd,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBC,WAAtB,GAAkC,CAAlC,GAAsCX,MAAMe,QAAN,KAAiB,CAArE;AACAf,cAAMgB,OAAN,CAAchB,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBG,YAAtB,GAAmC,CAAnC,GAAuCb,MAAMiB,QAAN,KAAiB,CAAtE;AACD;AACDd,UAAIG,KAAJ,CAAUe,KAAV,GAAkBrB,MAAMe,QAAN,KAAiB,IAAnC;AACAZ,UAAIG,KAAJ,CAAUgB,MAAV,GAAmBtB,MAAMiB,QAAN,KAAiB,IAApC;AACAd,UAAIG,KAAJ,CAAUY,GAAV,GAAgBlB,MAAMmB,OAAN,KAAkB,IAAlC;AACAhB,UAAIG,KAAJ,CAAUc,IAAV,GAAiBpB,MAAMO,OAAN,KAAkB,IAAnC;AACAJ,UAAIG,KAAJ,CAAUiB,MAAV,GAAmB,8BAAnB;AACApB,UAAIG,KAAJ,CAAUkB,YAAV,GAAyB,KAAzB;AACArB,UAAIG,KAAJ,CAAUmB,UAAV,GAAuB,MAAvB;;AAEAtB,UAAIG,KAAJ,CAAUoB,eAAV,GAA4B,mCAA5B;AACAvB,UAAIG,KAAJ,CAAUqB,YAAV,GAAyB,mCAAzB;AACAxB,UAAIG,KAAJ,CAAUsB,SAAV,GAAsB,oCAAtB;;AAEA,UAAIC,iBAAiB,IAArB;AACA,UAAIC,iBAAiB,IAArB;AACA,UAAIC,YAAY,IAAhB;AACA,UAAIC,YAAY,IAAhB;;AAEA;AACA,UAAIC,YAAY5D,SAAS+B,aAAT,CAAuB,KAAvB,CAAhB;AACA6B,gBAAU3B,KAAV,CAAgB3C,QAAhB,GAA2B,UAA3B;AACAsE,gBAAU3B,KAAV,CAAgB4B,KAAhB,GAAsB,KAAtB;AACAD,gBAAU3B,KAAV,CAAgB6B,MAAhB,GAAuB,KAAvB;AACAF,gBAAU3B,KAAV,CAAgBe,KAAhB,GAAsB,MAAtB;AACAY,gBAAU3B,KAAV,CAAgBgB,MAAhB,GAAuB,MAAvB;AACAW,gBAAU3B,KAAV,CAAgB8B,MAAhB,GAAuB,aAAvB;AACAH,gBAAU3B,KAAV,CAAgB+B,eAAhB,GAAkC,6GAAlC;AACAJ,gBAAU3B,KAAV,CAAgBgC,cAAhB,GAAiC,MAAjC;;AAEA;AACA,UAAIC,WAAWlE,SAAS+B,aAAT,CAAuB,KAAvB,CAAf;AACAmC,eAASjC,KAAT,CAAe3C,QAAf,GAA0B,UAA1B;AACA4E,eAASjC,KAAT,CAAe4B,KAAf,GAAqB,KAArB;AACAK,eAASjC,KAAT,CAAeY,GAAf,GAAmB,KAAnB;AACAqB,eAASjC,KAAT,CAAee,KAAf,GAAqB,MAArB;AACAkB,eAASjC,KAAT,CAAegB,MAAf,GAAsB,MAAtB;AACAiB,eAASjC,KAAT,CAAekC,MAAf,GAAwB,cAAxB;AACAD,eAASjC,KAAT,CAAe8B,MAAf,GAAsB,SAAtB;AACAG,eAASjC,KAAT,CAAe+B,eAAf,GAAiC,6GAAjC;AACAE,eAASjC,KAAT,CAAegC,cAAf,GAAgC,MAAhC;;AAEAC,eAAShE,gBAAT,CAA0B,OAA1B,EAAmC,YAAU;AAC3CyB,cAAMyC,UAAN;AACD,OAFD;;AAIA;AACA;AACA,UAAIC,eAAe,CAAnB;AACA,UAAIC,gBAAgB,IAApB;AACA,UAAIC,gBAAgB,IAApB;;AAEA,UAAIC,mBAAmB,SAASC,YAAT,CAAsBC,MAAtB,EAA6B;AAClDL,uBAAe,CAAf;AACAC,wBAAgBI,OAAOC,OAAvB;AACAJ,wBAAgBG,OAAOE,OAAvB;AACA,YAAGN,iBAAiB,IAApB,EAAyB;AACvBA,0BAAgBI,OAAOG,OAAP,CAAe,CAAf,EAAkBC,OAAlC;AACAP,0BAAgBG,OAAOG,OAAP,CAAe,CAAf,EAAkBE,OAAlC;AACD;AACF,OARD;AASA,UAAIC,WAAW,SAASC,IAAT,GAAe;AAC5BZ,uBAAe,CAAf;AACAa,iBAAS,CAAT;AACD,OAHD;AAIAtB,gBAAU1D,gBAAV,CAA2B,WAA3B,EAAwCsE,gBAAxC;AACAZ,gBAAU1D,gBAAV,CAA2B,YAA3B,EAAyCsE,gBAAzC;AACA7C,YAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBnC,gBAAtB,CAAuC,SAAvC,EAAkD8E,QAAlD;AACArD,YAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBnC,gBAAtB,CAAuC,YAAvC,EAAqD8E,QAArD;;AAEA,UAAIG,iBAAiB,SAAjBA,cAAiB,CAASC,KAAT,EAAe;AAClC,YAAGf,gBAAgB,CAAnB,EAAqB;AACnB,cAAIgB,YAAYD,MAAMT,OAAtB;AACA,cAAIW,YAAYF,MAAMR,OAAtB;AACA,cAAGS,aAAa,IAAhB,EAAqB;AACnBA,wBAAYD,MAAMP,OAAN,CAAc,CAAd,EAAiBC,OAA7B;AACAQ,wBAAYF,MAAMP,OAAN,CAAc,CAAd,EAAiBE,OAA7B;AACD;AACD,cAAIQ,WAAW5D,MAAMe,QAAN,EAAf;AACA,cAAI8C,WAAW7D,MAAMiB,QAAN,EAAf;AACAjB,gBAAMQ,QAAN,CAAeR,MAAMe,QAAN,MAAoB2C,YAAYf,aAAhC,CAAf;AACA3C,gBAAMY,QAAN,CAAeZ,MAAMiB,QAAN,MAAoB0C,YAAYf,aAAhC,CAAf;AACA,cAAG5C,MAAMe,QAAN,KAAmB,EAAtB,EAA0Bf,MAAMQ,QAAN,CAAe,EAAf;AAC1B,cAAGR,MAAMiB,QAAN,KAAmB,EAAtB,EAA0BjB,MAAMY,QAAN,CAAe,EAAf;AAC1B,cAAGZ,MAAMO,OAAN,KAAkB,IAAEuD,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAApB,GAAoD/D,MAAMe,QAAN,EAApD,GAAuEf,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBC,WAAhG,EACEX,MAAMQ,QAAN,CAAeR,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBC,WAAtB,GAAkCX,MAAMO,OAAN,EAAlC,GAAkD,IAAEuD,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAnE;AACF,cAAG/D,MAAMmB,OAAN,KAAkB,IAAE2C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAApB,GAAoD/D,MAAMiB,QAAN,EAApD,GAAuEjB,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBG,YAAhG,EACEb,MAAMY,QAAN,CAAeZ,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBG,YAAtB,GAAmCb,MAAMmB,OAAN,EAAnC,GAAmD,IAAE2C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAApE;AACF,cAAGH,WAAW,EAAX,IAAiBC,WAAW,EAA/B,EAAkC;AAChC,gBAAG7D,MAAMe,QAAN,KAAmB6C,QAAnB,IAA+B5D,MAAMiB,QAAN,KAAmB4C,QAArD,EAA8D;AAC5DG;AACD,aAFD,MAEM,IAAGhE,MAAMe,QAAN,KAAmB6C,QAAtB,EAA+B;AACnCK;AACAjE,oBAAMY,QAAN,CAAeiD,QAAf;AACD,aAHK,MAGC,IAAG7D,MAAMiB,QAAN,KAAmB4C,QAAtB,EAA+B;AACpCK;AACAlE,oBAAMQ,QAAN,CAAeoD,QAAf;AACD,aAHM,MAGA;AACL5D,oBAAMQ,QAAN,CAAeoD,QAAf;AACA5D,oBAAMY,QAAN,CAAeiD,QAAf;AACD;AACF,WAbD,MAaO,IAAGD,WAAW,EAAd,EAAiB;AACtBM;AACA,gBAAGN,WAAW5D,MAAMe,QAAN,EAAd,EAA+B;AAC7BkD;AACD,aAFD,MAEO;AACLjE,oBAAMQ,QAAN,CAAeoD,QAAf;AACD;AACF,WAPM,MAOA,IAAGC,WAAW,EAAd,EAAiB;AACtBI;AACA,gBAAGJ,WAAW7D,MAAMmB,OAAN,EAAd,EAA8B;AAC5B+C;AACD,aAFD,MAEK;AACHlE,oBAAMY,QAAN,CAAeiD,QAAf;AACD;AACF,WAPM,MAOA;AACLG;AACD;AACDhE,gBAAMC,OAAN,GAAgBkE,UAAhB,CAA2BC,SAA3B,EAAsCpE,MAAM1D,IAA5C;AACA,cAAI+H,cAAcrE,MAAMC,OAAN,GAAgBqE,oBAAhB,CAAqCtE,MAAM1D,IAA3C,EAAiD0D,MAAMO,OAAN,KAAgBuD,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAhB,GAAiD/D,MAAMe,QAAN,KAAiB,CAAnH,EAAuHf,MAAMmB,OAAN,KAAgB2C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAhB,GAAiD/D,MAAMiB,QAAN,KAAiB,CAAzL,CAAlB;AACAmD,oBAAUG,SAAV,CAAoB;AAClBC,eAAGH,YAAY,CAAZ,CADe;AAElBI,eAAGJ,YAAY,CAAZ,CAFe;AAGlBK,kBAAM;AAHY,WAApB;AAKA1E,gBAAMC,OAAN,GAAgB0E,UAAhB,CAA2BP,SAA3B;AACD;;AAED,iBAASH,OAAT,GAAkB;AAChB9D,cAAIG,KAAJ,CAAUe,KAAV,GAAkBrB,MAAMe,QAAN,KAAiB,IAAnC;AACA4B,0BAAgBe,SAAhB;AACD;;AAED,iBAASQ,OAAT,GAAkB;AAChB/D,cAAIG,KAAJ,CAAUgB,MAAV,GAAmBtB,MAAMiB,QAAN,KAAiB,IAApC;AACA2B,0BAAgBe,SAAhB;AACD;;AAED,iBAASK,UAAT,GAAqB;AACnB7D,cAAIG,KAAJ,CAAUe,KAAV,GAAkBrB,MAAMe,QAAN,KAAiB,IAAnC;AACAZ,cAAIG,KAAJ,CAAUgB,MAAV,GAAmBtB,MAAMiB,QAAN,KAAiB,IAApC;AACA0B,0BAAgBe,SAAhB;AACAd,0BAAgBe,SAAhB;AACD;AACF,OA1ED;;AA4EA3D,YAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBnC,gBAAtB,CAAuC,WAAvC,EAAoDiF,cAApD;AACAxD,YAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBnC,gBAAtB,CAAuC,WAAvC,EAAoDiF,cAApD;;AAEA;AACA,UAAID,SAAS,CAAb;;AAEA,UAAIqB,iBAAiB,SAAjBA,cAAiB,CAASnB,KAAT,EAAe;AAClCF,iBAAS,CAAT;AACA,YAAGE,MAAMT,OAAN,IAAiB,IAApB,EAAyB;AACvBjB,sBAAY0B,MAAMT,OAAN,GAAgBhD,MAAMO,OAAN,EAA5B;AACAyB,sBAAYyB,MAAMR,OAAN,GAAgBjD,MAAMmB,OAAN,EAA5B;AACD,SAHD,MAGK;AACHY,sBAAY0B,MAAMP,OAAN,CAAc,CAAd,EAAiBC,OAAjB,GAA2BnD,MAAMO,OAAN,EAAvC;AACAyB,sBAAYyB,MAAMP,OAAN,CAAc,CAAd,EAAiBE,OAAjB,GAA2BpD,MAAMmB,OAAN,EAAvC;AACD;AACF,OATD;AAUAhB,UAAI5B,gBAAJ,CAAqB,WAArB,EAAkCqG,cAAlC;AACAzE,UAAI5B,gBAAJ,CAAqB,YAArB,EAAmCqG,cAAnC;;AAEAzE,UAAI5B,gBAAJ,CAAqB,SAArB,EAAgC8E,QAAhC;AACAlD,UAAI5B,gBAAJ,CAAqB,UAArB,EAAiC8E,QAAjC;;AAEA,UAAIwB,YAAY,SAAZA,SAAY,CAASpB,KAAT,EAAe;AAC7B,YAAGF,UAAU,CAAV,IAAeb,gBAAgB,CAAlC,EAAoC;AAClCb,2BAAiB4B,MAAMT,OAAvB;AACAlB,2BAAiB2B,MAAMR,OAAvB;AACA,cAAGpB,kBAAkB,IAArB,EAA0B;AACxBA,6BAAiB4B,MAAMP,OAAN,CAAc,CAAd,EAAiBC,OAAlC;AACArB,6BAAiB2B,MAAMP,OAAN,CAAc,CAAd,EAAiBE,OAAlC;AACD;AACDpD,gBAAMc,OAAN,CAAce,iBAAiBE,SAA/B;AACA/B,gBAAMgB,OAAN,CAAcc,iBAAiBE,SAA/B;AACA,cAAGhC,MAAMO,OAAN,KAAkB,CAArB,EAAwBP,MAAMc,OAAN,CAAc,CAAd;AACxB,cAAGd,MAAMO,OAAN,KAAgBP,MAAMe,QAAN,EAAhB,GAAiC,IAAE+C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAnC,GAAqE/D,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBC,WAA9F,EACEX,MAAMc,OAAN,CAAcd,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBC,WAAtB,GAAoC,IAAEmD,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAtC,GAAwE/D,MAAMe,QAAN,EAAtF;AACF,cAAGf,MAAMmB,OAAN,KAAkB,CAArB,EAAwBnB,MAAMgB,OAAN,CAAc,CAAd;AACxB,cAAGhB,MAAMmB,OAAN,KAAgBnB,MAAMiB,QAAN,EAAhB,GAAiC,IAAE6C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAnC,GAAqE/D,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBG,YAA9F,EACEb,MAAMgB,OAAN,CAAchB,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBG,YAAtB,GAAqC,IAAEiD,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAvC,GAAyE/D,MAAMiB,QAAN,EAAvF;;AAEFd,cAAIG,KAAJ,CAAUY,GAAV,GAAgBlB,MAAMmB,OAAN,KAAgB,IAAhC;AACAhB,cAAIG,KAAJ,CAAUc,IAAV,GAAiBpB,MAAMO,OAAN,KAAgB,IAAjC;AACAP,gBAAMC,OAAN,GAAgBkE,UAAhB,CAA2BC,SAA3B,EAAsCpE,MAAM1D,IAA5C;AACA,cAAIwI,WAAW9E,MAAMC,OAAN,GAAgBqE,oBAAhB,CAAqCtE,MAAM1D,IAA3C,EAAiD0D,MAAMO,OAAN,KAAgBP,MAAMe,QAAN,KAAiB,CAAjC,GAAmC+C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAApF,EAAqH/D,MAAMmB,OAAN,KAAgBnB,MAAMiB,QAAN,KAAiB,CAAjC,GAAmC6C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAxJ,CAAf;AACAK,oBAAUG,SAAV,CAAoB;AAClBC,eAAGM,SAAS,CAAT,CADe;AAElBL,eAAGK,SAAS,CAAT,CAFe;AAGlBJ,kBAAM;AAHY,WAApB;AAKD;AACF,OA3BD;;AA6BAvE,UAAI5B,gBAAJ,CAAqB,WAArB,EAAkCsG,SAAlC;AACA1E,UAAI5B,gBAAJ,CAAqB,WAArB,EAAkCsG,SAAlC;AACA7E,YAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBnC,gBAAtB,CAAuC,WAAvC,EAAoDsG,SAApD;AACA7E,YAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBnC,gBAAtB,CAAuC,WAAvC,EAAoDsG,SAApD;;AAEA;AACA,WAAKvI,IAAL,CAAUyI,YAAV,GAAyBC,WAAzB,CAAqC7E,GAArC;AACA,UAAIiE,YAAYnH,EAAEF,GAAF,CAAM;AACpBkI,mBAAU,UADU;AAEpBqB,eAAO;AAFa,OAAN,CAAhB;AAIAlC,gBAAUmC,YAAV,CAAuBnC,UAAUoC,SAAV,EAAvB;AACApC,gBAAUqC,MAAV,CAAiB,IAAIxJ,EAAEqJ,KAAF,CAAQI,GAAZ,CAAgB;AAC/BC,aAAK,+DAD0B;AAE/B7K,cAAM,UAFyB;AAG/B8K,eAAO;AAHwB,OAAhB,CAAjB;;AAMA;AACA,WAAK3G,OAAL,GAAe4F,gBAAf,CAAgC,IAAhC,EAAsC7F,MAAM1D,IAA5C,EAAkD8H,SAAlD,EAA6DjE,GAA7D;;AAEA;AACA,+BAAU,sBAAV,EAAkC;AAChC,kBAAU0J,WADsB;AAEhCC,gBAAQ,IAFwB;AAGhCC,kBAAU,kBAASC,aAAT,EAAwBC,OAAxB,EAAiCC,QAAjC,EAA0C;AAClD9F,oBAAUmC,YAAV,CAAuBnC,UAAUoC,SAAV,EAAvB;AACApC,oBAAUqC,MAAV,CAAiB,IAAIxJ,EAAEqJ,KAAF,CAAQI,GAAZ,CAAgB;AAC/BC,iBAAK,uEAAqEsD,OAD3C;AAE/BnO,kBAAM,UAFyB;AAG/B8K,mBAAO;AAHwB,WAAhB,CAAjB;AAKD,SAV+B;AAWhC;AACAuD,iBAAS,YAZuB;AAahCC,iBAAS;AAbuB,OAAlC;;AAgBA;AACA,WAAK5N,KAAL,CAAW8B,aAAX,CAAyB,qBAAzB,EAAgDgC,KAAhD,CAAsD6E,OAAtD,GAAgE,OAAhE;;AAEA,4BAAElJ,MAAF,EAAUwJ,MAAV,CAAiB,YAAU;AACzBrH,mBAAW,YAAU;AACnB4B,gBAAMQ,QAAN,CAAeR,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBC,WAAtB,GAAkC,CAAjD;AACAX,gBAAMY,QAAN,CAAeZ,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBG,YAAtB,GAAmC,CAAlD;AACAb,gBAAMc,OAAN,CAAcd,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBC,WAAtB,GAAkC,CAAlC,GAAsCX,MAAMe,QAAN,KAAiB,CAArE;AACAf,gBAAMgB,OAAN,CAAchB,MAAM1D,IAAN,CAAWmE,EAAX,CAAcnE,IAAd,CAAmBoE,EAAnB,CAAsBG,YAAtB,GAAmC,CAAnC,GAAuCb,MAAMiB,QAAN,KAAiB,CAAtE;;AAEAd,cAAIG,KAAJ,CAAUe,KAAV,GAAkBrB,MAAMe,QAAN,KAAiB,IAAnC;AACAZ,cAAIG,KAAJ,CAAUc,IAAV,GAAiBpB,MAAMO,OAAN,KAAgB,IAAjC;AACAJ,cAAIG,KAAJ,CAAUgB,MAAV,GAAmBtB,MAAMiB,QAAN,KAAiB,IAApC;AACAd,cAAIG,KAAJ,CAAUY,GAAV,GAAgBlB,MAAMmB,OAAN,KAAgB,IAAhC;;AAEAnB,gBAAMC,OAAN,GAAgBkE,UAAhB,CAA2BC,SAA3B,EAAsCpE,MAAM1D,IAA5C;AACA,cAAIwI,WAAW9E,MAAMC,OAAN,GAAgBqE,oBAAhB,CAAqCtE,MAAM1D,IAA3C,EAAiD0D,MAAMO,OAAN,KAAgBP,MAAMe,QAAN,KAAiB,CAAjC,GAAmC+C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAApF,EAAqH/D,MAAMmB,OAAN,KAAgBnB,MAAMiB,QAAN,KAAiB,CAAjC,GAAmC6C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAxJ,CAAf;AACAK,oBAAUG,SAAV,CAAoB;AAClBC,eAAGM,SAAS,CAAT,CADe;AAElBL,eAAGK,SAAS,CAAT,CAFe;AAGlBJ,kBAAM;AAHY,WAApB;AAKF1E,gBAAMC,OAAN,GAAgB0E,UAAhB,CAA2BP,SAA3B;AACC,SAnBD,EAmBG,GAnBH;AAoBD,OArBD;;AAwBAA,gBAAUnG,EAAV,CAAahB,EAAEiB,GAAF,CAAMC,SAAnB,EAA8B,YAAU;AACtC,YAAIuH,WAAW1F,MAAMC,OAAN,GAAgBqE,oBAAhB,CAAqCtE,MAAM1D,IAA3C,EAAiD0D,MAAMO,OAAN,KAAgBP,MAAMe,QAAN,KAAiB,CAAjC,GAAmC+C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAApF,EAAqH/D,MAAMmB,OAAN,KAAgBnB,MAAMiB,QAAN,KAAiB,CAAjC,GAAmC6C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAxJ,CAAf;AACAK,kBAAUuB,cAAV,CAAyB3F,MAAM1D,IAAN,CAAWsJ,cAAX,EAAzB;AACA5F,cAAMC,OAAN,GAAgBkE,UAAhB,CAA2BC,SAA3B,EAAsCpE,MAAM1D,IAA5C;AACA8H,kBAAUG,SAAV,CAAoB,EAACC,GAAGkB,SAAS,CAAT,CAAJ,EAAiBjB,GAAGiB,SAAS,CAAT,CAApB,EAAiChB,MAAM,KAAvC,EAApB;AACD,OALD;AAMA,WAAKpF,KAAL,GAAa8E,SAAb;;AAEAA,gBAAUW,YAAV,GAAyBC,WAAzB,CAAqC/C,SAArC;AACAmC,gBAAUW,YAAV,GAAyBC,WAAzB,CAAqCzC,QAArC;;AAEA,WAAKtC,OAAL,GAAe6F,cAAf,CAA8B1B,SAA9B;AACA;AACA,WAAK2B,OAAL;AAED;;AAED;;;;;;;;;;iCAOa;AACX,mIADW,CACS;AACpB,UAAI5F,MAAM9B,SAAS2H,cAAT,CAAwB,UAAxB,CAAV;AACA,WAAK1J,IAAL,CAAUyI,YAAV,GAAyBkB,WAAzB,CAAqC9F,GAArC;AACA,UAAI+E,aAAa,KAAK1I,KAAL,CAAW8B,aAAX,CAAyB,qBAAzB,CAAjB;AACA4G,iBAAW5E,KAAX,CAAiB6E,OAAjB,GAA2B,MAA3B;AACA,WAAKkB,iBAAL;AACA;AACD;AACA;;;;;;;;;;;wCAQmBvG,I,EAAM;AACxB,aAAOA,KAAKxB,aAAL,CAAmB,wBAAnB,CAAP;AACD;;;;;AAED;;;;;;;;2BAQOpB,O,EAAS;AACd,aAAOA,mBAAmBG,eAA1B;AACD;;AAED;;;;8BACS;AACP,aAAO,KAAKkC,UAAL,CAAgBgB,OAAhB,EAAP;AACD;;;8BACQ;AACP,aAAO,KAAKhB,UAAL,CAAgB4B,OAAhB,EAAP;AACD;;;4BACOvC,I,EAAK;AACX,WAAKW,UAAL,CAAgBuB,OAAhB,CAAwBlC,IAAxB;AACD;;;4BACOC,I,EAAK;AACX,WAAKU,UAAL,CAAgByB,OAAhB,CAAwBnC,IAAxB;AACD;;;+BAES;AACR,aAAO,KAAKU,UAAL,CAAgBwB,QAAhB,EAAP;AACD;;;+BACS;AACR,aAAO,KAAKxB,UAAL,CAAgB0B,QAAhB,EAAP;AACD;;;6BACQnC,K,EAAM;AACb,WAAKS,UAAL,CAAgBiB,QAAhB,CAAyB1B,KAAzB;AACD;;;6BACQC,K,EAAM;AACb,WAAKQ,UAAL,CAAgBqB,QAAhB,CAAyB7B,KAAzB;AACD;;;kCAEY;AACX,UAAIiB,QAAQ,IAAZ;AACA,4BAAEA,MAAMxD,KAAR,EAAe2K,IAAf,CAAoB,uBAApB,EAA6CI,MAA7C;AACA,4BAAEvH,MAAMxD,KAAR,EAAe2K,IAAf,CAAoB,yBAApB,EAA+CC,KAA/C,CAAqD,YAAU;AAC7D,8BAAEpH,MAAMxD,KAAR,EAAe2K,IAAf,CAAoB,uBAApB,EAA6CI,MAA7C;AACD,OAFD;AAGD;;;8BAEQ;AACP,UAAIvH,QAAQ,IAAZ;;AAEA,UAAIqK,aAAa,GAAjB;AACA,UAAIC,SAAS,CAAb;AACA,UAAIC,WAAW,GAAf;;AAEA,4BAAE,eAAF,EAAmBpD,IAAnB,CAAwB,uBAAxB,EAAiDA,IAAjD,CAAsD,OAAtD,EAA+DlJ,EAA/D,CAAkE,OAAlE,EAA2E,YAAU;AACnF,YAAG,sBAAE,eAAF,EAAmBkJ,IAAnB,CAAwB,uBAAxB,EAAiDA,IAAjD,CAAsD,cAAtD,EAAsEgB,IAAtE,CAA2E,SAA3E,CAAH,EAAyF;AACvFkC,uBAAa,CAAb;AACAC,mBAAS,GAAT;AACD,SAHD,MAGK;AACHD,uBAAa,GAAb;AACAC,mBAAS,CAAT;AACD;AACDC,mBAAW,sBAAE,eAAF,EAAmBpD,IAAnB,CAAwB,uBAAxB,EAAiDA,IAAjD,CAAsD,gBAAtD,EAAwEmB,GAAxE,EAAX;AACA,8BAAEtI,MAAMV,KAAN,CAAYmB,EAAZ,CAAenE,IAAf,CAAoBoE,EAAtB,EAA0ByG,IAA1B,CAA+B,QAA/B,EAAyCqD,GAAzC,CAA6C,QAA7C,EAAuD,gBAAcH,UAAd,GAAyB,YAAzB,GAAsCC,MAAtC,GAA6C,cAA7C,GAA4DC,QAA5D,GAAqE,IAA5H;AACD,OAVD;AAYD;;;wCAEkB;AACjB,4BAAE,eAAF,EAAmBpD,IAAnB,CAAwB,uBAAxB,EAAiDA,IAAjD,CAAsD,cAAtD,EAAsEgB,IAAtE,CAA2E,SAA3E,EAAsF,KAAtF;AACA,4BAAE,eAAF,EAAmBhB,IAAnB,CAAwB,uBAAxB,EAAiDA,IAAjD,CAAsD,gBAAtD,EAAwEmB,GAAxE,CAA4E,GAA5E;AACD;;;;EArbkCrL,EAAE2L,O;;;;;;;;;;;;;;;;;;;;ACTvC;;;;AACA;;;;;;;;;;;;IAGavL,e,WAAAA,e,WADZ,yBAAU,gBAAV,C;;;AAEC;;;;;;;;AAQA,6BAAc;AAAA;;AAAA;AAEb;AACD;;;;;;;;;;;;;0BASMN,G,EAAK+C,I,EAAM;AACf;AACA,8HAAY/C,GAAZ,EAAiB+C,IAAjB;AACD;;;mCAEc/C,G,EAAI;AACjBA,UAAIkB,EAAJ,CAAOhB,EAAEiB,GAAF,CAAMC,SAAb,EAAwB,YAAU;AAChCpB,YAAI8L,cAAJ,CAAmB9L,IAAI+L,WAAJ,EAAnB;AACA/L,YAAIgM,UAAJ,GAAiBC,eAAjB,GAAmCC,OAAnC,CAA2C,UAACC,CAAD,EAAO;AAC9CA,YAAEhB,SAAF,CAAY,KAAZ;AACH,SAFD;AAGD,OALD;AAMD;;;yCAEoBnL,G,EAAKyH,C,EAAGC,C,EAAE;AAC7B,aAAO1H,IAAIgM,UAAJ,GAAiBI,sBAAjB,CAAwC,CAAC3E,CAAD,EAAIC,CAAJ,CAAxC,CAAP;AACD;;;+BAEU1H,G,EAAI;AACbA,UAAIgM,UAAJ,GAAiBpE,UAAjB;AACD;;;+BAEUyE,W,EAAaC,S,EAAU;AAChCD,kBAAYE,OAAZ,CAAoBD,UAAUE,OAAV,EAApB;AACA;AACD;;;qCAEgBtK,C,EAAGlC,G,EAAKqH,S,EAAWjE,G,EAAI;AACtC,UAAIH,QAAQf,CAAZ;AACA,UAAIuK,aAAa,IAAjB;;AAEAzM,UAAIgM,UAAJ,GAAiBU,OAAjB,GAA2BxL,EAA3B,CAA8B,gBAA9B,EAAgD,UAASoJ,CAAT,EAAY;AAC1D,YAAItE,SAASyG,WAAWlF,oBAAX,CAAgCvH,GAAhC,EAAqCiD,MAAMO,OAAN,KAAgBP,MAAMe,QAAN,KAAiB,CAAjC,GAAmC+C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAAxE,EAAyG/D,MAAMmB,OAAN,KAAgBnB,MAAMiB,QAAN,KAAiB,CAAjC,GAAmC6C,SAAS3D,IAAIG,KAAJ,CAAUyD,WAAnB,CAA5I,CAAb;AACAK,kBAAUG,SAAV,CAAoB;AAClBC,aAAGzB,OAAO,CAAP,CADe;AAElB0B,aAAG1B,OAAO,CAAP,CAFe;AAGlB2B,gBAAM;AAHY,SAApB;AAKA8E,mBAAWrF,UAAX,CAAsBC,SAAtB,EAAiCrH,GAAjC;AACA;AACD,OATD;AAUD;;;4BAEOA,G,EAAI;AACVA,UAAIgM,UAAJ,GAAiBU,OAAjB,GAA2BH,OAA3B,CAAmCI,KAAKC,KAAL,CAAW5M,IAAIgM,UAAJ,GAAiBU,OAAjB,GAA2BF,OAA3B,EAAX,CAAnC;AACD;;;;EAlEkCtM,EAAEmC,IAAF,CAAOwJ,O;;;;;;ACJ5C;AACA;AACA;AACA;AACA;AACA,CAAC,oBAAoB;;AAErB;AACA;AACA,mEAAmE;AACnE;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,oDAAoD,OAAO;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iCAAiC,iCAAiC;AAClE,+BAA+B,gCAAgC;AAC/D;AACA;AACA,mCAAmC,mBAAmB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,kCAAkC,kBAAkB;AACpD,gEAAgE,yEAAyE;AACzI;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT,sCAAsC,iDAAiD,EAAE;AACzF;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT,kCAAkC,0BAA0B,EAAE;AAC9D;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,EAAE;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,EAAE;AACnB;AACA;AACA;AACA,4BAA4B,2BAA2B,EAAE;AACzD;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA,4BAA4B,6BAA6B,EAAE;AAC3D;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,oCAAoC,+CAA+C,EAAE;AACrF;AACA;AACA;AACA,SAAS;AACT;AACA,4BAA4B,+BAA+B,EAAE;AAC7D;AACA,4BAA4B,8BAA8B,EAAE;AAC5D;AACA;AACA,SAAS;AACT;AACA,4BAA4B,2BAA2B,EAAE;AACzD;AACA,4BAA4B,4BAA4B,EAAE;AAC1D;AACA,4BAA4B,2DAA2D,EAAE;AACzF;AACA,4BAA4B,+BAA+B,EAAE;AAC7D;AACA,4BAA4B,uBAAuB,EAAE;AACrD;AACA;AACA;AACA,SAAS;AACT;AACA,4BAA4B,iCAAiC,EAAE;AAC/D;AACA,4BAA4B,4BAA4B,EAAE;AAC1D;AACA,4BAA4B,0BAA0B,EAAE;AACxD;AACA,4BAA4B,uBAAuB,EAAE;AACrD;AACA,4BAA4B,sBAAsB,EAAE;AACpD;AACA,4BAA4B,gDAAgD;AAC5E;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE,mBAAmB;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA,4CAA4C;AAC5C;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,4BAA4B,uBAAuB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,oCAAoC,EAAE;AACtG;AACA;AACA,2CAA2C,oBAAoB;AAC/D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA;AACA,2CAA2C,uCAAuC;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,2BAA2B;AACtE,wCAAwC,uBAAuB;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA,mBAAmB,OAAO;AAC1B,mBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,MAAM;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,QAAQ;AAC3B,mBAAmB,OAAO;AAC1B,mBAAmB,SAAS;AAC5B;AACA;AACA;AACA,oDAAoD,4CAA4C,EAAE;AAClG;AACA,sDAAsD,0CAA0C,EAAE;AAClG;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,gBAAgB;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,gBAAgB;AAC9E;AACA;AACA;AACA,mEAAmE,0DAA0D,EAAE;AAC/H;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,mBAAmB,KAAK;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,MAAM;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,MAAM;AACzB,mBAAmB,OAAO;AAC1B,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,eAAe;AACnD;AACA;AACA;AACA,wCAAwC,eAAe;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAwD,eAAe;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,oEAAoE;AAC5G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,4BAA4B;AAC9C;AACA;AACA;AACA,+BAA+B,0BAA0B;AACzD;AACA;AACA;AACA,8CAA8C;AAC9C,qEAAqE;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,4BAA4B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2DAA2D,iBAAiB;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,KAAK;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,kCAAkC,EAAE;AACtE;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,kCAAkC,kCAAkC,EAAE;AACtE;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,KAAK;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,KAAK;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,kBAAkB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,2BAA2B;AAC3E,uCAAuC,kBAAkB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,KAAK;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,iBAAiB;AACvD,wEAAwE;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,kBAAkB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,UAAU,EAAE;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,cAAc;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,4BAA4B;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,OAAO;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,yCAAyC;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,kCAAkC,EAAE;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iFAAiF,qBAAqB,EAAE;AACxG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,iEAAiE;AACzG;AACA;AACA;AACA;AACA,kCAAkC,4BAA4B,EAAE;AAChE;AACA;AACA;AACA,aAAa;AACb;AACA,kCAAkC,6BAA6B,EAAE;AACjE;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,6BAA6B,EAAE;AACjE;AACA,aAAa;AACb;AACA,kCAAkC,6BAA6B,EAAE;AACjE;AACA,aAAa;AACb,oDAAoD;AACpD;AACA,cAAc;AACd;AACA,kCAAkC,6BAA6B,EAAE;AACjE;AACA,aAAa;AACb;AACA,kCAAkC,6BAA6B,EAAE;AACjE;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,2BAA2B,qBAAqB;AAChD;AACA;AACA;AACA,0CAA0C,wCAAwC,EAAE;AACpF;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,gCAAgC;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,uCAAuC;AACtF;AACA;AACA;AACA;AACA;AACA;AACA,sHAAsH,iCAAiC,EAAE;AACzJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,gCAAgC,YAAY;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,kCAAkC,EAAE;AACjG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,oCAAoC,EAAE;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,YAAY,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,kCAAkC,EAAE;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,qCAAqC,EAAE;AACzF;AACA;AACA;AACA;AACA,kDAAkD,qCAAqC,EAAE;AACzF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,iDAAiD,EAAE;AAC/G;AACA,yDAAyD,kCAAkC,EAAE;AAC7F;AACA;AACA,2CAA2C,uBAAuB;AAClE,oCAAoC,iCAAiC;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,sCAAsC,UAAU,EAAE,EAAE;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,4BAA4B,EAAE;AAChE;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,8BAA8B;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,+BAA+B;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,sCAAsC,EAAE;AAC9E;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,sBAAsB;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iCAAiC,EAAE;AACrE;AACA,uBAAuB,kBAAkB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB,8BAA8B;AAC9B;AACA;AACA,gDAAgD;AAChD;AACA;AACA,6CAA6C;AAC7C;AACA,6CAA6C;AAC7C,iDAAiD;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,CAAC;;;;;;;ACl8ED;AACA;AACA;AACA,kDAAkD;AAClD,CAAC,2BAA2B;;AAE5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,gDAAgD,cAAc;;AAE9D,CAAC;;;;;;;ACpED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,UAAU;AACrB,WAAW,UAAU;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,EAAE;AACb,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA,uDAAuD,gCAAgC,EAAE;AACzF,mDAAmD,kBAAkB,EAAE;AACvE;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,EAAE;AACb,WAAW,EAAE;AACb,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oBAAoB;AAC3C;AACA;AACA,yBAAyB,kBAAkB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,6B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,2B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL,2B;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,yBAAyB,kBAAkB;AAC3C,yB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,EAAE;AACb,YAAY,OAAO;AACnB,YAAY,QAAQ;AACpB,YAAY,eAAe;AAC3B,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,eAAe;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,qBAAqB;AAChC,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,qBAAqB;AAChC,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,EAAE;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,YAAY,EAAE;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,4BAA4B;AAC/B;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,4C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,E;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA,qFAAqF;AACrF;AACA;AACA;AACA;AACA,+BAA+B,cAAc;AAC7C,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW,QAAQ;AACnB,YAAY,OAAO;AACnB,YAAY,6BAA6B;AACzC,YAAY,mBAAmB;AAC/B,YAAY,mBAAmB;AAC/B,YAAY,mBAAmB;AAC/B,YAAY,mBAAmB;AAC/B,YAAY,mBAAmB;AAC/B,YAAY,oBAAoB;AAChC,YAAY,oBAAoB;AAChC,YAAY,oBAAoB;AAChC,YAAY,SAAS;AACrB,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,yBAAyB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,kDAAkD;AAC1E,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,sBAAsB,EAAE;AACpF;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,wCAAwC;AACpE,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,Q;AACX;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,IAAI;AACd,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,WAAW,EAAE;AACb;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,mDAAmD;AACnD;AACA;AACA;AACA;AACA,UAAU,OAAO;AACjB,UAAU,QAAQ;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,IAAI;AACd;AACA;AACA;AACA,sBAAsB,0BAA0B;AAChD;AACA;AACA;AACA,WAAW,EAAE;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,MAAM;AAC/B;AACA;AACA;AACA;AACA,GAAG;AACH,yBAAyB,MAAM;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,YAAY;AACjB,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,OAAO;AACjB,UAAU,SAAS;AACnB,WAAW,YAAY;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,MAAM;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,eAAe,OAAO,O;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf,WAAW,IAAI;AACf,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,IAAI;AACf,WAAW,OAAO;AAClB,WAAW,6BAA6B;AACxC,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,oBAAoB;AAC/B,WAAW,oBAAoB;AAC/B,YAAY,qBAAqB;AACjC;AACA,WAAW,iBAAiB;AAC5B,WAAW,mBAAmB;AAC9B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,OAAO;AACjB,UAAU,SAAS,mDAAmD,cAAc;AACpF;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,WAAW,IAAI;AACf,YAAY,WAAW;AACvB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,6BAA6B;AACxC,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,oBAAoB;AAC/B,WAAW,oBAAoB;AAC/B,YAAY,qBAAqB;AACjC;AACA,WAAW,iBAAiB;AAC5B,WAAW,iBAAiB;AAC5B,WAAW,QAAQ;AACnB,WAAW,SAAS;AACpB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,sFAAsF;AACtF;AACA;AACA;AACA,UAAU,WAAW;AACrB,WAAW,OAAO;AAClB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf,YAAY,WAAW;AACvB;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,YAAY;AACZ,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,IAAI;AACd;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,EAAE,WAAW;AACb,qBAAqB,yCAAyC;AAC9D;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,IAAI;AACf,WAAW,OAAO;AAClB,WAAW,oBAAoB;AAC/B,WAAW,mBAAmB;AAC9B,WAAW,6BAA6B;AACxC,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,oBAAoB;AAC/B,WAAW,oBAAoB;AAC/B;AACA,WAAW,yDAAyD;AACpE,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+EAA+E;AAC/E;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB;AACA;AACA;AACA,S;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf,YAAY,WAAW;AACvB;AACA;AACA;AACA;AACA;AACA,iCAAiC,MAAM;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,WAAW;AAChB;AACA;AACA;AACA,4BAA4B,yCAAyC;AACrE,OAAO;AACP,KAAK;AACL,0BAA0B,yCAAyC;AACnE;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB,YAAY,SAAS;AACrB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,SAAS;AACrB,YAAY,QAAQ;AACpB,YAAY,SAAS;AACrB;AACA;AACA,mBAAmB,QAAQ;AAC3B,6BAA6B,QAAQ;AACrC,uBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA,+C;AACA,yB;AACA;AACA,KAAK;AACL;AACA;AACA,4C;AACA;AACA,KAAK;AACL;AACA,yDAAyD,uCAAuC,EAAE;AAClG,wDAAwD,0CAA0C,EAAE;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,WAAW,eAAe;AAC1B;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA,6D;AACA;AACA;AACA;AACA,6CAA6C,iBAAiB;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,iBAAiB;AAC9D;AACA;AACA,0BAA0B;AAC1B,2BAA2B;AAC3B,4CAA4C;AAC5C,4CAA4C;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,4CAA4C,gBAAgB;AAC5D;AACA,KAAK;AACL,6CAA6C,iBAAiB;AAC9D,4CAA4C,SAAS;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,SAAS;AACpB;AACA;AACA,qBAAqB,qBAAqB;AAC1C;AACA;AACA,WAAW,QAAQ;AACnB,YAAY;AACZ;AACA;AACA,kBAAkB,mBAAmB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,mBAAmB,EAAE;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,WAAW;AACX,WAAW,gBAAgB;AAC3B;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,WAAW;AACX,YAAY;AACZ;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,MAAM;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,iBAAiB;AACtC;AACA;AACA;AACA;AACA;AACA,qBAAqB,iBAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6C;AACA;AACA;AACA,gB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,yEAAyE;AACjH;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,MAAM;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,4BAA4B;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY,MAAM,UAAU;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uB;AACA;AACA,mB;AACA,wBAAwB,yBAAyB;AACjD;AACA;AACA;AACA;AACA,uB;AACA;AACA,wC;AACA,8E;AACA,wBAAwB,2BAA2B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,6BAA6B,MAAM;AACnC;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK,6CAA6C,cAAc,EAAE;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,sCAAsC,wBAAwB,EAAE;AAC/E;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,mEAAmE,YAAY;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA,cAAc,qCAAqC;AACnD;AACA,6CAA6C,uBAAuB;AACpE,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,sCAAsC;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,WAAW,EAAE;AAC5E,OAAO;AACP,+DAA+D,mDAAmD,EAAE;AACpH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,oBAAoB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,iBAAiB,2BAA2B;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,QAAQ;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA,cAAc,yBAAyB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,UAAU,sBAAsB;AAChC;AACA;AACA;AACA;AACA,cAAc,cAAc;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,aAAa;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,kEAAkE;AACvF;AACA;AACA;AACA,UAAU,aAAa;AACvB;AACA;AACA,eAAe,yBAAyB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,qBAAqB;AACtC;AACA;AACA;AACA;AACA;AACA,UAAU,QAAQ;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,iBAAiB;AACpC;AACA;AACA;AACA;AACA;AACA,UAAU,SAAS,6BAA6B,aAAa,kBAAkB;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,yBAAyB;AACrC;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,wBAAwB,qBAAqB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,UAAU,QAAQ;AAClB,UAAU,OAAO;AACjB,UAAU,OAAO;AACjB,UAAU,OAAO;AACjB,UAAU,OAAO;AACjB,UAAU,SAAS;AACnB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,QAAQ;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB,YAAY,eAAe;AAC3B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,WAAW,eAAe;AAC1B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB,YAAY,eAAe;AAC3B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB,YAAY,eAAe;AAC3B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,eAAe;AAC1B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,WAAW,KAAK;AAChB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,YAAY,K;AACZ;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ,qCAAqC,kBAAkB;AAC1E,WAAW,OAAO;AAClB,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB,WAAW,kBAAkB;AAC7B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,eAAe;AAC/C;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF,gCAAgC,+CAA+C;AAC/E;AACA;AACA;AACA;AACA;AACA,cAAc,KAAK;AACnB;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,mB;AACA,mBAAmB,oBAAoB;AACvC,oBAAoB,sBAAsB;AAC1C,mBAAmB,qBAAqB;AACxC,oBAAoB,qBAAqB;AACzC;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,mB;AACA,mBAAmB,qBAAqB;AACxC,oBAAoB,qBAAqB;AACzC,mBAAmB,oBAAoB;AACvC,oBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA,mB;AACA,mBAAmB,qBAAqB;AACxC,oBAAoB,qBAAqB;AACzC,mBAAmB,oBAAoB;AACvC,oBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,SAAS;AACnB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,iBAAiB,KAAK;AACtB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,KAAK;AACjB,YAAY,SAAS;AACrB;AACA;AACA,CAAC;AACD;AACA;AACA,sBAAsB;AACtB;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF,EAAE;AACF;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,WAAW,KAAK;AAChB;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB;AACA;AACA,WAAW,iBAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8D;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4B;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,6CAA6C,cAAc;AAC3D;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,8CAA8C,4BAA4B;AAC1E,2CAA2C,cAAc;AACzD;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,OAAO;AACjB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,UAAU,iBAAiB;AAC3B,WAAW,OAAO;AAClB;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,YAAY;AACZ,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,KAAK;AACjB,YAAY,OAAO;AACnB,YAAY,WAAW;AACvB;AACA;AACA,2B;AACA;AACA,cAAc,oGAAoG;AAClH,eAAe;AACf;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,iB;AACA,YAAY,oGAAoG;AAChH,aAAa;AACb,CAAC;AACD;AACA;AACA,uFAAuF;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,uDAAuD;AACnF;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI,wBAAwB,MAAM,kCAAkC,OAAO,kCAAkC;AACxH;AACA;AACA,0EAA0E;AAC1E;AACA;AACA,UAAU,OAAO;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,OAAO;AACjB,UAAU,gBAAgB;AAC1B,UAAU,OAAO;AACjB,UAAU,KAAK;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB,YAAY,QAAQ;AACpB,YAAY,sBAAsB;AAClC,YAAY,gBAAgB;AAC5B,YAAY,oDAAoD;AAChE;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,KAAK;AACL;AACA,IAAI;AACJ;AACA,EAAE;AACF;AACA,EAAE,0B;AACF,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,MAAM;AACN,OAAO;AACP;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA,OAAO;AACP;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,UAAU,sBAAsB;AAChC;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,UAAU,gBAAgB;AAC1B,UAAU,QAAQ;AAClB;AACA;AACA,CAAC;AACD;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,0BAA0B,wBAAwB;AAClD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB,iBAAiB,kBAAkB;AACnC,oBAAoB,OAAO;AAC3B,YAAY,eAAe;AAC3B,WAAW,OAAO;AAClB,gBAAgB,OAAO;AACvB,cAAc,OAAO;AACrB,kBAAkB,OAAO;AACzB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,eAAe;AAC/C;AACA;AACA,iCAAiC,4BAA4B;AAC7D;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD;AACvD;AACA;AACA,GAAG,8BAA8B,wBAAwB;AACzD,4BAA4B,gBAAgB;AAC5C;AACA,IAAI,8BAA8B,wBAAwB;AAC1D,6BAA6B,eAAe;AAC5C,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,WAAW;AAC5B,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,cAAc,QAAQ;AACtB,GAAG;AACH;AACA;AACA;AACA,oBAAoB,SAAS;AAC7B,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,QAAQ;AACtB,GAAG;AACH;AACA;AACA;AACA,oBAAoB,SAAS;AAC7B,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,gBAAgB;AAC5B,IAAI;AACJ;AACA;AACA;AACA;AACA,YAAY,mBAAmB;AAC/B,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,YAAY,iBAAiB;AAC7B,IAAI;AACJ;AACA;AACA;AACA;AACA,YAAY,kBAAkB;AAC9B,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,YAAY,kBAAkB;AAC9B,IAAI;AACJ;AACA;AACA,e;AACA,iB;AACA;AACA,YAAY,qBAAqB;AACjC,IAAI;AACJ;AACA;AACA,e;AACA,iB;AACA;AACA,YAAY,mBAAmB;AAC/B,IAAI;AACJ;AACA;AACA,e;AACA,iB;AACA;AACA,YAAY,oBAAoB;AAChC,IAAI;AACJ;AACA;AACA,e;AACA,iB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,c;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,QAAQ;AACnB,YAAY,eAAe;AAC3B,oBAAoB,OAAO;AAC3B,aAAa,UAAU;AACvB,WAAW,QAAQ;AACnB,aAAa,OAAO;AACpB,aAAa,iBAAiB;AAC9B,eAAe,kBAAkB;AACjC,mBAAmB,mBAAmB;AACtC,iBAAiB,mBAAmB;AACpC,kBAAkB,OAAO;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,IAAI;AACJ,KAAK;AACL;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,8BAA8B,wBAAwB;AACzD;AACA,IAAI;AACJ,iCAAiC,wBAAwB;AACzD,6BAA6B,eAAe;AAC5C,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA,UAAU,WAAW;AACrB,WAAW,OAAO;AAClB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,WAAW;AACrB,UAAU,WAAW;AACrB,WAAW,OAAO;AAClB;AACA;AACA;AACA,CAAC,4H;AACD;AACA;AACA,UAAU,WAAW;AACrB;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,gDAAgD;AAC1D;AACA;AACA,CAAC;AACD;AACA;AACA,gCAAgC,+BAA+B,EAAE;AACjE;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,eAAe;AAChC;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,qBAAqB,kCAAkC;AAC/D,QAAQ;AACR;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,UAAU,cAAc;AACxB,WAAW,OAAO;AAClB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,UAAU,eAAe;AACzB;AACA;AACA,CAAC;AACD;AACA;AACA,WAAW,eAAe;AAC1B;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,SAAS;AACnB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,YAAY;AACvB,GAAG;AACH;AACA;AACA,WAAW,YAAY;AACvB,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,GAAG;AACH;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,GAAG;AACH;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,iBAAiB;AAC5B,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB,WAAW,eAAe;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,W;AACA;AACA;AACA,oC;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,sBAAsB,kDAAkD;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,sBAAsB,kDAAkD;AACxE;AACA;AACA,WAAW,WAAW;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,qB;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA,iBAAiB;AACjB;AACA;AACA;AACA,8BAA8B,4BAA4B;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,mCAAmC,cAAc;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,kBAAkB,eAAe;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,6BAA6B;AACxC,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,oBAAoB;AAC/B,WAAW,oBAAoB;AAC/B,WAAW,oBAAoB;AAC/B,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,wBAAwB;AACrE;AACA,8CAA8C,kBAAkB;AAChE;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,8CAA8C,wCAAwC;AACtF;AACA;AACA;AACA,mCAAmC,qFAAqF;AACxH;AACA;AACA,KAAK;AACL,8BAA8B,kFAAkF;AAChH;AACA;AACA,KAAK;AACL;AACA,8BAA8B,0EAA0E;AACxG;AACA;AACA,KAAK;AACL,8BAA8B,yEAAyE;AACvG;AACA;AACA,KAAK;AACL;AACA,8BAA8B,uFAAuF;AACrH;AACA;AACA,KAAK;AACL,8BAA8B,gFAAgF;AAC9G;AACA;AACA,KAAK;AACL;AACA,0CAA0C,wCAAwC;AAClF,gCAAgC,iCAAiC;AACjE,kCAAkC,sCAAsC;AACxE;AACA;AACA,KAAK;AACL,iCAAiC,yBAAyB;AAC1D,kCAAkC,sCAAsC;AACxE;AACA;AACA,KAAK;AACL,iCAAiC,0BAA0B;AAC3D,sCAAsC,4CAA4C;AAClF,gCAAgC,mCAAmC;AACnE,kCAAkC,mDAAmD;AACrF;AACA;AACA,KAAK;AACL,iCAAiC,0BAA0B;AAC3D,sCAAsC,wCAAwC;AAC9E,gCAAgC,iCAAiC;AACjE,kCAAkC,gDAAgD;AAClF;AACA;AACA,KAAK;AACL;AACA,8BAA8B,gDAAgD;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,gC;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,kBAAkB;AAC3D;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,uEAAuE;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,cAAc;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4C;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,eAAe;AACtC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf,YAAY,MAAM,UAAU;AAC5B;AACA;AACA,iE;AACA;AACA;AACA,uB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,oCAAoC;AACjD;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf,YAAY,MAAM,UAAU;AAC5B;AACA;AACA;AACA;AACA;AACA,uB;AACA;AACA;AACA;AACA;AACA,8BAA8B,iBAAiB;AAC/C;AACA;AACA;AACA;AACA;AACA,aAAa,oCAAoC;AACjD;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,EAAE;AACb,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,oBAAoB;AAChC,YAAY,gBAAgB;AAC5B,YAAY,oBAAoB;AAChC,YAAY,oBAAoB;AAChC,YAAY,6BAA6B;AACzC,YAAY,wEAAwE;AACpF,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,wEAAwE;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,YAAY,WAAW;AACvB,YAAY,eAAe;AAC3B,YAAY,EAAE;AACd,YAAY,OAAO;AACnB;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA,WAAW,EAAE;AACb,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,8CAA8C;AACxE,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,mBAAmB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,YAAY,WAAW;AACvB,YAAY,eAAe;AAC3B,YAAY,EAAE;AACd,YAAY,OAAO;AACnB,WAAW,iBAAiB;AAC5B,WAAW,cAAc;AACzB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,aAAa;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,aAAa;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,eAAe;AAC1B,WAAW,kBAAkB;AAC7B,YAAY,WAAW,iCAAiC;AACxD,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,4BAA4B,yDAAyD;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA,UAAU,QAAQ;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,QAAQ;AACnB,YAAY,OAAO;AACnB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,WAAW,sBAAsB;AACjC,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,eAAe;AAC1B,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA,uEAAuE,aAAa;AACpF;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,eAAe;AACzB;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA,GAAG;AACH;AACA,6CAA6C,aAAa;AAC1D;AACA;AACA;AACA;AACA;AACA,UAAU,eAAe;AACzB,UAAU,cAAc;AACxB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,uBAAuB,6DAA6D;AACpF,GAAG;AACH,qBAAqB,8DAA8D;AACnF;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,uCAAuC,4BAA4B,EAAE;AACrE,qBAAqB,8DAA8D;AACnF;AACA;AACA;AACA;AACA,C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,OAAO;AACjB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB,YAAY,kBAAkB;AAC9B,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,QAAQ;AACpB,YAAY,sBAAsB;AAClC,YAAY,gBAAgB;AAC5B,YAAY,oDAAoD;AAChE,YAAY,aAAa;AACzB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,kBAAkB,oBAAoB,EAAE;AAClG,oDAAoD,iBAAiB;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,WAAW;AACX;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,GAAG;AACH;AACA;AACA,YAAY,IAAI;AAChB,YAAY,OAAO;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,IAAI;AAChB,YAAY,OAAO;AACnB,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,eAAe;AACjC,kBAAkB,iBAAiB;AACnC,kBAAkB,aAAa;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mE;AACA;AACA;AACA,K;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB,WAAW,KAAK;AAChB,WAAW,QAAQ;AACnB,WAAW,KAAK;AAChB,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,eAAe;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,OAAO;AACjB,UAAU,0BAA0B;AACpC,WAAW;AACX;AACA;AACA;AACA,cAAc,iBAAiB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,eAAe;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,YAAY;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,iBAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY,Q;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,EAAE,WAAW;AACb;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA,EAAE,WAAW;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,2CAA2C,sBAAsB;AACjE;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,qDAAqD,gBAAgB,EAAE;AACvE,yDAAyD,gBAAgB,EAAE;AAC3E;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,OAAO;AACjB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,kBAAkB,gBAAgB;AAClC,GAAG;AACH,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,8EAA8E;AACpG;AACA;AACA,EAAE;AACF,GAAG;AACH;AACA;AACA,uBAAuB,aAAa;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,qBAAqB,0BAA0B;AAC/C;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,qBAAqB,2BAA2B;AAChD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,qBAAqB,wBAAwB;AAC7C;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,WAAW,QAAQ;AACnB,kBAAkB,kBAAkB;AACpC,aAAa,KAAK;AAClB,YAAY,KAAK;AACjB,YAAY,iBAAiB;AAC7B,YAAY,iBAAiB;AAC7B,kBAAkB,iBAAiB;AACnC,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,mCAAmC;AACnC;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF,wBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,iBAAiB;AACjB;AACA;AACA;AACA;AACA,aAAa,QAAQ;AACrB,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,UAAU,MAAM;AAChB,EAAE;AACF;AACA;AACA,8BAA8B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,QAAQ;AAClB,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,UAAU,iBAAiB;AAC3B,UAAU,iBAAiB;AAC3B,WAAW,OAAO;AAClB;AACA;AACA;AACA,CAAC;AACD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,6BAA6B;AACxC,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,oBAAoB;AAC/B,WAAW,oBAAoB;AAC/B,WAAW,oBAAoB;AAC/B,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,kBAAkB;AAChE;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,8CAA8C,wCAAwC;AACtF;AACA;AACA;AACA;AACA,8BAA8B,0EAA0E;AACxG;AACA;AACA,KAAK;AACL,8BAA8B,qFAAqF;AACnH;AACA;AACA,KAAK;AACL,8BAA8B,oFAAoF;AAClH;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,iBAAiB;AAC3D,oCAAoC,kDAAkD;AACtF;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA,eAAe,uBAAuB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,uBAAuB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,kBAAkB,gBAAgB;AAClC,oBAAoB,cAAc;AAClC;AACA,sBAAsB,eAAe;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,uBAAuB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL,E;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW,QAAQ;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,6BAA6B;AACxC,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,oBAAoB;AAC/B,WAAW,oBAAoB;AAC/B;AACA,WAAW,iBAAiB;AAC5B,WAAW,QAAQ;AACnB,WAAW,SAAS;AACpB,SAAS;AACT;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,gFAAgF;AAChF;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,WAAW;AAChB,wBAAwB,yCAAyC;AACjE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,6BAA6B;AACxC,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,oBAAoB;AAC/B,WAAW,oBAAoB;AAC/B;AACA,WAAW,mBAAmB;AAC9B,WAAW,SAAS;AACpB,WAAW,qBAAqB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,OAAO;AACjB,WAAW,iBAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,6DAA6D;AAC9E;AACA;AACA;AACA,eAAe,MAAM;AACrB,qBAAqB,iEAAiE;AACtF;AACA;AACA;AACA,eAAe,KAAK;AACpB,qBAAqB,yEAAyE;AAC9F;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,6BAA6B;AACxC,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,oBAAoB;AAC/B,WAAW,oBAAoB;AAC/B;AACA,WAAW,mBAAmB;AAC9B,WAAW,SAAS;AACpB,WAAW,qBAAqB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,WAAW;AACrB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,WAAW;AACrB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,iBAAiB;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,OAAO;AACjB,UAAU,IAAI;AACd,UAAU,SAAS;AACnB,WAAW,iBAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,eAAe;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,QAAQ;AACnB,YAAY,OAAO;AACnB,YAAY,6BAA6B;AACzC,YAAY,mBAAmB;AAC/B,YAAY,mBAAmB;AAC/B,YAAY,mBAAmB;AAC/B,YAAY,oBAAoB;AAChC,YAAY,oBAAoB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,UAAU,OAAO;AACjB,WAAW,iBAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,qCAAqC;AACpD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,IAAI;AACf,WAAW,OAAO;AAClB,WAAW,oBAAoB;AAC/B,WAAW,mBAAmB;AAC9B,WAAW,6BAA6B;AACxC,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,oBAAoB;AAC/B,WAAW,oBAAoB;AAC/B;AACA,WAAW,OAAO;AAClB,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,6CAA6C;AACrE,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,0E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,oBAAoB;AAC3C;AACA;AACA;AACA,kB;AACA;AACA;AACA;AACA,sBAAsB,UAAU;AAChC;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA,WAAW,EAAE;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,YAAY;AACvB;AACA;AACA;AACA,WAAW,YAAY;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,kBAAkB,aAAa;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb;AACA;AACA;AACA,sB;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,oBAAoB;AAC/B,WAAW,oBAAoB;AAC/B,WAAW,6BAA6B;AACxC,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,mBAAmB;AAC9B,WAAW,oBAAoB;AAC/B,WAAW,oBAAoB;AAC/B;AACA,WAAW,iBAAiB;AAC5B,SAAS;AACT;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,yFAAyF;AACzF;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB;AACA;AACA;AACA,a;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,WAAW;AAChB,wBAAwB,yCAAyC;AACjE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,QAAQ;AACnB,YAAY,OAAO;AACnB,YAAY,oBAAoB;AAChC,YAAY,2CAA2C;AACvD,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,sBAAsB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,6BAA6B;AAC5C;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,cAAc;AAChC;AACA,oBAAoB,eAAe;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,sDAAsD,yBAAyB,EAAE;AACjF;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;AACA,6BAA6B,qBAAqB;AAClD;AACA;AACA;AACA,WAAW,EAAE;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,YAAY,iCAAiC;AAC7C,YAAY,KAAK;AACjB,YAAY,KAAK;AACjB,YAAY,kBAAkB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,cAAc;AAC/B;AACA,mBAAmB,gBAAgB;AACnC;AACA,sBAAsB,iBAAiB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,oCAAoC;AAC1D;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,6BAA6B;AACxC,WAAW,6BAA6B;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,2C;AACA;AACA;AACA,sBAAsB,cAAc;AACpC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA,2C;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA,wBAAwB,4FAA4F;AACpH,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,sBAAsB,cAAc;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,+EAA+E;AACzG;AACA,GAAG;AACH;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,kBAAkB,cAAc;AAChC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB,aAAa,SAAS;AACtB,iBAAiB,SAAS;AAC1B,gBAAgB,OAAO;AACvB,eAAe,OAAO;AACtB,kBAAkB,oBAAoB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA,UAAU,yBAAyB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,WAAW,sBAAsB;AACjC,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,cAAc,sBAAsB;AACrC,EAAE;AACF;AACA;AACA;AACA;AACA,WAAW,yBAAyB;AACpC,UAAU,KAAK;AACf;AACA;AACA,CAAC;AACD,cAAc,iBAAiB;AAC/B;AACA;AACA,GAAG,mBAAmB,uBAAuB;AAC7C;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,yBAAyB;AACpC;AACA;AACA,CAAC;AACD,cAAc,iBAAiB;AAC/B,EAAE;AACF;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH,IAAI;AACJ,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,qCAAqC;AAClD,iBAAiB,OAAO;AACxB;AACA;AACA,CAAC;AACD;AACA,wBAAwB,oCAAoC,+FAA+F,yBAAyB,GAAG,GAAG;AAC1L,uBAAuB,oCAAoC,+FAA+F,yBAAyB,GAAG,GAAG;AACzL;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,qBAAqB;AACpC,GAAG;AACH;AACA,IAAI;AACJ;AACA;AACA;AACA,KAAK,sB;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,qBAAqB;AACpC,GAAG;AACH;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA,2CAA2C,sBAAsB;AACjE;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,kBAAkB;AAC7B,WAAW,6BAA6B;AACxC,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0B;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL,GAAG;AACH;AACA,iEAAiE;AACjE;AACA;AACA;AACA;AACA,uB;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,YAAY,OAAO;AACnB,YAAY,MAAM;AAClB,YAAY,eAAe;AAC3B,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,WAAW,cAAc;AACzB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA,sBAAsB,kDAAkD;AACxE;AACA;AACA;AACA;AACA;AACA,sBAAsB,kDAAkD;AACxE;AACA;AACA,WAAW,oCAAoC;AAC/C,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,GAAG;AACH,4B;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,iDAAiD,sCAAsC;AACvF,GAAG;AACH,iDAAiD,YAAY;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA,iBAAiB,cAAc;AAC/B,sCAAsC,cAAc;AACpD;AACA;AACA;AACA,kC;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,4BAA4B,oCAAoC;AAChE;AACA,KAAK;AACL;AACA;AACA,eAAe,aAAa;AAC5B;AACA;AACA;AACA;AACA;AACA,gCAAgC,sBAAsB;AACtD,GAAG;AACH;AACA,0CAA0C,iCAAiC;AAC3E;AACA,sB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,iDAAiD,gBAAgB;AACjE;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,uBAAuB;AAClC,WAAW,OAAO;AAClB,YAAY,QAAQ;AACpB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,sBAAsB,oBAAoB;AAC1C;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,eAAe;AAC1B,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,eAAe;AAC1B,WAAW,KAAK;AAChB,WAAW,SAAS;AACpB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,EAAE;AACF,GAAG;AACH,GAAG;AACH;AACA,2DAA2D;AAC3D;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA,CAAC;AACD,EAAE;AACF,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,YAAY,KAAK;AACjB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,UAAU,KAAK;AACf;AACA;AACA,CAAC;AACD;AACA;AACA,qBAAqB,+DAA+D;AACpF;AACA;AACA;AACA,YAAY,KAAK;AACjB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,UAAU,KAAK;AACf;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,qBAAqB,4DAA4D;AACjF;AACA;AACA,UAAU,iBAAiB;AAC3B;AACA;AACA,CAAC;AACD;AACA;AACA,WAAW,iBAAiB;AAC5B;AACA;AACA,CAAC;AACD;;AAEA;AACA;AACA;AACA;AACA;AACA,YAAY,8BAA8B,KAAK,uCAAuC;AACtF;AACA;AACA;AACA,UAAU,2BAA2B;AACrC,UAAU,OAAO;AACjB,UAAU,KAAK;AACf,UAAU,OAAO;AACjB,UAAU,eAAe;AACzB;AACA,UAAU,mDAAmD;AAC7D;AACA,UAAU,mBAAmB;AAC7B,UAAU,mBAAmB;AAC7B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,iDAAiD,wBAAwB;AACzE;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,wBAAwB;AAClC,UAAU,QAAQ;AAClB,UAAU,QAAQ;AAClB;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA,cAAc,gBAAgB;AAC9B,EAAE;AACF;AACA;AACA;AACA,GAAG,sB;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,WAAW;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,yBAAyB;AACpC,YAAY,KAAK;AACjB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,oBAAoB,6BAA6B,KAAK;AACtD,aAAa,OAAO;AACpB,cAAc,SAAS;AACvB,cAAc,SAAS;AACvB,cAAc,SAAS;AACvB;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,+CAA+C;AAC1D,YAAY,uBAAuB;AACnC;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,+CAA+C;AAC1D,YAAY,uBAAuB;AACnC;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,MAAM;AACjC,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI,4BAA4B,wCAAwC;AACxE;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,eAAe;AACf;AACA,GAAG;AACH,IAAI,wB;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,GAAG;AACH;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA,IAAI;AACJ,KAAK,wB;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,wBAAwB;AACjD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,iCAAiC;AAC5C,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,UAAU,mEAAmE,SAAS;AACjG,WAAW,QAAQ;AACnB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,yBAAyB;AACnC;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,+BAA+B;AAC1C,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,yBAAyB;AACnC;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,2BAA2B;AACtC;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,UAAU,yBAAyB;AACnC;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,+BAA+B;AAC1C;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,UAAU,yBAAyB;AACnC;AACA;AACA,C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,kCAAkC,aAAa;AAC/C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,+BAA+B;AAC1C,YAAY,OAAO;AACnB,YAAY,eAAe;AAC3B,YAAY,8BAA8B;AAC1C;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,yBAAyB;AACnC;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,gBAAgB,qBAAqB;AACrC,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,cAAc;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,gCAAgC;AAC3C,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,KAAK;AAChB;AACA;AACA,CAAC;AACD;AACA,iDAAiD;AACjD;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,yBAAyB;AACnC;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,2BAA2B;AACtC;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,UAAU,yBAAyB;AACnC;AACA;AACA,C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,gCAAgC;AAC3C,YAAY,OAAO;AACnB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,yBAAyB;AACnC;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,2BAA2B;AACtC;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,UAAU,yBAAyB;AACnC;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,gCAAgC;AAC3C,YAAY,WAAW;AACvB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,yBAAyB;AACnC;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,+BAA+B;AAC1C,YAAY,KAAK;AACjB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,+BAA+B;AAC1C;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,UAAU,yBAAyB;AACnC;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA,WAAW,gBAAgB;AAC3B,GAAG;AACH;AACA,IAAI,yB;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA,QAAQ,yBAAyB,GAAG,4BAA4B,KAAK,0BAA0B;AAC/F,QAAQ,8BAA8B,GAAG,iCAAiC,KAAK;AAC/E;AACA;AACA;AACA,aAAa;AACb,WAAW,OAAO,iBAAiB,2BAA2B;AAC9D,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,QAAQ;AAClB;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,UAAU;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,UAAU;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,sBAAsB;AAC/B;AACA;AACA;AACA;AACA,sB;AACA;AACA;AACA,SAAS,sBAAsB;AAC/B;AACA;AACA;AACA;AACA;AACA,kDAAkD,0EAA0E;AAC5H,mDAAmD,4EAA4E;AAC/H,2BAA2B,gFAAgF;AAC3G;AACA;AACA;AACA,SAAS,sBAAsB;AAC/B;AACA;AACA;AACA;AACA;AACA,gCAAgC,MAAM;AACtC;AACA;AACA,mCAAmC,MAAM;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,OAAO;AAClB,YAAY,WAAW;AACvB,YAAY,cAAc;AAC1B,YAAY,QAAQ;AACpB;AACA;AACA,CAAC;AACD;AACA;AACA,EAAE;AACF,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,eAAe,aAAa;AAC5B,GAAG;AACH,gBAAgB,YAAY;AAC5B,IAAI;AACJ;AACA,iBAAiB,eAAe;AAChC,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,UAAU,OAAO;AACjB,WAAW,qBAAqB;AAChC,WAAW,UAAU;AACrB,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,kBAAkB,qBAAqB;AACvC,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA,uBAAuB;AACvB;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA,uBAAuB,mBAAmB;AAC1C;AACA,iBAAiB,aAAa;AAC9B,EAAE;AACF;AACA;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,eAAe,SAAS;AACxB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW,sBAAsB;AACjC;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,WAAW,sBAAsB;AACjC;AACA;AACA,CAAC;AACD;AACA,EAAE,8BAA8B,oDAAoD;AACpF,4BAA4B,iEAAiE;AAC7F,2BAA2B,6DAA6D;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,SAAS;AACrB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,gD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,UAAU,OAAO;AACjB,YAAY,OAAO;AACnB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,UAAU,OAAO;AACjB;AACA;AACA,CAAC;AACD;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;AACD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,UAAU,OAAO;AACjB,WAAW,WAAW;AACtB,WAAW,QAAQ;AACnB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,UAAU,OAAO;AACjB,WAAW,iBAAiB;AAC5B,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,gBAAgB;AAC3B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,YAAY;AACtB,EAAE;AACF;AACA;AACA;AACA,UAAU,YAAY;AACtB,EAAE;AACF;AACA;AACA;AACA,gBAAgB,KAAK;AACrB,EAAE;AACF;AACA;AACA;AACA,gBAAgB,KAAK;AACrB,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,WAAW,mBAAmB,WAAW;AACxD,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,0BAA0B;AACtC;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,wBAAwB;AACzB,sBAAsB;AACtB,uBAAuB;AACvB;AACA;AACA,UAAU,OAAO;AACjB,UAAU,IAAI;AACd;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA,UAAU,OAAO;AACjB,UAAU,+BAA+B;AACzC,UAAU,OAAO;AACjB;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,OAAO;AACjB,UAAU,OAAO;AACjB;AACA;AACA,C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,a;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,KAAK,+BAA+B,KAAK;AAChE,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,a;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,eAAe,kBAAkB;AACjC,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,QAAQ;AACvB,eAAe,0BAA0B;AACzC;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,qBAAqB;AAChC;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,WAAW,qBAAqB;AAChC;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,wCAAwC;AACxC,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF,GAAG;AACH;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,c;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,e;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,e;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,mCAAmC;AAC9C,mBAAmB,qCAAqC;AACxD,iBAAiB,OAAO;AACxB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,oCAAoC,+FAA+F,yBAAyB,GAAG,GAAG;AAC1L,uBAAuB,oCAAoC,+FAA+F,yBAAyB,GAAG,GAAG;AACzL;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,KAAK;AACL,MAAM;AACN;AACA;AACA;AACA,iB;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH,IAAI;AACJ;AACA,gB;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,EAAE;AACF,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA,kB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,2BAA2B;AAC1C,GAAG;AACH;AACA,IAAI;AACJ;AACA;AACA;AACA,KAAK,sB;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb,WAAW,4BAA4B;AACvC,cAAc,OAAO;AACrB,cAAc,yBAAyB;AACvC;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,uBAAuB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,uBAAuB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,WAAW,yBAAyB;AACpC;AACA;AACA,CAAC;AACD,cAAc,iBAAiB;AAC/B,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,yBAAyB;AACpC;AACA;AACA,CAAC;AACD,cAAc,iBAAiB;AAC/B,EAAE;AACF,WAAW,uBAAuB;AAClC,GAAG;AACH,IAAI;AACJ;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,uBAAuB;AACjC;AACA;AACA;AACA,EAAE;AACF,UAAU,uBAAuB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW,EAAE;AACb;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,WAAW,4CAA4C;AACvD;AACA;AACA;AACA;AACA,wBAAwB,0CAA0C;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO,WAAW;AAClB,KAAK;AACL,wBAAwB,2CAA2C;AACnE;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,WAAW,IAAI;AACf,YAAY,4BAA4B;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4B;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,4B;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA,4B;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;AACA,kBAAkB,qBAAqB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;AACA,kBAAkB,qBAAqB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,WAAW,gCAAgC;AAC3C,YAAY,8CAA8C;AAC1D,YAAY,qEAAqE;AACjF;AACA;AACA,CAAC;AACD;AACA;AACA,2CAA2C,uBAAuB;AAClE;AACA;AACA;AACA;AACA,EAAE;AACF,GAAG;AACH;AACA;AACA;AACA;AACA,EAAE,6BAA6B,gCAAgC;AAC/D;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG;AACH,IAAI,yC;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,WAAW,0BAA0B;AACrC;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,eAAe,mBAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,WAAW,0BAA0B;AACrC;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,qBAAqB,mDAAmD;AACxE;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,uBAAuB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,qBAAqB,iDAAiD;AACtE;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,qBAAqB;AAChC,WAAW,gBAAgB;AAC3B,YAAY;AACZ;AACA;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF,E;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,iCAAiC;AAC5C,YAAY,gBAAgB;AAC5B,YAAY,0BAA0B;AACtC,YAAY,6EAA6E;AACzF,YAAY,QAAQ;AACpB,YAAY,sCAAsC;AAClD,YAAY,sCAAsC;AAClD,YAAY,OAAO;AACnB,YAAY,SAAS;AACrB,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,iCAAiC;AACpE,KAAK;AACL;AACA;AACA;AACA,iCAAiC,cAAc;AAC/C,qCAAqC,iCAAiC;AACtE,OAAO;AACP,mCAAmC,4BAA4B;AAC/D;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH,yC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,K;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,IAAI;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,2D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,aAAa;AACpC;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,6B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,4CAA4C;AAC3D;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,wB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,6EAA6E;AACrG,GAAG;AACH;AACA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,2HAA2H;AACnJ,GAAG;AACH,wBAAwB,iIAAiI;AACzJ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,4BAA4B;AACvC,aAAa,6BAA6B;AAC1C,WAAW,qBAAqB;AAChC,UAAU,QAAQ;AAClB;AACA,mBAAmB,qCAAqC;AACxD,iBAAiB,OAAO;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,iCAAiC;AACjE,GAAG;AACH;AACA;AACA;AACA,6BAA6B,cAAc;AAC3C,iCAAiC,iCAAiC;AAClE,IAAI;AACJ,gCAAgC,4BAA4B;AAC5D;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA,GAAG,+BAA+B,wBAAwB;AAC1D;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,EAAE;AACF;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA,WAAW,oBAAoB;AAC/B,YAAY,OAAO;AACnB,kBAAkB,cAAc;AAChC,0BAA0B,iDAAiD;AAC3E,cAAc,wBAAwB;AACtC;AACA;AACA,CAAC;AACD,yCAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,wBAAwB;AACnE;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA,mCAAmC;AACnC;AACA;AACA;AACA,eAAe,eAAe;AAC9B,GAAG;AACH,uBAAuB,kIAAkI;AACzJ;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,KAAK;AACL,KAAK,YAAY;AACjB;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,+CAA+C,QAAQ;AACvD,KAAK;AACL;AACA,iDAAiD,gCAAgC;AACjF;AACA,MAAM,qBAAqB,8FAA8F;AACzH,0BAA0B,0FAA0F;AACpH;AACA;AACA;AACA,wBAAwB,8CAA8C;AACtE;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW,EAAE;AACb,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,WAAW,EAAE;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,EAAE;AACb;AACA;AACA;AACA;AACA;AACA,YAAY,EAAE;AACd;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY,EAAE;AACd;AACA;AACA;AACA;AACA;AACA,WAAW,kBAAkB;AAC7B,WAAW,EAAE;AACb;AACA;AACA;AACA,wBAAwB,wEAAwE;AAChG;AACA;AACA;AACA;AACA,KAAK;AACL,wBAAwB,sEAAsE;AAC9F;AACA;;AAEA;AACA;AACA,aAAa;AACb,WAAW,sBAAsB;AACjC,aAAa,SAAS;AACtB,YAAY,SAAS;AACrB,cAAc,OAAO;AACrB;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,WAAW,sBAAsB;AACjC,aAAa,SAAS;AACtB,YAAY,SAAS;AACrB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,CAAC;AACD;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,IAAI;AACf,WAAW,yCAAyC;AACpD,WAAW,+BAA+B;AAC1C,WAAW,qBAAqB;AAChC,WAAW,mBAAmB;AAC9B,WAAW,qBAAqB;AAChC,WAAW,OAAO,2EAA2E,4DAA4D;AACzJ,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,8BAA8B;AACzC,WAAW,yEAAyE;AACpF;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,4BAA4B,cAAc;AAC1C,gCAAgC,iCAAiC;AACjE,GAAG;AACH;AACA;AACA,GAAG,8BAA8B,iCAAiC;AAClE,GAAG;AACH;AACA,GAAG,8BAA8B,4BAA4B;AAC7D;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,4BAA4B,cAAc;AAC1C,gCAAgC,iCAAiC;AACjE,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,4BAA4B,0BAA0B,0BAA0B,GAAG;AACtF,6BAA6B,0BAA0B,4BAA4B,GAAG;AACtF,2BAA2B,0BAA0B,0BAA0B,GAAG;AAClF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,uDAAuD;AACvD;AACA;AACA,EAAE;AACF,GAAG,sEAAsE;AACzE;AACA,EAAE;AACF;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,UAAU,QAAQ;AAClB;AACA;AACA,CAAC;AACD;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,sBAAsB,4CAA4C;AAClE;AACA;AACA,EAAE;AACF;AACA,GAAG;AACH;AACA,uBAAuB,4BAA4B;AACnD;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,QAAQ;AAClB;AACA;AACA,CAAC;AACD;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,8BAA8B;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG;AACH;AACA;AACA,IAAI;AACJ;AACA;AACA,4B;AACA,qBAAqB,2CAA2C;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,IAAI;AACJ;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,KAAK,uBAAuB,kCAAkC;AAC9D;AACA;AACA;AACA,KAAK,gC;AACL;AACA;AACA;AACA;AACA,IAAI,gC;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,6DAA6D;AACnF;AACA;AACA;AACA;AACA,qBAAqB,8DAA8D;AACnF;;AAEA;AACA;AACA,aAAa;AACb;AACA,WAAW,6B;AACX,WAAW,qBAAqB;AAChC,WAAW,qBAAqB;AAChC,WAAW,qBAAqB;AAChC,WAAW,mBAAmB;AAC9B,WAAW,uBAAuB;AAClC;AACA;AACA,CAAC;AACD;AACA;AACA,EAAE;AACF,GAAG,6BAA6B,qBAAqB,E;AACrD;AACA,e;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,UAAU,SAAS;AACnB;AACA;AACA,CAAC;AACD,uCAAuC,aAAa;AACpD;AACA;AACA,UAAU,SAAS;AACnB;AACA;AACA,CAAC;AACD,qCAAqC,aAAa;AAClD;AACA;AACA,UAAU,SAAS;AACnB;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,MAAM,EAAE,yCAAyC;AACjD,6BAA6B,uHAAuH;AACpJ;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA,oCAAoC,uHAAuH;AAC3J,4BAA4B,yFAAyF;AACrH;AACA;AACA,GAAG;AACH;AACA,IAAI;AACJ,KAAK;AACL;AACA;AACA,I;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,iC;AACX,YAAY,qBAAqB;AACjC,WAAW,qBAAqB;AAChC;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,EAAE;AACF,GAAG;AACH,IAAI;AACJ,KAAK;AACL;AACA;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;;AAEA;AACA;AACA,YAAY,kBAAkB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,WAAW,EAAE;AACb,WAAW,uBAAuB,kBAAkB;AACpD,YAAY,2BAA2B;AACvC,YAAY,QAAQ;AACpB,YAAY,mBAAmB;AAC/B,YAAY,mDAAmD;AAC/D,YAAY,mCAAmC;AAC/C,YAAY,mCAAmC;AAC/C,YAAY,mCAAmC;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,6BAA6B;AAC3E;AACA;AACA,mDAAmD,aAAa;AAChE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0BAA0B;AAC7D,uCAAuC,6BAA6B;AACpE,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,iCAAiC,sBAAsB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,S;AACX,YAAY,E;AACZ;AACA;AACA;AACA;AACA,eAAe,wBAAwB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA,UAAU,cAAc;AACxB,UAAU,QAAQ;AAClB,WAAW,EAAE;AACb;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mBAAmB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA,eAAe,cAAc;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,cAAc;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,c;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,mBAAmB;AAClC;AACA,kB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,mBAAmB,YAAY;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,oB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,cAAc;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,WAAW;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,gD;AACA,OAAO;AACP,4B;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,8BAA8B,4BAA4B;AAC1D;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,YAAY,kBAAkB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,GAAG;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,wB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL,wB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,sB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,8BAA8B;AACzC,YAAY,iBAAiB;AAC7B,YAAY,kBAAkB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,O;AACA;AACA,sBAAsB,eAAe;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,mDAAmD,IAAI,cAAc;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,cAAc;AACnC;AACA;AACA;AACA;AACA,qBAAqB,+BAA+B;AACpD,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA,6D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA,8D;AACA;AACA,qBAAqB,cAAc;AACnC;AACA;AACA;AACA;AACA,+D;AACA;AACA;AACA;AACA;AACA,qBAAqB,cAAc;AACnC;AACA;AACA;AACA,WAAW,MAAM;AACjB;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,WAAW,IAAI;AACf,WAAW,yCAAyC;AACpD,WAAW,2BAA2B;AACtC,WAAW,6BAA6B;AACxC,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,YAAY,IAAI;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,uBAAuB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG,IAAI,kBAAkB;AACzB;AACA;AACA,WAAW,mBAAmB;AAC9B,YAAY,QAAQ;AACpB;AACA;AACA,gE;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,0BAA0B,0DAA0D;AACpF;AACA;AACA;AACA,wBAAwB,gEAAgE;AACxF;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,oCAAoC;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,qHAAqH,E;AAC3I;AACA;AACA,WAAW,mBAAmB;AAC9B;AACA;AACA;AACA,sBAAsB,6EAA6E,E;AACnG;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B;AACA;AACA,gE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,sBAAsB;AACjC,aAAa,SAAS;AACtB,YAAY,SAAS;AACrB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,UAAU,QAAQ;AAClB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA,CAAC;AACD;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,6CAA6C,iCAAiC;AAC9E,EAAE,4CAA4C,iCAAiC;AAC/E,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,eAAe;AAChC;AACA;AACA;AACA;AACA,+D;AACA;AACA;AACA,wBAAwB,2BAA2B;AACnD;AACA;AACA;AACA,mBAAmB,iBAAiB;AACpC,uBAAuB,gBAAgB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,+BAA+B;AAC1C,YAAY,SAAS;AACrB,YAAY,QAAQ;AACpB,YAAY,OAAO;AACnB,YAAY,KAAK;AACjB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,KAAK;AACjB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA,CAAC;AACD,Q;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,EAAE;AACF,GAAG;AACH;AACA,IAAI;AACJ;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,EAAE,+D;AACF,qD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,WAAW,OAAO;AAClB,GAAG;AACH;AACA;AACA,wBAAwB,uFAAuF;AAC/G;AACA;AACA,wBAAwB,yEAAyE;AACjG;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,uFAAuF;AAC/G,sC;AACA;AACA,wBAAwB,yEAAyE;AACjG;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,WAAW,eAAe;AAC1B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iFAAiF,cAAc,EAAE,cAAc,gBAAgB,EAAE;AACjI;AACA;AACA;AACA;AACA,0CAA0C;AAC1C;AACA;AACA;AACA;AACA,wBAAwB,uBAAuB;AAC/C,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,gBAAgB,aAAa;AAC7B,IAAI;AACJ;AACA;AACA;AACA,KAAK;AACL,0B;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,8BAA8B,GAAG;AACvE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,kC;AACX,qBAAqB,mBAAmB;AACxC,2BAA2B,iBAAiB;AAC5C,YAAY,mDAAmD;AAC/D;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,iBAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,QAAQ;AAClB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,UAAU,8BAA8B;AACxC;AACA;AACA,CAAC;AACD;AACA,EAAE,iBAAiB,eAAe;AAClC,GAAG;AACH;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,qBAAqB;AAC/B,WAAW,WAAW;AACtB;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,2CAA2C;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,qBAAqB;AAC/B,WAAW,WAAW;AACtB;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,sBAAsB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,UAAU,wBAAwB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,6B;AACX,aAAa,uBAAuB,kBAAkB;AACtD,eAAe,2BAA2B;AAC1C,mBAAmB,QAAQ;AAC3B,aAAa,iBAAiB;AAC9B,aAAa,mBAAmB;AAChC,mBAAmB,2DAA2D;AAC9E,kBAAkB,mDAAmD;AACrE,gBAAgB,mBAAmB;AACnC;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF,GAAG;AACH,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,2CAA2C,6BAA6B;AAC1E;AACA;AACA,kDAAkD,aAAa;AAC/D;AACA;AACA;AACA;AACA,+BAA+B,iCAAiC;AAChE;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,IAAI;AACJ;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,WAAW,S;AACX,YAAY,W;AACZ;AACA;AACA;AACA,CAAC;AACD,cAAc,wBAAwB;AACtC,EAAE;AACF;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,UAAU;AACV;AACA;AACA;AACA,UAAU,cAAc;AACxB,UAAU,qBAAqB;AAC/B,WAAW,cAAc;AACzB;AACA;AACA,CAAC;AACD,cAAc,mBAAmB;AACjC,EAAE;AACF;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,YAAY,QAAQ;AACpB;AACA;AACA,CAAC;AACD;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,GAAG;AACH,YAAY,gBAAgB;AAC5B,IAAI;AACJ;AACA;AACA;AACA,uBAAuB,mEAAmE;AAC1F,iCAAiC,mEAAmE;AACpG;AACA,YAAY,kBAAkB;AAC9B,IAAI;AACJ;AACA,uBAAuB,kEAAkE;AACzF,iCAAiC,kEAAkE;AACnG;AACA;AACA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF,GAAG;AACH,IAAI;AACJ;AACA;AACA,G;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,2CAA2C,sBAAsB;AACjE;AACA;AACA,aAAa;AACb;AACA,WAAW,6B;AACX,aAAa,uBAAuB,kBAAkB;AACtD,oBAAoB,iBAAiB;AACrC,eAAe,2BAA2B;AAC1C,sBAAsB,2BAA2B;AACjD,aAAa,mBAAmB;AAChC,gBAAgB,mBAAmB;AACnC;AACA;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF,IAAI;AACJ;AACA,KAAK;AACL,MAAM;AACN;AACA;AACA;AACA;AACA;AACA,gB;AACA,IAAI;AACJ,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE,sCAAsC,6BAA6B;AACrE;AACA;AACA,EAAE,wEAAwE,gCAAgC;AAC1G;AACA;AACA;AACA,EAAE,iCAAiC,oCAAoC;AACvE;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,kDAAkD,aAAa;AAC/D;AACA;AACA;AACA,UAAU,uBAAuB;AACjC,UAAU,uBAAuB;AACjC,WAAW,4BAA4B;AACvC;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,WAAW;AACrB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,6BAA6B,4DAA4D;AACzF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,GAAG;AACH,gBAAgB,eAAe;AAC/B,IAAI;AACJ;AACA,KAAK;AACL;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,cAAc;AACxB,EAAE;AACF;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,IAAI;AACJ;AACA,aAAa,YAAY;AACzB,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,cAAc;AACxB,EAAE,gBAAgB,cAAc;AAChC,GAAG;AACH;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG,UAAU,iBAAiB;AAC9B,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,8BAA8B,oGAAoG;AAClI;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,yBAAyB,6BAA6B,EAAE;AACxD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,mC;AACX,YAAY,cAAc;AAC1B;AACA;AACA,CAAC;AACD;AACA;AACA,GAAG;AACH,KAAK,6BAA6B,qBAAqB;AACvD;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,cAAc;AACd;AACA,EAAE,cAAc,oBAAoB;AACpC,GAAG;AACH,IAAI;AACJ;AACA,sE;AACA;AACA;AACA;AACA,kE;AACA;AACA;AACA;AACA,MAAM;AACN;AACA,QAAQ;AACR;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,SAAS;AACnB;AACA;AACA,CAAC,cAAc,oBAAoB;AACnC,EAAE;AACF;AACA;AACA;AACA;AACA,UAAU,MAAM;AAChB;AACA;AACA,cAAc,oBAAoB;AAClC;AACA;AACA;AACA;AACA,UAAU,cAAc;AACxB;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA,wCAAwC,eAAe;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,kCAAkC;AAC7C,aAAa,SAAS;AACtB;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,yBAAyB,kBAAkB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,EAAE;AACF,sBAAsB,4FAA4F;AAClH;AACA;AACA;AACA;AACA,uCAAuC,oBAAoB;AAC3D,GAAG;AACH,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,6B;AACX,aAAa,mBAAmB;AAChC,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mB;AACA,mBAAmB,oBAAoB;AACvC,oBAAoB,sBAAsB;AAC1C,mBAAmB,qBAAqB;AACxC,oBAAoB,qBAAqB;AACzC;AACA;AACA;AACA,mB;AACA,mBAAmB,qBAAqB;AACxC,oBAAoB,qBAAqB;AACzC,mBAAmB,oBAAoB;AACvC,oBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA,CAAC;AACD;AACA,iC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,eAAe,MAAM;AACrB,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG;AACH;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA,WAAW,IAAI;AACf,YAAY,SAAS;AACrB,YAAY,gBAAgB;AAC5B,YAAY,0BAA0B;AACtC,WAAW,iCAAiC;AAC5C,WAAW,mBAAmB;AAC9B,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,WAAW,oCAAoC;AAC/C,WAAW,oCAAoC;AAC/C,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,oDAAoD,cAAc;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAsE,kCAAkC;AACxG;AACA,gEAAgE,4DAA4D;AAC5H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,+BAA+B;AACnE,wCAAwC,+CAA+C;AACvF,iCAAiC,uBAAuB;AACxD,gCAAgC,0BAA0B;AAC1D;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,iCAAiC,oCAAoC;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,qCAAqC;AAChD;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,4BAA4B;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4CAA4C,6BAA6B,EAAE;AAC3E,2BAA2B;AAC3B;AACA;AACA;AACA;AACA,8CAA8C,sBAAsB,EAAE;AACtE,kBAAkB;AAClB;AACA;AACA;AACA;AACA;AACA,iDAAiD;AACjD;AACA;AACA;AACA;AACA,qBAAqB,uBAAuB;AAC5C,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA,6CAA6C,6BAA6B,EAAE;AAC5E,2BAA2B;AAC3B;AACA;AACA;AACA,mBAAmB;AACnB,KAAK;AACL,KAAK;AACL;AACA;AACA;AACA,UAAU,QAAQ;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,wBAAwB;AACtC;AACA;AACA;AACA;AACA,iEAAiE,8DAA8D;AAC/H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,cAAc;AAC3E,6BAA6B,+HAA+H;AAC5J;AACA;AACA;AACA,sCAAsC,cAAc;AACpD,6BAA6B,8DAA8D;AAC3F;AACA;AACA;AACA;AACA,6BAA6B,8FAA8F;AAC3H;AACA;AACA;AACA;AACA;AACA,2BAA2B,qDAAqD;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,WAAW;AACrB,UAAU,QAAQ;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB,6DAA6D;AACnF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA,WAAW,mBAAmB;AAC9B,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,wBAAwB,2GAA2G;AACnI;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,yBAAyB;AACpC;AACA;AACA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,sBAAsB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,sBAAsB;AACxC;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,kBAAkB,sBAAsB;AACxC;AACA;AACA;AACA,mBAAmB,aAAa;AAChC;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA,WAAW,EAAE;AACb;AACA;AACA;AACA,wC;AACA,6B;AACA,kB;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,SAAS;AACpB;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA,WAAW,OAAO;AAClB,WAAW,IAAI;AACf,YAAY,QAAQ;AACpB;AACA;AACA;AACA,0BAA0B,8BAA8B;AACxD;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,0BAA0B,EAAE;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,0BAA0B,EAAE;AAC/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,oDAAoD;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,2DAA2D;AACrF,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,qBAAqB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,mBAAmB;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uB;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA,aAAa;AACb,WAAW,OAAO;AAClB,YAAY,iBAAiB;AAC7B,YAAY,QAAQ;AACpB,YAAY,iCAAiC;AAC7C,YAAY,+CAA+C;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6FAA6F,6CAA6C;AAC1I;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,gBAAgB;AAC3B,WAAW,WAAW;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,gBAAgB;AAC5B,YAAY,WAAW;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,gBAAgB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,WAAW;AACvB;AACA;AACA;AACA,kBAAkB,aAAa;AAC/B;AACA,oBAAoB,eAAe;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,OAAO;AAClB,aAAa,gB;AACb;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,QAAQ;AACnB,YAAY,WAAW;AACvB;AACA;AACA;AACA;AACA;AACA,sHAAsH;AACtH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,gBAAgB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,iBAAiB;AACrC,wBAAwB,aAAa;AACrC;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,mBAAmB;AAC9B;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,OAAO,OAAO;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,UAAU,oBAAoB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,QAAQ;AAClB,UAAU,WAAW;AACrB,UAAU,YAAY;AACtB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,0CAA0C;AAC3D,iBAAiB,wCAAwC;AACzD,iBAAiB,wBAAwB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,WAAW,8BAA8B;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA,8B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,UAAU,0BAA0B;AACpC,UAAU,OAAO;AACjB,UAAU,cAAc;AACxB,UAAU,gBAAgB;AAC1B,UAAU,OAAO;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C,wCAAwC,sBAAsB,GAAG;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,cAAc;AAC9D,sDAAsD,0BAA0B;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,IAAI;AACf,YAAY,cAAc;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,UAAU;AAC7B,qBAAqB,UAAU;AAC/B;AACA;AACA;AACA;AACA;AACA,iBAAiB,eAAe;AAChC;AACA;AACA;AACA;AACA,iBAAiB,KAAK;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,sBAAsB;AACjE;AACA;AACA,WAAW,EAAE;AACb,YAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,sBAAsB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,uBAAuB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,WAAW;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS,gBAAgB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,gBAAgB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,aAAa,oBAAoB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,sBAAsB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,KAAK;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,KAAK;AAClB;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,aAAa,YAAY;AACzB;AACA;AACA;AACA;AACA;AACA,aAAa,gBAAgB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,KAAK;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,cAAc;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,cAAc;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,sBAAsB;AACjC,WAAW,sBAAsB;AACjC,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,qBAAqB;AAChC,YAAY;AACZ;AACA;AACA,kBAAkB,eAAe;AACjC;AACA;AACA;AACA;AACA;AACA,WAAW,qBAAqB;AAChC,YAAY,OAAO;AACnB;AACA;AACA;AACA,kBAAkB,YAAY;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,qBAAqB;AAChC,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,qBAAqB;AAChC,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,W;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,OAAO;AAClB,YAAY,iBAAiB;AAC7B,YAAY,OAAO;AACnB,YAAY,iCAAiC;AAC7C,YAAY,+CAA+C;AAC3D;AACA;AACA;AACA,+CAA+C,mCAAmC;AAClF;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,aAAa,gB;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,EAAE,OAAO,OAAO;AAChB,UAAU,MAAM;AAChB,gBAAgB,cAAc;AAC9B,eAAe,eAAe;AAC9B,gBAAgB,OAAO;AACvB,cAAc,UAAU;AACxB,cAAc,sBAAsB;AACpC;AACA;AACA;AACA;AACA,YAAY;AACZ,UAAU,4BAA4B;AACtC;AACA;AACA,CAAC,gB;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD;AACnD;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,gBAAgB,oBAAoB;AACpC,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4C;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,cAAc;AAC1B;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,WAAW,cAAc;AACzB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,WAAW,eAAe;AAC1B;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,YAAY,UAAU;AACtB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,WAAW,mBAAmB;AAC9B;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,YAAY,mBAAmB;AAC/B;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B;AACA;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,OAAO;AAClB,YAAY,iBAAiB;AAC7B,YAAY,OAAO;AACnB,YAAY,iCAAiC;AAC7C,YAAY,+CAA+C;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,kBAAkB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,aAAa,gB;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,OAAO;AAClB,YAAY,iBAAiB;AAC7B,YAAY,OAAO;AACnB,YAAY,cAAc;AAC1B,YAAY,0CAA0C;AACtD,YAAY,iCAAiC;AAC7C,YAAY,+CAA+C;AAC3D;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,aAAa,gB;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,YAAY,0CAA0C;AACtD,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,YAAY,cAAc;AAC1B,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,OAAO;AAClB,YAAY,iBAAiB;AAC7B,YAAY,OAAO;AACnB,YAAY,iCAAiC;AAC7C,YAAY,+CAA+C;AAC3D;AACA;AACA;AACA,iCAAiC,qBAAqB;AACtD;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,aAAa,gB;AACb;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,kBAAkB;AAC7B,YAAY;AACZ;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,UAAU,sBAAsB;AAChC;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,QAAQ;AAClB,UAAU,WAAW;AACrB,WAAW,QAAQ;AACnB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA,MAAM;AACN;AACA;AACA;AACA,kBAAkB,eAAe;AACjC,MAAM;AACN;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,MAAM;AACN;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,IAAI;AACf,YAAY,OAAO;AACnB,YAAY,cAAc;AAC1B,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,OAAO;AACnB,YAAY,oCAAoC;AAChD,YAAY,mBAAmB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD;AACpD;AACA;AACA;AACA;AACA;AACA,2BAA2B,0BAA0B;AACrD;AACA;AACA,iBAAiB;AACjB;AACA;AACA,aAAa,IAAI,EAAE,YAAY;AAC/B;AACA;AACA;AACA,0EAA0E,8BAA8B;AACxG;AACA;AACA,oBAAoB,eAAe;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,Q;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,eAAe;AAChC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,wBAAwB,qBAAqB;AAC7C;AACA,wBAAwB,mBAAmB;AAC3C;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,UAAU,wBAAwB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D;AAC7D;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,QAAQ;AAClB,UAAU,WAAW;AACrB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,sGAAsG,EAAE;AACxG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,eAAe;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,kCAAkC;AAC7C,YAAY,OAAO;AACnB,YAAY,kBAAkB;AAC9B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,iBAAiB,cAAc;AAChC,EAAE;AACF;AACA,GAAG,kBAAkB,gBAAgB;AACrC,IAAI;AACJ,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,eAAe,YAAY;AAC3B,GAAG;AACH;AACA,IAAI;AACJ,4BAA4B,4CAA4C;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC;AACtC;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,kFAAkF,cAAc,EAAE,cAAc,gBAAgB,EAAE;AAClI;AACA;AACA;AACA;AACA;AACA,cAAc,iBAAiB;AAC/B,GAAG;AACH;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,SAAS;AAC5B,IAAI;AACJ;AACA;AACA;AACA,KAAK,sB;AACL,6B;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,wBAAwB;AACnC,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA,WAAW,wBAAwB;AACnC,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,wBAAwB;AACnC,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,gGAAgG;AAChG;AACA;AACA;AACA;AACA;AACA,WAAW,wBAAwB;AACnC,WAAW,OAAO;AAClB,YAAY,cAAc;AAC1B;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,EAAE;AACF;AACA,iCAAiC;AACjC,6BAA6B;AAC7B;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,wCAAwC;AACxC;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,0BAA0B;AACrC,WAAW,OAAO;AAClB,YAAY,cAAc;AAC1B;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,EAAE;AACF,eAAe,YAAY;AAC3B,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa;AACb,WAAW;AACX;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,qBAAqB,OAAO;AAC5B,qBAAqB,OAAO;AAC5B,cAAc,uBAAuB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,YAAY;AAC1B,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,uBAAuB;AACjC,WAAW,SAAS;AACpB;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA,IAAI;AACJ;AACA,KAAK,iC;AACL,KAAK;AACL;AACA,0CAA0C,UAAU,EAAE;AACtD,oCAAoC,WAAW,EAAE;AACjD;AACA;AACA;AACA,UAAU;AACV,aAAa,uBAAuB;AACpC,cAAc,OAAO;AACrB,aAAa,UAAU;AACvB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,gBAAgB,YAAY;AAC5B,IAAI,cAAc,eAAe;AACjC,KAAK;AACL,kBAAkB,kBAAkB;AACpC,MAAM;AACN;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,gBAAgB;AAC1B,E;AACA;AACA,GAAG;AACH,aAAa,wBAAwB;AACrC,KAAK;AACL,cAAc,cAAc;AAC5B,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,gBAAgB;AAC1B,EAAE;AACF,GAAG;AACH,IAAI;AACJ,aAAa,wBAAwB;AACrC,KAAK;AACL;AACA,MAAM;AACN,eAAe,cAAc;AAC7B,OAAO;AACP;AACA;AACA;AACA,MAAM;AACN,wBAAwB,MAAM;AAC9B,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,WAAW;AACX,UAAU,OAAO;AACjB,UAAU,KAAK;AACf,UAAU,mBAAmB;AAC7B,UAAU,mBAAmB;AAC7B,UAAU,qBAAqB;AAC/B,UAAU,2CAA2C;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+C;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,sDAAsD,qBAAqB,EAAE;AAC7E,uDAAuD,qBAAqB,EAAE;AAC9E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,6BAA6B,EAAE;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,2CAA2C;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,2CAA2C;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,qBAAqB;AAChC,WAAW,iBAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yC;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,mBAAmB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,EAAE;AACF;AACA;AACA,qBAAqB,iCAAiC;AACtD;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,CAAC;AACD;AACA;AACA,WAAW;AACX;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,QAAQ;AAClB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF,iBAAiB,eAAe;AAChC,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,WAAW;AACX,UAAU,OAAO;AACjB,UAAU,OAAO;AACjB,UAAU,OAAO;AACjB,UAAU,OAAO;AACjB,UAAU,OAAO;AACjB,UAAU,mBAAmB;AAC7B,UAAU,mBAAmB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,qBAAqB;AAChC,WAAW,iBAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,WAAW;AACX,UAAU,OAAO;AACjB,UAAU,KAAK;AACf,UAAU,mBAAmB;AAC7B,UAAU,mBAAmB;AAC7B,UAAU,qBAAqB;AAC/B,UAAU,2CAA2C;AACrD;AACA,UAAU,EAAE;AACZ,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,WAAW,wBAAwB;AACnC,WAAW,6BAA6B;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,+BAA+B;AAC1E;AACA,gCAAgC,mCAAmC;AACnE;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,iCAAiC,2BAA2B;AAC5D;AACA;AACA,oDAAoD,eAAe;AACnE;AACA;AACA;AACA,wCAAwC,gBAAgB;AACxD,mCAAmC,mCAAmC;AACtE;AACA,mC;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,mCAAmC,uCAAuC;AAC1E;AACA,sEAAsE,gBAAgB;AACtF,KAAK;AACL;AACA;AACA,4CAA4C,sCAAsC;AAClF,kCAAkC,oCAAoC;AACtE;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,mCAAmC,0DAA0D;AAC7F,kCAAkC,oCAAoC;AACtE;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,EAAE;AACb,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,YAAY;AACZ,WAAW,OAAO;AAClB,WAAW,qBAAqB;AAChC,WAAW,2CAA2C;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,qBAAqB;AAChC,WAAW,iBAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,2BAA2B;AAC5D,wBAAwB,wBAAwB;AAChD,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,8B;AACA,2B;AACA;AACA,GAAG;AACH;AACA;AACA,WAAW,WAAW;AACtB;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,uE;AACA;AACA;AACA;AACA,4CAA4C,sDAAsD;AAClG;AACA;AACA;AACA,6DAA6D,wBAAwB;AACrF,WAAW;AACX,mDAAmD,wBAAwB;AAC3E;AACA;AACA;AACA,OAAO;AACP,gDAAgD,sDAAsD;AACtG;AACA;AACA;AACA,8DAA8D,wBAAwB;AACtF,WAAW;AACX,uDAAuD,wBAAwB;AAC/E;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,cAAc;AACxB,UAAU,cAAc;AACxB,UAAU,cAAc;AACxB,WAAW,KAAK;AAChB;AACA;AACA;AACA;AACA;AACA,WAAW,qBAAqB;AAChC,YAAY,qBAAqB;AACjC;AACA,8CAA8C;AAC9C;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,aAAa,mBAAmB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,QAAQ;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,cAAc;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,cAAc;AAC/B;AACA;AACA;AACA,iBAAiB,cAAc;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,qBAAqB;AACjC;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,OAAO;AAClB,WAAW,mBAAmB;AAC9B,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,mBAAmB;AAC9B,YAAY,cAAc;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,mBAAmB;AAC9B,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf,YAAY,iBAAiB;AAC7B,YAAY,QAAQ;AACpB,YAAY,QAAQ;AACpB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,8BAA8B;AACzC,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,WAAW,cAAc;AACzB,YAAY,WAAW;AACvB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,OAAO;AAClB,WAAW,WAAW;AACtB,WAAW,WAAW;AACtB,YAAY,WAAW;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,YAAY,c;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,cAAc;AACzB,YAAY,6BAA6B;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,yBAAyB,gBAAgB,EAAE;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,kBAAkB,sBAAsB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,oBAAoB,YAAY;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,sCAAsC,iBAAiB;AACvD;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,WAAW,WAAW;AACtB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,cAAc;AACxB,UAAU,cAAc;AACxB,WAAW,OAAO;AAClB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,UAAU,cAAc;AACxB,UAAU,cAAc;AACxB,WAAW;AACX;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,WAAW;AACrB,WAAW,cAAc;AACzB;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,WAAW;AACrB,WAAW,cAAc;AACzB;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,qBAAqB;AAChC,WAAW,OAAO;AAClB,YAAY,qBAAqB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,qBAAqB;AAChC,aAAa;AACb;AACA;AACA,iBAAiB,mBAAmB;AACpC;AACA;AACA;AACA,oBAAoB;AACpB,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,wBAAwB;AACxB;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA,WAAW,qBAAqB;AAChC,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;AACA;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,4CAA4C;AACpE;AACA;AACA;AACA,6BAA6B,2BAA2B;AACxD;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;;AAEA;AACA;AACA,UAAU,qCAAqC;AAC/C,UAAU,OAAO;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,aAAa;AAC5B;AACA,qBAAqB,iBAAiB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,eAAe;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,sBAAsB;AACjE;AACA;AACA,YAAY;AACZ,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,6BAA6B;AACzC;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;AACA,G;AACA;AACA;AACA;AACA;AACA,eAAe,kBAAkB;AACjC;AACA,uBAAuB,eAAe;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,6BAA6B;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,UAAU;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,YAAY;AACtB;AACA;AACA;AACA;AACA;AACA,aAAa,YAAY;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,eAAe;AACzB,UAAU,iBAAiB;AAC3B,YAAY,4BAA4B;AACxC,YAAY,OAAO;AACnB,YAAY,UAAU;AACtB,YAAY,gBAAgB;AAC5B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW;AACX,UAAU,OAAO;AACjB,UAAU,OAAO;AACjB,UAAU,SAAS;AACnB;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,CAAC;AACD,cAAc,aAAa;AAC3B,EAAE;AACF;AACA;AACA;AACA;AACA,CAAC;AACD,cAAc,gBAAgB;AAC9B,EAAE;AACF;AACA;AACA;AACA;AACA,CAAC;AACD,cAAc,aAAa;AAC3B,EAAE;AACF;AACA;AACA;AACA;AACA,CAAC;AACD,cAAc,aAAa;AAC3B,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,UAAU,sBAAsB;AAChC,EAAE;AACF;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,oBAAoB;AAC/B,GAAG;AACH;AACA;AACA,yD;AACA,qD;AACA,uD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,kBAAkB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,UAAU,OAAO;AACjB,UAAU,OAAO;AACjB,UAAU,cAAc;AACxB,UAAU,cAAc;AACxB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,0BAA0B;AACpC;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,WAAW,cAAc;AACzB;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,cAAc;AACxB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,WAAW,cAAc;AACzB;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,OAAO;AACjB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA,UAAU,cAAc;AACxB,WAAW,cAAc;AACzB;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,cAAc;AACxB,WAAW,cAAc;AACzB;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,cAAc;AACxB,WAAW,cAAc;AACzB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,UAAU,cAAc;AACxB,WAAW,cAAc;AACzB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,UAAU,cAAc;AACxB,WAAW,cAAc;AACzB;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,cAAc;AACxB,WAAW,cAAc;AACzB;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,cAAc;AACxB,WAAW,cAAc;AACzB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,cAAc;AACxB,WAAW,cAAc;AACzB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,cAAc;AACxB,WAAW;AACX;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,cAAc;AACxB,WAAW;AACX;AACA;AACA,CAAC;AACD;AACA,cAAc,MAAM;AACpB,EAAE;AACF;AACA;AACA;AACA;AACA,UAAU,OAAO;AACjB,WAAW;AACX;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,UAAU,cAAc;AACxB,WAAW;AACX;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,UAAU,cAAc;AACxB,UAAU,cAAc;AACxB,WAAW,OAAO;AAClB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,cAAc;AACxB,UAAU,cAAc;AACxB,WAAW,qBAAqB;AAChC;AACA;AACA,CAAC;AACD;AACA;AACA,iBAAiB,MAAM;AACvB,EAAE;AACF;AACA;AACA;AACA,CAAC;AACD;AACA,CAAC;AACD;AACA;AACA;AACA,UAAU,cAAc;AACxB,UAAU,OAAO;AACjB,WAAW,uCAAuC;AAClD;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA,EAAE;AACF,WAAW,KAAK;AAChB,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,UAAU,cAAc;AACxB,UAAU,OAAO;AACjB,WAAW,uCAAuC;AAClD;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA,EAAE;AACF,WAAW,KAAK;AAChB,GAAG;AACH;AACA,WAAW,KAAK;AAChB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA,WAAW,cAAc;AACzB,WAAW,iBAAiB;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,eAAe;AACzB,UAAU,kBAAkB;AAC5B,iBAAiB,+BAA+B;AAChD,YAAY,OAAO;AACnB,cAAc,OAAO;AACrB,YAAY,oDAAoD;AAChE;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,wCAAwC,sBAAsB,GAAG;AAC3G,kEAAkE,eAAe;AACjF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,gBAAgB;AAChC,IAAI;AACJ,6B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,oC;AACH,GAAG;AACH;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,SAAS;AACrB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,EAAE;AACF,GAAG;AACH;AACA;AACA;AACA;AACA,EAAE;AACF,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,eAAe;AACzB,UAAU,iBAAiB;AAC3B,iBAAiB,sBAAsB;AACvC,eAAe,OAAO;AACtB,gBAAgB,OAAO;AACvB,aAAa,UAAU;AACvB,YAAY,oDAAoD;AAChE;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,wCAAwC,sBAAsB,GAAG;AAC3G,kEAAkE,eAAe;AACjF;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB,gBAAgB;AAChC,IAAI;AACJ,6B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,KAAK;AAChB,WAAW,kBAAkB;AAC7B,WAAW,uBAAuB;AAClC,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA,aAAa;AACb,gBAAgB;AAChB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,GAAG;AACH,4BAA4B,eAAe;AAC3C;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,uCAAuC,sBAAsB;AAC3H;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU;AACV;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU,OAAO;AACjB,UAAU,OAAO;AACjB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,UAAU,aAAa;AACvB;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,qBAAqB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,YAAY,qBAAqB;AACjC,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,aAAa,qBAAqB;AAClC,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,qBAAqB;AACjC,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,6BAA6B;AACxC,WAAW,yBAAyB;AACpC,WAAW,iBAAiB;AAC5B,WAAW,sBAAsB;AACjC,WAAW,SAAS;AACpB,WAAW,cAAc;AACzB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,YAAY;AACvB,WAAW,OAAO;AAClB,aAAa;AACb,gBAAgB;AAChB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,sBAAsB;AAClD,GAAG,yB;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,oBAAoB,mBAAmB,qBAAqB;AACtF,GAAG;AACH;AACA;AACA,gBAAgB,aAAa;AAC7B,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,iBAAiB;AAC7C;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU;AACV;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG;AACH;AACA,IAAI;AACJ;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAI,4B;AACJ;AACA;AACA;AACA;AACA,IAAI,4B;AACJ;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,M;AACV,UAAU;AACV,WAAW,QAAQ;AACnB,YAAY,QAAQ;AACpB,aAAa,QAAQ;AACrB,cAAc;AACd,aAAa;AACb,aAAa;AACb,WAAW;AACX,WAAW;AACX,WAAW,OAAO;AAClB;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,WAAW,OAAO;AAClB,YAAY,QAAQ;AACpB,YAAY,gBAAgB;AAC5B,YAAY,OAAO;AACnB,YAAY,sBAAsB;AAClC,YAAY,aAAa;AACzB;AACA;AACA;AACA,8B;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,YAAY,O;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,aAAa;AACxB;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,WAAW,aAAa;AACxB;AACA;AACA;AACA;AACA,GAAG;AACH,wB;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB,YAAY,O;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,qBAAqB;AAChC,WAAW,gBAAgB;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe,QAAQ;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,QAAQ;AACzB;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,WAAW,qBAAqB;AAChC,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,YAAY,OAAO;AACnB,uCAAuC,kCAAkC;AACzE,YAAY,OAAO;AACnB;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,QAAQ;AACpB,YAAY,gBAAgB;AAC5B,YAAY,kBAAkB;AAC9B,aAAa;AACb,gBAAgB;AAChB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA,mCAAmC;AACnC,4EAA4E;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA,EAAE,MAAM,sCAAsC;AAC9C,YAAY,cAAc;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,WAAW,aAAa;AAC9D;AACA,WAAW,cAAc;AACzB,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,0CAA0C;AAC1C;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,iDAAiD;AACjD;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,cAAc;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,kBAAkB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,iBAAiB;AAC5B,YAAY,kBAAkB;AAC9B;AACA;AACA;AACA,CAAC,sEAAsE;AACvE;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,YAAY,kBAAkB;AAC9B;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,YAAY,kCAAkC;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,kCAAkC;AAC7C,WAAW,yBAAyB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA,EAAE,4BAA4B;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;AACA,GAAG;AACH;AACA,IAAI;AACJ,iE;AACA;AACA;AACA;AACA,8E;AACA;AACA;AACA;AACA;AACA,+D;AACA;AACA;AACA;AACA;AACA,8E;AACA;AACA;AACA;AACA;AACA,yE;AACA;AACA;AACA;AACA;AACA,oC;AACA;AACA;AACA;AACA;AACA,kD;AACA;AACA;AACA;AACA;AACA,iD;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA,gBAAgB,cAAc;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,kCAAkC;AAC7C,WAAW,yBAAyB;AACpC,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA,CAAC;AACD;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,YAAY,8CAA8C;AAC1D,YAAY,QAAQ;AACpB,YAAY,OAAO;AACnB,YAAY,QAAQ;AACpB,YAAY,gBAAgB;AAC5B,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,SAAS;AACrB,aAAa;AACb,gBAAgB;AAChB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA,EAAE,uCAAuC,yBAAyB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,4BAA4B,YAAY;AACxC,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA,GAAG;AACH,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA,CAAC;AACD;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4EAA4E;AAC5E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,mBAAmB;AAC7B;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,WAAW,YAAY;AACvB,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH,yBAAyB,MAAM;AAC/B,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,eAAe;AAChC,EAAE,EAAE;AACJ,kBAAkB,YAAY;AAC9B,I;AACA;AACA;AACA;AACA,KAAK,2CAA2C;AAChD,qEAAqE;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,uDAAuD;AACjE,UAAU,OAAO;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,EAAE,+BAA+B,2BAA2B;AAC5D;AACA;AACA,wCAAwC,cAAc;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,UAAU,wBAAwB;AAClC,UAAU,OAAO;AACjB;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,2B;AACD;AACA;AACA,CAAC,uB;AACD;AACA;AACA,CAAC;AACD;AACA,UAAU,OAAO;AACjB,UAAU,cAAc;AACxB;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,GAAG,OAAO,iBAAiB;AAC3B,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,eAAe;AAC7B,EAAE;AACF;AACA;AACA;AACA;AACA;AACA,EAAE;AACF,GAAG;AACH;AACA,IAAI;AACJ;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA,GAAG;AACH;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,eAAe;AAC7B,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,aAAa,0BAA0B;AACvC,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa;AACb,gBAAgB;AAChB;AACA;AACA;AACA,CAAC;AACD,sDAAsD,2BAA2B;AACjF,mCAAmC,6CAA6C;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,CAAC;AACD,EAAE;AACF;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,IAAI;AACf,WAAW,yBAAyB;AACpC,WAAW,iBAAiB;AAC5B,WAAW,sBAAsB;AACjC,WAAW,aAAa;AACxB,WAAW,cAAc;AACzB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,YAAY;AACvB,WAAW,OAAO;AAClB,aAAa;AACb,gBAAgB;AAChB;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,sBAAsB;AAClD,GAAG,yB;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0BAA0B,oBAAoB,mBAAmB,qBAAqB;AACtF,GAAG;AACH;AACA;AACA,gBAAgB,aAAa;AAC7B,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,CAAC;AACD;AACA;AACA,UAAU;AACV;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA,GAAG;AACH;AACA,IAAI;AACJ;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,IAAI;AACJ;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,IAAI,4B;AACJ;AACA;AACA;AACA;AACA,IAAI,4B;AACJ;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;AC9hsBA,yC;;;;;;ACAA,yC;;;;;;ACAA,yC","file":"plg_cartografia_historica.ol.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 441f52bb4990bf38b093","  const namespace = (namespace) => {\n    return (target) => {\n      let namespaceArray = namespace.split(\".\");\n      const constructObject = (namespaceArray, obj) => {\n        if (namespaceArray.length > 0) {\n          let name = namespaceArray[0];\n          if (!obj[name]) {\n            obj[name] = {};\n          }\n          constructObject(namespaceArray.splice(1), obj[name]);\n        }\n        else {\n          obj[target.name] = target;\n        }\n        return obj;\n      };\n      let mainPath = namespaceArray[0];\n      if (!window[mainPath]) {\n        window[mainPath] = {};\n      }\n      constructObject(namespaceArray.splice(1), window[mainPath]);\n    };\n  };\n\n  module.exports = namespace;\n\n\n\n// WEBPACK FOOTER //\n// ./compile-utils/util/decorator.js","/*!\n * jQuery JavaScript Library v3.4.0\n * https://jquery.com/\n *\n * Includes Sizzle.js\n * https://sizzlejs.com/\n *\n * Copyright JS Foundation and other contributors\n * Released under the MIT license\n * https://jquery.org/license\n *\n * Date: 2019-04-10T19:48Z\n */\n( function( global, factory ) {\n\n\t\"use strict\";\n\n\tif ( typeof module === \"object\" && typeof module.exports === \"object\" ) {\n\n\t\t// For CommonJS and CommonJS-like environments where a proper `window`\n\t\t// is present, execute the factory and get jQuery.\n\t\t// For environments that do not have a `window` with a `document`\n\t\t// (such as Node.js), expose a factory as module.exports.\n\t\t// This accentuates the need for the creation of a real `window`.\n\t\t// e.g. var jQuery = require(\"jquery\")(window);\n\t\t// See ticket #14549 for more info.\n\t\tmodule.exports = global.document ?\n\t\t\tfactory( global, true ) :\n\t\t\tfunction( w ) {\n\t\t\t\tif ( !w.document ) {\n\t\t\t\t\tthrow new Error( \"jQuery requires a window with a document\" );\n\t\t\t\t}\n\t\t\t\treturn factory( w );\n\t\t\t};\n\t} else {\n\t\tfactory( global );\n\t}\n\n// Pass this if window is not defined yet\n} )( typeof window !== \"undefined\" ? window : this, function( window, noGlobal ) {\n\n// Edge <= 12 - 13+, Firefox <=18 - 45+, IE 10 - 11, Safari 5.1 - 9+, iOS 6 - 9.1\n// throw exceptions when non-strict code (e.g., ASP.NET 4.5) accesses strict mode\n// arguments.callee.caller (trac-13335). But as of jQuery 3.0 (2016), strict mode should be common\n// enough that all such attempts are guarded in a try block.\n\"use strict\";\n\nvar arr = [];\n\nvar document = window.document;\n\nvar getProto = Object.getPrototypeOf;\n\nvar slice = arr.slice;\n\nvar concat = arr.concat;\n\nvar push = arr.push;\n\nvar indexOf = arr.indexOf;\n\nvar class2type = {};\n\nvar toString = class2type.toString;\n\nvar hasOwn = class2type.hasOwnProperty;\n\nvar fnToString = hasOwn.toString;\n\nvar ObjectFunctionString = fnToString.call( Object );\n\nvar support = {};\n\nvar isFunction = function isFunction( obj ) {\n\n      // Support: Chrome <=57, Firefox <=52\n      // In some browsers, typeof returns \"function\" for HTML <object> elements\n      // (i.e., `typeof document.createElement( \"object\" ) === \"function\"`).\n      // We don't want to classify *any* DOM node as a function.\n      return typeof obj === \"function\" && typeof obj.nodeType !== \"number\";\n  };\n\n\nvar isWindow = function isWindow( obj ) {\n\t\treturn obj != null && obj === obj.window;\n\t};\n\n\n\n\n\tvar preservedScriptAttributes = {\n\t\ttype: true,\n\t\tsrc: true,\n\t\tnonce: true,\n\t\tnoModule: true\n\t};\n\n\tfunction DOMEval( code, node, doc ) {\n\t\tdoc = doc || document;\n\n\t\tvar i, val,\n\t\t\tscript = doc.createElement( \"script\" );\n\n\t\tscript.text = code;\n\t\tif ( node ) {\n\t\t\tfor ( i in preservedScriptAttributes ) {\n\n\t\t\t\t// Support: Firefox 64+, Edge 18+\n\t\t\t\t// Some browsers don't support the \"nonce\" property on scripts.\n\t\t\t\t// On the other hand, just using `getAttribute` is not enough as\n\t\t\t\t// the `nonce` attribute is reset to an empty string whenever it\n\t\t\t\t// becomes browsing-context connected.\n\t\t\t\t// See https://github.com/whatwg/html/issues/2369\n\t\t\t\t// See https://html.spec.whatwg.org/#nonce-attributes\n\t\t\t\t// The `node.getAttribute` check was added for the sake of\n\t\t\t\t// `jQuery.globalEval` so that it can fake a nonce-containing node\n\t\t\t\t// via an object.\n\t\t\t\tval = node[ i ] || node.getAttribute && node.getAttribute( i );\n\t\t\t\tif ( val ) {\n\t\t\t\t\tscript.setAttribute( i, val );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tdoc.head.appendChild( script ).parentNode.removeChild( script );\n\t}\n\n\nfunction toType( obj ) {\n\tif ( obj == null ) {\n\t\treturn obj + \"\";\n\t}\n\n\t// Support: Android <=2.3 only (functionish RegExp)\n\treturn typeof obj === \"object\" || typeof obj === \"function\" ?\n\t\tclass2type[ toString.call( obj ) ] || \"object\" :\n\t\ttypeof obj;\n}\n/* global Symbol */\n// Defining this global in .eslintrc.json would create a danger of using the global\n// unguarded in another place, it seems safer to define global only for this module\n\n\n\nvar\n\tversion = \"3.4.0\",\n\n\t// Define a local copy of jQuery\n\tjQuery = function( selector, context ) {\n\n\t\t// The jQuery object is actually just the init constructor 'enhanced'\n\t\t// Need init if jQuery is called (just allow error to be thrown if not included)\n\t\treturn new jQuery.fn.init( selector, context );\n\t},\n\n\t// Support: Android <=4.0 only\n\t// Make sure we trim BOM and NBSP\n\trtrim = /^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g;\n\njQuery.fn = jQuery.prototype = {\n\n\t// The current version of jQuery being used\n\tjquery: version,\n\n\tconstructor: jQuery,\n\n\t// The default length of a jQuery object is 0\n\tlength: 0,\n\n\ttoArray: function() {\n\t\treturn slice.call( this );\n\t},\n\n\t// Get the Nth element in the matched element set OR\n\t// Get the whole matched element set as a clean array\n\tget: function( num ) {\n\n\t\t// Return all the elements in a clean array\n\t\tif ( num == null ) {\n\t\t\treturn slice.call( this );\n\t\t}\n\n\t\t// Return just the one element from the set\n\t\treturn num < 0 ? this[ num + this.length ] : this[ num ];\n\t},\n\n\t// Take an array of elements and push it onto the stack\n\t// (returning the new matched element set)\n\tpushStack: function( elems ) {\n\n\t\t// Build a new jQuery matched element set\n\t\tvar ret = jQuery.merge( this.constructor(), elems );\n\n\t\t// Add the old object onto the stack (as a reference)\n\t\tret.prevObject = this;\n\n\t\t// Return the newly-formed element set\n\t\treturn ret;\n\t},\n\n\t// Execute a callback for every element in the matched set.\n\teach: function( callback ) {\n\t\treturn jQuery.each( this, callback );\n\t},\n\n\tmap: function( callback ) {\n\t\treturn this.pushStack( jQuery.map( this, function( elem, i ) {\n\t\t\treturn callback.call( elem, i, elem );\n\t\t} ) );\n\t},\n\n\tslice: function() {\n\t\treturn this.pushStack( slice.apply( this, arguments ) );\n\t},\n\n\tfirst: function() {\n\t\treturn this.eq( 0 );\n\t},\n\n\tlast: function() {\n\t\treturn this.eq( -1 );\n\t},\n\n\teq: function( i ) {\n\t\tvar len = this.length,\n\t\t\tj = +i + ( i < 0 ? len : 0 );\n\t\treturn this.pushStack( j >= 0 && j < len ? [ this[ j ] ] : [] );\n\t},\n\n\tend: function() {\n\t\treturn this.prevObject || this.constructor();\n\t},\n\n\t// For internal use only.\n\t// Behaves like an Array's method, not like a jQuery method.\n\tpush: push,\n\tsort: arr.sort,\n\tsplice: arr.splice\n};\n\njQuery.extend = jQuery.fn.extend = function() {\n\tvar options, name, src, copy, copyIsArray, clone,\n\t\ttarget = arguments[ 0 ] || {},\n\t\ti = 1,\n\t\tlength = arguments.length,\n\t\tdeep = false;\n\n\t// Handle a deep copy situation\n\tif ( typeof target === \"boolean\" ) {\n\t\tdeep = target;\n\n\t\t// Skip the boolean and the target\n\t\ttarget = arguments[ i ] || {};\n\t\ti++;\n\t}\n\n\t// Handle case when target is a string or something (possible in deep copy)\n\tif ( typeof target !== \"object\" && !isFunction( target ) ) {\n\t\ttarget = {};\n\t}\n\n\t// Extend jQuery itself if only one argument is passed\n\tif ( i === length ) {\n\t\ttarget = this;\n\t\ti--;\n\t}\n\n\tfor ( ; i < length; i++ ) {\n\n\t\t// Only deal with non-null/undefined values\n\t\tif ( ( options = arguments[ i ] ) != null ) {\n\n\t\t\t// Extend the base object\n\t\t\tfor ( name in options ) {\n\t\t\t\tcopy = options[ name ];\n\n\t\t\t\t// Prevent Object.prototype pollution\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif ( name === \"__proto__\" || target === copy ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\tif ( deep && copy && ( jQuery.isPlainObject( copy ) ||\n\t\t\t\t\t( copyIsArray = Array.isArray( copy ) ) ) ) {\n\t\t\t\t\tsrc = target[ name ];\n\n\t\t\t\t\t// Ensure proper type for the source value\n\t\t\t\t\tif ( copyIsArray && !Array.isArray( src ) ) {\n\t\t\t\t\t\tclone = [];\n\t\t\t\t\t} else if ( !copyIsArray && !jQuery.isPlainObject( src ) ) {\n\t\t\t\t\t\tclone = {};\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclone = src;\n\t\t\t\t\t}\n\t\t\t\t\tcopyIsArray = false;\n\n\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\ttarget[ name ] = jQuery.extend( deep, clone, copy );\n\n\t\t\t\t// Don't bring in undefined values\n\t\t\t\t} else if ( copy !== undefined ) {\n\t\t\t\t\ttarget[ name ] = copy;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n\njQuery.extend( {\n\n\t// Unique for each copy of jQuery on the page\n\texpando: \"jQuery\" + ( version + Math.random() ).replace( /\\D/g, \"\" ),\n\n\t// Assume jQuery is ready without the ready module\n\tisReady: true,\n\n\terror: function( msg ) {\n\t\tthrow new Error( msg );\n\t},\n\n\tnoop: function() {},\n\n\tisPlainObject: function( obj ) {\n\t\tvar proto, Ctor;\n\n\t\t// Detect obvious negatives\n\t\t// Use toString instead of jQuery.type to catch host objects\n\t\tif ( !obj || toString.call( obj ) !== \"[object Object]\" ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tproto = getProto( obj );\n\n\t\t// Objects with no prototype (e.g., `Object.create( null )`) are plain\n\t\tif ( !proto ) {\n\t\t\treturn true;\n\t\t}\n\n\t\t// Objects with prototype are plain iff they were constructed by a global Object function\n\t\tCtor = hasOwn.call( proto, \"constructor\" ) && proto.constructor;\n\t\treturn typeof Ctor === \"function\" && fnToString.call( Ctor ) === ObjectFunctionString;\n\t},\n\n\tisEmptyObject: function( obj ) {\n\t\tvar name;\n\n\t\tfor ( name in obj ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t},\n\n\t// Evaluates a script in a global context\n\tglobalEval: function( code, options ) {\n\t\tDOMEval( code, { nonce: options && options.nonce } );\n\t},\n\n\teach: function( obj, callback ) {\n\t\tvar length, i = 0;\n\n\t\tif ( isArrayLike( obj ) ) {\n\t\t\tlength = obj.length;\n\t\t\tfor ( ; i < length; i++ ) {\n\t\t\t\tif ( callback.call( obj[ i ], i, obj[ i ] ) === false ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfor ( i in obj ) {\n\t\t\t\tif ( callback.call( obj[ i ], i, obj[ i ] ) === false ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn obj;\n\t},\n\n\t// Support: Android <=4.0 only\n\ttrim: function( text ) {\n\t\treturn text == null ?\n\t\t\t\"\" :\n\t\t\t( text + \"\" ).replace( rtrim, \"\" );\n\t},\n\n\t// results is for internal usage only\n\tmakeArray: function( arr, results ) {\n\t\tvar ret = results || [];\n\n\t\tif ( arr != null ) {\n\t\t\tif ( isArrayLike( Object( arr ) ) ) {\n\t\t\t\tjQuery.merge( ret,\n\t\t\t\t\ttypeof arr === \"string\" ?\n\t\t\t\t\t[ arr ] : arr\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tpush.call( ret, arr );\n\t\t\t}\n\t\t}\n\n\t\treturn ret;\n\t},\n\n\tinArray: function( elem, arr, i ) {\n\t\treturn arr == null ? -1 : indexOf.call( arr, elem, i );\n\t},\n\n\t// Support: Android <=4.0 only, PhantomJS 1 only\n\t// push.apply(_, arraylike) throws on ancient WebKit\n\tmerge: function( first, second ) {\n\t\tvar len = +second.length,\n\t\t\tj = 0,\n\t\t\ti = first.length;\n\n\t\tfor ( ; j < len; j++ ) {\n\t\t\tfirst[ i++ ] = second[ j ];\n\t\t}\n\n\t\tfirst.length = i;\n\n\t\treturn first;\n\t},\n\n\tgrep: function( elems, callback, invert ) {\n\t\tvar callbackInverse,\n\t\t\tmatches = [],\n\t\t\ti = 0,\n\t\t\tlength = elems.length,\n\t\t\tcallbackExpect = !invert;\n\n\t\t// Go through the array, only saving the items\n\t\t// that pass the validator function\n\t\tfor ( ; i < length; i++ ) {\n\t\t\tcallbackInverse = !callback( elems[ i ], i );\n\t\t\tif ( callbackInverse !== callbackExpect ) {\n\t\t\t\tmatches.push( elems[ i ] );\n\t\t\t}\n\t\t}\n\n\t\treturn matches;\n\t},\n\n\t// arg is for internal usage only\n\tmap: function( elems, callback, arg ) {\n\t\tvar length, value,\n\t\t\ti = 0,\n\t\t\tret = [];\n\n\t\t// Go through the array, translating each of the items to their new values\n\t\tif ( isArrayLike( elems ) ) {\n\t\t\tlength = elems.length;\n\t\t\tfor ( ; i < length; i++ ) {\n\t\t\t\tvalue = callback( elems[ i ], i, arg );\n\n\t\t\t\tif ( value != null ) {\n\t\t\t\t\tret.push( value );\n\t\t\t\t}\n\t\t\t}\n\n\t\t// Go through every key on the object,\n\t\t} else {\n\t\t\tfor ( i in elems ) {\n\t\t\t\tvalue = callback( elems[ i ], i, arg );\n\n\t\t\t\tif ( value != null ) {\n\t\t\t\t\tret.push( value );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Flatten any nested arrays\n\t\treturn concat.apply( [], ret );\n\t},\n\n\t// A global GUID counter for objects\n\tguid: 1,\n\n\t// jQuery.support is not used in Core but other projects attach their\n\t// properties to it so it needs to exist.\n\tsupport: support\n} );\n\nif ( typeof Symbol === \"function\" ) {\n\tjQuery.fn[ Symbol.iterator ] = arr[ Symbol.iterator ];\n}\n\n// Populate the class2type map\njQuery.each( \"Boolean Number String Function Array Date RegExp Object Error Symbol\".split( \" \" ),\nfunction( i, name ) {\n\tclass2type[ \"[object \" + name + \"]\" ] = name.toLowerCase();\n} );\n\nfunction isArrayLike( obj ) {\n\n\t// Support: real iOS 8.2 only (not reproducible in simulator)\n\t// `in` check used to prevent JIT error (gh-2145)\n\t// hasOwn isn't used here due to false negatives\n\t// regarding Nodelist length in IE\n\tvar length = !!obj && \"length\" in obj && obj.length,\n\t\ttype = toType( obj );\n\n\tif ( isFunction( obj ) || isWindow( obj ) ) {\n\t\treturn false;\n\t}\n\n\treturn type === \"array\" || length === 0 ||\n\t\ttypeof length === \"number\" && length > 0 && ( length - 1 ) in obj;\n}\nvar Sizzle =\n/*!\n * Sizzle CSS Selector Engine v2.3.4\n * https://sizzlejs.com/\n *\n * Copyright JS Foundation and other contributors\n * Released under the MIT license\n * https://js.foundation/\n *\n * Date: 2019-04-08\n */\n(function( window ) {\n\nvar i,\n\tsupport,\n\tExpr,\n\tgetText,\n\tisXML,\n\ttokenize,\n\tcompile,\n\tselect,\n\toutermostContext,\n\tsortInput,\n\thasDuplicate,\n\n\t// Local document vars\n\tsetDocument,\n\tdocument,\n\tdocElem,\n\tdocumentIsHTML,\n\trbuggyQSA,\n\trbuggyMatches,\n\tmatches,\n\tcontains,\n\n\t// Instance-specific data\n\texpando = \"sizzle\" + 1 * new Date(),\n\tpreferredDoc = window.document,\n\tdirruns = 0,\n\tdone = 0,\n\tclassCache = createCache(),\n\ttokenCache = createCache(),\n\tcompilerCache = createCache(),\n\tnonnativeSelectorCache = createCache(),\n\tsortOrder = function( a, b ) {\n\t\tif ( a === b ) {\n\t\t\thasDuplicate = true;\n\t\t}\n\t\treturn 0;\n\t},\n\n\t// Instance methods\n\thasOwn = ({}).hasOwnProperty,\n\tarr = [],\n\tpop = arr.pop,\n\tpush_native = arr.push,\n\tpush = arr.push,\n\tslice = arr.slice,\n\t// Use a stripped-down indexOf as it's faster than native\n\t// https://jsperf.com/thor-indexof-vs-for/5\n\tindexOf = function( list, elem ) {\n\t\tvar i = 0,\n\t\t\tlen = list.length;\n\t\tfor ( ; i < len; i++ ) {\n\t\t\tif ( list[i] === elem ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t},\n\n\tbooleans = \"checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped\",\n\n\t// Regular expressions\n\n\t// http://www.w3.org/TR/css3-selectors/#whitespace\n\twhitespace = \"[\\\\x20\\\\t\\\\r\\\\n\\\\f]\",\n\n\t// http://www.w3.org/TR/CSS21/syndata.html#value-def-identifier\n\tidentifier = \"(?:\\\\\\\\.|[\\\\w-]|[^\\0-\\\\xa0])+\",\n\n\t// Attribute selectors: http://www.w3.org/TR/selectors/#attribute-selectors\n\tattributes = \"\\\\[\" + whitespace + \"*(\" + identifier + \")(?:\" + whitespace +\n\t\t// Operator (capture 2)\n\t\t\"*([*^$|!~]?=)\" + whitespace +\n\t\t// \"Attribute values must be CSS identifiers [capture 5] or strings [capture 3 or capture 4]\"\n\t\t\"*(?:'((?:\\\\\\\\.|[^\\\\\\\\'])*)'|\\\"((?:\\\\\\\\.|[^\\\\\\\\\\\"])*)\\\"|(\" + identifier + \"))|)\" + whitespace +\n\t\t\"*\\\\]\",\n\n\tpseudos = \":(\" + identifier + \")(?:\\\\((\" +\n\t\t// To reduce the number of selectors needing tokenize in the preFilter, prefer arguments:\n\t\t// 1. quoted (capture 3; capture 4 or capture 5)\n\t\t\"('((?:\\\\\\\\.|[^\\\\\\\\'])*)'|\\\"((?:\\\\\\\\.|[^\\\\\\\\\\\"])*)\\\")|\" +\n\t\t// 2. simple (capture 6)\n\t\t\"((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|\" + attributes + \")*)|\" +\n\t\t// 3. anything else (capture 2)\n\t\t\".*\" +\n\t\t\")\\\\)|)\",\n\n\t// Leading and non-escaped trailing whitespace, capturing some non-whitespace characters preceding the latter\n\trwhitespace = new RegExp( whitespace + \"+\", \"g\" ),\n\trtrim = new RegExp( \"^\" + whitespace + \"+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)\" + whitespace + \"+$\", \"g\" ),\n\n\trcomma = new RegExp( \"^\" + whitespace + \"*,\" + whitespace + \"*\" ),\n\trcombinators = new RegExp( \"^\" + whitespace + \"*([>+~]|\" + whitespace + \")\" + whitespace + \"*\" ),\n\trdescend = new RegExp( whitespace + \"|>\" ),\n\n\trpseudo = new RegExp( pseudos ),\n\tridentifier = new RegExp( \"^\" + identifier + \"$\" ),\n\n\tmatchExpr = {\n\t\t\"ID\": new RegExp( \"^#(\" + identifier + \")\" ),\n\t\t\"CLASS\": new RegExp( \"^\\\\.(\" + identifier + \")\" ),\n\t\t\"TAG\": new RegExp( \"^(\" + identifier + \"|[*])\" ),\n\t\t\"ATTR\": new RegExp( \"^\" + attributes ),\n\t\t\"PSEUDO\": new RegExp( \"^\" + pseudos ),\n\t\t\"CHILD\": new RegExp( \"^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(\" + whitespace +\n\t\t\t\"*(even|odd|(([+-]|)(\\\\d*)n|)\" + whitespace + \"*(?:([+-]|)\" + whitespace +\n\t\t\t\"*(\\\\d+)|))\" + whitespace + \"*\\\\)|)\", \"i\" ),\n\t\t\"bool\": new RegExp( \"^(?:\" + booleans + \")$\", \"i\" ),\n\t\t// For use in libraries implementing .is()\n\t\t// We use this for POS matching in `select`\n\t\t\"needsContext\": new RegExp( \"^\" + whitespace + \"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(\" +\n\t\t\twhitespace + \"*((?:-\\\\d)?\\\\d*)\" + whitespace + \"*\\\\)|)(?=[^-]|$)\", \"i\" )\n\t},\n\n\trhtml = /HTML$/i,\n\trinputs = /^(?:input|select|textarea|button)$/i,\n\trheader = /^h\\d$/i,\n\n\trnative = /^[^{]+\\{\\s*\\[native \\w/,\n\n\t// Easily-parseable/retrievable ID or TAG or CLASS selectors\n\trquickExpr = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,\n\n\trsibling = /[+~]/,\n\n\t// CSS escapes\n\t// http://www.w3.org/TR/CSS21/syndata.html#escaped-characters\n\trunescape = new RegExp( \"\\\\\\\\([\\\\da-f]{1,6}\" + whitespace + \"?|(\" + whitespace + \")|.)\", \"ig\" ),\n\tfunescape = function( _, escaped, escapedWhitespace ) {\n\t\tvar high = \"0x\" + escaped - 0x10000;\n\t\t// NaN means non-codepoint\n\t\t// Support: Firefox<24\n\t\t// Workaround erroneous numeric interpretation of +\"0x\"\n\t\treturn high !== high || escapedWhitespace ?\n\t\t\tescaped :\n\t\t\thigh < 0 ?\n\t\t\t\t// BMP codepoint\n\t\t\t\tString.fromCharCode( high + 0x10000 ) :\n\t\t\t\t// Supplemental Plane codepoint (surrogate pair)\n\t\t\t\tString.fromCharCode( high >> 10 | 0xD800, high & 0x3FF | 0xDC00 );\n\t},\n\n\t// CSS string/identifier serialization\n\t// https://drafts.csswg.org/cssom/#common-serializing-idioms\n\trcssescape = /([\\0-\\x1f\\x7f]|^-?\\d)|^-$|[^\\0-\\x1f\\x7f-\\uFFFF\\w-]/g,\n\tfcssescape = function( ch, asCodePoint ) {\n\t\tif ( asCodePoint ) {\n\n\t\t\t// U+0000 NULL becomes U+FFFD REPLACEMENT CHARACTER\n\t\t\tif ( ch === \"\\0\" ) {\n\t\t\t\treturn \"\\uFFFD\";\n\t\t\t}\n\n\t\t\t// Control characters and (dependent upon position) numbers get escaped as code points\n\t\t\treturn ch.slice( 0, -1 ) + \"\\\\\" + ch.charCodeAt( ch.length - 1 ).toString( 16 ) + \" \";\n\t\t}\n\n\t\t// Other potentially-special ASCII characters get backslash-escaped\n\t\treturn \"\\\\\" + ch;\n\t},\n\n\t// Used for iframes\n\t// See setDocument()\n\t// Removing the function wrapper causes a \"Permission Denied\"\n\t// error in IE\n\tunloadHandler = function() {\n\t\tsetDocument();\n\t},\n\n\tinDisabledFieldset = addCombinator(\n\t\tfunction( elem ) {\n\t\t\treturn elem.disabled === true && elem.nodeName.toLowerCase() === \"fieldset\";\n\t\t},\n\t\t{ dir: \"parentNode\", next: \"legend\" }\n\t);\n\n// Optimize for push.apply( _, NodeList )\ntry {\n\tpush.apply(\n\t\t(arr = slice.call( preferredDoc.childNodes )),\n\t\tpreferredDoc.childNodes\n\t);\n\t// Support: Android<4.0\n\t// Detect silently failing push.apply\n\tarr[ preferredDoc.childNodes.length ].nodeType;\n} catch ( e ) {\n\tpush = { apply: arr.length ?\n\n\t\t// Leverage slice if possible\n\t\tfunction( target, els ) {\n\t\t\tpush_native.apply( target, slice.call(els) );\n\t\t} :\n\n\t\t// Support: IE<9\n\t\t// Otherwise append directly\n\t\tfunction( target, els ) {\n\t\t\tvar j = target.length,\n\t\t\t\ti = 0;\n\t\t\t// Can't trust NodeList.length\n\t\t\twhile ( (target[j++] = els[i++]) ) {}\n\t\t\ttarget.length = j - 1;\n\t\t}\n\t};\n}\n\nfunction Sizzle( selector, context, results, seed ) {\n\tvar m, i, elem, nid, match, groups, newSelector,\n\t\tnewContext = context && context.ownerDocument,\n\n\t\t// nodeType defaults to 9, since context defaults to document\n\t\tnodeType = context ? context.nodeType : 9;\n\n\tresults = results || [];\n\n\t// Return early from calls with invalid selector or context\n\tif ( typeof selector !== \"string\" || !selector ||\n\t\tnodeType !== 1 && nodeType !== 9 && nodeType !== 11 ) {\n\n\t\treturn results;\n\t}\n\n\t// Try to shortcut find operations (as opposed to filters) in HTML documents\n\tif ( !seed ) {\n\n\t\tif ( ( context ? context.ownerDocument || context : preferredDoc ) !== document ) {\n\t\t\tsetDocument( context );\n\t\t}\n\t\tcontext = context || document;\n\n\t\tif ( documentIsHTML ) {\n\n\t\t\t// If the selector is sufficiently simple, try using a \"get*By*\" DOM method\n\t\t\t// (excepting DocumentFragment context, where the methods don't exist)\n\t\t\tif ( nodeType !== 11 && (match = rquickExpr.exec( selector )) ) {\n\n\t\t\t\t// ID selector\n\t\t\t\tif ( (m = match[1]) ) {\n\n\t\t\t\t\t// Document context\n\t\t\t\t\tif ( nodeType === 9 ) {\n\t\t\t\t\t\tif ( (elem = context.getElementById( m )) ) {\n\n\t\t\t\t\t\t\t// Support: IE, Opera, Webkit\n\t\t\t\t\t\t\t// TODO: identify versions\n\t\t\t\t\t\t\t// getElementById can match elements by name instead of ID\n\t\t\t\t\t\t\tif ( elem.id === m ) {\n\t\t\t\t\t\t\t\tresults.push( elem );\n\t\t\t\t\t\t\t\treturn results;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn results;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t// Element context\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\t// Support: IE, Opera, Webkit\n\t\t\t\t\t\t// TODO: identify versions\n\t\t\t\t\t\t// getElementById can match elements by name instead of ID\n\t\t\t\t\t\tif ( newContext && (elem = newContext.getElementById( m )) &&\n\t\t\t\t\t\t\tcontains( context, elem ) &&\n\t\t\t\t\t\t\telem.id === m ) {\n\n\t\t\t\t\t\t\tresults.push( elem );\n\t\t\t\t\t\t\treturn results;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t// Type selector\n\t\t\t\t} else if ( match[2] ) {\n\t\t\t\t\tpush.apply( results, context.getElementsByTagName( selector ) );\n\t\t\t\t\treturn results;\n\n\t\t\t\t// Class selector\n\t\t\t\t} else if ( (m = match[3]) && support.getElementsByClassName &&\n\t\t\t\t\tcontext.getElementsByClassName ) {\n\n\t\t\t\t\tpush.apply( results, context.getElementsByClassName( m ) );\n\t\t\t\t\treturn results;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Take advantage of querySelectorAll\n\t\t\tif ( support.qsa &&\n\t\t\t\t!nonnativeSelectorCache[ selector + \" \" ] &&\n\t\t\t\t(!rbuggyQSA || !rbuggyQSA.test( selector )) &&\n\n\t\t\t\t// Support: IE 8 only\n\t\t\t\t// Exclude object elements\n\t\t\t\t(nodeType !== 1 || context.nodeName.toLowerCase() !== \"object\") ) {\n\n\t\t\t\tnewSelector = selector;\n\t\t\t\tnewContext = context;\n\n\t\t\t\t// qSA considers elements outside a scoping root when evaluating child or\n\t\t\t\t// descendant combinators, which is not what we want.\n\t\t\t\t// In such cases, we work around the behavior by prefixing every selector in the\n\t\t\t\t// list with an ID selector referencing the scope context.\n\t\t\t\t// Thanks to Andrew Dupont for this technique.\n\t\t\t\tif ( nodeType === 1 && rdescend.test( selector ) ) {\n\n\t\t\t\t\t// Capture the context ID, setting it first if necessary\n\t\t\t\t\tif ( (nid = context.getAttribute( \"id\" )) ) {\n\t\t\t\t\t\tnid = nid.replace( rcssescape, fcssescape );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontext.setAttribute( \"id\", (nid = expando) );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Prefix every selector in the list\n\t\t\t\t\tgroups = tokenize( selector );\n\t\t\t\t\ti = groups.length;\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tgroups[i] = \"#\" + nid + \" \" + toSelector( groups[i] );\n\t\t\t\t\t}\n\t\t\t\t\tnewSelector = groups.join( \",\" );\n\n\t\t\t\t\t// Expand context for sibling selectors\n\t\t\t\t\tnewContext = rsibling.test( selector ) && testContext( context.parentNode ) ||\n\t\t\t\t\t\tcontext;\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tpush.apply( results,\n\t\t\t\t\t\tnewContext.querySelectorAll( newSelector )\n\t\t\t\t\t);\n\t\t\t\t\treturn results;\n\t\t\t\t} catch ( qsaError ) {\n\t\t\t\t\tnonnativeSelectorCache( selector, true );\n\t\t\t\t} finally {\n\t\t\t\t\tif ( nid === expando ) {\n\t\t\t\t\t\tcontext.removeAttribute( \"id\" );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// All others\n\treturn select( selector.replace( rtrim, \"$1\" ), context, results, seed );\n}\n\n/**\n * Create key-value caches of limited size\n * @returns {function(string, object)} Returns the Object data after storing it on itself with\n *\tproperty name the (space-suffixed) string and (if the cache is larger than Expr.cacheLength)\n *\tdeleting the oldest entry\n */\nfunction createCache() {\n\tvar keys = [];\n\n\tfunction cache( key, value ) {\n\t\t// Use (key + \" \") to avoid collision with native prototype properties (see Issue #157)\n\t\tif ( keys.push( key + \" \" ) > Expr.cacheLength ) {\n\t\t\t// Only keep the most recent entries\n\t\t\tdelete cache[ keys.shift() ];\n\t\t}\n\t\treturn (cache[ key + \" \" ] = value);\n\t}\n\treturn cache;\n}\n\n/**\n * Mark a function for special use by Sizzle\n * @param {Function} fn The function to mark\n */\nfunction markFunction( fn ) {\n\tfn[ expando ] = true;\n\treturn fn;\n}\n\n/**\n * Support testing using an element\n * @param {Function} fn Passed the created element and returns a boolean result\n */\nfunction assert( fn ) {\n\tvar el = document.createElement(\"fieldset\");\n\n\ttry {\n\t\treturn !!fn( el );\n\t} catch (e) {\n\t\treturn false;\n\t} finally {\n\t\t// Remove from its parent by default\n\t\tif ( el.parentNode ) {\n\t\t\tel.parentNode.removeChild( el );\n\t\t}\n\t\t// release memory in IE\n\t\tel = null;\n\t}\n}\n\n/**\n * Adds the same handler for all of the specified attrs\n * @param {String} attrs Pipe-separated list of attributes\n * @param {Function} handler The method that will be applied\n */\nfunction addHandle( attrs, handler ) {\n\tvar arr = attrs.split(\"|\"),\n\t\ti = arr.length;\n\n\twhile ( i-- ) {\n\t\tExpr.attrHandle[ arr[i] ] = handler;\n\t}\n}\n\n/**\n * Checks document order of two siblings\n * @param {Element} a\n * @param {Element} b\n * @returns {Number} Returns less than 0 if a precedes b, greater than 0 if a follows b\n */\nfunction siblingCheck( a, b ) {\n\tvar cur = b && a,\n\t\tdiff = cur && a.nodeType === 1 && b.nodeType === 1 &&\n\t\t\ta.sourceIndex - b.sourceIndex;\n\n\t// Use IE sourceIndex if available on both nodes\n\tif ( diff ) {\n\t\treturn diff;\n\t}\n\n\t// Check if b follows a\n\tif ( cur ) {\n\t\twhile ( (cur = cur.nextSibling) ) {\n\t\t\tif ( cur === b ) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn a ? 1 : -1;\n}\n\n/**\n * Returns a function to use in pseudos for input types\n * @param {String} type\n */\nfunction createInputPseudo( type ) {\n\treturn function( elem ) {\n\t\tvar name = elem.nodeName.toLowerCase();\n\t\treturn name === \"input\" && elem.type === type;\n\t};\n}\n\n/**\n * Returns a function to use in pseudos for buttons\n * @param {String} type\n */\nfunction createButtonPseudo( type ) {\n\treturn function( elem ) {\n\t\tvar name = elem.nodeName.toLowerCase();\n\t\treturn (name === \"input\" || name === \"button\") && elem.type === type;\n\t};\n}\n\n/**\n * Returns a function to use in pseudos for :enabled/:disabled\n * @param {Boolean} disabled true for :disabled; false for :enabled\n */\nfunction createDisabledPseudo( disabled ) {\n\n\t// Known :disabled false positives: fieldset[disabled] > legend:nth-of-type(n+2) :can-disable\n\treturn function( elem ) {\n\n\t\t// Only certain elements can match :enabled or :disabled\n\t\t// https://html.spec.whatwg.org/multipage/scripting.html#selector-enabled\n\t\t// https://html.spec.whatwg.org/multipage/scripting.html#selector-disabled\n\t\tif ( \"form\" in elem ) {\n\n\t\t\t// Check for inherited disabledness on relevant non-disabled elements:\n\t\t\t// * listed form-associated elements in a disabled fieldset\n\t\t\t//   https://html.spec.whatwg.org/multipage/forms.html#category-listed\n\t\t\t//   https://html.spec.whatwg.org/multipage/forms.html#concept-fe-disabled\n\t\t\t// * option elements in a disabled optgroup\n\t\t\t//   https://html.spec.whatwg.org/multipage/forms.html#concept-option-disabled\n\t\t\t// All such elements have a \"form\" property.\n\t\t\tif ( elem.parentNode && elem.disabled === false ) {\n\n\t\t\t\t// Option elements defer to a parent optgroup if present\n\t\t\t\tif ( \"label\" in elem ) {\n\t\t\t\t\tif ( \"label\" in elem.parentNode ) {\n\t\t\t\t\t\treturn elem.parentNode.disabled === disabled;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn elem.disabled === disabled;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Support: IE 6 - 11\n\t\t\t\t// Use the isDisabled shortcut property to check for disabled fieldset ancestors\n\t\t\t\treturn elem.isDisabled === disabled ||\n\n\t\t\t\t\t// Where there is no isDisabled, check manually\n\t\t\t\t\t/* jshint -W018 */\n\t\t\t\t\telem.isDisabled !== !disabled &&\n\t\t\t\t\t\tinDisabledFieldset( elem ) === disabled;\n\t\t\t}\n\n\t\t\treturn elem.disabled === disabled;\n\n\t\t// Try to winnow out elements that can't be disabled before trusting the disabled property.\n\t\t// Some victims get caught in our net (label, legend, menu, track), but it shouldn't\n\t\t// even exist on them, let alone have a boolean value.\n\t\t} else if ( \"label\" in elem ) {\n\t\t\treturn elem.disabled === disabled;\n\t\t}\n\n\t\t// Remaining elements are neither :enabled nor :disabled\n\t\treturn false;\n\t};\n}\n\n/**\n * Returns a function to use in pseudos for positionals\n * @param {Function} fn\n */\nfunction createPositionalPseudo( fn ) {\n\treturn markFunction(function( argument ) {\n\t\targument = +argument;\n\t\treturn markFunction(function( seed, matches ) {\n\t\t\tvar j,\n\t\t\t\tmatchIndexes = fn( [], seed.length, argument ),\n\t\t\t\ti = matchIndexes.length;\n\n\t\t\t// Match elements found at the specified indexes\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( seed[ (j = matchIndexes[i]) ] ) {\n\t\t\t\t\tseed[j] = !(matches[j] = seed[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n}\n\n/**\n * Checks a node for validity as a Sizzle context\n * @param {Element|Object=} context\n * @returns {Element|Object|Boolean} The input node if acceptable, otherwise a falsy value\n */\nfunction testContext( context ) {\n\treturn context && typeof context.getElementsByTagName !== \"undefined\" && context;\n}\n\n// Expose support vars for convenience\nsupport = Sizzle.support = {};\n\n/**\n * Detects XML nodes\n * @param {Element|Object} elem An element or a document\n * @returns {Boolean} True iff elem is a non-HTML XML node\n */\nisXML = Sizzle.isXML = function( elem ) {\n\tvar namespace = elem.namespaceURI,\n\t\tdocElem = (elem.ownerDocument || elem).documentElement;\n\n\t// Support: IE <=8\n\t// Assume HTML when documentElement doesn't yet exist, such as inside loading iframes\n\t// https://bugs.jquery.com/ticket/4833\n\treturn !rhtml.test( namespace || docElem && docElem.nodeName || \"HTML\" );\n};\n\n/**\n * Sets document-related variables once based on the current document\n * @param {Element|Object} [doc] An element or document object to use to set the document\n * @returns {Object} Returns the current document\n */\nsetDocument = Sizzle.setDocument = function( node ) {\n\tvar hasCompare, subWindow,\n\t\tdoc = node ? node.ownerDocument || node : preferredDoc;\n\n\t// Return early if doc is invalid or already selected\n\tif ( doc === document || doc.nodeType !== 9 || !doc.documentElement ) {\n\t\treturn document;\n\t}\n\n\t// Update global variables\n\tdocument = doc;\n\tdocElem = document.documentElement;\n\tdocumentIsHTML = !isXML( document );\n\n\t// Support: IE 9-11, Edge\n\t// Accessing iframe documents after unload throws \"permission denied\" errors (jQuery #13936)\n\tif ( preferredDoc !== document &&\n\t\t(subWindow = document.defaultView) && subWindow.top !== subWindow ) {\n\n\t\t// Support: IE 11, Edge\n\t\tif ( subWindow.addEventListener ) {\n\t\t\tsubWindow.addEventListener( \"unload\", unloadHandler, false );\n\n\t\t// Support: IE 9 - 10 only\n\t\t} else if ( subWindow.attachEvent ) {\n\t\t\tsubWindow.attachEvent( \"onunload\", unloadHandler );\n\t\t}\n\t}\n\n\t/* Attributes\n\t---------------------------------------------------------------------- */\n\n\t// Support: IE<8\n\t// Verify that getAttribute really returns attributes and not properties\n\t// (excepting IE8 booleans)\n\tsupport.attributes = assert(function( el ) {\n\t\tel.className = \"i\";\n\t\treturn !el.getAttribute(\"className\");\n\t});\n\n\t/* getElement(s)By*\n\t---------------------------------------------------------------------- */\n\n\t// Check if getElementsByTagName(\"*\") returns only elements\n\tsupport.getElementsByTagName = assert(function( el ) {\n\t\tel.appendChild( document.createComment(\"\") );\n\t\treturn !el.getElementsByTagName(\"*\").length;\n\t});\n\n\t// Support: IE<9\n\tsupport.getElementsByClassName = rnative.test( document.getElementsByClassName );\n\n\t// Support: IE<10\n\t// Check if getElementById returns elements by name\n\t// The broken getElementById methods don't pick up programmatically-set names,\n\t// so use a roundabout getElementsByName test\n\tsupport.getById = assert(function( el ) {\n\t\tdocElem.appendChild( el ).id = expando;\n\t\treturn !document.getElementsByName || !document.getElementsByName( expando ).length;\n\t});\n\n\t// ID filter and find\n\tif ( support.getById ) {\n\t\tExpr.filter[\"ID\"] = function( id ) {\n\t\t\tvar attrId = id.replace( runescape, funescape );\n\t\t\treturn function( elem ) {\n\t\t\t\treturn elem.getAttribute(\"id\") === attrId;\n\t\t\t};\n\t\t};\n\t\tExpr.find[\"ID\"] = function( id, context ) {\n\t\t\tif ( typeof context.getElementById !== \"undefined\" && documentIsHTML ) {\n\t\t\t\tvar elem = context.getElementById( id );\n\t\t\t\treturn elem ? [ elem ] : [];\n\t\t\t}\n\t\t};\n\t} else {\n\t\tExpr.filter[\"ID\"] =  function( id ) {\n\t\t\tvar attrId = id.replace( runescape, funescape );\n\t\t\treturn function( elem ) {\n\t\t\t\tvar node = typeof elem.getAttributeNode !== \"undefined\" &&\n\t\t\t\t\telem.getAttributeNode(\"id\");\n\t\t\t\treturn node && node.value === attrId;\n\t\t\t};\n\t\t};\n\n\t\t// Support: IE 6 - 7 only\n\t\t// getElementById is not reliable as a find shortcut\n\t\tExpr.find[\"ID\"] = function( id, context ) {\n\t\t\tif ( typeof context.getElementById !== \"undefined\" && documentIsHTML ) {\n\t\t\t\tvar node, i, elems,\n\t\t\t\t\telem = context.getElementById( id );\n\n\t\t\t\tif ( elem ) {\n\n\t\t\t\t\t// Verify the id attribute\n\t\t\t\t\tnode = elem.getAttributeNode(\"id\");\n\t\t\t\t\tif ( node && node.value === id ) {\n\t\t\t\t\t\treturn [ elem ];\n\t\t\t\t\t}\n\n\t\t\t\t\t// Fall back on getElementsByName\n\t\t\t\t\telems = context.getElementsByName( id );\n\t\t\t\t\ti = 0;\n\t\t\t\t\twhile ( (elem = elems[i++]) ) {\n\t\t\t\t\t\tnode = elem.getAttributeNode(\"id\");\n\t\t\t\t\t\tif ( node && node.value === id ) {\n\t\t\t\t\t\t\treturn [ elem ];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn [];\n\t\t\t}\n\t\t};\n\t}\n\n\t// Tag\n\tExpr.find[\"TAG\"] = support.getElementsByTagName ?\n\t\tfunction( tag, context ) {\n\t\t\tif ( typeof context.getElementsByTagName !== \"undefined\" ) {\n\t\t\t\treturn context.getElementsByTagName( tag );\n\n\t\t\t// DocumentFragment nodes don't have gEBTN\n\t\t\t} else if ( support.qsa ) {\n\t\t\t\treturn context.querySelectorAll( tag );\n\t\t\t}\n\t\t} :\n\n\t\tfunction( tag, context ) {\n\t\t\tvar elem,\n\t\t\t\ttmp = [],\n\t\t\t\ti = 0,\n\t\t\t\t// By happy coincidence, a (broken) gEBTN appears on DocumentFragment nodes too\n\t\t\t\tresults = context.getElementsByTagName( tag );\n\n\t\t\t// Filter out possible comments\n\t\t\tif ( tag === \"*\" ) {\n\t\t\t\twhile ( (elem = results[i++]) ) {\n\t\t\t\t\tif ( elem.nodeType === 1 ) {\n\t\t\t\t\t\ttmp.push( elem );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn tmp;\n\t\t\t}\n\t\t\treturn results;\n\t\t};\n\n\t// Class\n\tExpr.find[\"CLASS\"] = support.getElementsByClassName && function( className, context ) {\n\t\tif ( typeof context.getElementsByClassName !== \"undefined\" && documentIsHTML ) {\n\t\t\treturn context.getElementsByClassName( className );\n\t\t}\n\t};\n\n\t/* QSA/matchesSelector\n\t---------------------------------------------------------------------- */\n\n\t// QSA and matchesSelector support\n\n\t// matchesSelector(:active) reports false when true (IE9/Opera 11.5)\n\trbuggyMatches = [];\n\n\t// qSa(:focus) reports false when true (Chrome 21)\n\t// We allow this because of a bug in IE8/9 that throws an error\n\t// whenever `document.activeElement` is accessed on an iframe\n\t// So, we allow :focus to pass through QSA all the time to avoid the IE error\n\t// See https://bugs.jquery.com/ticket/13378\n\trbuggyQSA = [];\n\n\tif ( (support.qsa = rnative.test( document.querySelectorAll )) ) {\n\t\t// Build QSA regex\n\t\t// Regex strategy adopted from Diego Perini\n\t\tassert(function( el ) {\n\t\t\t// Select is set to empty string on purpose\n\t\t\t// This is to test IE's treatment of not explicitly\n\t\t\t// setting a boolean content attribute,\n\t\t\t// since its presence should be enough\n\t\t\t// https://bugs.jquery.com/ticket/12359\n\t\t\tdocElem.appendChild( el ).innerHTML = \"<a id='\" + expando + \"'></a>\" +\n\t\t\t\t\"<select id='\" + expando + \"-\\r\\\\' msallowcapture=''>\" +\n\t\t\t\t\"<option selected=''></option></select>\";\n\n\t\t\t// Support: IE8, Opera 11-12.16\n\t\t\t// Nothing should be selected when empty strings follow ^= or $= or *=\n\t\t\t// The test attribute must be unknown in Opera but \"safe\" for WinRT\n\t\t\t// https://msdn.microsoft.com/en-us/library/ie/hh465388.aspx#attribute_section\n\t\t\tif ( el.querySelectorAll(\"[msallowcapture^='']\").length ) {\n\t\t\t\trbuggyQSA.push( \"[*^$]=\" + whitespace + \"*(?:''|\\\"\\\")\" );\n\t\t\t}\n\n\t\t\t// Support: IE8\n\t\t\t// Boolean attributes and \"value\" are not treated correctly\n\t\t\tif ( !el.querySelectorAll(\"[selected]\").length ) {\n\t\t\t\trbuggyQSA.push( \"\\\\[\" + whitespace + \"*(?:value|\" + booleans + \")\" );\n\t\t\t}\n\n\t\t\t// Support: Chrome<29, Android<4.4, Safari<7.0+, iOS<7.0+, PhantomJS<1.9.8+\n\t\t\tif ( !el.querySelectorAll( \"[id~=\" + expando + \"-]\" ).length ) {\n\t\t\t\trbuggyQSA.push(\"~=\");\n\t\t\t}\n\n\t\t\t// Webkit/Opera - :checked should return selected option elements\n\t\t\t// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked\n\t\t\t// IE8 throws error here and will not see later tests\n\t\t\tif ( !el.querySelectorAll(\":checked\").length ) {\n\t\t\t\trbuggyQSA.push(\":checked\");\n\t\t\t}\n\n\t\t\t// Support: Safari 8+, iOS 8+\n\t\t\t// https://bugs.webkit.org/show_bug.cgi?id=136851\n\t\t\t// In-page `selector#id sibling-combinator selector` fails\n\t\t\tif ( !el.querySelectorAll( \"a#\" + expando + \"+*\" ).length ) {\n\t\t\t\trbuggyQSA.push(\".#.+[+~]\");\n\t\t\t}\n\t\t});\n\n\t\tassert(function( el ) {\n\t\t\tel.innerHTML = \"<a href='' disabled='disabled'></a>\" +\n\t\t\t\t\"<select disabled='disabled'><option/></select>\";\n\n\t\t\t// Support: Windows 8 Native Apps\n\t\t\t// The type and name attributes are restricted during .innerHTML assignment\n\t\t\tvar input = document.createElement(\"input\");\n\t\t\tinput.setAttribute( \"type\", \"hidden\" );\n\t\t\tel.appendChild( input ).setAttribute( \"name\", \"D\" );\n\n\t\t\t// Support: IE8\n\t\t\t// Enforce case-sensitivity of name attribute\n\t\t\tif ( el.querySelectorAll(\"[name=d]\").length ) {\n\t\t\t\trbuggyQSA.push( \"name\" + whitespace + \"*[*^$|!~]?=\" );\n\t\t\t}\n\n\t\t\t// FF 3.5 - :enabled/:disabled and hidden elements (hidden elements are still enabled)\n\t\t\t// IE8 throws error here and will not see later tests\n\t\t\tif ( el.querySelectorAll(\":enabled\").length !== 2 ) {\n\t\t\t\trbuggyQSA.push( \":enabled\", \":disabled\" );\n\t\t\t}\n\n\t\t\t// Support: IE9-11+\n\t\t\t// IE's :disabled selector does not pick up the children of disabled fieldsets\n\t\t\tdocElem.appendChild( el ).disabled = true;\n\t\t\tif ( el.querySelectorAll(\":disabled\").length !== 2 ) {\n\t\t\t\trbuggyQSA.push( \":enabled\", \":disabled\" );\n\t\t\t}\n\n\t\t\t// Opera 10-11 does not throw on post-comma invalid pseudos\n\t\t\tel.querySelectorAll(\"*,:x\");\n\t\t\trbuggyQSA.push(\",.*:\");\n\t\t});\n\t}\n\n\tif ( (support.matchesSelector = rnative.test( (matches = docElem.matches ||\n\t\tdocElem.webkitMatchesSelector ||\n\t\tdocElem.mozMatchesSelector ||\n\t\tdocElem.oMatchesSelector ||\n\t\tdocElem.msMatchesSelector) )) ) {\n\n\t\tassert(function( el ) {\n\t\t\t// Check to see if it's possible to do matchesSelector\n\t\t\t// on a disconnected node (IE 9)\n\t\t\tsupport.disconnectedMatch = matches.call( el, \"*\" );\n\n\t\t\t// This should fail with an exception\n\t\t\t// Gecko does not error, returns false instead\n\t\t\tmatches.call( el, \"[s!='']:x\" );\n\t\t\trbuggyMatches.push( \"!=\", pseudos );\n\t\t});\n\t}\n\n\trbuggyQSA = rbuggyQSA.length && new RegExp( rbuggyQSA.join(\"|\") );\n\trbuggyMatches = rbuggyMatches.length && new RegExp( rbuggyMatches.join(\"|\") );\n\n\t/* Contains\n\t---------------------------------------------------------------------- */\n\thasCompare = rnative.test( docElem.compareDocumentPosition );\n\n\t// Element contains another\n\t// Purposefully self-exclusive\n\t// As in, an element does not contain itself\n\tcontains = hasCompare || rnative.test( docElem.contains ) ?\n\t\tfunction( a, b ) {\n\t\t\tvar adown = a.nodeType === 9 ? a.documentElement : a,\n\t\t\t\tbup = b && b.parentNode;\n\t\t\treturn a === bup || !!( bup && bup.nodeType === 1 && (\n\t\t\t\tadown.contains ?\n\t\t\t\t\tadown.contains( bup ) :\n\t\t\t\t\ta.compareDocumentPosition && a.compareDocumentPosition( bup ) & 16\n\t\t\t));\n\t\t} :\n\t\tfunction( a, b ) {\n\t\t\tif ( b ) {\n\t\t\t\twhile ( (b = b.parentNode) ) {\n\t\t\t\t\tif ( b === a ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\n\t/* Sorting\n\t---------------------------------------------------------------------- */\n\n\t// Document order sorting\n\tsortOrder = hasCompare ?\n\tfunction( a, b ) {\n\n\t\t// Flag for duplicate removal\n\t\tif ( a === b ) {\n\t\t\thasDuplicate = true;\n\t\t\treturn 0;\n\t\t}\n\n\t\t// Sort on method existence if only one input has compareDocumentPosition\n\t\tvar compare = !a.compareDocumentPosition - !b.compareDocumentPosition;\n\t\tif ( compare ) {\n\t\t\treturn compare;\n\t\t}\n\n\t\t// Calculate position if both inputs belong to the same document\n\t\tcompare = ( a.ownerDocument || a ) === ( b.ownerDocument || b ) ?\n\t\t\ta.compareDocumentPosition( b ) :\n\n\t\t\t// Otherwise we know they are disconnected\n\t\t\t1;\n\n\t\t// Disconnected nodes\n\t\tif ( compare & 1 ||\n\t\t\t(!support.sortDetached && b.compareDocumentPosition( a ) === compare) ) {\n\n\t\t\t// Choose the first element that is related to our preferred document\n\t\t\tif ( a === document || a.ownerDocument === preferredDoc && contains(preferredDoc, a) ) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif ( b === document || b.ownerDocument === preferredDoc && contains(preferredDoc, b) ) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\t// Maintain original order\n\t\t\treturn sortInput ?\n\t\t\t\t( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :\n\t\t\t\t0;\n\t\t}\n\n\t\treturn compare & 4 ? -1 : 1;\n\t} :\n\tfunction( a, b ) {\n\t\t// Exit early if the nodes are identical\n\t\tif ( a === b ) {\n\t\t\thasDuplicate = true;\n\t\t\treturn 0;\n\t\t}\n\n\t\tvar cur,\n\t\t\ti = 0,\n\t\t\taup = a.parentNode,\n\t\t\tbup = b.parentNode,\n\t\t\tap = [ a ],\n\t\t\tbp = [ b ];\n\n\t\t// Parentless nodes are either documents or disconnected\n\t\tif ( !aup || !bup ) {\n\t\t\treturn a === document ? -1 :\n\t\t\t\tb === document ? 1 :\n\t\t\t\taup ? -1 :\n\t\t\t\tbup ? 1 :\n\t\t\t\tsortInput ?\n\t\t\t\t( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :\n\t\t\t\t0;\n\n\t\t// If the nodes are siblings, we can do a quick check\n\t\t} else if ( aup === bup ) {\n\t\t\treturn siblingCheck( a, b );\n\t\t}\n\n\t\t// Otherwise we need full lists of their ancestors for comparison\n\t\tcur = a;\n\t\twhile ( (cur = cur.parentNode) ) {\n\t\t\tap.unshift( cur );\n\t\t}\n\t\tcur = b;\n\t\twhile ( (cur = cur.parentNode) ) {\n\t\t\tbp.unshift( cur );\n\t\t}\n\n\t\t// Walk down the tree looking for a discrepancy\n\t\twhile ( ap[i] === bp[i] ) {\n\t\t\ti++;\n\t\t}\n\n\t\treturn i ?\n\t\t\t// Do a sibling check if the nodes have a common ancestor\n\t\t\tsiblingCheck( ap[i], bp[i] ) :\n\n\t\t\t// Otherwise nodes in our document sort first\n\t\t\tap[i] === preferredDoc ? -1 :\n\t\t\tbp[i] === preferredDoc ? 1 :\n\t\t\t0;\n\t};\n\n\treturn document;\n};\n\nSizzle.matches = function( expr, elements ) {\n\treturn Sizzle( expr, null, null, elements );\n};\n\nSizzle.matchesSelector = function( elem, expr ) {\n\t// Set document vars if needed\n\tif ( ( elem.ownerDocument || elem ) !== document ) {\n\t\tsetDocument( elem );\n\t}\n\n\tif ( support.matchesSelector && documentIsHTML &&\n\t\t!nonnativeSelectorCache[ expr + \" \" ] &&\n\t\t( !rbuggyMatches || !rbuggyMatches.test( expr ) ) &&\n\t\t( !rbuggyQSA     || !rbuggyQSA.test( expr ) ) ) {\n\n\t\ttry {\n\t\t\tvar ret = matches.call( elem, expr );\n\n\t\t\t// IE 9's matchesSelector returns false on disconnected nodes\n\t\t\tif ( ret || support.disconnectedMatch ||\n\t\t\t\t\t// As well, disconnected nodes are said to be in a document\n\t\t\t\t\t// fragment in IE 9\n\t\t\t\t\telem.document && elem.document.nodeType !== 11 ) {\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tnonnativeSelectorCache( expr, true );\n\t\t}\n\t}\n\n\treturn Sizzle( expr, document, null, [ elem ] ).length > 0;\n};\n\nSizzle.contains = function( context, elem ) {\n\t// Set document vars if needed\n\tif ( ( context.ownerDocument || context ) !== document ) {\n\t\tsetDocument( context );\n\t}\n\treturn contains( context, elem );\n};\n\nSizzle.attr = function( elem, name ) {\n\t// Set document vars if needed\n\tif ( ( elem.ownerDocument || elem ) !== document ) {\n\t\tsetDocument( elem );\n\t}\n\n\tvar fn = Expr.attrHandle[ name.toLowerCase() ],\n\t\t// Don't get fooled by Object.prototype properties (jQuery #13807)\n\t\tval = fn && hasOwn.call( Expr.attrHandle, name.toLowerCase() ) ?\n\t\t\tfn( elem, name, !documentIsHTML ) :\n\t\t\tundefined;\n\n\treturn val !== undefined ?\n\t\tval :\n\t\tsupport.attributes || !documentIsHTML ?\n\t\t\telem.getAttribute( name ) :\n\t\t\t(val = elem.getAttributeNode(name)) && val.specified ?\n\t\t\t\tval.value :\n\t\t\t\tnull;\n};\n\nSizzle.escape = function( sel ) {\n\treturn (sel + \"\").replace( rcssescape, fcssescape );\n};\n\nSizzle.error = function( msg ) {\n\tthrow new Error( \"Syntax error, unrecognized expression: \" + msg );\n};\n\n/**\n * Document sorting and removing duplicates\n * @param {ArrayLike} results\n */\nSizzle.uniqueSort = function( results ) {\n\tvar elem,\n\t\tduplicates = [],\n\t\tj = 0,\n\t\ti = 0;\n\n\t// Unless we *know* we can detect duplicates, assume their presence\n\thasDuplicate = !support.detectDuplicates;\n\tsortInput = !support.sortStable && results.slice( 0 );\n\tresults.sort( sortOrder );\n\n\tif ( hasDuplicate ) {\n\t\twhile ( (elem = results[i++]) ) {\n\t\t\tif ( elem === results[ i ] ) {\n\t\t\t\tj = duplicates.push( i );\n\t\t\t}\n\t\t}\n\t\twhile ( j-- ) {\n\t\t\tresults.splice( duplicates[ j ], 1 );\n\t\t}\n\t}\n\n\t// Clear input after sorting to release objects\n\t// See https://github.com/jquery/sizzle/pull/225\n\tsortInput = null;\n\n\treturn results;\n};\n\n/**\n * Utility function for retrieving the text value of an array of DOM nodes\n * @param {Array|Element} elem\n */\ngetText = Sizzle.getText = function( elem ) {\n\tvar node,\n\t\tret = \"\",\n\t\ti = 0,\n\t\tnodeType = elem.nodeType;\n\n\tif ( !nodeType ) {\n\t\t// If no nodeType, this is expected to be an array\n\t\twhile ( (node = elem[i++]) ) {\n\t\t\t// Do not traverse comment nodes\n\t\t\tret += getText( node );\n\t\t}\n\t} else if ( nodeType === 1 || nodeType === 9 || nodeType === 11 ) {\n\t\t// Use textContent for elements\n\t\t// innerText usage removed for consistency of new lines (jQuery #11153)\n\t\tif ( typeof elem.textContent === \"string\" ) {\n\t\t\treturn elem.textContent;\n\t\t} else {\n\t\t\t// Traverse its children\n\t\t\tfor ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\n\t\t\t\tret += getText( elem );\n\t\t\t}\n\t\t}\n\t} else if ( nodeType === 3 || nodeType === 4 ) {\n\t\treturn elem.nodeValue;\n\t}\n\t// Do not include comment or processing instruction nodes\n\n\treturn ret;\n};\n\nExpr = Sizzle.selectors = {\n\n\t// Can be adjusted by the user\n\tcacheLength: 50,\n\n\tcreatePseudo: markFunction,\n\n\tmatch: matchExpr,\n\n\tattrHandle: {},\n\n\tfind: {},\n\n\trelative: {\n\t\t\">\": { dir: \"parentNode\", first: true },\n\t\t\" \": { dir: \"parentNode\" },\n\t\t\"+\": { dir: \"previousSibling\", first: true },\n\t\t\"~\": { dir: \"previousSibling\" }\n\t},\n\n\tpreFilter: {\n\t\t\"ATTR\": function( match ) {\n\t\t\tmatch[1] = match[1].replace( runescape, funescape );\n\n\t\t\t// Move the given value to match[3] whether quoted or unquoted\n\t\t\tmatch[3] = ( match[3] || match[4] || match[5] || \"\" ).replace( runescape, funescape );\n\n\t\t\tif ( match[2] === \"~=\" ) {\n\t\t\t\tmatch[3] = \" \" + match[3] + \" \";\n\t\t\t}\n\n\t\t\treturn match.slice( 0, 4 );\n\t\t},\n\n\t\t\"CHILD\": function( match ) {\n\t\t\t/* matches from matchExpr[\"CHILD\"]\n\t\t\t\t1 type (only|nth|...)\n\t\t\t\t2 what (child|of-type)\n\t\t\t\t3 argument (even|odd|\\d*|\\d*n([+-]\\d+)?|...)\n\t\t\t\t4 xn-component of xn+y argument ([+-]?\\d*n|)\n\t\t\t\t5 sign of xn-component\n\t\t\t\t6 x of xn-component\n\t\t\t\t7 sign of y-component\n\t\t\t\t8 y of y-component\n\t\t\t*/\n\t\t\tmatch[1] = match[1].toLowerCase();\n\n\t\t\tif ( match[1].slice( 0, 3 ) === \"nth\" ) {\n\t\t\t\t// nth-* requires argument\n\t\t\t\tif ( !match[3] ) {\n\t\t\t\t\tSizzle.error( match[0] );\n\t\t\t\t}\n\n\t\t\t\t// numeric x and y parameters for Expr.filter.CHILD\n\t\t\t\t// remember that false/true cast respectively to 0/1\n\t\t\t\tmatch[4] = +( match[4] ? match[5] + (match[6] || 1) : 2 * ( match[3] === \"even\" || match[3] === \"odd\" ) );\n\t\t\t\tmatch[5] = +( ( match[7] + match[8] ) || match[3] === \"odd\" );\n\n\t\t\t// other types prohibit arguments\n\t\t\t} else if ( match[3] ) {\n\t\t\t\tSizzle.error( match[0] );\n\t\t\t}\n\n\t\t\treturn match;\n\t\t},\n\n\t\t\"PSEUDO\": function( match ) {\n\t\t\tvar excess,\n\t\t\t\tunquoted = !match[6] && match[2];\n\n\t\t\tif ( matchExpr[\"CHILD\"].test( match[0] ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\t// Accept quoted arguments as-is\n\t\t\tif ( match[3] ) {\n\t\t\t\tmatch[2] = match[4] || match[5] || \"\";\n\n\t\t\t// Strip excess characters from unquoted arguments\n\t\t\t} else if ( unquoted && rpseudo.test( unquoted ) &&\n\t\t\t\t// Get excess from tokenize (recursively)\n\t\t\t\t(excess = tokenize( unquoted, true )) &&\n\t\t\t\t// advance to the next closing parenthesis\n\t\t\t\t(excess = unquoted.indexOf( \")\", unquoted.length - excess ) - unquoted.length) ) {\n\n\t\t\t\t// excess is a negative index\n\t\t\t\tmatch[0] = match[0].slice( 0, excess );\n\t\t\t\tmatch[2] = unquoted.slice( 0, excess );\n\t\t\t}\n\n\t\t\t// Return only captures needed by the pseudo filter method (type and argument)\n\t\t\treturn match.slice( 0, 3 );\n\t\t}\n\t},\n\n\tfilter: {\n\n\t\t\"TAG\": function( nodeNameSelector ) {\n\t\t\tvar nodeName = nodeNameSelector.replace( runescape, funescape ).toLowerCase();\n\t\t\treturn nodeNameSelector === \"*\" ?\n\t\t\t\tfunction() { return true; } :\n\t\t\t\tfunction( elem ) {\n\t\t\t\t\treturn elem.nodeName && elem.nodeName.toLowerCase() === nodeName;\n\t\t\t\t};\n\t\t},\n\n\t\t\"CLASS\": function( className ) {\n\t\t\tvar pattern = classCache[ className + \" \" ];\n\n\t\t\treturn pattern ||\n\t\t\t\t(pattern = new RegExp( \"(^|\" + whitespace + \")\" + className + \"(\" + whitespace + \"|$)\" )) &&\n\t\t\t\tclassCache( className, function( elem ) {\n\t\t\t\t\treturn pattern.test( typeof elem.className === \"string\" && elem.className || typeof elem.getAttribute !== \"undefined\" && elem.getAttribute(\"class\") || \"\" );\n\t\t\t\t});\n\t\t},\n\n\t\t\"ATTR\": function( name, operator, check ) {\n\t\t\treturn function( elem ) {\n\t\t\t\tvar result = Sizzle.attr( elem, name );\n\n\t\t\t\tif ( result == null ) {\n\t\t\t\t\treturn operator === \"!=\";\n\t\t\t\t}\n\t\t\t\tif ( !operator ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tresult += \"\";\n\n\t\t\t\treturn operator === \"=\" ? result === check :\n\t\t\t\t\toperator === \"!=\" ? result !== check :\n\t\t\t\t\toperator === \"^=\" ? check && result.indexOf( check ) === 0 :\n\t\t\t\t\toperator === \"*=\" ? check && result.indexOf( check ) > -1 :\n\t\t\t\t\toperator === \"$=\" ? check && result.slice( -check.length ) === check :\n\t\t\t\t\toperator === \"~=\" ? ( \" \" + result.replace( rwhitespace, \" \" ) + \" \" ).indexOf( check ) > -1 :\n\t\t\t\t\toperator === \"|=\" ? result === check || result.slice( 0, check.length + 1 ) === check + \"-\" :\n\t\t\t\t\tfalse;\n\t\t\t};\n\t\t},\n\n\t\t\"CHILD\": function( type, what, argument, first, last ) {\n\t\t\tvar simple = type.slice( 0, 3 ) !== \"nth\",\n\t\t\t\tforward = type.slice( -4 ) !== \"last\",\n\t\t\t\tofType = what === \"of-type\";\n\n\t\t\treturn first === 1 && last === 0 ?\n\n\t\t\t\t// Shortcut for :nth-*(n)\n\t\t\t\tfunction( elem ) {\n\t\t\t\t\treturn !!elem.parentNode;\n\t\t\t\t} :\n\n\t\t\t\tfunction( elem, context, xml ) {\n\t\t\t\t\tvar cache, uniqueCache, outerCache, node, nodeIndex, start,\n\t\t\t\t\t\tdir = simple !== forward ? \"nextSibling\" : \"previousSibling\",\n\t\t\t\t\t\tparent = elem.parentNode,\n\t\t\t\t\t\tname = ofType && elem.nodeName.toLowerCase(),\n\t\t\t\t\t\tuseCache = !xml && !ofType,\n\t\t\t\t\t\tdiff = false;\n\n\t\t\t\t\tif ( parent ) {\n\n\t\t\t\t\t\t// :(first|last|only)-(child|of-type)\n\t\t\t\t\t\tif ( simple ) {\n\t\t\t\t\t\t\twhile ( dir ) {\n\t\t\t\t\t\t\t\tnode = elem;\n\t\t\t\t\t\t\t\twhile ( (node = node[ dir ]) ) {\n\t\t\t\t\t\t\t\t\tif ( ofType ?\n\t\t\t\t\t\t\t\t\t\tnode.nodeName.toLowerCase() === name :\n\t\t\t\t\t\t\t\t\t\tnode.nodeType === 1 ) {\n\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// Reverse direction for :only-* (if we haven't yet done so)\n\t\t\t\t\t\t\t\tstart = dir = type === \"only\" && !start && \"nextSibling\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstart = [ forward ? parent.firstChild : parent.lastChild ];\n\n\t\t\t\t\t\t// non-xml :nth-child(...) stores cache data on `parent`\n\t\t\t\t\t\tif ( forward && useCache ) {\n\n\t\t\t\t\t\t\t// Seek `elem` from a previously-cached index\n\n\t\t\t\t\t\t\t// ...in a gzip-friendly way\n\t\t\t\t\t\t\tnode = parent;\n\t\t\t\t\t\t\touterCache = node[ expando ] || (node[ expando ] = {});\n\n\t\t\t\t\t\t\t// Support: IE <9 only\n\t\t\t\t\t\t\t// Defend against cloned attroperties (jQuery gh-1709)\n\t\t\t\t\t\t\tuniqueCache = outerCache[ node.uniqueID ] ||\n\t\t\t\t\t\t\t\t(outerCache[ node.uniqueID ] = {});\n\n\t\t\t\t\t\t\tcache = uniqueCache[ type ] || [];\n\t\t\t\t\t\t\tnodeIndex = cache[ 0 ] === dirruns && cache[ 1 ];\n\t\t\t\t\t\t\tdiff = nodeIndex && cache[ 2 ];\n\t\t\t\t\t\t\tnode = nodeIndex && parent.childNodes[ nodeIndex ];\n\n\t\t\t\t\t\t\twhile ( (node = ++nodeIndex && node && node[ dir ] ||\n\n\t\t\t\t\t\t\t\t// Fallback to seeking `elem` from the start\n\t\t\t\t\t\t\t\t(diff = nodeIndex = 0) || start.pop()) ) {\n\n\t\t\t\t\t\t\t\t// When found, cache indexes on `parent` and break\n\t\t\t\t\t\t\t\tif ( node.nodeType === 1 && ++diff && node === elem ) {\n\t\t\t\t\t\t\t\t\tuniqueCache[ type ] = [ dirruns, nodeIndex, diff ];\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Use previously-cached element index if available\n\t\t\t\t\t\t\tif ( useCache ) {\n\t\t\t\t\t\t\t\t// ...in a gzip-friendly way\n\t\t\t\t\t\t\t\tnode = elem;\n\t\t\t\t\t\t\t\touterCache = node[ expando ] || (node[ expando ] = {});\n\n\t\t\t\t\t\t\t\t// Support: IE <9 only\n\t\t\t\t\t\t\t\t// Defend against cloned attroperties (jQuery gh-1709)\n\t\t\t\t\t\t\t\tuniqueCache = outerCache[ node.uniqueID ] ||\n\t\t\t\t\t\t\t\t\t(outerCache[ node.uniqueID ] = {});\n\n\t\t\t\t\t\t\t\tcache = uniqueCache[ type ] || [];\n\t\t\t\t\t\t\t\tnodeIndex = cache[ 0 ] === dirruns && cache[ 1 ];\n\t\t\t\t\t\t\t\tdiff = nodeIndex;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// xml :nth-child(...)\n\t\t\t\t\t\t\t// or :nth-last-child(...) or :nth(-last)?-of-type(...)\n\t\t\t\t\t\t\tif ( diff === false ) {\n\t\t\t\t\t\t\t\t// Use the same loop as above to seek `elem` from the start\n\t\t\t\t\t\t\t\twhile ( (node = ++nodeIndex && node && node[ dir ] ||\n\t\t\t\t\t\t\t\t\t(diff = nodeIndex = 0) || start.pop()) ) {\n\n\t\t\t\t\t\t\t\t\tif ( ( ofType ?\n\t\t\t\t\t\t\t\t\t\tnode.nodeName.toLowerCase() === name :\n\t\t\t\t\t\t\t\t\t\tnode.nodeType === 1 ) &&\n\t\t\t\t\t\t\t\t\t\t++diff ) {\n\n\t\t\t\t\t\t\t\t\t\t// Cache the index of each encountered element\n\t\t\t\t\t\t\t\t\t\tif ( useCache ) {\n\t\t\t\t\t\t\t\t\t\t\touterCache = node[ expando ] || (node[ expando ] = {});\n\n\t\t\t\t\t\t\t\t\t\t\t// Support: IE <9 only\n\t\t\t\t\t\t\t\t\t\t\t// Defend against cloned attroperties (jQuery gh-1709)\n\t\t\t\t\t\t\t\t\t\t\tuniqueCache = outerCache[ node.uniqueID ] ||\n\t\t\t\t\t\t\t\t\t\t\t\t(outerCache[ node.uniqueID ] = {});\n\n\t\t\t\t\t\t\t\t\t\t\tuniqueCache[ type ] = [ dirruns, diff ];\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif ( node === elem ) {\n\t\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Incorporate the offset, then check against cycle size\n\t\t\t\t\t\tdiff -= last;\n\t\t\t\t\t\treturn diff === first || ( diff % first === 0 && diff / first >= 0 );\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t},\n\n\t\t\"PSEUDO\": function( pseudo, argument ) {\n\t\t\t// pseudo-class names are case-insensitive\n\t\t\t// http://www.w3.org/TR/selectors/#pseudo-classes\n\t\t\t// Prioritize by case sensitivity in case custom pseudos are added with uppercase letters\n\t\t\t// Remember that setFilters inherits from pseudos\n\t\t\tvar args,\n\t\t\t\tfn = Expr.pseudos[ pseudo ] || Expr.setFilters[ pseudo.toLowerCase() ] ||\n\t\t\t\t\tSizzle.error( \"unsupported pseudo: \" + pseudo );\n\n\t\t\t// The user may use createPseudo to indicate that\n\t\t\t// arguments are needed to create the filter function\n\t\t\t// just as Sizzle does\n\t\t\tif ( fn[ expando ] ) {\n\t\t\t\treturn fn( argument );\n\t\t\t}\n\n\t\t\t// But maintain support for old signatures\n\t\t\tif ( fn.length > 1 ) {\n\t\t\t\targs = [ pseudo, pseudo, \"\", argument ];\n\t\t\t\treturn Expr.setFilters.hasOwnProperty( pseudo.toLowerCase() ) ?\n\t\t\t\t\tmarkFunction(function( seed, matches ) {\n\t\t\t\t\t\tvar idx,\n\t\t\t\t\t\t\tmatched = fn( seed, argument ),\n\t\t\t\t\t\t\ti = matched.length;\n\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\tidx = indexOf( seed, matched[i] );\n\t\t\t\t\t\t\tseed[ idx ] = !( matches[ idx ] = matched[i] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}) :\n\t\t\t\t\tfunction( elem ) {\n\t\t\t\t\t\treturn fn( elem, 0, args );\n\t\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn fn;\n\t\t}\n\t},\n\n\tpseudos: {\n\t\t// Potentially complex pseudos\n\t\t\"not\": markFunction(function( selector ) {\n\t\t\t// Trim the selector passed to compile\n\t\t\t// to avoid treating leading and trailing\n\t\t\t// spaces as combinators\n\t\t\tvar input = [],\n\t\t\t\tresults = [],\n\t\t\t\tmatcher = compile( selector.replace( rtrim, \"$1\" ) );\n\n\t\t\treturn matcher[ expando ] ?\n\t\t\t\tmarkFunction(function( seed, matches, context, xml ) {\n\t\t\t\t\tvar elem,\n\t\t\t\t\t\tunmatched = matcher( seed, null, xml, [] ),\n\t\t\t\t\t\ti = seed.length;\n\n\t\t\t\t\t// Match elements unmatched by `matcher`\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tif ( (elem = unmatched[i]) ) {\n\t\t\t\t\t\t\tseed[i] = !(matches[i] = elem);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}) :\n\t\t\t\tfunction( elem, context, xml ) {\n\t\t\t\t\tinput[0] = elem;\n\t\t\t\t\tmatcher( input, null, xml, results );\n\t\t\t\t\t// Don't keep the element (issue #299)\n\t\t\t\t\tinput[0] = null;\n\t\t\t\t\treturn !results.pop();\n\t\t\t\t};\n\t\t}),\n\n\t\t\"has\": markFunction(function( selector ) {\n\t\t\treturn function( elem ) {\n\t\t\t\treturn Sizzle( selector, elem ).length > 0;\n\t\t\t};\n\t\t}),\n\n\t\t\"contains\": markFunction(function( text ) {\n\t\t\ttext = text.replace( runescape, funescape );\n\t\t\treturn function( elem ) {\n\t\t\t\treturn ( elem.textContent || getText( elem ) ).indexOf( text ) > -1;\n\t\t\t};\n\t\t}),\n\n\t\t// \"Whether an element is represented by a :lang() selector\n\t\t// is based solely on the element's language value\n\t\t// being equal to the identifier C,\n\t\t// or beginning with the identifier C immediately followed by \"-\".\n\t\t// The matching of C against the element's language value is performed case-insensitively.\n\t\t// The identifier C does not have to be a valid language name.\"\n\t\t// http://www.w3.org/TR/selectors/#lang-pseudo\n\t\t\"lang\": markFunction( function( lang ) {\n\t\t\t// lang value must be a valid identifier\n\t\t\tif ( !ridentifier.test(lang || \"\") ) {\n\t\t\t\tSizzle.error( \"unsupported lang: \" + lang );\n\t\t\t}\n\t\t\tlang = lang.replace( runescape, funescape ).toLowerCase();\n\t\t\treturn function( elem ) {\n\t\t\t\tvar elemLang;\n\t\t\t\tdo {\n\t\t\t\t\tif ( (elemLang = documentIsHTML ?\n\t\t\t\t\t\telem.lang :\n\t\t\t\t\t\telem.getAttribute(\"xml:lang\") || elem.getAttribute(\"lang\")) ) {\n\n\t\t\t\t\t\telemLang = elemLang.toLowerCase();\n\t\t\t\t\t\treturn elemLang === lang || elemLang.indexOf( lang + \"-\" ) === 0;\n\t\t\t\t\t}\n\t\t\t\t} while ( (elem = elem.parentNode) && elem.nodeType === 1 );\n\t\t\t\treturn false;\n\t\t\t};\n\t\t}),\n\n\t\t// Miscellaneous\n\t\t\"target\": function( elem ) {\n\t\t\tvar hash = window.location && window.location.hash;\n\t\t\treturn hash && hash.slice( 1 ) === elem.id;\n\t\t},\n\n\t\t\"root\": function( elem ) {\n\t\t\treturn elem === docElem;\n\t\t},\n\n\t\t\"focus\": function( elem ) {\n\t\t\treturn elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);\n\t\t},\n\n\t\t// Boolean properties\n\t\t\"enabled\": createDisabledPseudo( false ),\n\t\t\"disabled\": createDisabledPseudo( true ),\n\n\t\t\"checked\": function( elem ) {\n\t\t\t// In CSS3, :checked should return both checked and selected elements\n\t\t\t// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked\n\t\t\tvar nodeName = elem.nodeName.toLowerCase();\n\t\t\treturn (nodeName === \"input\" && !!elem.checked) || (nodeName === \"option\" && !!elem.selected);\n\t\t},\n\n\t\t\"selected\": function( elem ) {\n\t\t\t// Accessing this property makes selected-by-default\n\t\t\t// options in Safari work properly\n\t\t\tif ( elem.parentNode ) {\n\t\t\t\telem.parentNode.selectedIndex;\n\t\t\t}\n\n\t\t\treturn elem.selected === true;\n\t\t},\n\n\t\t// Contents\n\t\t\"empty\": function( elem ) {\n\t\t\t// http://www.w3.org/TR/selectors/#empty-pseudo\n\t\t\t// :empty is negated by element (1) or content nodes (text: 3; cdata: 4; entity ref: 5),\n\t\t\t//   but not by others (comment: 8; processing instruction: 7; etc.)\n\t\t\t// nodeType < 6 works because attributes (2) do not appear as children\n\t\t\tfor ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\n\t\t\t\tif ( elem.nodeType < 6 ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\n\t\t\"parent\": function( elem ) {\n\t\t\treturn !Expr.pseudos[\"empty\"]( elem );\n\t\t},\n\n\t\t// Element/input types\n\t\t\"header\": function( elem ) {\n\t\t\treturn rheader.test( elem.nodeName );\n\t\t},\n\n\t\t\"input\": function( elem ) {\n\t\t\treturn rinputs.test( elem.nodeName );\n\t\t},\n\n\t\t\"button\": function( elem ) {\n\t\t\tvar name = elem.nodeName.toLowerCase();\n\t\t\treturn name === \"input\" && elem.type === \"button\" || name === \"button\";\n\t\t},\n\n\t\t\"text\": function( elem ) {\n\t\t\tvar attr;\n\t\t\treturn elem.nodeName.toLowerCase() === \"input\" &&\n\t\t\t\telem.type === \"text\" &&\n\n\t\t\t\t// Support: IE<8\n\t\t\t\t// New HTML5 attribute values (e.g., \"search\") appear with elem.type === \"text\"\n\t\t\t\t( (attr = elem.getAttribute(\"type\")) == null || attr.toLowerCase() === \"text\" );\n\t\t},\n\n\t\t// Position-in-collection\n\t\t\"first\": createPositionalPseudo(function() {\n\t\t\treturn [ 0 ];\n\t\t}),\n\n\t\t\"last\": createPositionalPseudo(function( matchIndexes, length ) {\n\t\t\treturn [ length - 1 ];\n\t\t}),\n\n\t\t\"eq\": createPositionalPseudo(function( matchIndexes, length, argument ) {\n\t\t\treturn [ argument < 0 ? argument + length : argument ];\n\t\t}),\n\n\t\t\"even\": createPositionalPseudo(function( matchIndexes, length ) {\n\t\t\tvar i = 0;\n\t\t\tfor ( ; i < length; i += 2 ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t}),\n\n\t\t\"odd\": createPositionalPseudo(function( matchIndexes, length ) {\n\t\t\tvar i = 1;\n\t\t\tfor ( ; i < length; i += 2 ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t}),\n\n\t\t\"lt\": createPositionalPseudo(function( matchIndexes, length, argument ) {\n\t\t\tvar i = argument < 0 ?\n\t\t\t\targument + length :\n\t\t\t\targument > length ?\n\t\t\t\t\tlength :\n\t\t\t\t\targument;\n\t\t\tfor ( ; --i >= 0; ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t}),\n\n\t\t\"gt\": createPositionalPseudo(function( matchIndexes, length, argument ) {\n\t\t\tvar i = argument < 0 ? argument + length : argument;\n\t\t\tfor ( ; ++i < length; ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t})\n\t}\n};\n\nExpr.pseudos[\"nth\"] = Expr.pseudos[\"eq\"];\n\n// Add button/input type pseudos\nfor ( i in { radio: true, checkbox: true, file: true, password: true, image: true } ) {\n\tExpr.pseudos[ i ] = createInputPseudo( i );\n}\nfor ( i in { submit: true, reset: true } ) {\n\tExpr.pseudos[ i ] = createButtonPseudo( i );\n}\n\n// Easy API for creating new setFilters\nfunction setFilters() {}\nsetFilters.prototype = Expr.filters = Expr.pseudos;\nExpr.setFilters = new setFilters();\n\ntokenize = Sizzle.tokenize = function( selector, parseOnly ) {\n\tvar matched, match, tokens, type,\n\t\tsoFar, groups, preFilters,\n\t\tcached = tokenCache[ selector + \" \" ];\n\n\tif ( cached ) {\n\t\treturn parseOnly ? 0 : cached.slice( 0 );\n\t}\n\n\tsoFar = selector;\n\tgroups = [];\n\tpreFilters = Expr.preFilter;\n\n\twhile ( soFar ) {\n\n\t\t// Comma and first run\n\t\tif ( !matched || (match = rcomma.exec( soFar )) ) {\n\t\t\tif ( match ) {\n\t\t\t\t// Don't consume trailing commas as valid\n\t\t\t\tsoFar = soFar.slice( match[0].length ) || soFar;\n\t\t\t}\n\t\t\tgroups.push( (tokens = []) );\n\t\t}\n\n\t\tmatched = false;\n\n\t\t// Combinators\n\t\tif ( (match = rcombinators.exec( soFar )) ) {\n\t\t\tmatched = match.shift();\n\t\t\ttokens.push({\n\t\t\t\tvalue: matched,\n\t\t\t\t// Cast descendant combinators to space\n\t\t\t\ttype: match[0].replace( rtrim, \" \" )\n\t\t\t});\n\t\t\tsoFar = soFar.slice( matched.length );\n\t\t}\n\n\t\t// Filters\n\t\tfor ( type in Expr.filter ) {\n\t\t\tif ( (match = matchExpr[ type ].exec( soFar )) && (!preFilters[ type ] ||\n\t\t\t\t(match = preFilters[ type ]( match ))) ) {\n\t\t\t\tmatched = match.shift();\n\t\t\t\ttokens.push({\n\t\t\t\t\tvalue: matched,\n\t\t\t\t\ttype: type,\n\t\t\t\t\tmatches: match\n\t\t\t\t});\n\t\t\t\tsoFar = soFar.slice( matched.length );\n\t\t\t}\n\t\t}\n\n\t\tif ( !matched ) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t// Return the length of the invalid excess\n\t// if we're just parsing\n\t// Otherwise, throw an error or return tokens\n\treturn parseOnly ?\n\t\tsoFar.length :\n\t\tsoFar ?\n\t\t\tSizzle.error( selector ) :\n\t\t\t// Cache the tokens\n\t\t\ttokenCache( selector, groups ).slice( 0 );\n};\n\nfunction toSelector( tokens ) {\n\tvar i = 0,\n\t\tlen = tokens.length,\n\t\tselector = \"\";\n\tfor ( ; i < len; i++ ) {\n\t\tselector += tokens[i].value;\n\t}\n\treturn selector;\n}\n\nfunction addCombinator( matcher, combinator, base ) {\n\tvar dir = combinator.dir,\n\t\tskip = combinator.next,\n\t\tkey = skip || dir,\n\t\tcheckNonElements = base && key === \"parentNode\",\n\t\tdoneName = done++;\n\n\treturn combinator.first ?\n\t\t// Check against closest ancestor/preceding element\n\t\tfunction( elem, context, xml ) {\n\t\t\twhile ( (elem = elem[ dir ]) ) {\n\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n\t\t\t\t\treturn matcher( elem, context, xml );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t} :\n\n\t\t// Check against all ancestor/preceding elements\n\t\tfunction( elem, context, xml ) {\n\t\t\tvar oldCache, uniqueCache, outerCache,\n\t\t\t\tnewCache = [ dirruns, doneName ];\n\n\t\t\t// We can't set arbitrary data on XML nodes, so they don't benefit from combinator caching\n\t\t\tif ( xml ) {\n\t\t\t\twhile ( (elem = elem[ dir ]) ) {\n\t\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n\t\t\t\t\t\tif ( matcher( elem, context, xml ) ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\twhile ( (elem = elem[ dir ]) ) {\n\t\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n\t\t\t\t\t\touterCache = elem[ expando ] || (elem[ expando ] = {});\n\n\t\t\t\t\t\t// Support: IE <9 only\n\t\t\t\t\t\t// Defend against cloned attroperties (jQuery gh-1709)\n\t\t\t\t\t\tuniqueCache = outerCache[ elem.uniqueID ] || (outerCache[ elem.uniqueID ] = {});\n\n\t\t\t\t\t\tif ( skip && skip === elem.nodeName.toLowerCase() ) {\n\t\t\t\t\t\t\telem = elem[ dir ] || elem;\n\t\t\t\t\t\t} else if ( (oldCache = uniqueCache[ key ]) &&\n\t\t\t\t\t\t\toldCache[ 0 ] === dirruns && oldCache[ 1 ] === doneName ) {\n\n\t\t\t\t\t\t\t// Assign to newCache so results back-propagate to previous elements\n\t\t\t\t\t\t\treturn (newCache[ 2 ] = oldCache[ 2 ]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Reuse newcache so results back-propagate to previous elements\n\t\t\t\t\t\t\tuniqueCache[ key ] = newCache;\n\n\t\t\t\t\t\t\t// A match means we're done; a fail means we have to keep checking\n\t\t\t\t\t\t\tif ( (newCache[ 2 ] = matcher( elem, context, xml )) ) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n}\n\nfunction elementMatcher( matchers ) {\n\treturn matchers.length > 1 ?\n\t\tfunction( elem, context, xml ) {\n\t\t\tvar i = matchers.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( !matchers[i]( elem, context, xml ) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t} :\n\t\tmatchers[0];\n}\n\nfunction multipleContexts( selector, contexts, results ) {\n\tvar i = 0,\n\t\tlen = contexts.length;\n\tfor ( ; i < len; i++ ) {\n\t\tSizzle( selector, contexts[i], results );\n\t}\n\treturn results;\n}\n\nfunction condense( unmatched, map, filter, context, xml ) {\n\tvar elem,\n\t\tnewUnmatched = [],\n\t\ti = 0,\n\t\tlen = unmatched.length,\n\t\tmapped = map != null;\n\n\tfor ( ; i < len; i++ ) {\n\t\tif ( (elem = unmatched[i]) ) {\n\t\t\tif ( !filter || filter( elem, context, xml ) ) {\n\t\t\t\tnewUnmatched.push( elem );\n\t\t\t\tif ( mapped ) {\n\t\t\t\t\tmap.push( i );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn newUnmatched;\n}\n\nfunction setMatcher( preFilter, selector, matcher, postFilter, postFinder, postSelector ) {\n\tif ( postFilter && !postFilter[ expando ] ) {\n\t\tpostFilter = setMatcher( postFilter );\n\t}\n\tif ( postFinder && !postFinder[ expando ] ) {\n\t\tpostFinder = setMatcher( postFinder, postSelector );\n\t}\n\treturn markFunction(function( seed, results, context, xml ) {\n\t\tvar temp, i, elem,\n\t\t\tpreMap = [],\n\t\t\tpostMap = [],\n\t\t\tpreexisting = results.length,\n\n\t\t\t// Get initial elements from seed or context\n\t\t\telems = seed || multipleContexts( selector || \"*\", context.nodeType ? [ context ] : context, [] ),\n\n\t\t\t// Prefilter to get matcher input, preserving a map for seed-results synchronization\n\t\t\tmatcherIn = preFilter && ( seed || !selector ) ?\n\t\t\t\tcondense( elems, preMap, preFilter, context, xml ) :\n\t\t\t\telems,\n\n\t\t\tmatcherOut = matcher ?\n\t\t\t\t// If we have a postFinder, or filtered seed, or non-seed postFilter or preexisting results,\n\t\t\t\tpostFinder || ( seed ? preFilter : preexisting || postFilter ) ?\n\n\t\t\t\t\t// ...intermediate processing is necessary\n\t\t\t\t\t[] :\n\n\t\t\t\t\t// ...otherwise use results directly\n\t\t\t\t\tresults :\n\t\t\t\tmatcherIn;\n\n\t\t// Find primary matches\n\t\tif ( matcher ) {\n\t\t\tmatcher( matcherIn, matcherOut, context, xml );\n\t\t}\n\n\t\t// Apply postFilter\n\t\tif ( postFilter ) {\n\t\t\ttemp = condense( matcherOut, postMap );\n\t\t\tpostFilter( temp, [], context, xml );\n\n\t\t\t// Un-match failing elements by moving them back to matcherIn\n\t\t\ti = temp.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( (elem = temp[i]) ) {\n\t\t\t\t\tmatcherOut[ postMap[i] ] = !(matcherIn[ postMap[i] ] = elem);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( seed ) {\n\t\t\tif ( postFinder || preFilter ) {\n\t\t\t\tif ( postFinder ) {\n\t\t\t\t\t// Get the final matcherOut by condensing this intermediate into postFinder contexts\n\t\t\t\t\ttemp = [];\n\t\t\t\t\ti = matcherOut.length;\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tif ( (elem = matcherOut[i]) ) {\n\t\t\t\t\t\t\t// Restore matcherIn since elem is not yet a final match\n\t\t\t\t\t\t\ttemp.push( (matcherIn[i] = elem) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tpostFinder( null, (matcherOut = []), temp, xml );\n\t\t\t\t}\n\n\t\t\t\t// Move matched elements from seed to results to keep them synchronized\n\t\t\t\ti = matcherOut.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tif ( (elem = matcherOut[i]) &&\n\t\t\t\t\t\t(temp = postFinder ? indexOf( seed, elem ) : preMap[i]) > -1 ) {\n\n\t\t\t\t\t\tseed[temp] = !(results[temp] = elem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t// Add elements to results, through postFinder if defined\n\t\t} else {\n\t\t\tmatcherOut = condense(\n\t\t\t\tmatcherOut === results ?\n\t\t\t\t\tmatcherOut.splice( preexisting, matcherOut.length ) :\n\t\t\t\t\tmatcherOut\n\t\t\t);\n\t\t\tif ( postFinder ) {\n\t\t\t\tpostFinder( null, results, matcherOut, xml );\n\t\t\t} else {\n\t\t\t\tpush.apply( results, matcherOut );\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction matcherFromTokens( tokens ) {\n\tvar checkContext, matcher, j,\n\t\tlen = tokens.length,\n\t\tleadingRelative = Expr.relative[ tokens[0].type ],\n\t\timplicitRelative = leadingRelative || Expr.relative[\" \"],\n\t\ti = leadingRelative ? 1 : 0,\n\n\t\t// The foundational matcher ensures that elements are reachable from top-level context(s)\n\t\tmatchContext = addCombinator( function( elem ) {\n\t\t\treturn elem === checkContext;\n\t\t}, implicitRelative, true ),\n\t\tmatchAnyContext = addCombinator( function( elem ) {\n\t\t\treturn indexOf( checkContext, elem ) > -1;\n\t\t}, implicitRelative, true ),\n\t\tmatchers = [ function( elem, context, xml ) {\n\t\t\tvar ret = ( !leadingRelative && ( xml || context !== outermostContext ) ) || (\n\t\t\t\t(checkContext = context).nodeType ?\n\t\t\t\t\tmatchContext( elem, context, xml ) :\n\t\t\t\t\tmatchAnyContext( elem, context, xml ) );\n\t\t\t// Avoid hanging onto element (issue #299)\n\t\t\tcheckContext = null;\n\t\t\treturn ret;\n\t\t} ];\n\n\tfor ( ; i < len; i++ ) {\n\t\tif ( (matcher = Expr.relative[ tokens[i].type ]) ) {\n\t\t\tmatchers = [ addCombinator(elementMatcher( matchers ), matcher) ];\n\t\t} else {\n\t\t\tmatcher = Expr.filter[ tokens[i].type ].apply( null, tokens[i].matches );\n\n\t\t\t// Return special upon seeing a positional matcher\n\t\t\tif ( matcher[ expando ] ) {\n\t\t\t\t// Find the next relative operator (if any) for proper handling\n\t\t\t\tj = ++i;\n\t\t\t\tfor ( ; j < len; j++ ) {\n\t\t\t\t\tif ( Expr.relative[ tokens[j].type ] ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn setMatcher(\n\t\t\t\t\ti > 1 && elementMatcher( matchers ),\n\t\t\t\t\ti > 1 && toSelector(\n\t\t\t\t\t\t// If the preceding token was a descendant combinator, insert an implicit any-element `*`\n\t\t\t\t\t\ttokens.slice( 0, i - 1 ).concat({ value: tokens[ i - 2 ].type === \" \" ? \"*\" : \"\" })\n\t\t\t\t\t).replace( rtrim, \"$1\" ),\n\t\t\t\t\tmatcher,\n\t\t\t\t\ti < j && matcherFromTokens( tokens.slice( i, j ) ),\n\t\t\t\t\tj < len && matcherFromTokens( (tokens = tokens.slice( j )) ),\n\t\t\t\t\tj < len && toSelector( tokens )\n\t\t\t\t);\n\t\t\t}\n\t\t\tmatchers.push( matcher );\n\t\t}\n\t}\n\n\treturn elementMatcher( matchers );\n}\n\nfunction matcherFromGroupMatchers( elementMatchers, setMatchers ) {\n\tvar bySet = setMatchers.length > 0,\n\t\tbyElement = elementMatchers.length > 0,\n\t\tsuperMatcher = function( seed, context, xml, results, outermost ) {\n\t\t\tvar elem, j, matcher,\n\t\t\t\tmatchedCount = 0,\n\t\t\t\ti = \"0\",\n\t\t\t\tunmatched = seed && [],\n\t\t\t\tsetMatched = [],\n\t\t\t\tcontextBackup = outermostContext,\n\t\t\t\t// We must always have either seed elements or outermost context\n\t\t\t\telems = seed || byElement && Expr.find[\"TAG\"]( \"*\", outermost ),\n\t\t\t\t// Use integer dirruns iff this is the outermost matcher\n\t\t\t\tdirrunsUnique = (dirruns += contextBackup == null ? 1 : Math.random() || 0.1),\n\t\t\t\tlen = elems.length;\n\n\t\t\tif ( outermost ) {\n\t\t\t\toutermostContext = context === document || context || outermost;\n\t\t\t}\n\n\t\t\t// Add elements passing elementMatchers directly to results\n\t\t\t// Support: IE<9, Safari\n\t\t\t// Tolerate NodeList properties (IE: \"length\"; Safari: <number>) matching elements by id\n\t\t\tfor ( ; i !== len && (elem = elems[i]) != null; i++ ) {\n\t\t\t\tif ( byElement && elem ) {\n\t\t\t\t\tj = 0;\n\t\t\t\t\tif ( !context && elem.ownerDocument !== document ) {\n\t\t\t\t\t\tsetDocument( elem );\n\t\t\t\t\t\txml = !documentIsHTML;\n\t\t\t\t\t}\n\t\t\t\t\twhile ( (matcher = elementMatchers[j++]) ) {\n\t\t\t\t\t\tif ( matcher( elem, context || document, xml) ) {\n\t\t\t\t\t\t\tresults.push( elem );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif ( outermost ) {\n\t\t\t\t\t\tdirruns = dirrunsUnique;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Track unmatched elements for set filters\n\t\t\t\tif ( bySet ) {\n\t\t\t\t\t// They will have gone through all possible matchers\n\t\t\t\t\tif ( (elem = !matcher && elem) ) {\n\t\t\t\t\t\tmatchedCount--;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Lengthen the array for every element, matched or not\n\t\t\t\t\tif ( seed ) {\n\t\t\t\t\t\tunmatched.push( elem );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// `i` is now the count of elements visited above, and adding it to `matchedCount`\n\t\t\t// makes the latter nonnegative.\n\t\t\tmatchedCount += i;\n\n\t\t\t// Apply set filters to unmatched elements\n\t\t\t// NOTE: This can be skipped if there are no unmatched elements (i.e., `matchedCount`\n\t\t\t// equals `i`), unless we didn't visit _any_ elements in the above loop because we have\n\t\t\t// no element matchers and no seed.\n\t\t\t// Incrementing an initially-string \"0\" `i` allows `i` to remain a string only in that\n\t\t\t// case, which will result in a \"00\" `matchedCount` that differs from `i` but is also\n\t\t\t// numerically zero.\n\t\t\tif ( bySet && i !== matchedCount ) {\n\t\t\t\tj = 0;\n\t\t\t\twhile ( (matcher = setMatchers[j++]) ) {\n\t\t\t\t\tmatcher( unmatched, setMatched, context, xml );\n\t\t\t\t}\n\n\t\t\t\tif ( seed ) {\n\t\t\t\t\t// Reintegrate element matches to eliminate the need for sorting\n\t\t\t\t\tif ( matchedCount > 0 ) {\n\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\tif ( !(unmatched[i] || setMatched[i]) ) {\n\t\t\t\t\t\t\t\tsetMatched[i] = pop.call( results );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Discard index placeholder values to get only actual matches\n\t\t\t\t\tsetMatched = condense( setMatched );\n\t\t\t\t}\n\n\t\t\t\t// Add matches to results\n\t\t\t\tpush.apply( results, setMatched );\n\n\t\t\t\t// Seedless set matches succeeding multiple successful matchers stipulate sorting\n\t\t\t\tif ( outermost && !seed && setMatched.length > 0 &&\n\t\t\t\t\t( matchedCount + setMatchers.length ) > 1 ) {\n\n\t\t\t\t\tSizzle.uniqueSort( results );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Override manipulation of globals by nested matchers\n\t\t\tif ( outermost ) {\n\t\t\t\tdirruns = dirrunsUnique;\n\t\t\t\toutermostContext = contextBackup;\n\t\t\t}\n\n\t\t\treturn unmatched;\n\t\t};\n\n\treturn bySet ?\n\t\tmarkFunction( superMatcher ) :\n\t\tsuperMatcher;\n}\n\ncompile = Sizzle.compile = function( selector, match /* Internal Use Only */ ) {\n\tvar i,\n\t\tsetMatchers = [],\n\t\telementMatchers = [],\n\t\tcached = compilerCache[ selector + \" \" ];\n\n\tif ( !cached ) {\n\t\t// Generate a function of recursive functions that can be used to check each element\n\t\tif ( !match ) {\n\t\t\tmatch = tokenize( selector );\n\t\t}\n\t\ti = match.length;\n\t\twhile ( i-- ) {\n\t\t\tcached = matcherFromTokens( match[i] );\n\t\t\tif ( cached[ expando ] ) {\n\t\t\t\tsetMatchers.push( cached );\n\t\t\t} else {\n\t\t\t\telementMatchers.push( cached );\n\t\t\t}\n\t\t}\n\n\t\t// Cache the compiled function\n\t\tcached = compilerCache( selector, matcherFromGroupMatchers( elementMatchers, setMatchers ) );\n\n\t\t// Save selector and tokenization\n\t\tcached.selector = selector;\n\t}\n\treturn cached;\n};\n\n/**\n * A low-level selection function that works with Sizzle's compiled\n *  selector functions\n * @param {String|Function} selector A selector or a pre-compiled\n *  selector function built with Sizzle.compile\n * @param {Element} context\n * @param {Array} [results]\n * @param {Array} [seed] A set of elements to match against\n */\nselect = Sizzle.select = function( selector, context, results, seed ) {\n\tvar i, tokens, token, type, find,\n\t\tcompiled = typeof selector === \"function\" && selector,\n\t\tmatch = !seed && tokenize( (selector = compiled.selector || selector) );\n\n\tresults = results || [];\n\n\t// Try to minimize operations if there is only one selector in the list and no seed\n\t// (the latter of which guarantees us context)\n\tif ( match.length === 1 ) {\n\n\t\t// Reduce context if the leading compound selector is an ID\n\t\ttokens = match[0] = match[0].slice( 0 );\n\t\tif ( tokens.length > 2 && (token = tokens[0]).type === \"ID\" &&\n\t\t\t\tcontext.nodeType === 9 && documentIsHTML && Expr.relative[ tokens[1].type ] ) {\n\n\t\t\tcontext = ( Expr.find[\"ID\"]( token.matches[0].replace(runescape, funescape), context ) || [] )[0];\n\t\t\tif ( !context ) {\n\t\t\t\treturn results;\n\n\t\t\t// Precompiled matchers will still verify ancestry, so step up a level\n\t\t\t} else if ( compiled ) {\n\t\t\t\tcontext = context.parentNode;\n\t\t\t}\n\n\t\t\tselector = selector.slice( tokens.shift().value.length );\n\t\t}\n\n\t\t// Fetch a seed set for right-to-left matching\n\t\ti = matchExpr[\"needsContext\"].test( selector ) ? 0 : tokens.length;\n\t\twhile ( i-- ) {\n\t\t\ttoken = tokens[i];\n\n\t\t\t// Abort if we hit a combinator\n\t\t\tif ( Expr.relative[ (type = token.type) ] ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif ( (find = Expr.find[ type ]) ) {\n\t\t\t\t// Search, expanding context for leading sibling combinators\n\t\t\t\tif ( (seed = find(\n\t\t\t\t\ttoken.matches[0].replace( runescape, funescape ),\n\t\t\t\t\trsibling.test( tokens[0].type ) && testContext( context.parentNode ) || context\n\t\t\t\t)) ) {\n\n\t\t\t\t\t// If seed is empty or no tokens remain, we can return early\n\t\t\t\t\ttokens.splice( i, 1 );\n\t\t\t\t\tselector = seed.length && toSelector( tokens );\n\t\t\t\t\tif ( !selector ) {\n\t\t\t\t\t\tpush.apply( results, seed );\n\t\t\t\t\t\treturn results;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Compile and execute a filtering function if one is not provided\n\t// Provide `match` to avoid retokenization if we modified the selector above\n\t( compiled || compile( selector, match ) )(\n\t\tseed,\n\t\tcontext,\n\t\t!documentIsHTML,\n\t\tresults,\n\t\t!context || rsibling.test( selector ) && testContext( context.parentNode ) || context\n\t);\n\treturn results;\n};\n\n// One-time assignments\n\n// Sort stability\nsupport.sortStable = expando.split(\"\").sort( sortOrder ).join(\"\") === expando;\n\n// Support: Chrome 14-35+\n// Always assume duplicates if they aren't passed to the comparison function\nsupport.detectDuplicates = !!hasDuplicate;\n\n// Initialize against the default document\nsetDocument();\n\n// Support: Webkit<537.32 - Safari 6.0.3/Chrome 25 (fixed in Chrome 27)\n// Detached nodes confoundingly follow *each other*\nsupport.sortDetached = assert(function( el ) {\n\t// Should return 1, but returns 4 (following)\n\treturn el.compareDocumentPosition( document.createElement(\"fieldset\") ) & 1;\n});\n\n// Support: IE<8\n// Prevent attribute/property \"interpolation\"\n// https://msdn.microsoft.com/en-us/library/ms536429%28VS.85%29.aspx\nif ( !assert(function( el ) {\n\tel.innerHTML = \"<a href='#'></a>\";\n\treturn el.firstChild.getAttribute(\"href\") === \"#\" ;\n}) ) {\n\taddHandle( \"type|href|height|width\", function( elem, name, isXML ) {\n\t\tif ( !isXML ) {\n\t\t\treturn elem.getAttribute( name, name.toLowerCase() === \"type\" ? 1 : 2 );\n\t\t}\n\t});\n}\n\n// Support: IE<9\n// Use defaultValue in place of getAttribute(\"value\")\nif ( !support.attributes || !assert(function( el ) {\n\tel.innerHTML = \"<input/>\";\n\tel.firstChild.setAttribute( \"value\", \"\" );\n\treturn el.firstChild.getAttribute( \"value\" ) === \"\";\n}) ) {\n\taddHandle( \"value\", function( elem, name, isXML ) {\n\t\tif ( !isXML && elem.nodeName.toLowerCase() === \"input\" ) {\n\t\t\treturn elem.defaultValue;\n\t\t}\n\t});\n}\n\n// Support: IE<9\n// Use getAttributeNode to fetch booleans when getAttribute lies\nif ( !assert(function( el ) {\n\treturn el.getAttribute(\"disabled\") == null;\n}) ) {\n\taddHandle( booleans, function( elem, name, isXML ) {\n\t\tvar val;\n\t\tif ( !isXML ) {\n\t\t\treturn elem[ name ] === true ? name.toLowerCase() :\n\t\t\t\t\t(val = elem.getAttributeNode( name )) && val.specified ?\n\t\t\t\t\tval.value :\n\t\t\t\tnull;\n\t\t}\n\t});\n}\n\nreturn Sizzle;\n\n})( window );\n\n\n\njQuery.find = Sizzle;\njQuery.expr = Sizzle.selectors;\n\n// Deprecated\njQuery.expr[ \":\" ] = jQuery.expr.pseudos;\njQuery.uniqueSort = jQuery.unique = Sizzle.uniqueSort;\njQuery.text = Sizzle.getText;\njQuery.isXMLDoc = Sizzle.isXML;\njQuery.contains = Sizzle.contains;\njQuery.escapeSelector = Sizzle.escape;\n\n\n\n\nvar dir = function( elem, dir, until ) {\n\tvar matched = [],\n\t\ttruncate = until !== undefined;\n\n\twhile ( ( elem = elem[ dir ] ) && elem.nodeType !== 9 ) {\n\t\tif ( elem.nodeType === 1 ) {\n\t\t\tif ( truncate && jQuery( elem ).is( until ) ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmatched.push( elem );\n\t\t}\n\t}\n\treturn matched;\n};\n\n\nvar siblings = function( n, elem ) {\n\tvar matched = [];\n\n\tfor ( ; n; n = n.nextSibling ) {\n\t\tif ( n.nodeType === 1 && n !== elem ) {\n\t\t\tmatched.push( n );\n\t\t}\n\t}\n\n\treturn matched;\n};\n\n\nvar rneedsContext = jQuery.expr.match.needsContext;\n\n\n\nfunction nodeName( elem, name ) {\n\n  return elem.nodeName && elem.nodeName.toLowerCase() === name.toLowerCase();\n\n};\nvar rsingleTag = ( /^<([a-z][^\\/\\0>:\\x20\\t\\r\\n\\f]*)[\\x20\\t\\r\\n\\f]*\\/?>(?:<\\/\\1>|)$/i );\n\n\n\n// Implement the identical functionality for filter and not\nfunction winnow( elements, qualifier, not ) {\n\tif ( isFunction( qualifier ) ) {\n\t\treturn jQuery.grep( elements, function( elem, i ) {\n\t\t\treturn !!qualifier.call( elem, i, elem ) !== not;\n\t\t} );\n\t}\n\n\t// Single element\n\tif ( qualifier.nodeType ) {\n\t\treturn jQuery.grep( elements, function( elem ) {\n\t\t\treturn ( elem === qualifier ) !== not;\n\t\t} );\n\t}\n\n\t// Arraylike of elements (jQuery, arguments, Array)\n\tif ( typeof qualifier !== \"string\" ) {\n\t\treturn jQuery.grep( elements, function( elem ) {\n\t\t\treturn ( indexOf.call( qualifier, elem ) > -1 ) !== not;\n\t\t} );\n\t}\n\n\t// Filtered directly for both simple and complex selectors\n\treturn jQuery.filter( qualifier, elements, not );\n}\n\njQuery.filter = function( expr, elems, not ) {\n\tvar elem = elems[ 0 ];\n\n\tif ( not ) {\n\t\texpr = \":not(\" + expr + \")\";\n\t}\n\n\tif ( elems.length === 1 && elem.nodeType === 1 ) {\n\t\treturn jQuery.find.matchesSelector( elem, expr ) ? [ elem ] : [];\n\t}\n\n\treturn jQuery.find.matches( expr, jQuery.grep( elems, function( elem ) {\n\t\treturn elem.nodeType === 1;\n\t} ) );\n};\n\njQuery.fn.extend( {\n\tfind: function( selector ) {\n\t\tvar i, ret,\n\t\t\tlen = this.length,\n\t\t\tself = this;\n\n\t\tif ( typeof selector !== \"string\" ) {\n\t\t\treturn this.pushStack( jQuery( selector ).filter( function() {\n\t\t\t\tfor ( i = 0; i < len; i++ ) {\n\t\t\t\t\tif ( jQuery.contains( self[ i ], this ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} ) );\n\t\t}\n\n\t\tret = this.pushStack( [] );\n\n\t\tfor ( i = 0; i < len; i++ ) {\n\t\t\tjQuery.find( selector, self[ i ], ret );\n\t\t}\n\n\t\treturn len > 1 ? jQuery.uniqueSort( ret ) : ret;\n\t},\n\tfilter: function( selector ) {\n\t\treturn this.pushStack( winnow( this, selector || [], false ) );\n\t},\n\tnot: function( selector ) {\n\t\treturn this.pushStack( winnow( this, selector || [], true ) );\n\t},\n\tis: function( selector ) {\n\t\treturn !!winnow(\n\t\t\tthis,\n\n\t\t\t// If this is a positional/relative selector, check membership in the returned set\n\t\t\t// so $(\"p:first\").is(\"p:last\") won't return true for a doc with two \"p\".\n\t\t\ttypeof selector === \"string\" && rneedsContext.test( selector ) ?\n\t\t\t\tjQuery( selector ) :\n\t\t\t\tselector || [],\n\t\t\tfalse\n\t\t).length;\n\t}\n} );\n\n\n// Initialize a jQuery object\n\n\n// A central reference to the root jQuery(document)\nvar rootjQuery,\n\n\t// A simple way to check for HTML strings\n\t// Prioritize #id over <tag> to avoid XSS via location.hash (#9521)\n\t// Strict HTML recognition (#11290: must start with <)\n\t// Shortcut simple #id case for speed\n\trquickExpr = /^(?:\\s*(<[\\w\\W]+>)[^>]*|#([\\w-]+))$/,\n\n\tinit = jQuery.fn.init = function( selector, context, root ) {\n\t\tvar match, elem;\n\n\t\t// HANDLE: $(\"\"), $(null), $(undefined), $(false)\n\t\tif ( !selector ) {\n\t\t\treturn this;\n\t\t}\n\n\t\t// Method init() accepts an alternate rootjQuery\n\t\t// so migrate can support jQuery.sub (gh-2101)\n\t\troot = root || rootjQuery;\n\n\t\t// Handle HTML strings\n\t\tif ( typeof selector === \"string\" ) {\n\t\t\tif ( selector[ 0 ] === \"<\" &&\n\t\t\t\tselector[ selector.length - 1 ] === \">\" &&\n\t\t\t\tselector.length >= 3 ) {\n\n\t\t\t\t// Assume that strings that start and end with <> are HTML and skip the regex check\n\t\t\t\tmatch = [ null, selector, null ];\n\n\t\t\t} else {\n\t\t\t\tmatch = rquickExpr.exec( selector );\n\t\t\t}\n\n\t\t\t// Match html or make sure no context is specified for #id\n\t\t\tif ( match && ( match[ 1 ] || !context ) ) {\n\n\t\t\t\t// HANDLE: $(html) -> $(array)\n\t\t\t\tif ( match[ 1 ] ) {\n\t\t\t\t\tcontext = context instanceof jQuery ? context[ 0 ] : context;\n\n\t\t\t\t\t// Option to run scripts is true for back-compat\n\t\t\t\t\t// Intentionally let the error be thrown if parseHTML is not present\n\t\t\t\t\tjQuery.merge( this, jQuery.parseHTML(\n\t\t\t\t\t\tmatch[ 1 ],\n\t\t\t\t\t\tcontext && context.nodeType ? context.ownerDocument || context : document,\n\t\t\t\t\t\ttrue\n\t\t\t\t\t) );\n\n\t\t\t\t\t// HANDLE: $(html, props)\n\t\t\t\t\tif ( rsingleTag.test( match[ 1 ] ) && jQuery.isPlainObject( context ) ) {\n\t\t\t\t\t\tfor ( match in context ) {\n\n\t\t\t\t\t\t\t// Properties of context are called as methods if possible\n\t\t\t\t\t\t\tif ( isFunction( this[ match ] ) ) {\n\t\t\t\t\t\t\t\tthis[ match ]( context[ match ] );\n\n\t\t\t\t\t\t\t// ...and otherwise set as attributes\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.attr( match, context[ match ] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this;\n\n\t\t\t\t// HANDLE: $(#id)\n\t\t\t\t} else {\n\t\t\t\t\telem = document.getElementById( match[ 2 ] );\n\n\t\t\t\t\tif ( elem ) {\n\n\t\t\t\t\t\t// Inject the element directly into the jQuery object\n\t\t\t\t\t\tthis[ 0 ] = elem;\n\t\t\t\t\t\tthis.length = 1;\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\n\t\t\t// HANDLE: $(expr, $(...))\n\t\t\t} else if ( !context || context.jquery ) {\n\t\t\t\treturn ( context || root ).find( selector );\n\n\t\t\t// HANDLE: $(expr, context)\n\t\t\t// (which is just equivalent to: $(context).find(expr)\n\t\t\t} else {\n\t\t\t\treturn this.constructor( context ).find( selector );\n\t\t\t}\n\n\t\t// HANDLE: $(DOMElement)\n\t\t} else if ( selector.nodeType ) {\n\t\t\tthis[ 0 ] = selector;\n\t\t\tthis.length = 1;\n\t\t\treturn this;\n\n\t\t// HANDLE: $(function)\n\t\t// Shortcut for document ready\n\t\t} else if ( isFunction( selector ) ) {\n\t\t\treturn root.ready !== undefined ?\n\t\t\t\troot.ready( selector ) :\n\n\t\t\t\t// Execute immediately if ready is not present\n\t\t\t\tselector( jQuery );\n\t\t}\n\n\t\treturn jQuery.makeArray( selector, this );\n\t};\n\n// Give the init function the jQuery prototype for later instantiation\ninit.prototype = jQuery.fn;\n\n// Initialize central reference\nrootjQuery = jQuery( document );\n\n\nvar rparentsprev = /^(?:parents|prev(?:Until|All))/,\n\n\t// Methods guaranteed to produce a unique set when starting from a unique set\n\tguaranteedUnique = {\n\t\tchildren: true,\n\t\tcontents: true,\n\t\tnext: true,\n\t\tprev: true\n\t};\n\njQuery.fn.extend( {\n\thas: function( target ) {\n\t\tvar targets = jQuery( target, this ),\n\t\t\tl = targets.length;\n\n\t\treturn this.filter( function() {\n\t\t\tvar i = 0;\n\t\t\tfor ( ; i < l; i++ ) {\n\t\t\t\tif ( jQuery.contains( this, targets[ i ] ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t},\n\n\tclosest: function( selectors, context ) {\n\t\tvar cur,\n\t\t\ti = 0,\n\t\t\tl = this.length,\n\t\t\tmatched = [],\n\t\t\ttargets = typeof selectors !== \"string\" && jQuery( selectors );\n\n\t\t// Positional selectors never match, since there's no _selection_ context\n\t\tif ( !rneedsContext.test( selectors ) ) {\n\t\t\tfor ( ; i < l; i++ ) {\n\t\t\t\tfor ( cur = this[ i ]; cur && cur !== context; cur = cur.parentNode ) {\n\n\t\t\t\t\t// Always skip document fragments\n\t\t\t\t\tif ( cur.nodeType < 11 && ( targets ?\n\t\t\t\t\t\ttargets.index( cur ) > -1 :\n\n\t\t\t\t\t\t// Don't pass non-elements to Sizzle\n\t\t\t\t\t\tcur.nodeType === 1 &&\n\t\t\t\t\t\t\tjQuery.find.matchesSelector( cur, selectors ) ) ) {\n\n\t\t\t\t\t\tmatched.push( cur );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.pushStack( matched.length > 1 ? jQuery.uniqueSort( matched ) : matched );\n\t},\n\n\t// Determine the position of an element within the set\n\tindex: function( elem ) {\n\n\t\t// No argument, return index in parent\n\t\tif ( !elem ) {\n\t\t\treturn ( this[ 0 ] && this[ 0 ].parentNode ) ? this.first().prevAll().length : -1;\n\t\t}\n\n\t\t// Index in selector\n\t\tif ( typeof elem === \"string\" ) {\n\t\t\treturn indexOf.call( jQuery( elem ), this[ 0 ] );\n\t\t}\n\n\t\t// Locate the position of the desired element\n\t\treturn indexOf.call( this,\n\n\t\t\t// If it receives a jQuery object, the first element is used\n\t\t\telem.jquery ? elem[ 0 ] : elem\n\t\t);\n\t},\n\n\tadd: function( selector, context ) {\n\t\treturn this.pushStack(\n\t\t\tjQuery.uniqueSort(\n\t\t\t\tjQuery.merge( this.get(), jQuery( selector, context ) )\n\t\t\t)\n\t\t);\n\t},\n\n\taddBack: function( selector ) {\n\t\treturn this.add( selector == null ?\n\t\t\tthis.prevObject : this.prevObject.filter( selector )\n\t\t);\n\t}\n} );\n\nfunction sibling( cur, dir ) {\n\twhile ( ( cur = cur[ dir ] ) && cur.nodeType !== 1 ) {}\n\treturn cur;\n}\n\njQuery.each( {\n\tparent: function( elem ) {\n\t\tvar parent = elem.parentNode;\n\t\treturn parent && parent.nodeType !== 11 ? parent : null;\n\t},\n\tparents: function( elem ) {\n\t\treturn dir( elem, \"parentNode\" );\n\t},\n\tparentsUntil: function( elem, i, until ) {\n\t\treturn dir( elem, \"parentNode\", until );\n\t},\n\tnext: function( elem ) {\n\t\treturn sibling( elem, \"nextSibling\" );\n\t},\n\tprev: function( elem ) {\n\t\treturn sibling( elem, \"previousSibling\" );\n\t},\n\tnextAll: function( elem ) {\n\t\treturn dir( elem, \"nextSibling\" );\n\t},\n\tprevAll: function( elem ) {\n\t\treturn dir( elem, \"previousSibling\" );\n\t},\n\tnextUntil: function( elem, i, until ) {\n\t\treturn dir( elem, \"nextSibling\", until );\n\t},\n\tprevUntil: function( elem, i, until ) {\n\t\treturn dir( elem, \"previousSibling\", until );\n\t},\n\tsiblings: function( elem ) {\n\t\treturn siblings( ( elem.parentNode || {} ).firstChild, elem );\n\t},\n\tchildren: function( elem ) {\n\t\treturn siblings( elem.firstChild );\n\t},\n\tcontents: function( elem ) {\n\t\tif ( typeof elem.contentDocument !== \"undefined\" ) {\n\t\t\treturn elem.contentDocument;\n\t\t}\n\n\t\t// Support: IE 9 - 11 only, iOS 7 only, Android Browser <=4.3 only\n\t\t// Treat the template element as a regular one in browsers that\n\t\t// don't support it.\n\t\tif ( nodeName( elem, \"template\" ) ) {\n\t\t\telem = elem.content || elem;\n\t\t}\n\n\t\treturn jQuery.merge( [], elem.childNodes );\n\t}\n}, function( name, fn ) {\n\tjQuery.fn[ name ] = function( until, selector ) {\n\t\tvar matched = jQuery.map( this, fn, until );\n\n\t\tif ( name.slice( -5 ) !== \"Until\" ) {\n\t\t\tselector = until;\n\t\t}\n\n\t\tif ( selector && typeof selector === \"string\" ) {\n\t\t\tmatched = jQuery.filter( selector, matched );\n\t\t}\n\n\t\tif ( this.length > 1 ) {\n\n\t\t\t// Remove duplicates\n\t\t\tif ( !guaranteedUnique[ name ] ) {\n\t\t\t\tjQuery.uniqueSort( matched );\n\t\t\t}\n\n\t\t\t// Reverse order for parents* and prev-derivatives\n\t\t\tif ( rparentsprev.test( name ) ) {\n\t\t\t\tmatched.reverse();\n\t\t\t}\n\t\t}\n\n\t\treturn this.pushStack( matched );\n\t};\n} );\nvar rnothtmlwhite = ( /[^\\x20\\t\\r\\n\\f]+/g );\n\n\n\n// Convert String-formatted options into Object-formatted ones\nfunction createOptions( options ) {\n\tvar object = {};\n\tjQuery.each( options.match( rnothtmlwhite ) || [], function( _, flag ) {\n\t\tobject[ flag ] = true;\n\t} );\n\treturn object;\n}\n\n/*\n * Create a callback list using the following parameters:\n *\n *\toptions: an optional list of space-separated options that will change how\n *\t\t\tthe callback list behaves or a more traditional option object\n *\n * By default a callback list will act like an event callback list and can be\n * \"fired\" multiple times.\n *\n * Possible options:\n *\n *\tonce:\t\t\twill ensure the callback list can only be fired once (like a Deferred)\n *\n *\tmemory:\t\t\twill keep track of previous values and will call any callback added\n *\t\t\t\t\tafter the list has been fired right away with the latest \"memorized\"\n *\t\t\t\t\tvalues (like a Deferred)\n *\n *\tunique:\t\t\twill ensure a callback can only be added once (no duplicate in the list)\n *\n *\tstopOnFalse:\tinterrupt callings when a callback returns false\n *\n */\njQuery.Callbacks = function( options ) {\n\n\t// Convert options from String-formatted to Object-formatted if needed\n\t// (we check in cache first)\n\toptions = typeof options === \"string\" ?\n\t\tcreateOptions( options ) :\n\t\tjQuery.extend( {}, options );\n\n\tvar // Flag to know if list is currently firing\n\t\tfiring,\n\n\t\t// Last fire value for non-forgettable lists\n\t\tmemory,\n\n\t\t// Flag to know if list was already fired\n\t\tfired,\n\n\t\t// Flag to prevent firing\n\t\tlocked,\n\n\t\t// Actual callback list\n\t\tlist = [],\n\n\t\t// Queue of execution data for repeatable lists\n\t\tqueue = [],\n\n\t\t// Index of currently firing callback (modified by add/remove as needed)\n\t\tfiringIndex = -1,\n\n\t\t// Fire callbacks\n\t\tfire = function() {\n\n\t\t\t// Enforce single-firing\n\t\t\tlocked = locked || options.once;\n\n\t\t\t// Execute callbacks for all pending executions,\n\t\t\t// respecting firingIndex overrides and runtime changes\n\t\t\tfired = firing = true;\n\t\t\tfor ( ; queue.length; firingIndex = -1 ) {\n\t\t\t\tmemory = queue.shift();\n\t\t\t\twhile ( ++firingIndex < list.length ) {\n\n\t\t\t\t\t// Run callback and check for early termination\n\t\t\t\t\tif ( list[ firingIndex ].apply( memory[ 0 ], memory[ 1 ] ) === false &&\n\t\t\t\t\t\toptions.stopOnFalse ) {\n\n\t\t\t\t\t\t// Jump to end and forget the data so .add doesn't re-fire\n\t\t\t\t\t\tfiringIndex = list.length;\n\t\t\t\t\t\tmemory = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Forget the data if we're done with it\n\t\t\tif ( !options.memory ) {\n\t\t\t\tmemory = false;\n\t\t\t}\n\n\t\t\tfiring = false;\n\n\t\t\t// Clean up if we're done firing for good\n\t\t\tif ( locked ) {\n\n\t\t\t\t// Keep an empty list if we have data for future add calls\n\t\t\t\tif ( memory ) {\n\t\t\t\t\tlist = [];\n\n\t\t\t\t// Otherwise, this object is spent\n\t\t\t\t} else {\n\t\t\t\t\tlist = \"\";\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t// Actual Callbacks object\n\t\tself = {\n\n\t\t\t// Add a callback or a collection of callbacks to the list\n\t\t\tadd: function() {\n\t\t\t\tif ( list ) {\n\n\t\t\t\t\t// If we have memory from a past run, we should fire after adding\n\t\t\t\t\tif ( memory && !firing ) {\n\t\t\t\t\t\tfiringIndex = list.length - 1;\n\t\t\t\t\t\tqueue.push( memory );\n\t\t\t\t\t}\n\n\t\t\t\t\t( function add( args ) {\n\t\t\t\t\t\tjQuery.each( args, function( _, arg ) {\n\t\t\t\t\t\t\tif ( isFunction( arg ) ) {\n\t\t\t\t\t\t\t\tif ( !options.unique || !self.has( arg ) ) {\n\t\t\t\t\t\t\t\t\tlist.push( arg );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if ( arg && arg.length && toType( arg ) !== \"string\" ) {\n\n\t\t\t\t\t\t\t\t// Inspect recursively\n\t\t\t\t\t\t\t\tadd( arg );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} );\n\t\t\t\t\t} )( arguments );\n\n\t\t\t\t\tif ( memory && !firing ) {\n\t\t\t\t\t\tfire();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t// Remove a callback from the list\n\t\t\tremove: function() {\n\t\t\t\tjQuery.each( arguments, function( _, arg ) {\n\t\t\t\t\tvar index;\n\t\t\t\t\twhile ( ( index = jQuery.inArray( arg, list, index ) ) > -1 ) {\n\t\t\t\t\t\tlist.splice( index, 1 );\n\n\t\t\t\t\t\t// Handle firing indexes\n\t\t\t\t\t\tif ( index <= firingIndex ) {\n\t\t\t\t\t\t\tfiringIndex--;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t// Check if a given callback is in the list.\n\t\t\t// If no argument is given, return whether or not list has callbacks attached.\n\t\t\thas: function( fn ) {\n\t\t\t\treturn fn ?\n\t\t\t\t\tjQuery.inArray( fn, list ) > -1 :\n\t\t\t\t\tlist.length > 0;\n\t\t\t},\n\n\t\t\t// Remove all callbacks from the list\n\t\t\tempty: function() {\n\t\t\t\tif ( list ) {\n\t\t\t\t\tlist = [];\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t// Disable .fire and .add\n\t\t\t// Abort any current/pending executions\n\t\t\t// Clear all callbacks and values\n\t\t\tdisable: function() {\n\t\t\t\tlocked = queue = [];\n\t\t\t\tlist = memory = \"\";\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tdisabled: function() {\n\t\t\t\treturn !list;\n\t\t\t},\n\n\t\t\t// Disable .fire\n\t\t\t// Also disable .add unless we have memory (since it would have no effect)\n\t\t\t// Abort any pending executions\n\t\t\tlock: function() {\n\t\t\t\tlocked = queue = [];\n\t\t\t\tif ( !memory && !firing ) {\n\t\t\t\t\tlist = memory = \"\";\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\tlocked: function() {\n\t\t\t\treturn !!locked;\n\t\t\t},\n\n\t\t\t// Call all callbacks with the given context and arguments\n\t\t\tfireWith: function( context, args ) {\n\t\t\t\tif ( !locked ) {\n\t\t\t\t\targs = args || [];\n\t\t\t\t\targs = [ context, args.slice ? args.slice() : args ];\n\t\t\t\t\tqueue.push( args );\n\t\t\t\t\tif ( !firing ) {\n\t\t\t\t\t\tfire();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t// Call all the callbacks with the given arguments\n\t\t\tfire: function() {\n\t\t\t\tself.fireWith( this, arguments );\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t// To know if the callbacks have already been called at least once\n\t\t\tfired: function() {\n\t\t\t\treturn !!fired;\n\t\t\t}\n\t\t};\n\n\treturn self;\n};\n\n\nfunction Identity( v ) {\n\treturn v;\n}\nfunction Thrower( ex ) {\n\tthrow ex;\n}\n\nfunction adoptValue( value, resolve, reject, noValue ) {\n\tvar method;\n\n\ttry {\n\n\t\t// Check for promise aspect first to privilege synchronous behavior\n\t\tif ( value && isFunction( ( method = value.promise ) ) ) {\n\t\t\tmethod.call( value ).done( resolve ).fail( reject );\n\n\t\t// Other thenables\n\t\t} else if ( value && isFunction( ( method = value.then ) ) ) {\n\t\t\tmethod.call( value, resolve, reject );\n\n\t\t// Other non-thenables\n\t\t} else {\n\n\t\t\t// Control `resolve` arguments by letting Array#slice cast boolean `noValue` to integer:\n\t\t\t// * false: [ value ].slice( 0 ) => resolve( value )\n\t\t\t// * true: [ value ].slice( 1 ) => resolve()\n\t\t\tresolve.apply( undefined, [ value ].slice( noValue ) );\n\t\t}\n\n\t// For Promises/A+, convert exceptions into rejections\n\t// Since jQuery.when doesn't unwrap thenables, we can skip the extra checks appearing in\n\t// Deferred#then to conditionally suppress rejection.\n\t} catch ( value ) {\n\n\t\t// Support: Android 4.0 only\n\t\t// Strict mode functions invoked without .call/.apply get global-object context\n\t\treject.apply( undefined, [ value ] );\n\t}\n}\n\njQuery.extend( {\n\n\tDeferred: function( func ) {\n\t\tvar tuples = [\n\n\t\t\t\t// action, add listener, callbacks,\n\t\t\t\t// ... .then handlers, argument index, [final state]\n\t\t\t\t[ \"notify\", \"progress\", jQuery.Callbacks( \"memory\" ),\n\t\t\t\t\tjQuery.Callbacks( \"memory\" ), 2 ],\n\t\t\t\t[ \"resolve\", \"done\", jQuery.Callbacks( \"once memory\" ),\n\t\t\t\t\tjQuery.Callbacks( \"once memory\" ), 0, \"resolved\" ],\n\t\t\t\t[ \"reject\", \"fail\", jQuery.Callbacks( \"once memory\" ),\n\t\t\t\t\tjQuery.Callbacks( \"once memory\" ), 1, \"rejected\" ]\n\t\t\t],\n\t\t\tstate = \"pending\",\n\t\t\tpromise = {\n\t\t\t\tstate: function() {\n\t\t\t\t\treturn state;\n\t\t\t\t},\n\t\t\t\talways: function() {\n\t\t\t\t\tdeferred.done( arguments ).fail( arguments );\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\t\t\t\t\"catch\": function( fn ) {\n\t\t\t\t\treturn promise.then( null, fn );\n\t\t\t\t},\n\n\t\t\t\t// Keep pipe for back-compat\n\t\t\t\tpipe: function( /* fnDone, fnFail, fnProgress */ ) {\n\t\t\t\t\tvar fns = arguments;\n\n\t\t\t\t\treturn jQuery.Deferred( function( newDefer ) {\n\t\t\t\t\t\tjQuery.each( tuples, function( i, tuple ) {\n\n\t\t\t\t\t\t\t// Map tuples (progress, done, fail) to arguments (done, fail, progress)\n\t\t\t\t\t\t\tvar fn = isFunction( fns[ tuple[ 4 ] ] ) && fns[ tuple[ 4 ] ];\n\n\t\t\t\t\t\t\t// deferred.progress(function() { bind to newDefer or newDefer.notify })\n\t\t\t\t\t\t\t// deferred.done(function() { bind to newDefer or newDefer.resolve })\n\t\t\t\t\t\t\t// deferred.fail(function() { bind to newDefer or newDefer.reject })\n\t\t\t\t\t\t\tdeferred[ tuple[ 1 ] ]( function() {\n\t\t\t\t\t\t\t\tvar returned = fn && fn.apply( this, arguments );\n\t\t\t\t\t\t\t\tif ( returned && isFunction( returned.promise ) ) {\n\t\t\t\t\t\t\t\t\treturned.promise()\n\t\t\t\t\t\t\t\t\t\t.progress( newDefer.notify )\n\t\t\t\t\t\t\t\t\t\t.done( newDefer.resolve )\n\t\t\t\t\t\t\t\t\t\t.fail( newDefer.reject );\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tnewDefer[ tuple[ 0 ] + \"With\" ](\n\t\t\t\t\t\t\t\t\t\tthis,\n\t\t\t\t\t\t\t\t\t\tfn ? [ returned ] : arguments\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t} );\n\t\t\t\t\t\tfns = null;\n\t\t\t\t\t} ).promise();\n\t\t\t\t},\n\t\t\t\tthen: function( onFulfilled, onRejected, onProgress ) {\n\t\t\t\t\tvar maxDepth = 0;\n\t\t\t\t\tfunction resolve( depth, deferred, handler, special ) {\n\t\t\t\t\t\treturn function() {\n\t\t\t\t\t\t\tvar that = this,\n\t\t\t\t\t\t\t\targs = arguments,\n\t\t\t\t\t\t\t\tmightThrow = function() {\n\t\t\t\t\t\t\t\t\tvar returned, then;\n\n\t\t\t\t\t\t\t\t\t// Support: Promises/A+ section 2.3.3.3.3\n\t\t\t\t\t\t\t\t\t// https://promisesaplus.com/#point-59\n\t\t\t\t\t\t\t\t\t// Ignore double-resolution attempts\n\t\t\t\t\t\t\t\t\tif ( depth < maxDepth ) {\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\treturned = handler.apply( that, args );\n\n\t\t\t\t\t\t\t\t\t// Support: Promises/A+ section 2.3.1\n\t\t\t\t\t\t\t\t\t// https://promisesaplus.com/#point-48\n\t\t\t\t\t\t\t\t\tif ( returned === deferred.promise() ) {\n\t\t\t\t\t\t\t\t\t\tthrow new TypeError( \"Thenable self-resolution\" );\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// Support: Promises/A+ sections 2.3.3.1, 3.5\n\t\t\t\t\t\t\t\t\t// https://promisesaplus.com/#point-54\n\t\t\t\t\t\t\t\t\t// https://promisesaplus.com/#point-75\n\t\t\t\t\t\t\t\t\t// Retrieve `then` only once\n\t\t\t\t\t\t\t\t\tthen = returned &&\n\n\t\t\t\t\t\t\t\t\t\t// Support: Promises/A+ section 2.3.4\n\t\t\t\t\t\t\t\t\t\t// https://promisesaplus.com/#point-64\n\t\t\t\t\t\t\t\t\t\t// Only check objects and functions for thenability\n\t\t\t\t\t\t\t\t\t\t( typeof returned === \"object\" ||\n\t\t\t\t\t\t\t\t\t\t\ttypeof returned === \"function\" ) &&\n\t\t\t\t\t\t\t\t\t\treturned.then;\n\n\t\t\t\t\t\t\t\t\t// Handle a returned thenable\n\t\t\t\t\t\t\t\t\tif ( isFunction( then ) ) {\n\n\t\t\t\t\t\t\t\t\t\t// Special processors (notify) just wait for resolution\n\t\t\t\t\t\t\t\t\t\tif ( special ) {\n\t\t\t\t\t\t\t\t\t\t\tthen.call(\n\t\t\t\t\t\t\t\t\t\t\t\treturned,\n\t\t\t\t\t\t\t\t\t\t\t\tresolve( maxDepth, deferred, Identity, special ),\n\t\t\t\t\t\t\t\t\t\t\t\tresolve( maxDepth, deferred, Thrower, special )\n\t\t\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\t\t// Normal processors (resolve) also hook into progress\n\t\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\t\t// ...and disregard older resolution values\n\t\t\t\t\t\t\t\t\t\t\tmaxDepth++;\n\n\t\t\t\t\t\t\t\t\t\t\tthen.call(\n\t\t\t\t\t\t\t\t\t\t\t\treturned,\n\t\t\t\t\t\t\t\t\t\t\t\tresolve( maxDepth, deferred, Identity, special ),\n\t\t\t\t\t\t\t\t\t\t\t\tresolve( maxDepth, deferred, Thrower, special ),\n\t\t\t\t\t\t\t\t\t\t\t\tresolve( maxDepth, deferred, Identity,\n\t\t\t\t\t\t\t\t\t\t\t\t\tdeferred.notifyWith )\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// Handle all other returned values\n\t\t\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t\t\t// Only substitute handlers pass on context\n\t\t\t\t\t\t\t\t\t\t// and multiple values (non-spec behavior)\n\t\t\t\t\t\t\t\t\t\tif ( handler !== Identity ) {\n\t\t\t\t\t\t\t\t\t\t\tthat = undefined;\n\t\t\t\t\t\t\t\t\t\t\targs = [ returned ];\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t// Process the value(s)\n\t\t\t\t\t\t\t\t\t\t// Default process is resolve\n\t\t\t\t\t\t\t\t\t\t( special || deferred.resolveWith )( that, args );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\n\t\t\t\t\t\t\t\t// Only normal processors (resolve) catch and reject exceptions\n\t\t\t\t\t\t\t\tprocess = special ?\n\t\t\t\t\t\t\t\t\tmightThrow :\n\t\t\t\t\t\t\t\t\tfunction() {\n\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\tmightThrow();\n\t\t\t\t\t\t\t\t\t\t} catch ( e ) {\n\n\t\t\t\t\t\t\t\t\t\t\tif ( jQuery.Deferred.exceptionHook ) {\n\t\t\t\t\t\t\t\t\t\t\t\tjQuery.Deferred.exceptionHook( e,\n\t\t\t\t\t\t\t\t\t\t\t\t\tprocess.stackTrace );\n\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t// Support: Promises/A+ section 2.3.3.3.4.1\n\t\t\t\t\t\t\t\t\t\t\t// https://promisesaplus.com/#point-61\n\t\t\t\t\t\t\t\t\t\t\t// Ignore post-resolution exceptions\n\t\t\t\t\t\t\t\t\t\t\tif ( depth + 1 >= maxDepth ) {\n\n\t\t\t\t\t\t\t\t\t\t\t\t// Only substitute handlers pass on context\n\t\t\t\t\t\t\t\t\t\t\t\t// and multiple values (non-spec behavior)\n\t\t\t\t\t\t\t\t\t\t\t\tif ( handler !== Thrower ) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tthat = undefined;\n\t\t\t\t\t\t\t\t\t\t\t\t\targs = [ e ];\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t\t\tdeferred.rejectWith( that, args );\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t// Support: Promises/A+ section 2.3.3.3.1\n\t\t\t\t\t\t\t// https://promisesaplus.com/#point-57\n\t\t\t\t\t\t\t// Re-resolve promises immediately to dodge false rejection from\n\t\t\t\t\t\t\t// subsequent errors\n\t\t\t\t\t\t\tif ( depth ) {\n\t\t\t\t\t\t\t\tprocess();\n\t\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t\t// Call an optional hook to record the stack, in case of exception\n\t\t\t\t\t\t\t\t// since it's otherwise lost when execution goes async\n\t\t\t\t\t\t\t\tif ( jQuery.Deferred.getStackHook ) {\n\t\t\t\t\t\t\t\t\tprocess.stackTrace = jQuery.Deferred.getStackHook();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\twindow.setTimeout( process );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\treturn jQuery.Deferred( function( newDefer ) {\n\n\t\t\t\t\t\t// progress_handlers.add( ... )\n\t\t\t\t\t\ttuples[ 0 ][ 3 ].add(\n\t\t\t\t\t\t\tresolve(\n\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\tnewDefer,\n\t\t\t\t\t\t\t\tisFunction( onProgress ) ?\n\t\t\t\t\t\t\t\t\tonProgress :\n\t\t\t\t\t\t\t\t\tIdentity,\n\t\t\t\t\t\t\t\tnewDefer.notifyWith\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\t// fulfilled_handlers.add( ... )\n\t\t\t\t\t\ttuples[ 1 ][ 3 ].add(\n\t\t\t\t\t\t\tresolve(\n\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\tnewDefer,\n\t\t\t\t\t\t\t\tisFunction( onFulfilled ) ?\n\t\t\t\t\t\t\t\t\tonFulfilled :\n\t\t\t\t\t\t\t\t\tIdentity\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\t// rejected_handlers.add( ... )\n\t\t\t\t\t\ttuples[ 2 ][ 3 ].add(\n\t\t\t\t\t\t\tresolve(\n\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\tnewDefer,\n\t\t\t\t\t\t\t\tisFunction( onRejected ) ?\n\t\t\t\t\t\t\t\t\tonRejected :\n\t\t\t\t\t\t\t\t\tThrower\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\t\t\t\t\t} ).promise();\n\t\t\t\t},\n\n\t\t\t\t// Get a promise for this deferred\n\t\t\t\t// If obj is provided, the promise aspect is added to the object\n\t\t\t\tpromise: function( obj ) {\n\t\t\t\t\treturn obj != null ? jQuery.extend( obj, promise ) : promise;\n\t\t\t\t}\n\t\t\t},\n\t\t\tdeferred = {};\n\n\t\t// Add list-specific methods\n\t\tjQuery.each( tuples, function( i, tuple ) {\n\t\t\tvar list = tuple[ 2 ],\n\t\t\t\tstateString = tuple[ 5 ];\n\n\t\t\t// promise.progress = list.add\n\t\t\t// promise.done = list.add\n\t\t\t// promise.fail = list.add\n\t\t\tpromise[ tuple[ 1 ] ] = list.add;\n\n\t\t\t// Handle state\n\t\t\tif ( stateString ) {\n\t\t\t\tlist.add(\n\t\t\t\t\tfunction() {\n\n\t\t\t\t\t\t// state = \"resolved\" (i.e., fulfilled)\n\t\t\t\t\t\t// state = \"rejected\"\n\t\t\t\t\t\tstate = stateString;\n\t\t\t\t\t},\n\n\t\t\t\t\t// rejected_callbacks.disable\n\t\t\t\t\t// fulfilled_callbacks.disable\n\t\t\t\t\ttuples[ 3 - i ][ 2 ].disable,\n\n\t\t\t\t\t// rejected_handlers.disable\n\t\t\t\t\t// fulfilled_handlers.disable\n\t\t\t\t\ttuples[ 3 - i ][ 3 ].disable,\n\n\t\t\t\t\t// progress_callbacks.lock\n\t\t\t\t\ttuples[ 0 ][ 2 ].lock,\n\n\t\t\t\t\t// progress_handlers.lock\n\t\t\t\t\ttuples[ 0 ][ 3 ].lock\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// progress_handlers.fire\n\t\t\t// fulfilled_handlers.fire\n\t\t\t// rejected_handlers.fire\n\t\t\tlist.add( tuple[ 3 ].fire );\n\n\t\t\t// deferred.notify = function() { deferred.notifyWith(...) }\n\t\t\t// deferred.resolve = function() { deferred.resolveWith(...) }\n\t\t\t// deferred.reject = function() { deferred.rejectWith(...) }\n\t\t\tdeferred[ tuple[ 0 ] ] = function() {\n\t\t\t\tdeferred[ tuple[ 0 ] + \"With\" ]( this === deferred ? undefined : this, arguments );\n\t\t\t\treturn this;\n\t\t\t};\n\n\t\t\t// deferred.notifyWith = list.fireWith\n\t\t\t// deferred.resolveWith = list.fireWith\n\t\t\t// deferred.rejectWith = list.fireWith\n\t\t\tdeferred[ tuple[ 0 ] + \"With\" ] = list.fireWith;\n\t\t} );\n\n\t\t// Make the deferred a promise\n\t\tpromise.promise( deferred );\n\n\t\t// Call given func if any\n\t\tif ( func ) {\n\t\t\tfunc.call( deferred, deferred );\n\t\t}\n\n\t\t// All done!\n\t\treturn deferred;\n\t},\n\n\t// Deferred helper\n\twhen: function( singleValue ) {\n\t\tvar\n\n\t\t\t// count of uncompleted subordinates\n\t\t\tremaining = arguments.length,\n\n\t\t\t// count of unprocessed arguments\n\t\t\ti = remaining,\n\n\t\t\t// subordinate fulfillment data\n\t\t\tresolveContexts = Array( i ),\n\t\t\tresolveValues = slice.call( arguments ),\n\n\t\t\t// the master Deferred\n\t\t\tmaster = jQuery.Deferred(),\n\n\t\t\t// subordinate callback factory\n\t\t\tupdateFunc = function( i ) {\n\t\t\t\treturn function( value ) {\n\t\t\t\t\tresolveContexts[ i ] = this;\n\t\t\t\t\tresolveValues[ i ] = arguments.length > 1 ? slice.call( arguments ) : value;\n\t\t\t\t\tif ( !( --remaining ) ) {\n\t\t\t\t\t\tmaster.resolveWith( resolveContexts, resolveValues );\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\n\t\t// Single- and empty arguments are adopted like Promise.resolve\n\t\tif ( remaining <= 1 ) {\n\t\t\tadoptValue( singleValue, master.done( updateFunc( i ) ).resolve, master.reject,\n\t\t\t\t!remaining );\n\n\t\t\t// Use .then() to unwrap secondary thenables (cf. gh-3000)\n\t\t\tif ( master.state() === \"pending\" ||\n\t\t\t\tisFunction( resolveValues[ i ] && resolveValues[ i ].then ) ) {\n\n\t\t\t\treturn master.then();\n\t\t\t}\n\t\t}\n\n\t\t// Multiple arguments are aggregated like Promise.all array elements\n\t\twhile ( i-- ) {\n\t\t\tadoptValue( resolveValues[ i ], updateFunc( i ), master.reject );\n\t\t}\n\n\t\treturn master.promise();\n\t}\n} );\n\n\n// These usually indicate a programmer mistake during development,\n// warn about them ASAP rather than swallowing them by default.\nvar rerrorNames = /^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;\n\njQuery.Deferred.exceptionHook = function( error, stack ) {\n\n\t// Support: IE 8 - 9 only\n\t// Console exists when dev tools are open, which can happen at any time\n\tif ( window.console && window.console.warn && error && rerrorNames.test( error.name ) ) {\n\t\twindow.console.warn( \"jQuery.Deferred exception: \" + error.message, error.stack, stack );\n\t}\n};\n\n\n\n\njQuery.readyException = function( error ) {\n\twindow.setTimeout( function() {\n\t\tthrow error;\n\t} );\n};\n\n\n\n\n// The deferred used on DOM ready\nvar readyList = jQuery.Deferred();\n\njQuery.fn.ready = function( fn ) {\n\n\treadyList\n\t\t.then( fn )\n\n\t\t// Wrap jQuery.readyException in a function so that the lookup\n\t\t// happens at the time of error handling instead of callback\n\t\t// registration.\n\t\t.catch( function( error ) {\n\t\t\tjQuery.readyException( error );\n\t\t} );\n\n\treturn this;\n};\n\njQuery.extend( {\n\n\t// Is the DOM ready to be used? Set to true once it occurs.\n\tisReady: false,\n\n\t// A counter to track how many items to wait for before\n\t// the ready event fires. See #6781\n\treadyWait: 1,\n\n\t// Handle when the DOM is ready\n\tready: function( wait ) {\n\n\t\t// Abort if there are pending holds or we're already ready\n\t\tif ( wait === true ? --jQuery.readyWait : jQuery.isReady ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Remember that the DOM is ready\n\t\tjQuery.isReady = true;\n\n\t\t// If a normal DOM Ready event fired, decrement, and wait if need be\n\t\tif ( wait !== true && --jQuery.readyWait > 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If there are functions bound, to execute\n\t\treadyList.resolveWith( document, [ jQuery ] );\n\t}\n} );\n\njQuery.ready.then = readyList.then;\n\n// The ready event handler and self cleanup method\nfunction completed() {\n\tdocument.removeEventListener( \"DOMContentLoaded\", completed );\n\twindow.removeEventListener( \"load\", completed );\n\tjQuery.ready();\n}\n\n// Catch cases where $(document).ready() is called\n// after the browser event has already occurred.\n// Support: IE <=9 - 10 only\n// Older IE sometimes signals \"interactive\" too soon\nif ( document.readyState === \"complete\" ||\n\t( document.readyState !== \"loading\" && !document.documentElement.doScroll ) ) {\n\n\t// Handle it asynchronously to allow scripts the opportunity to delay ready\n\twindow.setTimeout( jQuery.ready );\n\n} else {\n\n\t// Use the handy event callback\n\tdocument.addEventListener( \"DOMContentLoaded\", completed );\n\n\t// A fallback to window.onload, that will always work\n\twindow.addEventListener( \"load\", completed );\n}\n\n\n\n\n// Multifunctional method to get and set values of a collection\n// The value/s can optionally be executed if it's a function\nvar access = function( elems, fn, key, value, chainable, emptyGet, raw ) {\n\tvar i = 0,\n\t\tlen = elems.length,\n\t\tbulk = key == null;\n\n\t// Sets many values\n\tif ( toType( key ) === \"object\" ) {\n\t\tchainable = true;\n\t\tfor ( i in key ) {\n\t\t\taccess( elems, fn, i, key[ i ], true, emptyGet, raw );\n\t\t}\n\n\t// Sets one value\n\t} else if ( value !== undefined ) {\n\t\tchainable = true;\n\n\t\tif ( !isFunction( value ) ) {\n\t\t\traw = true;\n\t\t}\n\n\t\tif ( bulk ) {\n\n\t\t\t// Bulk operations run against the entire set\n\t\t\tif ( raw ) {\n\t\t\t\tfn.call( elems, value );\n\t\t\t\tfn = null;\n\n\t\t\t// ...except when executing function values\n\t\t\t} else {\n\t\t\t\tbulk = fn;\n\t\t\t\tfn = function( elem, key, value ) {\n\t\t\t\t\treturn bulk.call( jQuery( elem ), value );\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif ( fn ) {\n\t\t\tfor ( ; i < len; i++ ) {\n\t\t\t\tfn(\n\t\t\t\t\telems[ i ], key, raw ?\n\t\t\t\t\tvalue :\n\t\t\t\t\tvalue.call( elems[ i ], i, fn( elems[ i ], key ) )\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( chainable ) {\n\t\treturn elems;\n\t}\n\n\t// Gets\n\tif ( bulk ) {\n\t\treturn fn.call( elems );\n\t}\n\n\treturn len ? fn( elems[ 0 ], key ) : emptyGet;\n};\n\n\n// Matches dashed string for camelizing\nvar rmsPrefix = /^-ms-/,\n\trdashAlpha = /-([a-z])/g;\n\n// Used by camelCase as callback to replace()\nfunction fcamelCase( all, letter ) {\n\treturn letter.toUpperCase();\n}\n\n// Convert dashed to camelCase; used by the css and data modules\n// Support: IE <=9 - 11, Edge 12 - 15\n// Microsoft forgot to hump their vendor prefix (#9572)\nfunction camelCase( string ) {\n\treturn string.replace( rmsPrefix, \"ms-\" ).replace( rdashAlpha, fcamelCase );\n}\nvar acceptData = function( owner ) {\n\n\t// Accepts only:\n\t//  - Node\n\t//    - Node.ELEMENT_NODE\n\t//    - Node.DOCUMENT_NODE\n\t//  - Object\n\t//    - Any\n\treturn owner.nodeType === 1 || owner.nodeType === 9 || !( +owner.nodeType );\n};\n\n\n\n\nfunction Data() {\n\tthis.expando = jQuery.expando + Data.uid++;\n}\n\nData.uid = 1;\n\nData.prototype = {\n\n\tcache: function( owner ) {\n\n\t\t// Check if the owner object already has a cache\n\t\tvar value = owner[ this.expando ];\n\n\t\t// If not, create one\n\t\tif ( !value ) {\n\t\t\tvalue = {};\n\n\t\t\t// We can accept data for non-element nodes in modern browsers,\n\t\t\t// but we should not, see #8335.\n\t\t\t// Always return an empty object.\n\t\t\tif ( acceptData( owner ) ) {\n\n\t\t\t\t// If it is a node unlikely to be stringify-ed or looped over\n\t\t\t\t// use plain assignment\n\t\t\t\tif ( owner.nodeType ) {\n\t\t\t\t\towner[ this.expando ] = value;\n\n\t\t\t\t// Otherwise secure it in a non-enumerable property\n\t\t\t\t// configurable must be true to allow the property to be\n\t\t\t\t// deleted when data is removed\n\t\t\t\t} else {\n\t\t\t\t\tObject.defineProperty( owner, this.expando, {\n\t\t\t\t\t\tvalue: value,\n\t\t\t\t\t\tconfigurable: true\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn value;\n\t},\n\tset: function( owner, data, value ) {\n\t\tvar prop,\n\t\t\tcache = this.cache( owner );\n\n\t\t// Handle: [ owner, key, value ] args\n\t\t// Always use camelCase key (gh-2257)\n\t\tif ( typeof data === \"string\" ) {\n\t\t\tcache[ camelCase( data ) ] = value;\n\n\t\t// Handle: [ owner, { properties } ] args\n\t\t} else {\n\n\t\t\t// Copy the properties one-by-one to the cache object\n\t\t\tfor ( prop in data ) {\n\t\t\t\tcache[ camelCase( prop ) ] = data[ prop ];\n\t\t\t}\n\t\t}\n\t\treturn cache;\n\t},\n\tget: function( owner, key ) {\n\t\treturn key === undefined ?\n\t\t\tthis.cache( owner ) :\n\n\t\t\t// Always use camelCase key (gh-2257)\n\t\t\towner[ this.expando ] && owner[ this.expando ][ camelCase( key ) ];\n\t},\n\taccess: function( owner, key, value ) {\n\n\t\t// In cases where either:\n\t\t//\n\t\t//   1. No key was specified\n\t\t//   2. A string key was specified, but no value provided\n\t\t//\n\t\t// Take the \"read\" path and allow the get method to determine\n\t\t// which value to return, respectively either:\n\t\t//\n\t\t//   1. The entire cache object\n\t\t//   2. The data stored at the key\n\t\t//\n\t\tif ( key === undefined ||\n\t\t\t\t( ( key && typeof key === \"string\" ) && value === undefined ) ) {\n\n\t\t\treturn this.get( owner, key );\n\t\t}\n\n\t\t// When the key is not a string, or both a key and value\n\t\t// are specified, set or extend (existing objects) with either:\n\t\t//\n\t\t//   1. An object of properties\n\t\t//   2. A key and value\n\t\t//\n\t\tthis.set( owner, key, value );\n\n\t\t// Since the \"set\" path can have two possible entry points\n\t\t// return the expected data based on which path was taken[*]\n\t\treturn value !== undefined ? value : key;\n\t},\n\tremove: function( owner, key ) {\n\t\tvar i,\n\t\t\tcache = owner[ this.expando ];\n\n\t\tif ( cache === undefined ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( key !== undefined ) {\n\n\t\t\t// Support array or space separated string of keys\n\t\t\tif ( Array.isArray( key ) ) {\n\n\t\t\t\t// If key is an array of keys...\n\t\t\t\t// We always set camelCase keys, so remove that.\n\t\t\t\tkey = key.map( camelCase );\n\t\t\t} else {\n\t\t\t\tkey = camelCase( key );\n\n\t\t\t\t// If a key with the spaces exists, use it.\n\t\t\t\t// Otherwise, create an array by matching non-whitespace\n\t\t\t\tkey = key in cache ?\n\t\t\t\t\t[ key ] :\n\t\t\t\t\t( key.match( rnothtmlwhite ) || [] );\n\t\t\t}\n\n\t\t\ti = key.length;\n\n\t\t\twhile ( i-- ) {\n\t\t\t\tdelete cache[ key[ i ] ];\n\t\t\t}\n\t\t}\n\n\t\t// Remove the expando if there's no more data\n\t\tif ( key === undefined || jQuery.isEmptyObject( cache ) ) {\n\n\t\t\t// Support: Chrome <=35 - 45\n\t\t\t// Webkit & Blink performance suffers when deleting properties\n\t\t\t// from DOM nodes, so set to undefined instead\n\t\t\t// https://bugs.chromium.org/p/chromium/issues/detail?id=378607 (bug restricted)\n\t\t\tif ( owner.nodeType ) {\n\t\t\t\towner[ this.expando ] = undefined;\n\t\t\t} else {\n\t\t\t\tdelete owner[ this.expando ];\n\t\t\t}\n\t\t}\n\t},\n\thasData: function( owner ) {\n\t\tvar cache = owner[ this.expando ];\n\t\treturn cache !== undefined && !jQuery.isEmptyObject( cache );\n\t}\n};\nvar dataPriv = new Data();\n\nvar dataUser = new Data();\n\n\n\n//\tImplementation Summary\n//\n//\t1. Enforce API surface and semantic compatibility with 1.9.x branch\n//\t2. Improve the module's maintainability by reducing the storage\n//\t\tpaths to a single mechanism.\n//\t3. Use the same single mechanism to support \"private\" and \"user\" data.\n//\t4. _Never_ expose \"private\" data to user code (TODO: Drop _data, _removeData)\n//\t5. Avoid exposing implementation details on user objects (eg. expando properties)\n//\t6. Provide a clear path for implementation upgrade to WeakMap in 2014\n\nvar rbrace = /^(?:\\{[\\w\\W]*\\}|\\[[\\w\\W]*\\])$/,\n\trmultiDash = /[A-Z]/g;\n\nfunction getData( data ) {\n\tif ( data === \"true\" ) {\n\t\treturn true;\n\t}\n\n\tif ( data === \"false\" ) {\n\t\treturn false;\n\t}\n\n\tif ( data === \"null\" ) {\n\t\treturn null;\n\t}\n\n\t// Only convert to a number if it doesn't change the string\n\tif ( data === +data + \"\" ) {\n\t\treturn +data;\n\t}\n\n\tif ( rbrace.test( data ) ) {\n\t\treturn JSON.parse( data );\n\t}\n\n\treturn data;\n}\n\nfunction dataAttr( elem, key, data ) {\n\tvar name;\n\n\t// If nothing was found internally, try to fetch any\n\t// data from the HTML5 data-* attribute\n\tif ( data === undefined && elem.nodeType === 1 ) {\n\t\tname = \"data-\" + key.replace( rmultiDash, \"-$&\" ).toLowerCase();\n\t\tdata = elem.getAttribute( name );\n\n\t\tif ( typeof data === \"string\" ) {\n\t\t\ttry {\n\t\t\t\tdata = getData( data );\n\t\t\t} catch ( e ) {}\n\n\t\t\t// Make sure we set the data so it isn't changed later\n\t\t\tdataUser.set( elem, key, data );\n\t\t} else {\n\t\t\tdata = undefined;\n\t\t}\n\t}\n\treturn data;\n}\n\njQuery.extend( {\n\thasData: function( elem ) {\n\t\treturn dataUser.hasData( elem ) || dataPriv.hasData( elem );\n\t},\n\n\tdata: function( elem, name, data ) {\n\t\treturn dataUser.access( elem, name, data );\n\t},\n\n\tremoveData: function( elem, name ) {\n\t\tdataUser.remove( elem, name );\n\t},\n\n\t// TODO: Now that all calls to _data and _removeData have been replaced\n\t// with direct calls to dataPriv methods, these can be deprecated.\n\t_data: function( elem, name, data ) {\n\t\treturn dataPriv.access( elem, name, data );\n\t},\n\n\t_removeData: function( elem, name ) {\n\t\tdataPriv.remove( elem, name );\n\t}\n} );\n\njQuery.fn.extend( {\n\tdata: function( key, value ) {\n\t\tvar i, name, data,\n\t\t\telem = this[ 0 ],\n\t\t\tattrs = elem && elem.attributes;\n\n\t\t// Gets all values\n\t\tif ( key === undefined ) {\n\t\t\tif ( this.length ) {\n\t\t\t\tdata = dataUser.get( elem );\n\n\t\t\t\tif ( elem.nodeType === 1 && !dataPriv.get( elem, \"hasDataAttrs\" ) ) {\n\t\t\t\t\ti = attrs.length;\n\t\t\t\t\twhile ( i-- ) {\n\n\t\t\t\t\t\t// Support: IE 11 only\n\t\t\t\t\t\t// The attrs elements can be null (#14894)\n\t\t\t\t\t\tif ( attrs[ i ] ) {\n\t\t\t\t\t\t\tname = attrs[ i ].name;\n\t\t\t\t\t\t\tif ( name.indexOf( \"data-\" ) === 0 ) {\n\t\t\t\t\t\t\t\tname = camelCase( name.slice( 5 ) );\n\t\t\t\t\t\t\t\tdataAttr( elem, name, data[ name ] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdataPriv.set( elem, \"hasDataAttrs\", true );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn data;\n\t\t}\n\n\t\t// Sets multiple values\n\t\tif ( typeof key === \"object\" ) {\n\t\t\treturn this.each( function() {\n\t\t\t\tdataUser.set( this, key );\n\t\t\t} );\n\t\t}\n\n\t\treturn access( this, function( value ) {\n\t\t\tvar data;\n\n\t\t\t// The calling jQuery object (element matches) is not empty\n\t\t\t// (and therefore has an element appears at this[ 0 ]) and the\n\t\t\t// `value` parameter was not undefined. An empty jQuery object\n\t\t\t// will result in `undefined` for elem = this[ 0 ] which will\n\t\t\t// throw an exception if an attempt to read a data cache is made.\n\t\t\tif ( elem && value === undefined ) {\n\n\t\t\t\t// Attempt to get data from the cache\n\t\t\t\t// The key will always be camelCased in Data\n\t\t\t\tdata = dataUser.get( elem, key );\n\t\t\t\tif ( data !== undefined ) {\n\t\t\t\t\treturn data;\n\t\t\t\t}\n\n\t\t\t\t// Attempt to \"discover\" the data in\n\t\t\t\t// HTML5 custom data-* attrs\n\t\t\t\tdata = dataAttr( elem, key );\n\t\t\t\tif ( data !== undefined ) {\n\t\t\t\t\treturn data;\n\t\t\t\t}\n\n\t\t\t\t// We tried really hard, but the data doesn't exist.\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Set the data...\n\t\t\tthis.each( function() {\n\n\t\t\t\t// We always store the camelCased key\n\t\t\t\tdataUser.set( this, key, value );\n\t\t\t} );\n\t\t}, null, value, arguments.length > 1, null, true );\n\t},\n\n\tremoveData: function( key ) {\n\t\treturn this.each( function() {\n\t\t\tdataUser.remove( this, key );\n\t\t} );\n\t}\n} );\n\n\njQuery.extend( {\n\tqueue: function( elem, type, data ) {\n\t\tvar queue;\n\n\t\tif ( elem ) {\n\t\t\ttype = ( type || \"fx\" ) + \"queue\";\n\t\t\tqueue = dataPriv.get( elem, type );\n\n\t\t\t// Speed up dequeue by getting out quickly if this is just a lookup\n\t\t\tif ( data ) {\n\t\t\t\tif ( !queue || Array.isArray( data ) ) {\n\t\t\t\t\tqueue = dataPriv.access( elem, type, jQuery.makeArray( data ) );\n\t\t\t\t} else {\n\t\t\t\t\tqueue.push( data );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn queue || [];\n\t\t}\n\t},\n\n\tdequeue: function( elem, type ) {\n\t\ttype = type || \"fx\";\n\n\t\tvar queue = jQuery.queue( elem, type ),\n\t\t\tstartLength = queue.length,\n\t\t\tfn = queue.shift(),\n\t\t\thooks = jQuery._queueHooks( elem, type ),\n\t\t\tnext = function() {\n\t\t\t\tjQuery.dequeue( elem, type );\n\t\t\t};\n\n\t\t// If the fx queue is dequeued, always remove the progress sentinel\n\t\tif ( fn === \"inprogress\" ) {\n\t\t\tfn = queue.shift();\n\t\t\tstartLength--;\n\t\t}\n\n\t\tif ( fn ) {\n\n\t\t\t// Add a progress sentinel to prevent the fx queue from being\n\t\t\t// automatically dequeued\n\t\t\tif ( type === \"fx\" ) {\n\t\t\t\tqueue.unshift( \"inprogress\" );\n\t\t\t}\n\n\t\t\t// Clear up the last queue stop function\n\t\t\tdelete hooks.stop;\n\t\t\tfn.call( elem, next, hooks );\n\t\t}\n\n\t\tif ( !startLength && hooks ) {\n\t\t\thooks.empty.fire();\n\t\t}\n\t},\n\n\t// Not public - generate a queueHooks object, or return the current one\n\t_queueHooks: function( elem, type ) {\n\t\tvar key = type + \"queueHooks\";\n\t\treturn dataPriv.get( elem, key ) || dataPriv.access( elem, key, {\n\t\t\tempty: jQuery.Callbacks( \"once memory\" ).add( function() {\n\t\t\t\tdataPriv.remove( elem, [ type + \"queue\", key ] );\n\t\t\t} )\n\t\t} );\n\t}\n} );\n\njQuery.fn.extend( {\n\tqueue: function( type, data ) {\n\t\tvar setter = 2;\n\n\t\tif ( typeof type !== \"string\" ) {\n\t\t\tdata = type;\n\t\t\ttype = \"fx\";\n\t\t\tsetter--;\n\t\t}\n\n\t\tif ( arguments.length < setter ) {\n\t\t\treturn jQuery.queue( this[ 0 ], type );\n\t\t}\n\n\t\treturn data === undefined ?\n\t\t\tthis :\n\t\t\tthis.each( function() {\n\t\t\t\tvar queue = jQuery.queue( this, type, data );\n\n\t\t\t\t// Ensure a hooks for this queue\n\t\t\t\tjQuery._queueHooks( this, type );\n\n\t\t\t\tif ( type === \"fx\" && queue[ 0 ] !== \"inprogress\" ) {\n\t\t\t\t\tjQuery.dequeue( this, type );\n\t\t\t\t}\n\t\t\t} );\n\t},\n\tdequeue: function( type ) {\n\t\treturn this.each( function() {\n\t\t\tjQuery.dequeue( this, type );\n\t\t} );\n\t},\n\tclearQueue: function( type ) {\n\t\treturn this.queue( type || \"fx\", [] );\n\t},\n\n\t// Get a promise resolved when queues of a certain type\n\t// are emptied (fx is the type by default)\n\tpromise: function( type, obj ) {\n\t\tvar tmp,\n\t\t\tcount = 1,\n\t\t\tdefer = jQuery.Deferred(),\n\t\t\telements = this,\n\t\t\ti = this.length,\n\t\t\tresolve = function() {\n\t\t\t\tif ( !( --count ) ) {\n\t\t\t\t\tdefer.resolveWith( elements, [ elements ] );\n\t\t\t\t}\n\t\t\t};\n\n\t\tif ( typeof type !== \"string\" ) {\n\t\t\tobj = type;\n\t\t\ttype = undefined;\n\t\t}\n\t\ttype = type || \"fx\";\n\n\t\twhile ( i-- ) {\n\t\t\ttmp = dataPriv.get( elements[ i ], type + \"queueHooks\" );\n\t\t\tif ( tmp && tmp.empty ) {\n\t\t\t\tcount++;\n\t\t\t\ttmp.empty.add( resolve );\n\t\t\t}\n\t\t}\n\t\tresolve();\n\t\treturn defer.promise( obj );\n\t}\n} );\nvar pnum = ( /[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/ ).source;\n\nvar rcssNum = new RegExp( \"^(?:([+-])=|)(\" + pnum + \")([a-z%]*)$\", \"i\" );\n\n\nvar cssExpand = [ \"Top\", \"Right\", \"Bottom\", \"Left\" ];\n\nvar documentElement = document.documentElement;\n\n\n\n\tvar isAttached = function( elem ) {\n\t\t\treturn jQuery.contains( elem.ownerDocument, elem );\n\t\t},\n\t\tcomposed = { composed: true };\n\n\t// Check attachment across shadow DOM boundaries when possible (gh-3504)\n\tif ( documentElement.attachShadow ) {\n\t\tisAttached = function( elem ) {\n\t\t\treturn jQuery.contains( elem.ownerDocument, elem ) ||\n\t\t\t\telem.getRootNode( composed ) === elem.ownerDocument;\n\t\t};\n\t}\nvar isHiddenWithinTree = function( elem, el ) {\n\n\t\t// isHiddenWithinTree might be called from jQuery#filter function;\n\t\t// in that case, element will be second argument\n\t\telem = el || elem;\n\n\t\t// Inline style trumps all\n\t\treturn elem.style.display === \"none\" ||\n\t\t\telem.style.display === \"\" &&\n\n\t\t\t// Otherwise, check computed style\n\t\t\t// Support: Firefox <=43 - 45\n\t\t\t// Disconnected elements can have computed display: none, so first confirm that elem is\n\t\t\t// in the document.\n\t\t\tisAttached( elem ) &&\n\n\t\t\tjQuery.css( elem, \"display\" ) === \"none\";\n\t};\n\nvar swap = function( elem, options, callback, args ) {\n\tvar ret, name,\n\t\told = {};\n\n\t// Remember the old values, and insert the new ones\n\tfor ( name in options ) {\n\t\told[ name ] = elem.style[ name ];\n\t\telem.style[ name ] = options[ name ];\n\t}\n\n\tret = callback.apply( elem, args || [] );\n\n\t// Revert the old values\n\tfor ( name in options ) {\n\t\telem.style[ name ] = old[ name ];\n\t}\n\n\treturn ret;\n};\n\n\n\n\nfunction adjustCSS( elem, prop, valueParts, tween ) {\n\tvar adjusted, scale,\n\t\tmaxIterations = 20,\n\t\tcurrentValue = tween ?\n\t\t\tfunction() {\n\t\t\t\treturn tween.cur();\n\t\t\t} :\n\t\t\tfunction() {\n\t\t\t\treturn jQuery.css( elem, prop, \"\" );\n\t\t\t},\n\t\tinitial = currentValue(),\n\t\tunit = valueParts && valueParts[ 3 ] || ( jQuery.cssNumber[ prop ] ? \"\" : \"px\" ),\n\n\t\t// Starting value computation is required for potential unit mismatches\n\t\tinitialInUnit = elem.nodeType &&\n\t\t\t( jQuery.cssNumber[ prop ] || unit !== \"px\" && +initial ) &&\n\t\t\trcssNum.exec( jQuery.css( elem, prop ) );\n\n\tif ( initialInUnit && initialInUnit[ 3 ] !== unit ) {\n\n\t\t// Support: Firefox <=54\n\t\t// Halve the iteration target value to prevent interference from CSS upper bounds (gh-2144)\n\t\tinitial = initial / 2;\n\n\t\t// Trust units reported by jQuery.css\n\t\tunit = unit || initialInUnit[ 3 ];\n\n\t\t// Iteratively approximate from a nonzero starting point\n\t\tinitialInUnit = +initial || 1;\n\n\t\twhile ( maxIterations-- ) {\n\n\t\t\t// Evaluate and update our best guess (doubling guesses that zero out).\n\t\t\t// Finish if the scale equals or crosses 1 (making the old*new product non-positive).\n\t\t\tjQuery.style( elem, prop, initialInUnit + unit );\n\t\t\tif ( ( 1 - scale ) * ( 1 - ( scale = currentValue() / initial || 0.5 ) ) <= 0 ) {\n\t\t\t\tmaxIterations = 0;\n\t\t\t}\n\t\t\tinitialInUnit = initialInUnit / scale;\n\n\t\t}\n\n\t\tinitialInUnit = initialInUnit * 2;\n\t\tjQuery.style( elem, prop, initialInUnit + unit );\n\n\t\t// Make sure we update the tween properties later on\n\t\tvalueParts = valueParts || [];\n\t}\n\n\tif ( valueParts ) {\n\t\tinitialInUnit = +initialInUnit || +initial || 0;\n\n\t\t// Apply relative offset (+=/-=) if specified\n\t\tadjusted = valueParts[ 1 ] ?\n\t\t\tinitialInUnit + ( valueParts[ 1 ] + 1 ) * valueParts[ 2 ] :\n\t\t\t+valueParts[ 2 ];\n\t\tif ( tween ) {\n\t\t\ttween.unit = unit;\n\t\t\ttween.start = initialInUnit;\n\t\t\ttween.end = adjusted;\n\t\t}\n\t}\n\treturn adjusted;\n}\n\n\nvar defaultDisplayMap = {};\n\nfunction getDefaultDisplay( elem ) {\n\tvar temp,\n\t\tdoc = elem.ownerDocument,\n\t\tnodeName = elem.nodeName,\n\t\tdisplay = defaultDisplayMap[ nodeName ];\n\n\tif ( display ) {\n\t\treturn display;\n\t}\n\n\ttemp = doc.body.appendChild( doc.createElement( nodeName ) );\n\tdisplay = jQuery.css( temp, \"display\" );\n\n\ttemp.parentNode.removeChild( temp );\n\n\tif ( display === \"none\" ) {\n\t\tdisplay = \"block\";\n\t}\n\tdefaultDisplayMap[ nodeName ] = display;\n\n\treturn display;\n}\n\nfunction showHide( elements, show ) {\n\tvar display, elem,\n\t\tvalues = [],\n\t\tindex = 0,\n\t\tlength = elements.length;\n\n\t// Determine new display value for elements that need to change\n\tfor ( ; index < length; index++ ) {\n\t\telem = elements[ index ];\n\t\tif ( !elem.style ) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tdisplay = elem.style.display;\n\t\tif ( show ) {\n\n\t\t\t// Since we force visibility upon cascade-hidden elements, an immediate (and slow)\n\t\t\t// check is required in this first loop unless we have a nonempty display value (either\n\t\t\t// inline or about-to-be-restored)\n\t\t\tif ( display === \"none\" ) {\n\t\t\t\tvalues[ index ] = dataPriv.get( elem, \"display\" ) || null;\n\t\t\t\tif ( !values[ index ] ) {\n\t\t\t\t\telem.style.display = \"\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ( elem.style.display === \"\" && isHiddenWithinTree( elem ) ) {\n\t\t\t\tvalues[ index ] = getDefaultDisplay( elem );\n\t\t\t}\n\t\t} else {\n\t\t\tif ( display !== \"none\" ) {\n\t\t\t\tvalues[ index ] = \"none\";\n\n\t\t\t\t// Remember what we're overwriting\n\t\t\t\tdataPriv.set( elem, \"display\", display );\n\t\t\t}\n\t\t}\n\t}\n\n\t// Set the display of the elements in a second loop to avoid constant reflow\n\tfor ( index = 0; index < length; index++ ) {\n\t\tif ( values[ index ] != null ) {\n\t\t\telements[ index ].style.display = values[ index ];\n\t\t}\n\t}\n\n\treturn elements;\n}\n\njQuery.fn.extend( {\n\tshow: function() {\n\t\treturn showHide( this, true );\n\t},\n\thide: function() {\n\t\treturn showHide( this );\n\t},\n\ttoggle: function( state ) {\n\t\tif ( typeof state === \"boolean\" ) {\n\t\t\treturn state ? this.show() : this.hide();\n\t\t}\n\n\t\treturn this.each( function() {\n\t\t\tif ( isHiddenWithinTree( this ) ) {\n\t\t\t\tjQuery( this ).show();\n\t\t\t} else {\n\t\t\t\tjQuery( this ).hide();\n\t\t\t}\n\t\t} );\n\t}\n} );\nvar rcheckableType = ( /^(?:checkbox|radio)$/i );\n\nvar rtagName = ( /<([a-z][^\\/\\0>\\x20\\t\\r\\n\\f]*)/i );\n\nvar rscriptType = ( /^$|^module$|\\/(?:java|ecma)script/i );\n\n\n\n// We have to close these tags to support XHTML (#13200)\nvar wrapMap = {\n\n\t// Support: IE <=9 only\n\toption: [ 1, \"<select multiple='multiple'>\", \"</select>\" ],\n\n\t// XHTML parsers do not magically insert elements in the\n\t// same way that tag soup parsers do. So we cannot shorten\n\t// this by omitting <tbody> or other required elements.\n\tthead: [ 1, \"<table>\", \"</table>\" ],\n\tcol: [ 2, \"<table><colgroup>\", \"</colgroup></table>\" ],\n\ttr: [ 2, \"<table><tbody>\", \"</tbody></table>\" ],\n\ttd: [ 3, \"<table><tbody><tr>\", \"</tr></tbody></table>\" ],\n\n\t_default: [ 0, \"\", \"\" ]\n};\n\n// Support: IE <=9 only\nwrapMap.optgroup = wrapMap.option;\n\nwrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;\nwrapMap.th = wrapMap.td;\n\n\nfunction getAll( context, tag ) {\n\n\t// Support: IE <=9 - 11 only\n\t// Use typeof to avoid zero-argument method invocation on host objects (#15151)\n\tvar ret;\n\n\tif ( typeof context.getElementsByTagName !== \"undefined\" ) {\n\t\tret = context.getElementsByTagName( tag || \"*\" );\n\n\t} else if ( typeof context.querySelectorAll !== \"undefined\" ) {\n\t\tret = context.querySelectorAll( tag || \"*\" );\n\n\t} else {\n\t\tret = [];\n\t}\n\n\tif ( tag === undefined || tag && nodeName( context, tag ) ) {\n\t\treturn jQuery.merge( [ context ], ret );\n\t}\n\n\treturn ret;\n}\n\n\n// Mark scripts as having already been evaluated\nfunction setGlobalEval( elems, refElements ) {\n\tvar i = 0,\n\t\tl = elems.length;\n\n\tfor ( ; i < l; i++ ) {\n\t\tdataPriv.set(\n\t\t\telems[ i ],\n\t\t\t\"globalEval\",\n\t\t\t!refElements || dataPriv.get( refElements[ i ], \"globalEval\" )\n\t\t);\n\t}\n}\n\n\nvar rhtml = /<|&#?\\w+;/;\n\nfunction buildFragment( elems, context, scripts, selection, ignored ) {\n\tvar elem, tmp, tag, wrap, attached, j,\n\t\tfragment = context.createDocumentFragment(),\n\t\tnodes = [],\n\t\ti = 0,\n\t\tl = elems.length;\n\n\tfor ( ; i < l; i++ ) {\n\t\telem = elems[ i ];\n\n\t\tif ( elem || elem === 0 ) {\n\n\t\t\t// Add nodes directly\n\t\t\tif ( toType( elem ) === \"object\" ) {\n\n\t\t\t\t// Support: Android <=4.0 only, PhantomJS 1 only\n\t\t\t\t// push.apply(_, arraylike) throws on ancient WebKit\n\t\t\t\tjQuery.merge( nodes, elem.nodeType ? [ elem ] : elem );\n\n\t\t\t// Convert non-html into a text node\n\t\t\t} else if ( !rhtml.test( elem ) ) {\n\t\t\t\tnodes.push( context.createTextNode( elem ) );\n\n\t\t\t// Convert html into DOM nodes\n\t\t\t} else {\n\t\t\t\ttmp = tmp || fragment.appendChild( context.createElement( \"div\" ) );\n\n\t\t\t\t// Deserialize a standard representation\n\t\t\t\ttag = ( rtagName.exec( elem ) || [ \"\", \"\" ] )[ 1 ].toLowerCase();\n\t\t\t\twrap = wrapMap[ tag ] || wrapMap._default;\n\t\t\t\ttmp.innerHTML = wrap[ 1 ] + jQuery.htmlPrefilter( elem ) + wrap[ 2 ];\n\n\t\t\t\t// Descend through wrappers to the right content\n\t\t\t\tj = wrap[ 0 ];\n\t\t\t\twhile ( j-- ) {\n\t\t\t\t\ttmp = tmp.lastChild;\n\t\t\t\t}\n\n\t\t\t\t// Support: Android <=4.0 only, PhantomJS 1 only\n\t\t\t\t// push.apply(_, arraylike) throws on ancient WebKit\n\t\t\t\tjQuery.merge( nodes, tmp.childNodes );\n\n\t\t\t\t// Remember the top-level container\n\t\t\t\ttmp = fragment.firstChild;\n\n\t\t\t\t// Ensure the created nodes are orphaned (#12392)\n\t\t\t\ttmp.textContent = \"\";\n\t\t\t}\n\t\t}\n\t}\n\n\t// Remove wrapper from fragment\n\tfragment.textContent = \"\";\n\n\ti = 0;\n\twhile ( ( elem = nodes[ i++ ] ) ) {\n\n\t\t// Skip elements already in the context collection (trac-4087)\n\t\tif ( selection && jQuery.inArray( elem, selection ) > -1 ) {\n\t\t\tif ( ignored ) {\n\t\t\t\tignored.push( elem );\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\n\t\tattached = isAttached( elem );\n\n\t\t// Append to fragment\n\t\ttmp = getAll( fragment.appendChild( elem ), \"script\" );\n\n\t\t// Preserve script evaluation history\n\t\tif ( attached ) {\n\t\t\tsetGlobalEval( tmp );\n\t\t}\n\n\t\t// Capture executables\n\t\tif ( scripts ) {\n\t\t\tj = 0;\n\t\t\twhile ( ( elem = tmp[ j++ ] ) ) {\n\t\t\t\tif ( rscriptType.test( elem.type || \"\" ) ) {\n\t\t\t\t\tscripts.push( elem );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn fragment;\n}\n\n\n( function() {\n\tvar fragment = document.createDocumentFragment(),\n\t\tdiv = fragment.appendChild( document.createElement( \"div\" ) ),\n\t\tinput = document.createElement( \"input\" );\n\n\t// Support: Android 4.0 - 4.3 only\n\t// Check state lost if the name is set (#11217)\n\t// Support: Windows Web Apps (WWA)\n\t// `name` and `type` must use .setAttribute for WWA (#14901)\n\tinput.setAttribute( \"type\", \"radio\" );\n\tinput.setAttribute( \"checked\", \"checked\" );\n\tinput.setAttribute( \"name\", \"t\" );\n\n\tdiv.appendChild( input );\n\n\t// Support: Android <=4.1 only\n\t// Older WebKit doesn't clone checked state correctly in fragments\n\tsupport.checkClone = div.cloneNode( true ).cloneNode( true ).lastChild.checked;\n\n\t// Support: IE <=11 only\n\t// Make sure textarea (and checkbox) defaultValue is properly cloned\n\tdiv.innerHTML = \"<textarea>x</textarea>\";\n\tsupport.noCloneChecked = !!div.cloneNode( true ).lastChild.defaultValue;\n} )();\n\n\nvar\n\trkeyEvent = /^key/,\n\trmouseEvent = /^(?:mouse|pointer|contextmenu|drag|drop)|click/,\n\trtypenamespace = /^([^.]*)(?:\\.(.+)|)/;\n\nfunction returnTrue() {\n\treturn true;\n}\n\nfunction returnFalse() {\n\treturn false;\n}\n\n// Support: IE <=9 - 11+\n// focus() and blur() are asynchronous, except when they are no-op.\n// So expect focus to be synchronous when the element is already active,\n// and blur to be synchronous when the element is not already active.\n// (focus and blur are always synchronous in other supported browsers,\n// this just defines when we can count on it).\nfunction expectSync( elem, type ) {\n\treturn ( elem === safeActiveElement() ) === ( type === \"focus\" );\n}\n\n// Support: IE <=9 only\n// Accessing document.activeElement can throw unexpectedly\n// https://bugs.jquery.com/ticket/13393\nfunction safeActiveElement() {\n\ttry {\n\t\treturn document.activeElement;\n\t} catch ( err ) { }\n}\n\nfunction on( elem, types, selector, data, fn, one ) {\n\tvar origFn, type;\n\n\t// Types can be a map of types/handlers\n\tif ( typeof types === \"object\" ) {\n\n\t\t// ( types-Object, selector, data )\n\t\tif ( typeof selector !== \"string\" ) {\n\n\t\t\t// ( types-Object, data )\n\t\t\tdata = data || selector;\n\t\t\tselector = undefined;\n\t\t}\n\t\tfor ( type in types ) {\n\t\t\ton( elem, type, selector, data, types[ type ], one );\n\t\t}\n\t\treturn elem;\n\t}\n\n\tif ( data == null && fn == null ) {\n\n\t\t// ( types, fn )\n\t\tfn = selector;\n\t\tdata = selector = undefined;\n\t} else if ( fn == null ) {\n\t\tif ( typeof selector === \"string\" ) {\n\n\t\t\t// ( types, selector, fn )\n\t\t\tfn = data;\n\t\t\tdata = undefined;\n\t\t} else {\n\n\t\t\t// ( types, data, fn )\n\t\t\tfn = data;\n\t\t\tdata = selector;\n\t\t\tselector = undefined;\n\t\t}\n\t}\n\tif ( fn === false ) {\n\t\tfn = returnFalse;\n\t} else if ( !fn ) {\n\t\treturn elem;\n\t}\n\n\tif ( one === 1 ) {\n\t\torigFn = fn;\n\t\tfn = function( event ) {\n\n\t\t\t// Can use an empty set, since event contains the info\n\t\t\tjQuery().off( event );\n\t\t\treturn origFn.apply( this, arguments );\n\t\t};\n\n\t\t// Use same guid so caller can remove using origFn\n\t\tfn.guid = origFn.guid || ( origFn.guid = jQuery.guid++ );\n\t}\n\treturn elem.each( function() {\n\t\tjQuery.event.add( this, types, fn, data, selector );\n\t} );\n}\n\n/*\n * Helper functions for managing events -- not part of the public interface.\n * Props to Dean Edwards' addEvent library for many of the ideas.\n */\njQuery.event = {\n\n\tglobal: {},\n\n\tadd: function( elem, types, handler, data, selector ) {\n\n\t\tvar handleObjIn, eventHandle, tmp,\n\t\t\tevents, t, handleObj,\n\t\t\tspecial, handlers, type, namespaces, origType,\n\t\t\telemData = dataPriv.get( elem );\n\n\t\t// Don't attach events to noData or text/comment nodes (but allow plain objects)\n\t\tif ( !elemData ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Caller can pass in an object of custom data in lieu of the handler\n\t\tif ( handler.handler ) {\n\t\t\thandleObjIn = handler;\n\t\t\thandler = handleObjIn.handler;\n\t\t\tselector = handleObjIn.selector;\n\t\t}\n\n\t\t// Ensure that invalid selectors throw exceptions at attach time\n\t\t// Evaluate against documentElement in case elem is a non-element node (e.g., document)\n\t\tif ( selector ) {\n\t\t\tjQuery.find.matchesSelector( documentElement, selector );\n\t\t}\n\n\t\t// Make sure that the handler has a unique ID, used to find/remove it later\n\t\tif ( !handler.guid ) {\n\t\t\thandler.guid = jQuery.guid++;\n\t\t}\n\n\t\t// Init the element's event structure and main handler, if this is the first\n\t\tif ( !( events = elemData.events ) ) {\n\t\t\tevents = elemData.events = {};\n\t\t}\n\t\tif ( !( eventHandle = elemData.handle ) ) {\n\t\t\teventHandle = elemData.handle = function( e ) {\n\n\t\t\t\t// Discard the second event of a jQuery.event.trigger() and\n\t\t\t\t// when an event is called after a page has unloaded\n\t\t\t\treturn typeof jQuery !== \"undefined\" && jQuery.event.triggered !== e.type ?\n\t\t\t\t\tjQuery.event.dispatch.apply( elem, arguments ) : undefined;\n\t\t\t};\n\t\t}\n\n\t\t// Handle multiple events separated by a space\n\t\ttypes = ( types || \"\" ).match( rnothtmlwhite ) || [ \"\" ];\n\t\tt = types.length;\n\t\twhile ( t-- ) {\n\t\t\ttmp = rtypenamespace.exec( types[ t ] ) || [];\n\t\t\ttype = origType = tmp[ 1 ];\n\t\t\tnamespaces = ( tmp[ 2 ] || \"\" ).split( \".\" ).sort();\n\n\t\t\t// There *must* be a type, no attaching namespace-only handlers\n\t\t\tif ( !type ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// If event changes its type, use the special event handlers for the changed type\n\t\t\tspecial = jQuery.event.special[ type ] || {};\n\n\t\t\t// If selector defined, determine special event api type, otherwise given type\n\t\t\ttype = ( selector ? special.delegateType : special.bindType ) || type;\n\n\t\t\t// Update special based on newly reset type\n\t\t\tspecial = jQuery.event.special[ type ] || {};\n\n\t\t\t// handleObj is passed to all event handlers\n\t\t\thandleObj = jQuery.extend( {\n\t\t\t\ttype: type,\n\t\t\t\torigType: origType,\n\t\t\t\tdata: data,\n\t\t\t\thandler: handler,\n\t\t\t\tguid: handler.guid,\n\t\t\t\tselector: selector,\n\t\t\t\tneedsContext: selector && jQuery.expr.match.needsContext.test( selector ),\n\t\t\t\tnamespace: namespaces.join( \".\" )\n\t\t\t}, handleObjIn );\n\n\t\t\t// Init the event handler queue if we're the first\n\t\t\tif ( !( handlers = events[ type ] ) ) {\n\t\t\t\thandlers = events[ type ] = [];\n\t\t\t\thandlers.delegateCount = 0;\n\n\t\t\t\t// Only use addEventListener if the special events handler returns false\n\t\t\t\tif ( !special.setup ||\n\t\t\t\t\tspecial.setup.call( elem, data, namespaces, eventHandle ) === false ) {\n\n\t\t\t\t\tif ( elem.addEventListener ) {\n\t\t\t\t\t\telem.addEventListener( type, eventHandle );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( special.add ) {\n\t\t\t\tspecial.add.call( elem, handleObj );\n\n\t\t\t\tif ( !handleObj.handler.guid ) {\n\t\t\t\t\thandleObj.handler.guid = handler.guid;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Add to the element's handler list, delegates in front\n\t\t\tif ( selector ) {\n\t\t\t\thandlers.splice( handlers.delegateCount++, 0, handleObj );\n\t\t\t} else {\n\t\t\t\thandlers.push( handleObj );\n\t\t\t}\n\n\t\t\t// Keep track of which events have ever been used, for event optimization\n\t\t\tjQuery.event.global[ type ] = true;\n\t\t}\n\n\t},\n\n\t// Detach an event or set of events from an element\n\tremove: function( elem, types, handler, selector, mappedTypes ) {\n\n\t\tvar j, origCount, tmp,\n\t\t\tevents, t, handleObj,\n\t\t\tspecial, handlers, type, namespaces, origType,\n\t\t\telemData = dataPriv.hasData( elem ) && dataPriv.get( elem );\n\n\t\tif ( !elemData || !( events = elemData.events ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Once for each type.namespace in types; type may be omitted\n\t\ttypes = ( types || \"\" ).match( rnothtmlwhite ) || [ \"\" ];\n\t\tt = types.length;\n\t\twhile ( t-- ) {\n\t\t\ttmp = rtypenamespace.exec( types[ t ] ) || [];\n\t\t\ttype = origType = tmp[ 1 ];\n\t\t\tnamespaces = ( tmp[ 2 ] || \"\" ).split( \".\" ).sort();\n\n\t\t\t// Unbind all events (on this namespace, if provided) for the element\n\t\t\tif ( !type ) {\n\t\t\t\tfor ( type in events ) {\n\t\t\t\t\tjQuery.event.remove( elem, type + types[ t ], handler, selector, true );\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tspecial = jQuery.event.special[ type ] || {};\n\t\t\ttype = ( selector ? special.delegateType : special.bindType ) || type;\n\t\t\thandlers = events[ type ] || [];\n\t\t\ttmp = tmp[ 2 ] &&\n\t\t\t\tnew RegExp( \"(^|\\\\.)\" + namespaces.join( \"\\\\.(?:.*\\\\.|)\" ) + \"(\\\\.|$)\" );\n\n\t\t\t// Remove matching events\n\t\t\torigCount = j = handlers.length;\n\t\t\twhile ( j-- ) {\n\t\t\t\thandleObj = handlers[ j ];\n\n\t\t\t\tif ( ( mappedTypes || origType === handleObj.origType ) &&\n\t\t\t\t\t( !handler || handler.guid === handleObj.guid ) &&\n\t\t\t\t\t( !tmp || tmp.test( handleObj.namespace ) ) &&\n\t\t\t\t\t( !selector || selector === handleObj.selector ||\n\t\t\t\t\t\tselector === \"**\" && handleObj.selector ) ) {\n\t\t\t\t\thandlers.splice( j, 1 );\n\n\t\t\t\t\tif ( handleObj.selector ) {\n\t\t\t\t\t\thandlers.delegateCount--;\n\t\t\t\t\t}\n\t\t\t\t\tif ( special.remove ) {\n\t\t\t\t\t\tspecial.remove.call( elem, handleObj );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Remove generic event handler if we removed something and no more handlers exist\n\t\t\t// (avoids potential for endless recursion during removal of special event handlers)\n\t\t\tif ( origCount && !handlers.length ) {\n\t\t\t\tif ( !special.teardown ||\n\t\t\t\t\tspecial.teardown.call( elem, namespaces, elemData.handle ) === false ) {\n\n\t\t\t\t\tjQuery.removeEvent( elem, type, elemData.handle );\n\t\t\t\t}\n\n\t\t\t\tdelete events[ type ];\n\t\t\t}\n\t\t}\n\n\t\t// Remove data and the expando if it's no longer used\n\t\tif ( jQuery.isEmptyObject( events ) ) {\n\t\t\tdataPriv.remove( elem, \"handle events\" );\n\t\t}\n\t},\n\n\tdispatch: function( nativeEvent ) {\n\n\t\t// Make a writable jQuery.Event from the native event object\n\t\tvar event = jQuery.event.fix( nativeEvent );\n\n\t\tvar i, j, ret, matched, handleObj, handlerQueue,\n\t\t\targs = new Array( arguments.length ),\n\t\t\thandlers = ( dataPriv.get( this, \"events\" ) || {} )[ event.type ] || [],\n\t\t\tspecial = jQuery.event.special[ event.type ] || {};\n\n\t\t// Use the fix-ed jQuery.Event rather than the (read-only) native event\n\t\targs[ 0 ] = event;\n\n\t\tfor ( i = 1; i < arguments.length; i++ ) {\n\t\t\targs[ i ] = arguments[ i ];\n\t\t}\n\n\t\tevent.delegateTarget = this;\n\n\t\t// Call the preDispatch hook for the mapped type, and let it bail if desired\n\t\tif ( special.preDispatch && special.preDispatch.call( this, event ) === false ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Determine handlers\n\t\thandlerQueue = jQuery.event.handlers.call( this, event, handlers );\n\n\t\t// Run delegates first; they may want to stop propagation beneath us\n\t\ti = 0;\n\t\twhile ( ( matched = handlerQueue[ i++ ] ) && !event.isPropagationStopped() ) {\n\t\t\tevent.currentTarget = matched.elem;\n\n\t\t\tj = 0;\n\t\t\twhile ( ( handleObj = matched.handlers[ j++ ] ) &&\n\t\t\t\t!event.isImmediatePropagationStopped() ) {\n\n\t\t\t\t// If the event is namespaced, then each handler is only invoked if it is\n\t\t\t\t// specially universal or its namespaces are a superset of the event's.\n\t\t\t\tif ( !event.rnamespace || handleObj.namespace === false ||\n\t\t\t\t\tevent.rnamespace.test( handleObj.namespace ) ) {\n\n\t\t\t\t\tevent.handleObj = handleObj;\n\t\t\t\t\tevent.data = handleObj.data;\n\n\t\t\t\t\tret = ( ( jQuery.event.special[ handleObj.origType ] || {} ).handle ||\n\t\t\t\t\t\thandleObj.handler ).apply( matched.elem, args );\n\n\t\t\t\t\tif ( ret !== undefined ) {\n\t\t\t\t\t\tif ( ( event.result = ret ) === false ) {\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Call the postDispatch hook for the mapped type\n\t\tif ( special.postDispatch ) {\n\t\t\tspecial.postDispatch.call( this, event );\n\t\t}\n\n\t\treturn event.result;\n\t},\n\n\thandlers: function( event, handlers ) {\n\t\tvar i, handleObj, sel, matchedHandlers, matchedSelectors,\n\t\t\thandlerQueue = [],\n\t\t\tdelegateCount = handlers.delegateCount,\n\t\t\tcur = event.target;\n\n\t\t// Find delegate handlers\n\t\tif ( delegateCount &&\n\n\t\t\t// Support: IE <=9\n\t\t\t// Black-hole SVG <use> instance trees (trac-13180)\n\t\t\tcur.nodeType &&\n\n\t\t\t// Support: Firefox <=42\n\t\t\t// Suppress spec-violating clicks indicating a non-primary pointer button (trac-3861)\n\t\t\t// https://www.w3.org/TR/DOM-Level-3-Events/#event-type-click\n\t\t\t// Support: IE 11 only\n\t\t\t// ...but not arrow key \"clicks\" of radio inputs, which can have `button` -1 (gh-2343)\n\t\t\t!( event.type === \"click\" && event.button >= 1 ) ) {\n\n\t\t\tfor ( ; cur !== this; cur = cur.parentNode || this ) {\n\n\t\t\t\t// Don't check non-elements (#13208)\n\t\t\t\t// Don't process clicks on disabled elements (#6911, #8165, #11382, #11764)\n\t\t\t\tif ( cur.nodeType === 1 && !( event.type === \"click\" && cur.disabled === true ) ) {\n\t\t\t\t\tmatchedHandlers = [];\n\t\t\t\t\tmatchedSelectors = {};\n\t\t\t\t\tfor ( i = 0; i < delegateCount; i++ ) {\n\t\t\t\t\t\thandleObj = handlers[ i ];\n\n\t\t\t\t\t\t// Don't conflict with Object.prototype properties (#13203)\n\t\t\t\t\t\tsel = handleObj.selector + \" \";\n\n\t\t\t\t\t\tif ( matchedSelectors[ sel ] === undefined ) {\n\t\t\t\t\t\t\tmatchedSelectors[ sel ] = handleObj.needsContext ?\n\t\t\t\t\t\t\t\tjQuery( sel, this ).index( cur ) > -1 :\n\t\t\t\t\t\t\t\tjQuery.find( sel, this, null, [ cur ] ).length;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( matchedSelectors[ sel ] ) {\n\t\t\t\t\t\t\tmatchedHandlers.push( handleObj );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif ( matchedHandlers.length ) {\n\t\t\t\t\t\thandlerQueue.push( { elem: cur, handlers: matchedHandlers } );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Add the remaining (directly-bound) handlers\n\t\tcur = this;\n\t\tif ( delegateCount < handlers.length ) {\n\t\t\thandlerQueue.push( { elem: cur, handlers: handlers.slice( delegateCount ) } );\n\t\t}\n\n\t\treturn handlerQueue;\n\t},\n\n\taddProp: function( name, hook ) {\n\t\tObject.defineProperty( jQuery.Event.prototype, name, {\n\t\t\tenumerable: true,\n\t\t\tconfigurable: true,\n\n\t\t\tget: isFunction( hook ) ?\n\t\t\t\tfunction() {\n\t\t\t\t\tif ( this.originalEvent ) {\n\t\t\t\t\t\t\treturn hook( this.originalEvent );\n\t\t\t\t\t}\n\t\t\t\t} :\n\t\t\t\tfunction() {\n\t\t\t\t\tif ( this.originalEvent ) {\n\t\t\t\t\t\t\treturn this.originalEvent[ name ];\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\tset: function( value ) {\n\t\t\t\tObject.defineProperty( this, name, {\n\t\t\t\t\tenumerable: true,\n\t\t\t\t\tconfigurable: true,\n\t\t\t\t\twritable: true,\n\t\t\t\t\tvalue: value\n\t\t\t\t} );\n\t\t\t}\n\t\t} );\n\t},\n\n\tfix: function( originalEvent ) {\n\t\treturn originalEvent[ jQuery.expando ] ?\n\t\t\toriginalEvent :\n\t\t\tnew jQuery.Event( originalEvent );\n\t},\n\n\tspecial: {\n\t\tload: {\n\n\t\t\t// Prevent triggered image.load events from bubbling to window.load\n\t\t\tnoBubble: true\n\t\t},\n\t\tclick: {\n\n\t\t\t// Utilize native event to ensure correct state for checkable inputs\n\t\t\tsetup: function( data ) {\n\n\t\t\t\t// For mutual compressibility with _default, replace `this` access with a local var.\n\t\t\t\t// `|| data` is dead code meant only to preserve the variable through minification.\n\t\t\t\tvar el = this || data;\n\n\t\t\t\t// Claim the first handler\n\t\t\t\tif ( rcheckableType.test( el.type ) &&\n\t\t\t\t\tel.click && nodeName( el, \"input\" ) &&\n\t\t\t\t\tdataPriv.get( el, \"click\" ) === undefined ) {\n\n\t\t\t\t\t// dataPriv.set( el, \"click\", ... )\n\t\t\t\t\tleverageNative( el, \"click\", returnTrue );\n\t\t\t\t}\n\n\t\t\t\t// Return false to allow normal processing in the caller\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\ttrigger: function( data ) {\n\n\t\t\t\t// For mutual compressibility with _default, replace `this` access with a local var.\n\t\t\t\t// `|| data` is dead code meant only to preserve the variable through minification.\n\t\t\t\tvar el = this || data;\n\n\t\t\t\t// Force setup before triggering a click\n\t\t\t\tif ( rcheckableType.test( el.type ) &&\n\t\t\t\t\tel.click && nodeName( el, \"input\" ) &&\n\t\t\t\t\tdataPriv.get( el, \"click\" ) === undefined ) {\n\n\t\t\t\t\tleverageNative( el, \"click\" );\n\t\t\t\t}\n\n\t\t\t\t// Return non-false to allow normal event-path propagation\n\t\t\t\treturn true;\n\t\t\t},\n\n\t\t\t// For cross-browser consistency, suppress native .click() on links\n\t\t\t// Also prevent it if we're currently inside a leveraged native-event stack\n\t\t\t_default: function( event ) {\n\t\t\t\tvar target = event.target;\n\t\t\t\treturn rcheckableType.test( target.type ) &&\n\t\t\t\t\ttarget.click && nodeName( target, \"input\" ) &&\n\t\t\t\t\tdataPriv.get( target, \"click\" ) ||\n\t\t\t\t\tnodeName( target, \"a\" );\n\t\t\t}\n\t\t},\n\n\t\tbeforeunload: {\n\t\t\tpostDispatch: function( event ) {\n\n\t\t\t\t// Support: Firefox 20+\n\t\t\t\t// Firefox doesn't alert if the returnValue field is not set.\n\t\t\t\tif ( event.result !== undefined && event.originalEvent ) {\n\t\t\t\t\tevent.originalEvent.returnValue = event.result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n\n// Ensure the presence of an event listener that handles manually-triggered\n// synthetic events by interrupting progress until reinvoked in response to\n// *native* events that it fires directly, ensuring that state changes have\n// already occurred before other listeners are invoked.\nfunction leverageNative( el, type, expectSync ) {\n\n\t// Missing expectSync indicates a trigger call, which must force setup through jQuery.event.add\n\tif ( !expectSync ) {\n\t\tjQuery.event.add( el, type, returnTrue );\n\t\treturn;\n\t}\n\n\t// Register the controller as a special universal handler for all event namespaces\n\tdataPriv.set( el, type, false );\n\tjQuery.event.add( el, type, {\n\t\tnamespace: false,\n\t\thandler: function( event ) {\n\t\t\tvar notAsync, result,\n\t\t\t\tsaved = dataPriv.get( this, type );\n\n\t\t\tif ( ( event.isTrigger & 1 ) && this[ type ] ) {\n\n\t\t\t\t// Interrupt processing of the outer synthetic .trigger()ed event\n\t\t\t\tif ( !saved ) {\n\n\t\t\t\t\t// Store arguments for use when handling the inner native event\n\t\t\t\t\tsaved = slice.call( arguments );\n\t\t\t\t\tdataPriv.set( this, type, saved );\n\n\t\t\t\t\t// Trigger the native event and capture its result\n\t\t\t\t\t// Support: IE <=9 - 11+\n\t\t\t\t\t// focus() and blur() are asynchronous\n\t\t\t\t\tnotAsync = expectSync( this, type );\n\t\t\t\t\tthis[ type ]();\n\t\t\t\t\tresult = dataPriv.get( this, type );\n\t\t\t\t\tif ( saved !== result || notAsync ) {\n\t\t\t\t\t\tdataPriv.set( this, type, false );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult = undefined;\n\t\t\t\t\t}\n\t\t\t\t\tif ( saved !== result ) {\n\n\t\t\t\t\t\t// Cancel the outer synthetic event\n\t\t\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\n\t\t\t\t// If this is an inner synthetic event for an event with a bubbling surrogate\n\t\t\t\t// (focus or blur), assume that the surrogate already propagated from triggering the\n\t\t\t\t// native event and prevent that from happening again here.\n\t\t\t\t// This technically gets the ordering wrong w.r.t. to `.trigger()` (in which the\n\t\t\t\t// bubbling surrogate propagates *after* the non-bubbling base), but that seems\n\t\t\t\t// less bad than duplication.\n\t\t\t\t} else if ( ( jQuery.event.special[ type ] || {} ).delegateType ) {\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t}\n\n\t\t\t// If this is a native event triggered above, everything is now in order\n\t\t\t// Fire an inner synthetic event with the original arguments\n\t\t\t} else if ( saved ) {\n\n\t\t\t\t// ...and capture the result\n\t\t\t\tdataPriv.set( this, type, jQuery.event.trigger(\n\n\t\t\t\t\t// Support: IE <=9 - 11+\n\t\t\t\t\t// Extend with the prototype to reset the above stopImmediatePropagation()\n\t\t\t\t\tjQuery.extend( saved.shift(), jQuery.Event.prototype ),\n\t\t\t\t\tsaved,\n\t\t\t\t\tthis\n\t\t\t\t) );\n\n\t\t\t\t// Abort handling of the native event\n\t\t\t\tevent.stopImmediatePropagation();\n\t\t\t}\n\t\t}\n\t} );\n}\n\njQuery.removeEvent = function( elem, type, handle ) {\n\n\t// This \"if\" is needed for plain objects\n\tif ( elem.removeEventListener ) {\n\t\telem.removeEventListener( type, handle );\n\t}\n};\n\njQuery.Event = function( src, props ) {\n\n\t// Allow instantiation without the 'new' keyword\n\tif ( !( this instanceof jQuery.Event ) ) {\n\t\treturn new jQuery.Event( src, props );\n\t}\n\n\t// Event object\n\tif ( src && src.type ) {\n\t\tthis.originalEvent = src;\n\t\tthis.type = src.type;\n\n\t\t// Events bubbling up the document may have been marked as prevented\n\t\t// by a handler lower down the tree; reflect the correct value.\n\t\tthis.isDefaultPrevented = src.defaultPrevented ||\n\t\t\t\tsrc.defaultPrevented === undefined &&\n\n\t\t\t\t// Support: Android <=2.3 only\n\t\t\t\tsrc.returnValue === false ?\n\t\t\treturnTrue :\n\t\t\treturnFalse;\n\n\t\t// Create target properties\n\t\t// Support: Safari <=6 - 7 only\n\t\t// Target should not be a text node (#504, #13143)\n\t\tthis.target = ( src.target && src.target.nodeType === 3 ) ?\n\t\t\tsrc.target.parentNode :\n\t\t\tsrc.target;\n\n\t\tthis.currentTarget = src.currentTarget;\n\t\tthis.relatedTarget = src.relatedTarget;\n\n\t// Event type\n\t} else {\n\t\tthis.type = src;\n\t}\n\n\t// Put explicitly provided properties onto the event object\n\tif ( props ) {\n\t\tjQuery.extend( this, props );\n\t}\n\n\t// Create a timestamp if incoming event doesn't have one\n\tthis.timeStamp = src && src.timeStamp || Date.now();\n\n\t// Mark it as fixed\n\tthis[ jQuery.expando ] = true;\n};\n\n// jQuery.Event is based on DOM3 Events as specified by the ECMAScript Language Binding\n// https://www.w3.org/TR/2003/WD-DOM-Level-3-Events-20030331/ecma-script-binding.html\njQuery.Event.prototype = {\n\tconstructor: jQuery.Event,\n\tisDefaultPrevented: returnFalse,\n\tisPropagationStopped: returnFalse,\n\tisImmediatePropagationStopped: returnFalse,\n\tisSimulated: false,\n\n\tpreventDefault: function() {\n\t\tvar e = this.originalEvent;\n\n\t\tthis.isDefaultPrevented = returnTrue;\n\n\t\tif ( e && !this.isSimulated ) {\n\t\t\te.preventDefault();\n\t\t}\n\t},\n\tstopPropagation: function() {\n\t\tvar e = this.originalEvent;\n\n\t\tthis.isPropagationStopped = returnTrue;\n\n\t\tif ( e && !this.isSimulated ) {\n\t\t\te.stopPropagation();\n\t\t}\n\t},\n\tstopImmediatePropagation: function() {\n\t\tvar e = this.originalEvent;\n\n\t\tthis.isImmediatePropagationStopped = returnTrue;\n\n\t\tif ( e && !this.isSimulated ) {\n\t\t\te.stopImmediatePropagation();\n\t\t}\n\n\t\tthis.stopPropagation();\n\t}\n};\n\n// Includes all common event props including KeyEvent and MouseEvent specific props\njQuery.each( {\n\taltKey: true,\n\tbubbles: true,\n\tcancelable: true,\n\tchangedTouches: true,\n\tctrlKey: true,\n\tdetail: true,\n\teventPhase: true,\n\tmetaKey: true,\n\tpageX: true,\n\tpageY: true,\n\tshiftKey: true,\n\tview: true,\n\t\"char\": true,\n\tcode: true,\n\tcharCode: true,\n\tkey: true,\n\tkeyCode: true,\n\tbutton: true,\n\tbuttons: true,\n\tclientX: true,\n\tclientY: true,\n\toffsetX: true,\n\toffsetY: true,\n\tpointerId: true,\n\tpointerType: true,\n\tscreenX: true,\n\tscreenY: true,\n\ttargetTouches: true,\n\ttoElement: true,\n\ttouches: true,\n\n\twhich: function( event ) {\n\t\tvar button = event.button;\n\n\t\t// Add which for key events\n\t\tif ( event.which == null && rkeyEvent.test( event.type ) ) {\n\t\t\treturn event.charCode != null ? event.charCode : event.keyCode;\n\t\t}\n\n\t\t// Add which for click: 1 === left; 2 === middle; 3 === right\n\t\tif ( !event.which && button !== undefined && rmouseEvent.test( event.type ) ) {\n\t\t\tif ( button & 1 ) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\tif ( button & 2 ) {\n\t\t\t\treturn 3;\n\t\t\t}\n\n\t\t\tif ( button & 4 ) {\n\t\t\t\treturn 2;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t}\n\n\t\treturn event.which;\n\t}\n}, jQuery.event.addProp );\n\njQuery.each( { focus: \"focusin\", blur: \"focusout\" }, function( type, delegateType ) {\n\tjQuery.event.special[ type ] = {\n\n\t\t// Utilize native event if possible so blur/focus sequence is correct\n\t\tsetup: function() {\n\n\t\t\t// Claim the first handler\n\t\t\t// dataPriv.set( this, \"focus\", ... )\n\t\t\t// dataPriv.set( this, \"blur\", ... )\n\t\t\tleverageNative( this, type, expectSync );\n\n\t\t\t// Return false to allow normal processing in the caller\n\t\t\treturn false;\n\t\t},\n\t\ttrigger: function() {\n\n\t\t\t// Force setup before trigger\n\t\t\tleverageNative( this, type );\n\n\t\t\t// Return non-false to allow normal event-path propagation\n\t\t\treturn true;\n\t\t},\n\n\t\tdelegateType: delegateType\n\t};\n} );\n\n// Create mouseenter/leave events using mouseover/out and event-time checks\n// so that event delegation works in jQuery.\n// Do the same for pointerenter/pointerleave and pointerover/pointerout\n//\n// Support: Safari 7 only\n// Safari sends mouseenter too often; see:\n// https://bugs.chromium.org/p/chromium/issues/detail?id=470258\n// for the description of the bug (it existed in older Chrome versions as well).\njQuery.each( {\n\tmouseenter: \"mouseover\",\n\tmouseleave: \"mouseout\",\n\tpointerenter: \"pointerover\",\n\tpointerleave: \"pointerout\"\n}, function( orig, fix ) {\n\tjQuery.event.special[ orig ] = {\n\t\tdelegateType: fix,\n\t\tbindType: fix,\n\n\t\thandle: function( event ) {\n\t\t\tvar ret,\n\t\t\t\ttarget = this,\n\t\t\t\trelated = event.relatedTarget,\n\t\t\t\thandleObj = event.handleObj;\n\n\t\t\t// For mouseenter/leave call the handler if related is outside the target.\n\t\t\t// NB: No relatedTarget if the mouse left/entered the browser window\n\t\t\tif ( !related || ( related !== target && !jQuery.contains( target, related ) ) ) {\n\t\t\t\tevent.type = handleObj.origType;\n\t\t\t\tret = handleObj.handler.apply( this, arguments );\n\t\t\t\tevent.type = fix;\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\t};\n} );\n\njQuery.fn.extend( {\n\n\ton: function( types, selector, data, fn ) {\n\t\treturn on( this, types, selector, data, fn );\n\t},\n\tone: function( types, selector, data, fn ) {\n\t\treturn on( this, types, selector, data, fn, 1 );\n\t},\n\toff: function( types, selector, fn ) {\n\t\tvar handleObj, type;\n\t\tif ( types && types.preventDefault && types.handleObj ) {\n\n\t\t\t// ( event )  dispatched jQuery.Event\n\t\t\thandleObj = types.handleObj;\n\t\t\tjQuery( types.delegateTarget ).off(\n\t\t\t\thandleObj.namespace ?\n\t\t\t\t\thandleObj.origType + \".\" + handleObj.namespace :\n\t\t\t\t\thandleObj.origType,\n\t\t\t\thandleObj.selector,\n\t\t\t\thandleObj.handler\n\t\t\t);\n\t\t\treturn this;\n\t\t}\n\t\tif ( typeof types === \"object\" ) {\n\n\t\t\t// ( types-object [, selector] )\n\t\t\tfor ( type in types ) {\n\t\t\t\tthis.off( type, selector, types[ type ] );\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\t\tif ( selector === false || typeof selector === \"function\" ) {\n\n\t\t\t// ( types [, fn] )\n\t\t\tfn = selector;\n\t\t\tselector = undefined;\n\t\t}\n\t\tif ( fn === false ) {\n\t\t\tfn = returnFalse;\n\t\t}\n\t\treturn this.each( function() {\n\t\t\tjQuery.event.remove( this, types, fn, selector );\n\t\t} );\n\t}\n} );\n\n\nvar\n\n\t/* eslint-disable max-len */\n\n\t// See https://github.com/eslint/eslint/issues/3229\n\trxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\\/\\0>\\x20\\t\\r\\n\\f]*)[^>]*)\\/>/gi,\n\n\t/* eslint-enable */\n\n\t// Support: IE <=10 - 11, Edge 12 - 13 only\n\t// In IE/Edge using regex groups here causes severe slowdowns.\n\t// See https://connect.microsoft.com/IE/feedback/details/1736512/\n\trnoInnerhtml = /<script|<style|<link/i,\n\n\t// checked=\"checked\" or checked\n\trchecked = /checked\\s*(?:[^=]|=\\s*.checked.)/i,\n\trcleanScript = /^\\s*<!(?:\\[CDATA\\[|--)|(?:\\]\\]|--)>\\s*$/g;\n\n// Prefer a tbody over its parent table for containing new rows\nfunction manipulationTarget( elem, content ) {\n\tif ( nodeName( elem, \"table\" ) &&\n\t\tnodeName( content.nodeType !== 11 ? content : content.firstChild, \"tr\" ) ) {\n\n\t\treturn jQuery( elem ).children( \"tbody\" )[ 0 ] || elem;\n\t}\n\n\treturn elem;\n}\n\n// Replace/restore the type attribute of script elements for safe DOM manipulation\nfunction disableScript( elem ) {\n\telem.type = ( elem.getAttribute( \"type\" ) !== null ) + \"/\" + elem.type;\n\treturn elem;\n}\nfunction restoreScript( elem ) {\n\tif ( ( elem.type || \"\" ).slice( 0, 5 ) === \"true/\" ) {\n\t\telem.type = elem.type.slice( 5 );\n\t} else {\n\t\telem.removeAttribute( \"type\" );\n\t}\n\n\treturn elem;\n}\n\nfunction cloneCopyEvent( src, dest ) {\n\tvar i, l, type, pdataOld, pdataCur, udataOld, udataCur, events;\n\n\tif ( dest.nodeType !== 1 ) {\n\t\treturn;\n\t}\n\n\t// 1. Copy private data: events, handlers, etc.\n\tif ( dataPriv.hasData( src ) ) {\n\t\tpdataOld = dataPriv.access( src );\n\t\tpdataCur = dataPriv.set( dest, pdataOld );\n\t\tevents = pdataOld.events;\n\n\t\tif ( events ) {\n\t\t\tdelete pdataCur.handle;\n\t\t\tpdataCur.events = {};\n\n\t\t\tfor ( type in events ) {\n\t\t\t\tfor ( i = 0, l = events[ type ].length; i < l; i++ ) {\n\t\t\t\t\tjQuery.event.add( dest, type, events[ type ][ i ] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// 2. Copy user data\n\tif ( dataUser.hasData( src ) ) {\n\t\tudataOld = dataUser.access( src );\n\t\tudataCur = jQuery.extend( {}, udataOld );\n\n\t\tdataUser.set( dest, udataCur );\n\t}\n}\n\n// Fix IE bugs, see support tests\nfunction fixInput( src, dest ) {\n\tvar nodeName = dest.nodeName.toLowerCase();\n\n\t// Fails to persist the checked state of a cloned checkbox or radio button.\n\tif ( nodeName === \"input\" && rcheckableType.test( src.type ) ) {\n\t\tdest.checked = src.checked;\n\n\t// Fails to return the selected option to the default selected state when cloning options\n\t} else if ( nodeName === \"input\" || nodeName === \"textarea\" ) {\n\t\tdest.defaultValue = src.defaultValue;\n\t}\n}\n\nfunction domManip( collection, args, callback, ignored ) {\n\n\t// Flatten any nested arrays\n\targs = concat.apply( [], args );\n\n\tvar fragment, first, scripts, hasScripts, node, doc,\n\t\ti = 0,\n\t\tl = collection.length,\n\t\tiNoClone = l - 1,\n\t\tvalue = args[ 0 ],\n\t\tvalueIsFunction = isFunction( value );\n\n\t// We can't cloneNode fragments that contain checked, in WebKit\n\tif ( valueIsFunction ||\n\t\t\t( l > 1 && typeof value === \"string\" &&\n\t\t\t\t!support.checkClone && rchecked.test( value ) ) ) {\n\t\treturn collection.each( function( index ) {\n\t\t\tvar self = collection.eq( index );\n\t\t\tif ( valueIsFunction ) {\n\t\t\t\targs[ 0 ] = value.call( this, index, self.html() );\n\t\t\t}\n\t\t\tdomManip( self, args, callback, ignored );\n\t\t} );\n\t}\n\n\tif ( l ) {\n\t\tfragment = buildFragment( args, collection[ 0 ].ownerDocument, false, collection, ignored );\n\t\tfirst = fragment.firstChild;\n\n\t\tif ( fragment.childNodes.length === 1 ) {\n\t\t\tfragment = first;\n\t\t}\n\n\t\t// Require either new content or an interest in ignored elements to invoke the callback\n\t\tif ( first || ignored ) {\n\t\t\tscripts = jQuery.map( getAll( fragment, \"script\" ), disableScript );\n\t\t\thasScripts = scripts.length;\n\n\t\t\t// Use the original fragment for the last item\n\t\t\t// instead of the first because it can end up\n\t\t\t// being emptied incorrectly in certain situations (#8070).\n\t\t\tfor ( ; i < l; i++ ) {\n\t\t\t\tnode = fragment;\n\n\t\t\t\tif ( i !== iNoClone ) {\n\t\t\t\t\tnode = jQuery.clone( node, true, true );\n\n\t\t\t\t\t// Keep references to cloned scripts for later restoration\n\t\t\t\t\tif ( hasScripts ) {\n\n\t\t\t\t\t\t// Support: Android <=4.0 only, PhantomJS 1 only\n\t\t\t\t\t\t// push.apply(_, arraylike) throws on ancient WebKit\n\t\t\t\t\t\tjQuery.merge( scripts, getAll( node, \"script\" ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tcallback.call( collection[ i ], node, i );\n\t\t\t}\n\n\t\t\tif ( hasScripts ) {\n\t\t\t\tdoc = scripts[ scripts.length - 1 ].ownerDocument;\n\n\t\t\t\t// Reenable scripts\n\t\t\t\tjQuery.map( scripts, restoreScript );\n\n\t\t\t\t// Evaluate executable scripts on first document insertion\n\t\t\t\tfor ( i = 0; i < hasScripts; i++ ) {\n\t\t\t\t\tnode = scripts[ i ];\n\t\t\t\t\tif ( rscriptType.test( node.type || \"\" ) &&\n\t\t\t\t\t\t!dataPriv.access( node, \"globalEval\" ) &&\n\t\t\t\t\t\tjQuery.contains( doc, node ) ) {\n\n\t\t\t\t\t\tif ( node.src && ( node.type || \"\" ).toLowerCase()  !== \"module\" ) {\n\n\t\t\t\t\t\t\t// Optional AJAX dependency, but won't run scripts if not present\n\t\t\t\t\t\t\tif ( jQuery._evalUrl && !node.noModule ) {\n\t\t\t\t\t\t\t\tjQuery._evalUrl( node.src, {\n\t\t\t\t\t\t\t\t\tnonce: node.nonce || node.getAttribute( \"nonce\" )\n\t\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tDOMEval( node.textContent.replace( rcleanScript, \"\" ), node, doc );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn collection;\n}\n\nfunction remove( elem, selector, keepData ) {\n\tvar node,\n\t\tnodes = selector ? jQuery.filter( selector, elem ) : elem,\n\t\ti = 0;\n\n\tfor ( ; ( node = nodes[ i ] ) != null; i++ ) {\n\t\tif ( !keepData && node.nodeType === 1 ) {\n\t\t\tjQuery.cleanData( getAll( node ) );\n\t\t}\n\n\t\tif ( node.parentNode ) {\n\t\t\tif ( keepData && isAttached( node ) ) {\n\t\t\t\tsetGlobalEval( getAll( node, \"script\" ) );\n\t\t\t}\n\t\t\tnode.parentNode.removeChild( node );\n\t\t}\n\t}\n\n\treturn elem;\n}\n\njQuery.extend( {\n\thtmlPrefilter: function( html ) {\n\t\treturn html.replace( rxhtmlTag, \"<$1></$2>\" );\n\t},\n\n\tclone: function( elem, dataAndEvents, deepDataAndEvents ) {\n\t\tvar i, l, srcElements, destElements,\n\t\t\tclone = elem.cloneNode( true ),\n\t\t\tinPage = isAttached( elem );\n\n\t\t// Fix IE cloning issues\n\t\tif ( !support.noCloneChecked && ( elem.nodeType === 1 || elem.nodeType === 11 ) &&\n\t\t\t\t!jQuery.isXMLDoc( elem ) ) {\n\n\t\t\t// We eschew Sizzle here for performance reasons: https://jsperf.com/getall-vs-sizzle/2\n\t\t\tdestElements = getAll( clone );\n\t\t\tsrcElements = getAll( elem );\n\n\t\t\tfor ( i = 0, l = srcElements.length; i < l; i++ ) {\n\t\t\t\tfixInput( srcElements[ i ], destElements[ i ] );\n\t\t\t}\n\t\t}\n\n\t\t// Copy the events from the original to the clone\n\t\tif ( dataAndEvents ) {\n\t\t\tif ( deepDataAndEvents ) {\n\t\t\t\tsrcElements = srcElements || getAll( elem );\n\t\t\t\tdestElements = destElements || getAll( clone );\n\n\t\t\t\tfor ( i = 0, l = srcElements.length; i < l; i++ ) {\n\t\t\t\t\tcloneCopyEvent( srcElements[ i ], destElements[ i ] );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcloneCopyEvent( elem, clone );\n\t\t\t}\n\t\t}\n\n\t\t// Preserve script evaluation history\n\t\tdestElements = getAll( clone, \"script\" );\n\t\tif ( destElements.length > 0 ) {\n\t\t\tsetGlobalEval( destElements, !inPage && getAll( elem, \"script\" ) );\n\t\t}\n\n\t\t// Return the cloned set\n\t\treturn clone;\n\t},\n\n\tcleanData: function( elems ) {\n\t\tvar data, elem, type,\n\t\t\tspecial = jQuery.event.special,\n\t\t\ti = 0;\n\n\t\tfor ( ; ( elem = elems[ i ] ) !== undefined; i++ ) {\n\t\t\tif ( acceptData( elem ) ) {\n\t\t\t\tif ( ( data = elem[ dataPriv.expando ] ) ) {\n\t\t\t\t\tif ( data.events ) {\n\t\t\t\t\t\tfor ( type in data.events ) {\n\t\t\t\t\t\t\tif ( special[ type ] ) {\n\t\t\t\t\t\t\t\tjQuery.event.remove( elem, type );\n\n\t\t\t\t\t\t\t// This is a shortcut to avoid jQuery.event.remove's overhead\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tjQuery.removeEvent( elem, type, data.handle );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Support: Chrome <=35 - 45+\n\t\t\t\t\t// Assign undefined instead of using delete, see Data#remove\n\t\t\t\t\telem[ dataPriv.expando ] = undefined;\n\t\t\t\t}\n\t\t\t\tif ( elem[ dataUser.expando ] ) {\n\n\t\t\t\t\t// Support: Chrome <=35 - 45+\n\t\t\t\t\t// Assign undefined instead of using delete, see Data#remove\n\t\t\t\t\telem[ dataUser.expando ] = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n} );\n\njQuery.fn.extend( {\n\tdetach: function( selector ) {\n\t\treturn remove( this, selector, true );\n\t},\n\n\tremove: function( selector ) {\n\t\treturn remove( this, selector );\n\t},\n\n\ttext: function( value ) {\n\t\treturn access( this, function( value ) {\n\t\t\treturn value === undefined ?\n\t\t\t\tjQuery.text( this ) :\n\t\t\t\tthis.empty().each( function() {\n\t\t\t\t\tif ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {\n\t\t\t\t\t\tthis.textContent = value;\n\t\t\t\t\t}\n\t\t\t\t} );\n\t\t}, null, value, arguments.length );\n\t},\n\n\tappend: function() {\n\t\treturn domManip( this, arguments, function( elem ) {\n\t\t\tif ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {\n\t\t\t\tvar target = manipulationTarget( this, elem );\n\t\t\t\ttarget.appendChild( elem );\n\t\t\t}\n\t\t} );\n\t},\n\n\tprepend: function() {\n\t\treturn domManip( this, arguments, function( elem ) {\n\t\t\tif ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {\n\t\t\t\tvar target = manipulationTarget( this, elem );\n\t\t\t\ttarget.insertBefore( elem, target.firstChild );\n\t\t\t}\n\t\t} );\n\t},\n\n\tbefore: function() {\n\t\treturn domManip( this, arguments, function( elem ) {\n\t\t\tif ( this.parentNode ) {\n\t\t\t\tthis.parentNode.insertBefore( elem, this );\n\t\t\t}\n\t\t} );\n\t},\n\n\tafter: function() {\n\t\treturn domManip( this, arguments, function( elem ) {\n\t\t\tif ( this.parentNode ) {\n\t\t\t\tthis.parentNode.insertBefore( elem, this.nextSibling );\n\t\t\t}\n\t\t} );\n\t},\n\n\tempty: function() {\n\t\tvar elem,\n\t\t\ti = 0;\n\n\t\tfor ( ; ( elem = this[ i ] ) != null; i++ ) {\n\t\t\tif ( elem.nodeType === 1 ) {\n\n\t\t\t\t// Prevent memory leaks\n\t\t\t\tjQuery.cleanData( getAll( elem, false ) );\n\n\t\t\t\t// Remove any remaining nodes\n\t\t\t\telem.textContent = \"\";\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tclone: function( dataAndEvents, deepDataAndEvents ) {\n\t\tdataAndEvents = dataAndEvents == null ? false : dataAndEvents;\n\t\tdeepDataAndEvents = deepDataAndEvents == null ? dataAndEvents : deepDataAndEvents;\n\n\t\treturn this.map( function() {\n\t\t\treturn jQuery.clone( this, dataAndEvents, deepDataAndEvents );\n\t\t} );\n\t},\n\n\thtml: function( value ) {\n\t\treturn access( this, function( value ) {\n\t\t\tvar elem = this[ 0 ] || {},\n\t\t\t\ti = 0,\n\t\t\t\tl = this.length;\n\n\t\t\tif ( value === undefined && elem.nodeType === 1 ) {\n\t\t\t\treturn elem.innerHTML;\n\t\t\t}\n\n\t\t\t// See if we can take a shortcut and just use innerHTML\n\t\t\tif ( typeof value === \"string\" && !rnoInnerhtml.test( value ) &&\n\t\t\t\t!wrapMap[ ( rtagName.exec( value ) || [ \"\", \"\" ] )[ 1 ].toLowerCase() ] ) {\n\n\t\t\t\tvalue = jQuery.htmlPrefilter( value );\n\n\t\t\t\ttry {\n\t\t\t\t\tfor ( ; i < l; i++ ) {\n\t\t\t\t\t\telem = this[ i ] || {};\n\n\t\t\t\t\t\t// Remove element nodes and prevent memory leaks\n\t\t\t\t\t\tif ( elem.nodeType === 1 ) {\n\t\t\t\t\t\t\tjQuery.cleanData( getAll( elem, false ) );\n\t\t\t\t\t\t\telem.innerHTML = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\telem = 0;\n\n\t\t\t\t// If using innerHTML throws an exception, use the fallback method\n\t\t\t\t} catch ( e ) {}\n\t\t\t}\n\n\t\t\tif ( elem ) {\n\t\t\t\tthis.empty().append( value );\n\t\t\t}\n\t\t}, null, value, arguments.length );\n\t},\n\n\treplaceWith: function() {\n\t\tvar ignored = [];\n\n\t\t// Make the changes, replacing each non-ignored context element with the new content\n\t\treturn domManip( this, arguments, function( elem ) {\n\t\t\tvar parent = this.parentNode;\n\n\t\t\tif ( jQuery.inArray( this, ignored ) < 0 ) {\n\t\t\t\tjQuery.cleanData( getAll( this ) );\n\t\t\t\tif ( parent ) {\n\t\t\t\t\tparent.replaceChild( elem, this );\n\t\t\t\t}\n\t\t\t}\n\n\t\t// Force callback invocation\n\t\t}, ignored );\n\t}\n} );\n\njQuery.each( {\n\tappendTo: \"append\",\n\tprependTo: \"prepend\",\n\tinsertBefore: \"before\",\n\tinsertAfter: \"after\",\n\treplaceAll: \"replaceWith\"\n}, function( name, original ) {\n\tjQuery.fn[ name ] = function( selector ) {\n\t\tvar elems,\n\t\t\tret = [],\n\t\t\tinsert = jQuery( selector ),\n\t\t\tlast = insert.length - 1,\n\t\t\ti = 0;\n\n\t\tfor ( ; i <= last; i++ ) {\n\t\t\telems = i === last ? this : this.clone( true );\n\t\t\tjQuery( insert[ i ] )[ original ]( elems );\n\n\t\t\t// Support: Android <=4.0 only, PhantomJS 1 only\n\t\t\t// .get() because push.apply(_, arraylike) throws on ancient WebKit\n\t\t\tpush.apply( ret, elems.get() );\n\t\t}\n\n\t\treturn this.pushStack( ret );\n\t};\n} );\nvar rnumnonpx = new RegExp( \"^(\" + pnum + \")(?!px)[a-z%]+$\", \"i\" );\n\nvar getStyles = function( elem ) {\n\n\t\t// Support: IE <=11 only, Firefox <=30 (#15098, #14150)\n\t\t// IE throws on elements created in popups\n\t\t// FF meanwhile throws on frame elements through \"defaultView.getComputedStyle\"\n\t\tvar view = elem.ownerDocument.defaultView;\n\n\t\tif ( !view || !view.opener ) {\n\t\t\tview = window;\n\t\t}\n\n\t\treturn view.getComputedStyle( elem );\n\t};\n\nvar rboxStyle = new RegExp( cssExpand.join( \"|\" ), \"i\" );\n\n\n\n( function() {\n\n\t// Executing both pixelPosition & boxSizingReliable tests require only one layout\n\t// so they're executed at the same time to save the second computation.\n\tfunction computeStyleTests() {\n\n\t\t// This is a singleton, we need to execute it only once\n\t\tif ( !div ) {\n\t\t\treturn;\n\t\t}\n\n\t\tcontainer.style.cssText = \"position:absolute;left:-11111px;width:60px;\" +\n\t\t\t\"margin-top:1px;padding:0;border:0\";\n\t\tdiv.style.cssText =\n\t\t\t\"position:relative;display:block;box-sizing:border-box;overflow:scroll;\" +\n\t\t\t\"margin:auto;border:1px;padding:1px;\" +\n\t\t\t\"width:60%;top:1%\";\n\t\tdocumentElement.appendChild( container ).appendChild( div );\n\n\t\tvar divStyle = window.getComputedStyle( div );\n\t\tpixelPositionVal = divStyle.top !== \"1%\";\n\n\t\t// Support: Android 4.0 - 4.3 only, Firefox <=3 - 44\n\t\treliableMarginLeftVal = roundPixelMeasures( divStyle.marginLeft ) === 12;\n\n\t\t// Support: Android 4.0 - 4.3 only, Safari <=9.1 - 10.1, iOS <=7.0 - 9.3\n\t\t// Some styles come back with percentage values, even though they shouldn't\n\t\tdiv.style.right = \"60%\";\n\t\tpixelBoxStylesVal = roundPixelMeasures( divStyle.right ) === 36;\n\n\t\t// Support: IE 9 - 11 only\n\t\t// Detect misreporting of content dimensions for box-sizing:border-box elements\n\t\tboxSizingReliableVal = roundPixelMeasures( divStyle.width ) === 36;\n\n\t\t// Support: IE 9 only\n\t\t// Detect overflow:scroll screwiness (gh-3699)\n\t\t// Support: Chrome <=64\n\t\t// Don't get tricked when zoom affects offsetWidth (gh-4029)\n\t\tdiv.style.position = \"absolute\";\n\t\tscrollboxSizeVal = roundPixelMeasures( div.offsetWidth / 3 ) === 12;\n\n\t\tdocumentElement.removeChild( container );\n\n\t\t// Nullify the div so it wouldn't be stored in the memory and\n\t\t// it will also be a sign that checks already performed\n\t\tdiv = null;\n\t}\n\n\tfunction roundPixelMeasures( measure ) {\n\t\treturn Math.round( parseFloat( measure ) );\n\t}\n\n\tvar pixelPositionVal, boxSizingReliableVal, scrollboxSizeVal, pixelBoxStylesVal,\n\t\treliableMarginLeftVal,\n\t\tcontainer = document.createElement( \"div\" ),\n\t\tdiv = document.createElement( \"div\" );\n\n\t// Finish early in limited (non-browser) environments\n\tif ( !div.style ) {\n\t\treturn;\n\t}\n\n\t// Support: IE <=9 - 11 only\n\t// Style of cloned element affects source element cloned (#8908)\n\tdiv.style.backgroundClip = \"content-box\";\n\tdiv.cloneNode( true ).style.backgroundClip = \"\";\n\tsupport.clearCloneStyle = div.style.backgroundClip === \"content-box\";\n\n\tjQuery.extend( support, {\n\t\tboxSizingReliable: function() {\n\t\t\tcomputeStyleTests();\n\t\t\treturn boxSizingReliableVal;\n\t\t},\n\t\tpixelBoxStyles: function() {\n\t\t\tcomputeStyleTests();\n\t\t\treturn pixelBoxStylesVal;\n\t\t},\n\t\tpixelPosition: function() {\n\t\t\tcomputeStyleTests();\n\t\t\treturn pixelPositionVal;\n\t\t},\n\t\treliableMarginLeft: function() {\n\t\t\tcomputeStyleTests();\n\t\t\treturn reliableMarginLeftVal;\n\t\t},\n\t\tscrollboxSize: function() {\n\t\t\tcomputeStyleTests();\n\t\t\treturn scrollboxSizeVal;\n\t\t}\n\t} );\n} )();\n\n\nfunction curCSS( elem, name, computed ) {\n\tvar width, minWidth, maxWidth, ret,\n\n\t\t// Support: Firefox 51+\n\t\t// Retrieving style before computed somehow\n\t\t// fixes an issue with getting wrong values\n\t\t// on detached elements\n\t\tstyle = elem.style;\n\n\tcomputed = computed || getStyles( elem );\n\n\t// getPropertyValue is needed for:\n\t//   .css('filter') (IE 9 only, #12537)\n\t//   .css('--customProperty) (#3144)\n\tif ( computed ) {\n\t\tret = computed.getPropertyValue( name ) || computed[ name ];\n\n\t\tif ( ret === \"\" && !isAttached( elem ) ) {\n\t\t\tret = jQuery.style( elem, name );\n\t\t}\n\n\t\t// A tribute to the \"awesome hack by Dean Edwards\"\n\t\t// Android Browser returns percentage for some values,\n\t\t// but width seems to be reliably pixels.\n\t\t// This is against the CSSOM draft spec:\n\t\t// https://drafts.csswg.org/cssom/#resolved-values\n\t\tif ( !support.pixelBoxStyles() && rnumnonpx.test( ret ) && rboxStyle.test( name ) ) {\n\n\t\t\t// Remember the original values\n\t\t\twidth = style.width;\n\t\t\tminWidth = style.minWidth;\n\t\t\tmaxWidth = style.maxWidth;\n\n\t\t\t// Put in the new values to get a computed value out\n\t\t\tstyle.minWidth = style.maxWidth = style.width = ret;\n\t\t\tret = computed.width;\n\n\t\t\t// Revert the changed values\n\t\t\tstyle.width = width;\n\t\t\tstyle.minWidth = minWidth;\n\t\t\tstyle.maxWidth = maxWidth;\n\t\t}\n\t}\n\n\treturn ret !== undefined ?\n\n\t\t// Support: IE <=9 - 11 only\n\t\t// IE returns zIndex value as an integer.\n\t\tret + \"\" :\n\t\tret;\n}\n\n\nfunction addGetHookIf( conditionFn, hookFn ) {\n\n\t// Define the hook, we'll check on the first run if it's really needed.\n\treturn {\n\t\tget: function() {\n\t\t\tif ( conditionFn() ) {\n\n\t\t\t\t// Hook not needed (or it's not possible to use it due\n\t\t\t\t// to missing dependency), remove it.\n\t\t\t\tdelete this.get;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Hook needed; redefine it so that the support test is not executed again.\n\t\t\treturn ( this.get = hookFn ).apply( this, arguments );\n\t\t}\n\t};\n}\n\n\nvar cssPrefixes = [ \"Webkit\", \"Moz\", \"ms\" ],\n\temptyStyle = document.createElement( \"div\" ).style,\n\tvendorProps = {};\n\n// Return a vendor-prefixed property or undefined\nfunction vendorPropName( name ) {\n\n\t// Check for vendor prefixed names\n\tvar capName = name[ 0 ].toUpperCase() + name.slice( 1 ),\n\t\ti = cssPrefixes.length;\n\n\twhile ( i-- ) {\n\t\tname = cssPrefixes[ i ] + capName;\n\t\tif ( name in emptyStyle ) {\n\t\t\treturn name;\n\t\t}\n\t}\n}\n\n// Return a potentially-mapped jQuery.cssProps or vendor prefixed property\nfunction finalPropName( name ) {\n\tvar final = jQuery.cssProps[ name ] || vendorProps[ name ];\n\n\tif ( final ) {\n\t\treturn final;\n\t}\n\tif ( name in emptyStyle ) {\n\t\treturn name;\n\t}\n\treturn vendorProps[ name ] = vendorPropName( name ) || name;\n}\n\n\nvar\n\n\t// Swappable if display is none or starts with table\n\t// except \"table\", \"table-cell\", or \"table-caption\"\n\t// See here for display values: https://developer.mozilla.org/en-US/docs/CSS/display\n\trdisplayswap = /^(none|table(?!-c[ea]).+)/,\n\trcustomProp = /^--/,\n\tcssShow = { position: \"absolute\", visibility: \"hidden\", display: \"block\" },\n\tcssNormalTransform = {\n\t\tletterSpacing: \"0\",\n\t\tfontWeight: \"400\"\n\t};\n\nfunction setPositiveNumber( elem, value, subtract ) {\n\n\t// Any relative (+/-) values have already been\n\t// normalized at this point\n\tvar matches = rcssNum.exec( value );\n\treturn matches ?\n\n\t\t// Guard against undefined \"subtract\", e.g., when used as in cssHooks\n\t\tMath.max( 0, matches[ 2 ] - ( subtract || 0 ) ) + ( matches[ 3 ] || \"px\" ) :\n\t\tvalue;\n}\n\nfunction boxModelAdjustment( elem, dimension, box, isBorderBox, styles, computedVal ) {\n\tvar i = dimension === \"width\" ? 1 : 0,\n\t\textra = 0,\n\t\tdelta = 0;\n\n\t// Adjustment may not be necessary\n\tif ( box === ( isBorderBox ? \"border\" : \"content\" ) ) {\n\t\treturn 0;\n\t}\n\n\tfor ( ; i < 4; i += 2 ) {\n\n\t\t// Both box models exclude margin\n\t\tif ( box === \"margin\" ) {\n\t\t\tdelta += jQuery.css( elem, box + cssExpand[ i ], true, styles );\n\t\t}\n\n\t\t// If we get here with a content-box, we're seeking \"padding\" or \"border\" or \"margin\"\n\t\tif ( !isBorderBox ) {\n\n\t\t\t// Add padding\n\t\t\tdelta += jQuery.css( elem, \"padding\" + cssExpand[ i ], true, styles );\n\n\t\t\t// For \"border\" or \"margin\", add border\n\t\t\tif ( box !== \"padding\" ) {\n\t\t\t\tdelta += jQuery.css( elem, \"border\" + cssExpand[ i ] + \"Width\", true, styles );\n\n\t\t\t// But still keep track of it otherwise\n\t\t\t} else {\n\t\t\t\textra += jQuery.css( elem, \"border\" + cssExpand[ i ] + \"Width\", true, styles );\n\t\t\t}\n\n\t\t// If we get here with a border-box (content + padding + border), we're seeking \"content\" or\n\t\t// \"padding\" or \"margin\"\n\t\t} else {\n\n\t\t\t// For \"content\", subtract padding\n\t\t\tif ( box === \"content\" ) {\n\t\t\t\tdelta -= jQuery.css( elem, \"padding\" + cssExpand[ i ], true, styles );\n\t\t\t}\n\n\t\t\t// For \"content\" or \"padding\", subtract border\n\t\t\tif ( box !== \"margin\" ) {\n\t\t\t\tdelta -= jQuery.css( elem, \"border\" + cssExpand[ i ] + \"Width\", true, styles );\n\t\t\t}\n\t\t}\n\t}\n\n\t// Account for positive content-box scroll gutter when requested by providing computedVal\n\tif ( !isBorderBox && computedVal >= 0 ) {\n\n\t\t// offsetWidth/offsetHeight is a rounded sum of content, padding, scroll gutter, and border\n\t\t// Assuming integer scroll gutter, subtract the rest and round down\n\t\tdelta += Math.max( 0, Math.ceil(\n\t\t\telem[ \"offset\" + dimension[ 0 ].toUpperCase() + dimension.slice( 1 ) ] -\n\t\t\tcomputedVal -\n\t\t\tdelta -\n\t\t\textra -\n\t\t\t0.5\n\n\t\t// If offsetWidth/offsetHeight is unknown, then we can't determine content-box scroll gutter\n\t\t// Use an explicit zero to avoid NaN (gh-3964)\n\t\t) ) || 0;\n\t}\n\n\treturn delta;\n}\n\nfunction getWidthOrHeight( elem, dimension, extra ) {\n\n\t// Start with computed style\n\tvar styles = getStyles( elem ),\n\n\t\t// To avoid forcing a reflow, only fetch boxSizing if we need it (gh-4322).\n\t\t// Fake content-box until we know it's needed to know the true value.\n\t\tboxSizingNeeded = !support.boxSizingReliable() || extra,\n\t\tisBorderBox = boxSizingNeeded &&\n\t\t\tjQuery.css( elem, \"boxSizing\", false, styles ) === \"border-box\",\n\t\tvalueIsBorderBox = isBorderBox,\n\n\t\tval = curCSS( elem, dimension, styles ),\n\t\toffsetProp = \"offset\" + dimension[ 0 ].toUpperCase() + dimension.slice( 1 );\n\n\t// Support: Firefox <=54\n\t// Return a confounding non-pixel value or feign ignorance, as appropriate.\n\tif ( rnumnonpx.test( val ) ) {\n\t\tif ( !extra ) {\n\t\t\treturn val;\n\t\t}\n\t\tval = \"auto\";\n\t}\n\n\n\t// Fall back to offsetWidth/offsetHeight when value is \"auto\"\n\t// This happens for inline elements with no explicit setting (gh-3571)\n\t// Support: Android <=4.1 - 4.3 only\n\t// Also use offsetWidth/offsetHeight for misreported inline dimensions (gh-3602)\n\t// Support: IE 9-11 only\n\t// Also use offsetWidth/offsetHeight for when box sizing is unreliable\n\t// We use getClientRects() to check for hidden/disconnected.\n\t// In those cases, the computed value can be trusted to be border-box\n\tif ( ( !support.boxSizingReliable() && isBorderBox ||\n\t\tval === \"auto\" ||\n\t\t!parseFloat( val ) && jQuery.css( elem, \"display\", false, styles ) === \"inline\" ) &&\n\t\telem.getClientRects().length ) {\n\n\t\tisBorderBox = jQuery.css( elem, \"boxSizing\", false, styles ) === \"border-box\";\n\n\t\t// Where available, offsetWidth/offsetHeight approximate border box dimensions.\n\t\t// Where not available (e.g., SVG), assume unreliable box-sizing and interpret the\n\t\t// retrieved value as a content box dimension.\n\t\tvalueIsBorderBox = offsetProp in elem;\n\t\tif ( valueIsBorderBox ) {\n\t\t\tval = elem[ offsetProp ];\n\t\t}\n\t}\n\n\t// Normalize \"\" and auto\n\tval = parseFloat( val ) || 0;\n\n\t// Adjust for the element's box model\n\treturn ( val +\n\t\tboxModelAdjustment(\n\t\t\telem,\n\t\t\tdimension,\n\t\t\textra || ( isBorderBox ? \"border\" : \"content\" ),\n\t\t\tvalueIsBorderBox,\n\t\t\tstyles,\n\n\t\t\t// Provide the current computed size to request scroll gutter calculation (gh-3589)\n\t\t\tval\n\t\t)\n\t) + \"px\";\n}\n\njQuery.extend( {\n\n\t// Add in style property hooks for overriding the default\n\t// behavior of getting and setting a style property\n\tcssHooks: {\n\t\topacity: {\n\t\t\tget: function( elem, computed ) {\n\t\t\t\tif ( computed ) {\n\n\t\t\t\t\t// We should always get a number back from opacity\n\t\t\t\t\tvar ret = curCSS( elem, \"opacity\" );\n\t\t\t\t\treturn ret === \"\" ? \"1\" : ret;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t// Don't automatically add \"px\" to these possibly-unitless properties\n\tcssNumber: {\n\t\t\"animationIterationCount\": true,\n\t\t\"columnCount\": true,\n\t\t\"fillOpacity\": true,\n\t\t\"flexGrow\": true,\n\t\t\"flexShrink\": true,\n\t\t\"fontWeight\": true,\n\t\t\"gridArea\": true,\n\t\t\"gridColumn\": true,\n\t\t\"gridColumnEnd\": true,\n\t\t\"gridColumnStart\": true,\n\t\t\"gridRow\": true,\n\t\t\"gridRowEnd\": true,\n\t\t\"gridRowStart\": true,\n\t\t\"lineHeight\": true,\n\t\t\"opacity\": true,\n\t\t\"order\": true,\n\t\t\"orphans\": true,\n\t\t\"widows\": true,\n\t\t\"zIndex\": true,\n\t\t\"zoom\": true\n\t},\n\n\t// Add in properties whose names you wish to fix before\n\t// setting or getting the value\n\tcssProps: {},\n\n\t// Get and set the style property on a DOM Node\n\tstyle: function( elem, name, value, extra ) {\n\n\t\t// Don't set styles on text and comment nodes\n\t\tif ( !elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Make sure that we're working with the right name\n\t\tvar ret, type, hooks,\n\t\t\torigName = camelCase( name ),\n\t\t\tisCustomProp = rcustomProp.test( name ),\n\t\t\tstyle = elem.style;\n\n\t\t// Make sure that we're working with the right name. We don't\n\t\t// want to query the value if it is a CSS custom property\n\t\t// since they are user-defined.\n\t\tif ( !isCustomProp ) {\n\t\t\tname = finalPropName( origName );\n\t\t}\n\n\t\t// Gets hook for the prefixed version, then unprefixed version\n\t\thooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];\n\n\t\t// Check if we're setting a value\n\t\tif ( value !== undefined ) {\n\t\t\ttype = typeof value;\n\n\t\t\t// Convert \"+=\" or \"-=\" to relative numbers (#7345)\n\t\t\tif ( type === \"string\" && ( ret = rcssNum.exec( value ) ) && ret[ 1 ] ) {\n\t\t\t\tvalue = adjustCSS( elem, name, ret );\n\n\t\t\t\t// Fixes bug #9237\n\t\t\t\ttype = \"number\";\n\t\t\t}\n\n\t\t\t// Make sure that null and NaN values aren't set (#7116)\n\t\t\tif ( value == null || value !== value ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If a number was passed in, add the unit (except for certain CSS properties)\n\t\t\t// The isCustomProp check can be removed in jQuery 4.0 when we only auto-append\n\t\t\t// \"px\" to a few hardcoded values.\n\t\t\tif ( type === \"number\" && !isCustomProp ) {\n\t\t\t\tvalue += ret && ret[ 3 ] || ( jQuery.cssNumber[ origName ] ? \"\" : \"px\" );\n\t\t\t}\n\n\t\t\t// background-* props affect original clone's values\n\t\t\tif ( !support.clearCloneStyle && value === \"\" && name.indexOf( \"background\" ) === 0 ) {\n\t\t\t\tstyle[ name ] = \"inherit\";\n\t\t\t}\n\n\t\t\t// If a hook was provided, use that value, otherwise just set the specified value\n\t\t\tif ( !hooks || !( \"set\" in hooks ) ||\n\t\t\t\t( value = hooks.set( elem, value, extra ) ) !== undefined ) {\n\n\t\t\t\tif ( isCustomProp ) {\n\t\t\t\t\tstyle.setProperty( name, value );\n\t\t\t\t} else {\n\t\t\t\t\tstyle[ name ] = value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t} else {\n\n\t\t\t// If a hook was provided get the non-computed value from there\n\t\t\tif ( hooks && \"get\" in hooks &&\n\t\t\t\t( ret = hooks.get( elem, false, extra ) ) !== undefined ) {\n\n\t\t\t\treturn ret;\n\t\t\t}\n\n\t\t\t// Otherwise just get the value from the style object\n\t\t\treturn style[ name ];\n\t\t}\n\t},\n\n\tcss: function( elem, name, extra, styles ) {\n\t\tvar val, num, hooks,\n\t\t\torigName = camelCase( name ),\n\t\t\tisCustomProp = rcustomProp.test( name );\n\n\t\t// Make sure that we're working with the right name. We don't\n\t\t// want to modify the value if it is a CSS custom property\n\t\t// since they are user-defined.\n\t\tif ( !isCustomProp ) {\n\t\t\tname = finalPropName( origName );\n\t\t}\n\n\t\t// Try prefixed name followed by the unprefixed name\n\t\thooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];\n\n\t\t// If a hook was provided get the computed value from there\n\t\tif ( hooks && \"get\" in hooks ) {\n\t\t\tval = hooks.get( elem, true, extra );\n\t\t}\n\n\t\t// Otherwise, if a way to get the computed value exists, use that\n\t\tif ( val === undefined ) {\n\t\t\tval = curCSS( elem, name, styles );\n\t\t}\n\n\t\t// Convert \"normal\" to computed value\n\t\tif ( val === \"normal\" && name in cssNormalTransform ) {\n\t\t\tval = cssNormalTransform[ name ];\n\t\t}\n\n\t\t// Make numeric if forced or a qualifier was provided and val looks numeric\n\t\tif ( extra === \"\" || extra ) {\n\t\t\tnum = parseFloat( val );\n\t\t\treturn extra === true || isFinite( num ) ? num || 0 : val;\n\t\t}\n\n\t\treturn val;\n\t}\n} );\n\njQuery.each( [ \"height\", \"width\" ], function( i, dimension ) {\n\tjQuery.cssHooks[ dimension ] = {\n\t\tget: function( elem, computed, extra ) {\n\t\t\tif ( computed ) {\n\n\t\t\t\t// Certain elements can have dimension info if we invisibly show them\n\t\t\t\t// but it must have a current display style that would benefit\n\t\t\t\treturn rdisplayswap.test( jQuery.css( elem, \"display\" ) ) &&\n\n\t\t\t\t\t// Support: Safari 8+\n\t\t\t\t\t// Table columns in Safari have non-zero offsetWidth & zero\n\t\t\t\t\t// getBoundingClientRect().width unless display is changed.\n\t\t\t\t\t// Support: IE <=11 only\n\t\t\t\t\t// Running getBoundingClientRect on a disconnected node\n\t\t\t\t\t// in IE throws an error.\n\t\t\t\t\t( !elem.getClientRects().length || !elem.getBoundingClientRect().width ) ?\n\t\t\t\t\t\tswap( elem, cssShow, function() {\n\t\t\t\t\t\t\treturn getWidthOrHeight( elem, dimension, extra );\n\t\t\t\t\t\t} ) :\n\t\t\t\t\t\tgetWidthOrHeight( elem, dimension, extra );\n\t\t\t}\n\t\t},\n\n\t\tset: function( elem, value, extra ) {\n\t\t\tvar matches,\n\t\t\t\tstyles = getStyles( elem ),\n\n\t\t\t\t// Only read styles.position if the test has a chance to fail\n\t\t\t\t// to avoid forcing a reflow.\n\t\t\t\tscrollboxSizeBuggy = !support.scrollboxSize() &&\n\t\t\t\t\tstyles.position === \"absolute\",\n\n\t\t\t\t// To avoid forcing a reflow, only fetch boxSizing if we need it (gh-3991)\n\t\t\t\tboxSizingNeeded = scrollboxSizeBuggy || extra,\n\t\t\t\tisBorderBox = boxSizingNeeded &&\n\t\t\t\t\tjQuery.css( elem, \"boxSizing\", false, styles ) === \"border-box\",\n\t\t\t\tsubtract = extra ?\n\t\t\t\t\tboxModelAdjustment(\n\t\t\t\t\t\telem,\n\t\t\t\t\t\tdimension,\n\t\t\t\t\t\textra,\n\t\t\t\t\t\tisBorderBox,\n\t\t\t\t\t\tstyles\n\t\t\t\t\t) :\n\t\t\t\t\t0;\n\n\t\t\t// Account for unreliable border-box dimensions by comparing offset* to computed and\n\t\t\t// faking a content-box to get border and padding (gh-3699)\n\t\t\tif ( isBorderBox && scrollboxSizeBuggy ) {\n\t\t\t\tsubtract -= Math.ceil(\n\t\t\t\t\telem[ \"offset\" + dimension[ 0 ].toUpperCase() + dimension.slice( 1 ) ] -\n\t\t\t\t\tparseFloat( styles[ dimension ] ) -\n\t\t\t\t\tboxModelAdjustment( elem, dimension, \"border\", false, styles ) -\n\t\t\t\t\t0.5\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Convert to pixels if value adjustment is needed\n\t\t\tif ( subtract && ( matches = rcssNum.exec( value ) ) &&\n\t\t\t\t( matches[ 3 ] || \"px\" ) !== \"px\" ) {\n\n\t\t\t\telem.style[ dimension ] = value;\n\t\t\t\tvalue = jQuery.css( elem, dimension );\n\t\t\t}\n\n\t\t\treturn setPositiveNumber( elem, value, subtract );\n\t\t}\n\t};\n} );\n\njQuery.cssHooks.marginLeft = addGetHookIf( support.reliableMarginLeft,\n\tfunction( elem, computed ) {\n\t\tif ( computed ) {\n\t\t\treturn ( parseFloat( curCSS( elem, \"marginLeft\" ) ) ||\n\t\t\t\telem.getBoundingClientRect().left -\n\t\t\t\t\tswap( elem, { marginLeft: 0 }, function() {\n\t\t\t\t\t\treturn elem.getBoundingClientRect().left;\n\t\t\t\t\t} )\n\t\t\t\t) + \"px\";\n\t\t}\n\t}\n);\n\n// These hooks are used by animate to expand properties\njQuery.each( {\n\tmargin: \"\",\n\tpadding: \"\",\n\tborder: \"Width\"\n}, function( prefix, suffix ) {\n\tjQuery.cssHooks[ prefix + suffix ] = {\n\t\texpand: function( value ) {\n\t\t\tvar i = 0,\n\t\t\t\texpanded = {},\n\n\t\t\t\t// Assumes a single number if not a string\n\t\t\t\tparts = typeof value === \"string\" ? value.split( \" \" ) : [ value ];\n\n\t\t\tfor ( ; i < 4; i++ ) {\n\t\t\t\texpanded[ prefix + cssExpand[ i ] + suffix ] =\n\t\t\t\t\tparts[ i ] || parts[ i - 2 ] || parts[ 0 ];\n\t\t\t}\n\n\t\t\treturn expanded;\n\t\t}\n\t};\n\n\tif ( prefix !== \"margin\" ) {\n\t\tjQuery.cssHooks[ prefix + suffix ].set = setPositiveNumber;\n\t}\n} );\n\njQuery.fn.extend( {\n\tcss: function( name, value ) {\n\t\treturn access( this, function( elem, name, value ) {\n\t\t\tvar styles, len,\n\t\t\t\tmap = {},\n\t\t\t\ti = 0;\n\n\t\t\tif ( Array.isArray( name ) ) {\n\t\t\t\tstyles = getStyles( elem );\n\t\t\t\tlen = name.length;\n\n\t\t\t\tfor ( ; i < len; i++ ) {\n\t\t\t\t\tmap[ name[ i ] ] = jQuery.css( elem, name[ i ], false, styles );\n\t\t\t\t}\n\n\t\t\t\treturn map;\n\t\t\t}\n\n\t\t\treturn value !== undefined ?\n\t\t\t\tjQuery.style( elem, name, value ) :\n\t\t\t\tjQuery.css( elem, name );\n\t\t}, name, value, arguments.length > 1 );\n\t}\n} );\n\n\nfunction Tween( elem, options, prop, end, easing ) {\n\treturn new Tween.prototype.init( elem, options, prop, end, easing );\n}\njQuery.Tween = Tween;\n\nTween.prototype = {\n\tconstructor: Tween,\n\tinit: function( elem, options, prop, end, easing, unit ) {\n\t\tthis.elem = elem;\n\t\tthis.prop = prop;\n\t\tthis.easing = easing || jQuery.easing._default;\n\t\tthis.options = options;\n\t\tthis.start = this.now = this.cur();\n\t\tthis.end = end;\n\t\tthis.unit = unit || ( jQuery.cssNumber[ prop ] ? \"\" : \"px\" );\n\t},\n\tcur: function() {\n\t\tvar hooks = Tween.propHooks[ this.prop ];\n\n\t\treturn hooks && hooks.get ?\n\t\t\thooks.get( this ) :\n\t\t\tTween.propHooks._default.get( this );\n\t},\n\trun: function( percent ) {\n\t\tvar eased,\n\t\t\thooks = Tween.propHooks[ this.prop ];\n\n\t\tif ( this.options.duration ) {\n\t\t\tthis.pos = eased = jQuery.easing[ this.easing ](\n\t\t\t\tpercent, this.options.duration * percent, 0, 1, this.options.duration\n\t\t\t);\n\t\t} else {\n\t\t\tthis.pos = eased = percent;\n\t\t}\n\t\tthis.now = ( this.end - this.start ) * eased + this.start;\n\n\t\tif ( this.options.step ) {\n\t\t\tthis.options.step.call( this.elem, this.now, this );\n\t\t}\n\n\t\tif ( hooks && hooks.set ) {\n\t\t\thooks.set( this );\n\t\t} else {\n\t\t\tTween.propHooks._default.set( this );\n\t\t}\n\t\treturn this;\n\t}\n};\n\nTween.prototype.init.prototype = Tween.prototype;\n\nTween.propHooks = {\n\t_default: {\n\t\tget: function( tween ) {\n\t\t\tvar result;\n\n\t\t\t// Use a property on the element directly when it is not a DOM element,\n\t\t\t// or when there is no matching style property that exists.\n\t\t\tif ( tween.elem.nodeType !== 1 ||\n\t\t\t\ttween.elem[ tween.prop ] != null && tween.elem.style[ tween.prop ] == null ) {\n\t\t\t\treturn tween.elem[ tween.prop ];\n\t\t\t}\n\n\t\t\t// Passing an empty string as a 3rd parameter to .css will automatically\n\t\t\t// attempt a parseFloat and fallback to a string if the parse fails.\n\t\t\t// Simple values such as \"10px\" are parsed to Float;\n\t\t\t// complex values such as \"rotate(1rad)\" are returned as-is.\n\t\t\tresult = jQuery.css( tween.elem, tween.prop, \"\" );\n\n\t\t\t// Empty strings, null, undefined and \"auto\" are converted to 0.\n\t\t\treturn !result || result === \"auto\" ? 0 : result;\n\t\t},\n\t\tset: function( tween ) {\n\n\t\t\t// Use step hook for back compat.\n\t\t\t// Use cssHook if its there.\n\t\t\t// Use .style if available and use plain properties where available.\n\t\t\tif ( jQuery.fx.step[ tween.prop ] ) {\n\t\t\t\tjQuery.fx.step[ tween.prop ]( tween );\n\t\t\t} else if ( tween.elem.nodeType === 1 && (\n\t\t\t\t\tjQuery.cssHooks[ tween.prop ] ||\n\t\t\t\t\ttween.elem.style[ finalPropName( tween.prop ) ] != null ) ) {\n\t\t\t\tjQuery.style( tween.elem, tween.prop, tween.now + tween.unit );\n\t\t\t} else {\n\t\t\t\ttween.elem[ tween.prop ] = tween.now;\n\t\t\t}\n\t\t}\n\t}\n};\n\n// Support: IE <=9 only\n// Panic based approach to setting things on disconnected nodes\nTween.propHooks.scrollTop = Tween.propHooks.scrollLeft = {\n\tset: function( tween ) {\n\t\tif ( tween.elem.nodeType && tween.elem.parentNode ) {\n\t\t\ttween.elem[ tween.prop ] = tween.now;\n\t\t}\n\t}\n};\n\njQuery.easing = {\n\tlinear: function( p ) {\n\t\treturn p;\n\t},\n\tswing: function( p ) {\n\t\treturn 0.5 - Math.cos( p * Math.PI ) / 2;\n\t},\n\t_default: \"swing\"\n};\n\njQuery.fx = Tween.prototype.init;\n\n// Back compat <1.8 extension point\njQuery.fx.step = {};\n\n\n\n\nvar\n\tfxNow, inProgress,\n\trfxtypes = /^(?:toggle|show|hide)$/,\n\trrun = /queueHooks$/;\n\nfunction schedule() {\n\tif ( inProgress ) {\n\t\tif ( document.hidden === false && window.requestAnimationFrame ) {\n\t\t\twindow.requestAnimationFrame( schedule );\n\t\t} else {\n\t\t\twindow.setTimeout( schedule, jQuery.fx.interval );\n\t\t}\n\n\t\tjQuery.fx.tick();\n\t}\n}\n\n// Animations created synchronously will run synchronously\nfunction createFxNow() {\n\twindow.setTimeout( function() {\n\t\tfxNow = undefined;\n\t} );\n\treturn ( fxNow = Date.now() );\n}\n\n// Generate parameters to create a standard animation\nfunction genFx( type, includeWidth ) {\n\tvar which,\n\t\ti = 0,\n\t\tattrs = { height: type };\n\n\t// If we include width, step value is 1 to do all cssExpand values,\n\t// otherwise step value is 2 to skip over Left and Right\n\tincludeWidth = includeWidth ? 1 : 0;\n\tfor ( ; i < 4; i += 2 - includeWidth ) {\n\t\twhich = cssExpand[ i ];\n\t\tattrs[ \"margin\" + which ] = attrs[ \"padding\" + which ] = type;\n\t}\n\n\tif ( includeWidth ) {\n\t\tattrs.opacity = attrs.width = type;\n\t}\n\n\treturn attrs;\n}\n\nfunction createTween( value, prop, animation ) {\n\tvar tween,\n\t\tcollection = ( Animation.tweeners[ prop ] || [] ).concat( Animation.tweeners[ \"*\" ] ),\n\t\tindex = 0,\n\t\tlength = collection.length;\n\tfor ( ; index < length; index++ ) {\n\t\tif ( ( tween = collection[ index ].call( animation, prop, value ) ) ) {\n\n\t\t\t// We're done with this property\n\t\t\treturn tween;\n\t\t}\n\t}\n}\n\nfunction defaultPrefilter( elem, props, opts ) {\n\tvar prop, value, toggle, hooks, oldfire, propTween, restoreDisplay, display,\n\t\tisBox = \"width\" in props || \"height\" in props,\n\t\tanim = this,\n\t\torig = {},\n\t\tstyle = elem.style,\n\t\thidden = elem.nodeType && isHiddenWithinTree( elem ),\n\t\tdataShow = dataPriv.get( elem, \"fxshow\" );\n\n\t// Queue-skipping animations hijack the fx hooks\n\tif ( !opts.queue ) {\n\t\thooks = jQuery._queueHooks( elem, \"fx\" );\n\t\tif ( hooks.unqueued == null ) {\n\t\t\thooks.unqueued = 0;\n\t\t\toldfire = hooks.empty.fire;\n\t\t\thooks.empty.fire = function() {\n\t\t\t\tif ( !hooks.unqueued ) {\n\t\t\t\t\toldfire();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\thooks.unqueued++;\n\n\t\tanim.always( function() {\n\n\t\t\t// Ensure the complete handler is called before this completes\n\t\t\tanim.always( function() {\n\t\t\t\thooks.unqueued--;\n\t\t\t\tif ( !jQuery.queue( elem, \"fx\" ).length ) {\n\t\t\t\t\thooks.empty.fire();\n\t\t\t\t}\n\t\t\t} );\n\t\t} );\n\t}\n\n\t// Detect show/hide animations\n\tfor ( prop in props ) {\n\t\tvalue = props[ prop ];\n\t\tif ( rfxtypes.test( value ) ) {\n\t\t\tdelete props[ prop ];\n\t\t\ttoggle = toggle || value === \"toggle\";\n\t\t\tif ( value === ( hidden ? \"hide\" : \"show\" ) ) {\n\n\t\t\t\t// Pretend to be hidden if this is a \"show\" and\n\t\t\t\t// there is still data from a stopped show/hide\n\t\t\t\tif ( value === \"show\" && dataShow && dataShow[ prop ] !== undefined ) {\n\t\t\t\t\thidden = true;\n\n\t\t\t\t// Ignore all other no-op show/hide data\n\t\t\t\t} else {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\torig[ prop ] = dataShow && dataShow[ prop ] || jQuery.style( elem, prop );\n\t\t}\n\t}\n\n\t// Bail out if this is a no-op like .hide().hide()\n\tpropTween = !jQuery.isEmptyObject( props );\n\tif ( !propTween && jQuery.isEmptyObject( orig ) ) {\n\t\treturn;\n\t}\n\n\t// Restrict \"overflow\" and \"display\" styles during box animations\n\tif ( isBox && elem.nodeType === 1 ) {\n\n\t\t// Support: IE <=9 - 11, Edge 12 - 15\n\t\t// Record all 3 overflow attributes because IE does not infer the shorthand\n\t\t// from identically-valued overflowX and overflowY and Edge just mirrors\n\t\t// the overflowX value there.\n\t\topts.overflow = [ style.overflow, style.overflowX, style.overflowY ];\n\n\t\t// Identify a display type, preferring old show/hide data over the CSS cascade\n\t\trestoreDisplay = dataShow && dataShow.display;\n\t\tif ( restoreDisplay == null ) {\n\t\t\trestoreDisplay = dataPriv.get( elem, \"display\" );\n\t\t}\n\t\tdisplay = jQuery.css( elem, \"display\" );\n\t\tif ( display === \"none\" ) {\n\t\t\tif ( restoreDisplay ) {\n\t\t\t\tdisplay = restoreDisplay;\n\t\t\t} else {\n\n\t\t\t\t// Get nonempty value(s) by temporarily forcing visibility\n\t\t\t\tshowHide( [ elem ], true );\n\t\t\t\trestoreDisplay = elem.style.display || restoreDisplay;\n\t\t\t\tdisplay = jQuery.css( elem, \"display\" );\n\t\t\t\tshowHide( [ elem ] );\n\t\t\t}\n\t\t}\n\n\t\t// Animate inline elements as inline-block\n\t\tif ( display === \"inline\" || display === \"inline-block\" && restoreDisplay != null ) {\n\t\t\tif ( jQuery.css( elem, \"float\" ) === \"none\" ) {\n\n\t\t\t\t// Restore the original display value at the end of pure show/hide animations\n\t\t\t\tif ( !propTween ) {\n\t\t\t\t\tanim.done( function() {\n\t\t\t\t\t\tstyle.display = restoreDisplay;\n\t\t\t\t\t} );\n\t\t\t\t\tif ( restoreDisplay == null ) {\n\t\t\t\t\t\tdisplay = style.display;\n\t\t\t\t\t\trestoreDisplay = display === \"none\" ? \"\" : display;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tstyle.display = \"inline-block\";\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( opts.overflow ) {\n\t\tstyle.overflow = \"hidden\";\n\t\tanim.always( function() {\n\t\t\tstyle.overflow = opts.overflow[ 0 ];\n\t\t\tstyle.overflowX = opts.overflow[ 1 ];\n\t\t\tstyle.overflowY = opts.overflow[ 2 ];\n\t\t} );\n\t}\n\n\t// Implement show/hide animations\n\tpropTween = false;\n\tfor ( prop in orig ) {\n\n\t\t// General show/hide setup for this element animation\n\t\tif ( !propTween ) {\n\t\t\tif ( dataShow ) {\n\t\t\t\tif ( \"hidden\" in dataShow ) {\n\t\t\t\t\thidden = dataShow.hidden;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdataShow = dataPriv.access( elem, \"fxshow\", { display: restoreDisplay } );\n\t\t\t}\n\n\t\t\t// Store hidden/visible for toggle so `.stop().toggle()` \"reverses\"\n\t\t\tif ( toggle ) {\n\t\t\t\tdataShow.hidden = !hidden;\n\t\t\t}\n\n\t\t\t// Show elements before animating them\n\t\t\tif ( hidden ) {\n\t\t\t\tshowHide( [ elem ], true );\n\t\t\t}\n\n\t\t\t/* eslint-disable no-loop-func */\n\n\t\t\tanim.done( function() {\n\n\t\t\t/* eslint-enable no-loop-func */\n\n\t\t\t\t// The final step of a \"hide\" animation is actually hiding the element\n\t\t\t\tif ( !hidden ) {\n\t\t\t\t\tshowHide( [ elem ] );\n\t\t\t\t}\n\t\t\t\tdataPriv.remove( elem, \"fxshow\" );\n\t\t\t\tfor ( prop in orig ) {\n\t\t\t\t\tjQuery.style( elem, prop, orig[ prop ] );\n\t\t\t\t}\n\t\t\t} );\n\t\t}\n\n\t\t// Per-property setup\n\t\tpropTween = createTween( hidden ? dataShow[ prop ] : 0, prop, anim );\n\t\tif ( !( prop in dataShow ) ) {\n\t\t\tdataShow[ prop ] = propTween.start;\n\t\t\tif ( hidden ) {\n\t\t\t\tpropTween.end = propTween.start;\n\t\t\t\tpropTween.start = 0;\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction propFilter( props, specialEasing ) {\n\tvar index, name, easing, value, hooks;\n\n\t// camelCase, specialEasing and expand cssHook pass\n\tfor ( index in props ) {\n\t\tname = camelCase( index );\n\t\teasing = specialEasing[ name ];\n\t\tvalue = props[ index ];\n\t\tif ( Array.isArray( value ) ) {\n\t\t\teasing = value[ 1 ];\n\t\t\tvalue = props[ index ] = value[ 0 ];\n\t\t}\n\n\t\tif ( index !== name ) {\n\t\t\tprops[ name ] = value;\n\t\t\tdelete props[ index ];\n\t\t}\n\n\t\thooks = jQuery.cssHooks[ name ];\n\t\tif ( hooks && \"expand\" in hooks ) {\n\t\t\tvalue = hooks.expand( value );\n\t\t\tdelete props[ name ];\n\n\t\t\t// Not quite $.extend, this won't overwrite existing keys.\n\t\t\t// Reusing 'index' because we have the correct \"name\"\n\t\t\tfor ( index in value ) {\n\t\t\t\tif ( !( index in props ) ) {\n\t\t\t\t\tprops[ index ] = value[ index ];\n\t\t\t\t\tspecialEasing[ index ] = easing;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tspecialEasing[ name ] = easing;\n\t\t}\n\t}\n}\n\nfunction Animation( elem, properties, options ) {\n\tvar result,\n\t\tstopped,\n\t\tindex = 0,\n\t\tlength = Animation.prefilters.length,\n\t\tdeferred = jQuery.Deferred().always( function() {\n\n\t\t\t// Don't match elem in the :animated selector\n\t\t\tdelete tick.elem;\n\t\t} ),\n\t\ttick = function() {\n\t\t\tif ( stopped ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar currentTime = fxNow || createFxNow(),\n\t\t\t\tremaining = Math.max( 0, animation.startTime + animation.duration - currentTime ),\n\n\t\t\t\t// Support: Android 2.3 only\n\t\t\t\t// Archaic crash bug won't allow us to use `1 - ( 0.5 || 0 )` (#12497)\n\t\t\t\ttemp = remaining / animation.duration || 0,\n\t\t\t\tpercent = 1 - temp,\n\t\t\t\tindex = 0,\n\t\t\t\tlength = animation.tweens.length;\n\n\t\t\tfor ( ; index < length; index++ ) {\n\t\t\t\tanimation.tweens[ index ].run( percent );\n\t\t\t}\n\n\t\t\tdeferred.notifyWith( elem, [ animation, percent, remaining ] );\n\n\t\t\t// If there's more to do, yield\n\t\t\tif ( percent < 1 && length ) {\n\t\t\t\treturn remaining;\n\t\t\t}\n\n\t\t\t// If this was an empty animation, synthesize a final progress notification\n\t\t\tif ( !length ) {\n\t\t\t\tdeferred.notifyWith( elem, [ animation, 1, 0 ] );\n\t\t\t}\n\n\t\t\t// Resolve the animation and report its conclusion\n\t\t\tdeferred.resolveWith( elem, [ animation ] );\n\t\t\treturn false;\n\t\t},\n\t\tanimation = deferred.promise( {\n\t\t\telem: elem,\n\t\t\tprops: jQuery.extend( {}, properties ),\n\t\t\topts: jQuery.extend( true, {\n\t\t\t\tspecialEasing: {},\n\t\t\t\teasing: jQuery.easing._default\n\t\t\t}, options ),\n\t\t\toriginalProperties: properties,\n\t\t\toriginalOptions: options,\n\t\t\tstartTime: fxNow || createFxNow(),\n\t\t\tduration: options.duration,\n\t\t\ttweens: [],\n\t\t\tcreateTween: function( prop, end ) {\n\t\t\t\tvar tween = jQuery.Tween( elem, animation.opts, prop, end,\n\t\t\t\t\t\tanimation.opts.specialEasing[ prop ] || animation.opts.easing );\n\t\t\t\tanimation.tweens.push( tween );\n\t\t\t\treturn tween;\n\t\t\t},\n\t\t\tstop: function( gotoEnd ) {\n\t\t\t\tvar index = 0,\n\n\t\t\t\t\t// If we are going to the end, we want to run all the tweens\n\t\t\t\t\t// otherwise we skip this part\n\t\t\t\t\tlength = gotoEnd ? animation.tweens.length : 0;\n\t\t\t\tif ( stopped ) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t\tstopped = true;\n\t\t\t\tfor ( ; index < length; index++ ) {\n\t\t\t\t\tanimation.tweens[ index ].run( 1 );\n\t\t\t\t}\n\n\t\t\t\t// Resolve when we played the last frame; otherwise, reject\n\t\t\t\tif ( gotoEnd ) {\n\t\t\t\t\tdeferred.notifyWith( elem, [ animation, 1, 0 ] );\n\t\t\t\t\tdeferred.resolveWith( elem, [ animation, gotoEnd ] );\n\t\t\t\t} else {\n\t\t\t\t\tdeferred.rejectWith( elem, [ animation, gotoEnd ] );\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t}\n\t\t} ),\n\t\tprops = animation.props;\n\n\tpropFilter( props, animation.opts.specialEasing );\n\n\tfor ( ; index < length; index++ ) {\n\t\tresult = Animation.prefilters[ index ].call( animation, elem, props, animation.opts );\n\t\tif ( result ) {\n\t\t\tif ( isFunction( result.stop ) ) {\n\t\t\t\tjQuery._queueHooks( animation.elem, animation.opts.queue ).stop =\n\t\t\t\t\tresult.stop.bind( result );\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t}\n\n\tjQuery.map( props, createTween, animation );\n\n\tif ( isFunction( animation.opts.start ) ) {\n\t\tanimation.opts.start.call( elem, animation );\n\t}\n\n\t// Attach callbacks from options\n\tanimation\n\t\t.progress( animation.opts.progress )\n\t\t.done( animation.opts.done, animation.opts.complete )\n\t\t.fail( animation.opts.fail )\n\t\t.always( animation.opts.always );\n\n\tjQuery.fx.timer(\n\t\tjQuery.extend( tick, {\n\t\t\telem: elem,\n\t\t\tanim: animation,\n\t\t\tqueue: animation.opts.queue\n\t\t} )\n\t);\n\n\treturn animation;\n}\n\njQuery.Animation = jQuery.extend( Animation, {\n\n\ttweeners: {\n\t\t\"*\": [ function( prop, value ) {\n\t\t\tvar tween = this.createTween( prop, value );\n\t\t\tadjustCSS( tween.elem, prop, rcssNum.exec( value ), tween );\n\t\t\treturn tween;\n\t\t} ]\n\t},\n\n\ttweener: function( props, callback ) {\n\t\tif ( isFunction( props ) ) {\n\t\t\tcallback = props;\n\t\t\tprops = [ \"*\" ];\n\t\t} else {\n\t\t\tprops = props.match( rnothtmlwhite );\n\t\t}\n\n\t\tvar prop,\n\t\t\tindex = 0,\n\t\t\tlength = props.length;\n\n\t\tfor ( ; index < length; index++ ) {\n\t\t\tprop = props[ index ];\n\t\t\tAnimation.tweeners[ prop ] = Animation.tweeners[ prop ] || [];\n\t\t\tAnimation.tweeners[ prop ].unshift( callback );\n\t\t}\n\t},\n\n\tprefilters: [ defaultPrefilter ],\n\n\tprefilter: function( callback, prepend ) {\n\t\tif ( prepend ) {\n\t\t\tAnimation.prefilters.unshift( callback );\n\t\t} else {\n\t\t\tAnimation.prefilters.push( callback );\n\t\t}\n\t}\n} );\n\njQuery.speed = function( speed, easing, fn ) {\n\tvar opt = speed && typeof speed === \"object\" ? jQuery.extend( {}, speed ) : {\n\t\tcomplete: fn || !fn && easing ||\n\t\t\tisFunction( speed ) && speed,\n\t\tduration: speed,\n\t\teasing: fn && easing || easing && !isFunction( easing ) && easing\n\t};\n\n\t// Go to the end state if fx are off\n\tif ( jQuery.fx.off ) {\n\t\topt.duration = 0;\n\n\t} else {\n\t\tif ( typeof opt.duration !== \"number\" ) {\n\t\t\tif ( opt.duration in jQuery.fx.speeds ) {\n\t\t\t\topt.duration = jQuery.fx.speeds[ opt.duration ];\n\n\t\t\t} else {\n\t\t\t\topt.duration = jQuery.fx.speeds._default;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Normalize opt.queue - true/undefined/null -> \"fx\"\n\tif ( opt.queue == null || opt.queue === true ) {\n\t\topt.queue = \"fx\";\n\t}\n\n\t// Queueing\n\topt.old = opt.complete;\n\n\topt.complete = function() {\n\t\tif ( isFunction( opt.old ) ) {\n\t\t\topt.old.call( this );\n\t\t}\n\n\t\tif ( opt.queue ) {\n\t\t\tjQuery.dequeue( this, opt.queue );\n\t\t}\n\t};\n\n\treturn opt;\n};\n\njQuery.fn.extend( {\n\tfadeTo: function( speed, to, easing, callback ) {\n\n\t\t// Show any hidden elements after setting opacity to 0\n\t\treturn this.filter( isHiddenWithinTree ).css( \"opacity\", 0 ).show()\n\n\t\t\t// Animate to the value specified\n\t\t\t.end().animate( { opacity: to }, speed, easing, callback );\n\t},\n\tanimate: function( prop, speed, easing, callback ) {\n\t\tvar empty = jQuery.isEmptyObject( prop ),\n\t\t\toptall = jQuery.speed( speed, easing, callback ),\n\t\t\tdoAnimation = function() {\n\n\t\t\t\t// Operate on a copy of prop so per-property easing won't be lost\n\t\t\t\tvar anim = Animation( this, jQuery.extend( {}, prop ), optall );\n\n\t\t\t\t// Empty animations, or finishing resolves immediately\n\t\t\t\tif ( empty || dataPriv.get( this, \"finish\" ) ) {\n\t\t\t\t\tanim.stop( true );\n\t\t\t\t}\n\t\t\t};\n\t\t\tdoAnimation.finish = doAnimation;\n\n\t\treturn empty || optall.queue === false ?\n\t\t\tthis.each( doAnimation ) :\n\t\t\tthis.queue( optall.queue, doAnimation );\n\t},\n\tstop: function( type, clearQueue, gotoEnd ) {\n\t\tvar stopQueue = function( hooks ) {\n\t\t\tvar stop = hooks.stop;\n\t\t\tdelete hooks.stop;\n\t\t\tstop( gotoEnd );\n\t\t};\n\n\t\tif ( typeof type !== \"string\" ) {\n\t\t\tgotoEnd = clearQueue;\n\t\t\tclearQueue = type;\n\t\t\ttype = undefined;\n\t\t}\n\t\tif ( clearQueue && type !== false ) {\n\t\t\tthis.queue( type || \"fx\", [] );\n\t\t}\n\n\t\treturn this.each( function() {\n\t\t\tvar dequeue = true,\n\t\t\t\tindex = type != null && type + \"queueHooks\",\n\t\t\t\ttimers = jQuery.timers,\n\t\t\t\tdata = dataPriv.get( this );\n\n\t\t\tif ( index ) {\n\t\t\t\tif ( data[ index ] && data[ index ].stop ) {\n\t\t\t\t\tstopQueue( data[ index ] );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor ( index in data ) {\n\t\t\t\t\tif ( data[ index ] && data[ index ].stop && rrun.test( index ) ) {\n\t\t\t\t\t\tstopQueue( data[ index ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor ( index = timers.length; index--; ) {\n\t\t\t\tif ( timers[ index ].elem === this &&\n\t\t\t\t\t( type == null || timers[ index ].queue === type ) ) {\n\n\t\t\t\t\ttimers[ index ].anim.stop( gotoEnd );\n\t\t\t\t\tdequeue = false;\n\t\t\t\t\ttimers.splice( index, 1 );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Start the next in the queue if the last step wasn't forced.\n\t\t\t// Timers currently will call their complete callbacks, which\n\t\t\t// will dequeue but only if they were gotoEnd.\n\t\t\tif ( dequeue || !gotoEnd ) {\n\t\t\t\tjQuery.dequeue( this, type );\n\t\t\t}\n\t\t} );\n\t},\n\tfinish: function( type ) {\n\t\tif ( type !== false ) {\n\t\t\ttype = type || \"fx\";\n\t\t}\n\t\treturn this.each( function() {\n\t\t\tvar index,\n\t\t\t\tdata = dataPriv.get( this ),\n\t\t\t\tqueue = data[ type + \"queue\" ],\n\t\t\t\thooks = data[ type + \"queueHooks\" ],\n\t\t\t\ttimers = jQuery.timers,\n\t\t\t\tlength = queue ? queue.length : 0;\n\n\t\t\t// Enable finishing flag on private data\n\t\t\tdata.finish = true;\n\n\t\t\t// Empty the queue first\n\t\t\tjQuery.queue( this, type, [] );\n\n\t\t\tif ( hooks && hooks.stop ) {\n\t\t\t\thooks.stop.call( this, true );\n\t\t\t}\n\n\t\t\t// Look for any active animations, and finish them\n\t\t\tfor ( index = timers.length; index--; ) {\n\t\t\t\tif ( timers[ index ].elem === this && timers[ index ].queue === type ) {\n\t\t\t\t\ttimers[ index ].anim.stop( true );\n\t\t\t\t\ttimers.splice( index, 1 );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Look for any animations in the old queue and finish them\n\t\t\tfor ( index = 0; index < length; index++ ) {\n\t\t\t\tif ( queue[ index ] && queue[ index ].finish ) {\n\t\t\t\t\tqueue[ index ].finish.call( this );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Turn off finishing flag\n\t\t\tdelete data.finish;\n\t\t} );\n\t}\n} );\n\njQuery.each( [ \"toggle\", \"show\", \"hide\" ], function( i, name ) {\n\tvar cssFn = jQuery.fn[ name ];\n\tjQuery.fn[ name ] = function( speed, easing, callback ) {\n\t\treturn speed == null || typeof speed === \"boolean\" ?\n\t\t\tcssFn.apply( this, arguments ) :\n\t\t\tthis.animate( genFx( name, true ), speed, easing, callback );\n\t};\n} );\n\n// Generate shortcuts for custom animations\njQuery.each( {\n\tslideDown: genFx( \"show\" ),\n\tslideUp: genFx( \"hide\" ),\n\tslideToggle: genFx( \"toggle\" ),\n\tfadeIn: { opacity: \"show\" },\n\tfadeOut: { opacity: \"hide\" },\n\tfadeToggle: { opacity: \"toggle\" }\n}, function( name, props ) {\n\tjQuery.fn[ name ] = function( speed, easing, callback ) {\n\t\treturn this.animate( props, speed, easing, callback );\n\t};\n} );\n\njQuery.timers = [];\njQuery.fx.tick = function() {\n\tvar timer,\n\t\ti = 0,\n\t\ttimers = jQuery.timers;\n\n\tfxNow = Date.now();\n\n\tfor ( ; i < timers.length; i++ ) {\n\t\ttimer = timers[ i ];\n\n\t\t// Run the timer and safely remove it when done (allowing for external removal)\n\t\tif ( !timer() && timers[ i ] === timer ) {\n\t\t\ttimers.splice( i--, 1 );\n\t\t}\n\t}\n\n\tif ( !timers.length ) {\n\t\tjQuery.fx.stop();\n\t}\n\tfxNow = undefined;\n};\n\njQuery.fx.timer = function( timer ) {\n\tjQuery.timers.push( timer );\n\tjQuery.fx.start();\n};\n\njQuery.fx.interval = 13;\njQuery.fx.start = function() {\n\tif ( inProgress ) {\n\t\treturn;\n\t}\n\n\tinProgress = true;\n\tschedule();\n};\n\njQuery.fx.stop = function() {\n\tinProgress = null;\n};\n\njQuery.fx.speeds = {\n\tslow: 600,\n\tfast: 200,\n\n\t// Default speed\n\t_default: 400\n};\n\n\n// Based off of the plugin by Clint Helfers, with permission.\n// https://web.archive.org/web/20100324014747/http://blindsignals.com/index.php/2009/07/jquery-delay/\njQuery.fn.delay = function( time, type ) {\n\ttime = jQuery.fx ? jQuery.fx.speeds[ time ] || time : time;\n\ttype = type || \"fx\";\n\n\treturn this.queue( type, function( next, hooks ) {\n\t\tvar timeout = window.setTimeout( next, time );\n\t\thooks.stop = function() {\n\t\t\twindow.clearTimeout( timeout );\n\t\t};\n\t} );\n};\n\n\n( function() {\n\tvar input = document.createElement( \"input\" ),\n\t\tselect = document.createElement( \"select\" ),\n\t\topt = select.appendChild( document.createElement( \"option\" ) );\n\n\tinput.type = \"checkbox\";\n\n\t// Support: Android <=4.3 only\n\t// Default value for a checkbox should be \"on\"\n\tsupport.checkOn = input.value !== \"\";\n\n\t// Support: IE <=11 only\n\t// Must access selectedIndex to make default options select\n\tsupport.optSelected = opt.selected;\n\n\t// Support: IE <=11 only\n\t// An input loses its value after becoming a radio\n\tinput = document.createElement( \"input\" );\n\tinput.value = \"t\";\n\tinput.type = \"radio\";\n\tsupport.radioValue = input.value === \"t\";\n} )();\n\n\nvar boolHook,\n\tattrHandle = jQuery.expr.attrHandle;\n\njQuery.fn.extend( {\n\tattr: function( name, value ) {\n\t\treturn access( this, jQuery.attr, name, value, arguments.length > 1 );\n\t},\n\n\tremoveAttr: function( name ) {\n\t\treturn this.each( function() {\n\t\t\tjQuery.removeAttr( this, name );\n\t\t} );\n\t}\n} );\n\njQuery.extend( {\n\tattr: function( elem, name, value ) {\n\t\tvar ret, hooks,\n\t\t\tnType = elem.nodeType;\n\n\t\t// Don't get/set attributes on text, comment and attribute nodes\n\t\tif ( nType === 3 || nType === 8 || nType === 2 ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Fallback to prop when attributes are not supported\n\t\tif ( typeof elem.getAttribute === \"undefined\" ) {\n\t\t\treturn jQuery.prop( elem, name, value );\n\t\t}\n\n\t\t// Attribute hooks are determined by the lowercase version\n\t\t// Grab necessary hook if one is defined\n\t\tif ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {\n\t\t\thooks = jQuery.attrHooks[ name.toLowerCase() ] ||\n\t\t\t\t( jQuery.expr.match.bool.test( name ) ? boolHook : undefined );\n\t\t}\n\n\t\tif ( value !== undefined ) {\n\t\t\tif ( value === null ) {\n\t\t\t\tjQuery.removeAttr( elem, name );\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( hooks && \"set\" in hooks &&\n\t\t\t\t( ret = hooks.set( elem, value, name ) ) !== undefined ) {\n\t\t\t\treturn ret;\n\t\t\t}\n\n\t\t\telem.setAttribute( name, value + \"\" );\n\t\t\treturn value;\n\t\t}\n\n\t\tif ( hooks && \"get\" in hooks && ( ret = hooks.get( elem, name ) ) !== null ) {\n\t\t\treturn ret;\n\t\t}\n\n\t\tret = jQuery.find.attr( elem, name );\n\n\t\t// Non-existent attributes return null, we normalize to undefined\n\t\treturn ret == null ? undefined : ret;\n\t},\n\n\tattrHooks: {\n\t\ttype: {\n\t\t\tset: function( elem, value ) {\n\t\t\t\tif ( !support.radioValue && value === \"radio\" &&\n\t\t\t\t\tnodeName( elem, \"input\" ) ) {\n\t\t\t\t\tvar val = elem.value;\n\t\t\t\t\telem.setAttribute( \"type\", value );\n\t\t\t\t\tif ( val ) {\n\t\t\t\t\t\telem.value = val;\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tremoveAttr: function( elem, value ) {\n\t\tvar name,\n\t\t\ti = 0,\n\n\t\t\t// Attribute names can contain non-HTML whitespace characters\n\t\t\t// https://html.spec.whatwg.org/multipage/syntax.html#attributes-2\n\t\t\tattrNames = value && value.match( rnothtmlwhite );\n\n\t\tif ( attrNames && elem.nodeType === 1 ) {\n\t\t\twhile ( ( name = attrNames[ i++ ] ) ) {\n\t\t\t\telem.removeAttribute( name );\n\t\t\t}\n\t\t}\n\t}\n} );\n\n// Hooks for boolean attributes\nboolHook = {\n\tset: function( elem, value, name ) {\n\t\tif ( value === false ) {\n\n\t\t\t// Remove boolean attributes when set to false\n\t\t\tjQuery.removeAttr( elem, name );\n\t\t} else {\n\t\t\telem.setAttribute( name, name );\n\t\t}\n\t\treturn name;\n\t}\n};\n\njQuery.each( jQuery.expr.match.bool.source.match( /\\w+/g ), function( i, name ) {\n\tvar getter = attrHandle[ name ] || jQuery.find.attr;\n\n\tattrHandle[ name ] = function( elem, name, isXML ) {\n\t\tvar ret, handle,\n\t\t\tlowercaseName = name.toLowerCase();\n\n\t\tif ( !isXML ) {\n\n\t\t\t// Avoid an infinite loop by temporarily removing this function from the getter\n\t\t\thandle = attrHandle[ lowercaseName ];\n\t\t\tattrHandle[ lowercaseName ] = ret;\n\t\t\tret = getter( elem, name, isXML ) != null ?\n\t\t\t\tlowercaseName :\n\t\t\t\tnull;\n\t\t\tattrHandle[ lowercaseName ] = handle;\n\t\t}\n\t\treturn ret;\n\t};\n} );\n\n\n\n\nvar rfocusable = /^(?:input|select|textarea|button)$/i,\n\trclickable = /^(?:a|area)$/i;\n\njQuery.fn.extend( {\n\tprop: function( name, value ) {\n\t\treturn access( this, jQuery.prop, name, value, arguments.length > 1 );\n\t},\n\n\tremoveProp: function( name ) {\n\t\treturn this.each( function() {\n\t\t\tdelete this[ jQuery.propFix[ name ] || name ];\n\t\t} );\n\t}\n} );\n\njQuery.extend( {\n\tprop: function( elem, name, value ) {\n\t\tvar ret, hooks,\n\t\t\tnType = elem.nodeType;\n\n\t\t// Don't get/set properties on text, comment and attribute nodes\n\t\tif ( nType === 3 || nType === 8 || nType === 2 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {\n\n\t\t\t// Fix name and attach hooks\n\t\t\tname = jQuery.propFix[ name ] || name;\n\t\t\thooks = jQuery.propHooks[ name ];\n\t\t}\n\n\t\tif ( value !== undefined ) {\n\t\t\tif ( hooks && \"set\" in hooks &&\n\t\t\t\t( ret = hooks.set( elem, value, name ) ) !== undefined ) {\n\t\t\t\treturn ret;\n\t\t\t}\n\n\t\t\treturn ( elem[ name ] = value );\n\t\t}\n\n\t\tif ( hooks && \"get\" in hooks && ( ret = hooks.get( elem, name ) ) !== null ) {\n\t\t\treturn ret;\n\t\t}\n\n\t\treturn elem[ name ];\n\t},\n\n\tpropHooks: {\n\t\ttabIndex: {\n\t\t\tget: function( elem ) {\n\n\t\t\t\t// Support: IE <=9 - 11 only\n\t\t\t\t// elem.tabIndex doesn't always return the\n\t\t\t\t// correct value when it hasn't been explicitly set\n\t\t\t\t// https://web.archive.org/web/20141116233347/http://fluidproject.org/blog/2008/01/09/getting-setting-and-removing-tabindex-values-with-javascript/\n\t\t\t\t// Use proper attribute retrieval(#12072)\n\t\t\t\tvar tabindex = jQuery.find.attr( elem, \"tabindex\" );\n\n\t\t\t\tif ( tabindex ) {\n\t\t\t\t\treturn parseInt( tabindex, 10 );\n\t\t\t\t}\n\n\t\t\t\tif (\n\t\t\t\t\trfocusable.test( elem.nodeName ) ||\n\t\t\t\t\trclickable.test( elem.nodeName ) &&\n\t\t\t\t\telem.href\n\t\t\t\t) {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\t},\n\n\tpropFix: {\n\t\t\"for\": \"htmlFor\",\n\t\t\"class\": \"className\"\n\t}\n} );\n\n// Support: IE <=11 only\n// Accessing the selectedIndex property\n// forces the browser to respect setting selected\n// on the option\n// The getter ensures a default option is selected\n// when in an optgroup\n// eslint rule \"no-unused-expressions\" is disabled for this code\n// since it considers such accessions noop\nif ( !support.optSelected ) {\n\tjQuery.propHooks.selected = {\n\t\tget: function( elem ) {\n\n\t\t\t/* eslint no-unused-expressions: \"off\" */\n\n\t\t\tvar parent = elem.parentNode;\n\t\t\tif ( parent && parent.parentNode ) {\n\t\t\t\tparent.parentNode.selectedIndex;\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tset: function( elem ) {\n\n\t\t\t/* eslint no-unused-expressions: \"off\" */\n\n\t\t\tvar parent = elem.parentNode;\n\t\t\tif ( parent ) {\n\t\t\t\tparent.selectedIndex;\n\n\t\t\t\tif ( parent.parentNode ) {\n\t\t\t\t\tparent.parentNode.selectedIndex;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}\n\njQuery.each( [\n\t\"tabIndex\",\n\t\"readOnly\",\n\t\"maxLength\",\n\t\"cellSpacing\",\n\t\"cellPadding\",\n\t\"rowSpan\",\n\t\"colSpan\",\n\t\"useMap\",\n\t\"frameBorder\",\n\t\"contentEditable\"\n], function() {\n\tjQuery.propFix[ this.toLowerCase() ] = this;\n} );\n\n\n\n\n\t// Strip and collapse whitespace according to HTML spec\n\t// https://infra.spec.whatwg.org/#strip-and-collapse-ascii-whitespace\n\tfunction stripAndCollapse( value ) {\n\t\tvar tokens = value.match( rnothtmlwhite ) || [];\n\t\treturn tokens.join( \" \" );\n\t}\n\n\nfunction getClass( elem ) {\n\treturn elem.getAttribute && elem.getAttribute( \"class\" ) || \"\";\n}\n\nfunction classesToArray( value ) {\n\tif ( Array.isArray( value ) ) {\n\t\treturn value;\n\t}\n\tif ( typeof value === \"string\" ) {\n\t\treturn value.match( rnothtmlwhite ) || [];\n\t}\n\treturn [];\n}\n\njQuery.fn.extend( {\n\taddClass: function( value ) {\n\t\tvar classes, elem, cur, curValue, clazz, j, finalValue,\n\t\t\ti = 0;\n\n\t\tif ( isFunction( value ) ) {\n\t\t\treturn this.each( function( j ) {\n\t\t\t\tjQuery( this ).addClass( value.call( this, j, getClass( this ) ) );\n\t\t\t} );\n\t\t}\n\n\t\tclasses = classesToArray( value );\n\n\t\tif ( classes.length ) {\n\t\t\twhile ( ( elem = this[ i++ ] ) ) {\n\t\t\t\tcurValue = getClass( elem );\n\t\t\t\tcur = elem.nodeType === 1 && ( \" \" + stripAndCollapse( curValue ) + \" \" );\n\n\t\t\t\tif ( cur ) {\n\t\t\t\t\tj = 0;\n\t\t\t\t\twhile ( ( clazz = classes[ j++ ] ) ) {\n\t\t\t\t\t\tif ( cur.indexOf( \" \" + clazz + \" \" ) < 0 ) {\n\t\t\t\t\t\t\tcur += clazz + \" \";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Only assign if different to avoid unneeded rendering.\n\t\t\t\t\tfinalValue = stripAndCollapse( cur );\n\t\t\t\t\tif ( curValue !== finalValue ) {\n\t\t\t\t\t\telem.setAttribute( \"class\", finalValue );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tremoveClass: function( value ) {\n\t\tvar classes, elem, cur, curValue, clazz, j, finalValue,\n\t\t\ti = 0;\n\n\t\tif ( isFunction( value ) ) {\n\t\t\treturn this.each( function( j ) {\n\t\t\t\tjQuery( this ).removeClass( value.call( this, j, getClass( this ) ) );\n\t\t\t} );\n\t\t}\n\n\t\tif ( !arguments.length ) {\n\t\t\treturn this.attr( \"class\", \"\" );\n\t\t}\n\n\t\tclasses = classesToArray( value );\n\n\t\tif ( classes.length ) {\n\t\t\twhile ( ( elem = this[ i++ ] ) ) {\n\t\t\t\tcurValue = getClass( elem );\n\n\t\t\t\t// This expression is here for better compressibility (see addClass)\n\t\t\t\tcur = elem.nodeType === 1 && ( \" \" + stripAndCollapse( curValue ) + \" \" );\n\n\t\t\t\tif ( cur ) {\n\t\t\t\t\tj = 0;\n\t\t\t\t\twhile ( ( clazz = classes[ j++ ] ) ) {\n\n\t\t\t\t\t\t// Remove *all* instances\n\t\t\t\t\t\twhile ( cur.indexOf( \" \" + clazz + \" \" ) > -1 ) {\n\t\t\t\t\t\t\tcur = cur.replace( \" \" + clazz + \" \", \" \" );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Only assign if different to avoid unneeded rendering.\n\t\t\t\t\tfinalValue = stripAndCollapse( cur );\n\t\t\t\t\tif ( curValue !== finalValue ) {\n\t\t\t\t\t\telem.setAttribute( \"class\", finalValue );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\ttoggleClass: function( value, stateVal ) {\n\t\tvar type = typeof value,\n\t\t\tisValidValue = type === \"string\" || Array.isArray( value );\n\n\t\tif ( typeof stateVal === \"boolean\" && isValidValue ) {\n\t\t\treturn stateVal ? this.addClass( value ) : this.removeClass( value );\n\t\t}\n\n\t\tif ( isFunction( value ) ) {\n\t\t\treturn this.each( function( i ) {\n\t\t\t\tjQuery( this ).toggleClass(\n\t\t\t\t\tvalue.call( this, i, getClass( this ), stateVal ),\n\t\t\t\t\tstateVal\n\t\t\t\t);\n\t\t\t} );\n\t\t}\n\n\t\treturn this.each( function() {\n\t\t\tvar className, i, self, classNames;\n\n\t\t\tif ( isValidValue ) {\n\n\t\t\t\t// Toggle individual class names\n\t\t\t\ti = 0;\n\t\t\t\tself = jQuery( this );\n\t\t\t\tclassNames = classesToArray( value );\n\n\t\t\t\twhile ( ( className = classNames[ i++ ] ) ) {\n\n\t\t\t\t\t// Check each className given, space separated list\n\t\t\t\t\tif ( self.hasClass( className ) ) {\n\t\t\t\t\t\tself.removeClass( className );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.addClass( className );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t// Toggle whole class name\n\t\t\t} else if ( value === undefined || type === \"boolean\" ) {\n\t\t\t\tclassName = getClass( this );\n\t\t\t\tif ( className ) {\n\n\t\t\t\t\t// Store className if set\n\t\t\t\t\tdataPriv.set( this, \"__className__\", className );\n\t\t\t\t}\n\n\t\t\t\t// If the element has a class name or if we're passed `false`,\n\t\t\t\t// then remove the whole classname (if there was one, the above saved it).\n\t\t\t\t// Otherwise bring back whatever was previously saved (if anything),\n\t\t\t\t// falling back to the empty string if nothing was stored.\n\t\t\t\tif ( this.setAttribute ) {\n\t\t\t\t\tthis.setAttribute( \"class\",\n\t\t\t\t\t\tclassName || value === false ?\n\t\t\t\t\t\t\"\" :\n\t\t\t\t\t\tdataPriv.get( this, \"__className__\" ) || \"\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t} );\n\t},\n\n\thasClass: function( selector ) {\n\t\tvar className, elem,\n\t\t\ti = 0;\n\n\t\tclassName = \" \" + selector + \" \";\n\t\twhile ( ( elem = this[ i++ ] ) ) {\n\t\t\tif ( elem.nodeType === 1 &&\n\t\t\t\t( \" \" + stripAndCollapse( getClass( elem ) ) + \" \" ).indexOf( className ) > -1 ) {\n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n} );\n\n\n\n\nvar rreturn = /\\r/g;\n\njQuery.fn.extend( {\n\tval: function( value ) {\n\t\tvar hooks, ret, valueIsFunction,\n\t\t\telem = this[ 0 ];\n\n\t\tif ( !arguments.length ) {\n\t\t\tif ( elem ) {\n\t\t\t\thooks = jQuery.valHooks[ elem.type ] ||\n\t\t\t\t\tjQuery.valHooks[ elem.nodeName.toLowerCase() ];\n\n\t\t\t\tif ( hooks &&\n\t\t\t\t\t\"get\" in hooks &&\n\t\t\t\t\t( ret = hooks.get( elem, \"value\" ) ) !== undefined\n\t\t\t\t) {\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\n\t\t\t\tret = elem.value;\n\n\t\t\t\t// Handle most common string cases\n\t\t\t\tif ( typeof ret === \"string\" ) {\n\t\t\t\t\treturn ret.replace( rreturn, \"\" );\n\t\t\t\t}\n\n\t\t\t\t// Handle cases where value is null/undef or number\n\t\t\t\treturn ret == null ? \"\" : ret;\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tvalueIsFunction = isFunction( value );\n\n\t\treturn this.each( function( i ) {\n\t\t\tvar val;\n\n\t\t\tif ( this.nodeType !== 1 ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( valueIsFunction ) {\n\t\t\t\tval = value.call( this, i, jQuery( this ).val() );\n\t\t\t} else {\n\t\t\t\tval = value;\n\t\t\t}\n\n\t\t\t// Treat null/undefined as \"\"; convert numbers to string\n\t\t\tif ( val == null ) {\n\t\t\t\tval = \"\";\n\n\t\t\t} else if ( typeof val === \"number\" ) {\n\t\t\t\tval += \"\";\n\n\t\t\t} else if ( Array.isArray( val ) ) {\n\t\t\t\tval = jQuery.map( val, function( value ) {\n\t\t\t\t\treturn value == null ? \"\" : value + \"\";\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\thooks = jQuery.valHooks[ this.type ] || jQuery.valHooks[ this.nodeName.toLowerCase() ];\n\n\t\t\t// If set returns undefined, fall back to normal setting\n\t\t\tif ( !hooks || !( \"set\" in hooks ) || hooks.set( this, val, \"value\" ) === undefined ) {\n\t\t\t\tthis.value = val;\n\t\t\t}\n\t\t} );\n\t}\n} );\n\njQuery.extend( {\n\tvalHooks: {\n\t\toption: {\n\t\t\tget: function( elem ) {\n\n\t\t\t\tvar val = jQuery.find.attr( elem, \"value\" );\n\t\t\t\treturn val != null ?\n\t\t\t\t\tval :\n\n\t\t\t\t\t// Support: IE <=10 - 11 only\n\t\t\t\t\t// option.text throws exceptions (#14686, #14858)\n\t\t\t\t\t// Strip and collapse whitespace\n\t\t\t\t\t// https://html.spec.whatwg.org/#strip-and-collapse-whitespace\n\t\t\t\t\tstripAndCollapse( jQuery.text( elem ) );\n\t\t\t}\n\t\t},\n\t\tselect: {\n\t\t\tget: function( elem ) {\n\t\t\t\tvar value, option, i,\n\t\t\t\t\toptions = elem.options,\n\t\t\t\t\tindex = elem.selectedIndex,\n\t\t\t\t\tone = elem.type === \"select-one\",\n\t\t\t\t\tvalues = one ? null : [],\n\t\t\t\t\tmax = one ? index + 1 : options.length;\n\n\t\t\t\tif ( index < 0 ) {\n\t\t\t\t\ti = max;\n\n\t\t\t\t} else {\n\t\t\t\t\ti = one ? index : 0;\n\t\t\t\t}\n\n\t\t\t\t// Loop through all the selected options\n\t\t\t\tfor ( ; i < max; i++ ) {\n\t\t\t\t\toption = options[ i ];\n\n\t\t\t\t\t// Support: IE <=9 only\n\t\t\t\t\t// IE8-9 doesn't update selected after form reset (#2551)\n\t\t\t\t\tif ( ( option.selected || i === index ) &&\n\n\t\t\t\t\t\t\t// Don't return options that are disabled or in a disabled optgroup\n\t\t\t\t\t\t\t!option.disabled &&\n\t\t\t\t\t\t\t( !option.parentNode.disabled ||\n\t\t\t\t\t\t\t\t!nodeName( option.parentNode, \"optgroup\" ) ) ) {\n\n\t\t\t\t\t\t// Get the specific value for the option\n\t\t\t\t\t\tvalue = jQuery( option ).val();\n\n\t\t\t\t\t\t// We don't need an array for one selects\n\t\t\t\t\t\tif ( one ) {\n\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Multi-Selects return an array\n\t\t\t\t\t\tvalues.push( value );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn values;\n\t\t\t},\n\n\t\t\tset: function( elem, value ) {\n\t\t\t\tvar optionSet, option,\n\t\t\t\t\toptions = elem.options,\n\t\t\t\t\tvalues = jQuery.makeArray( value ),\n\t\t\t\t\ti = options.length;\n\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\toption = options[ i ];\n\n\t\t\t\t\t/* eslint-disable no-cond-assign */\n\n\t\t\t\t\tif ( option.selected =\n\t\t\t\t\t\tjQuery.inArray( jQuery.valHooks.option.get( option ), values ) > -1\n\t\t\t\t\t) {\n\t\t\t\t\t\toptionSet = true;\n\t\t\t\t\t}\n\n\t\t\t\t\t/* eslint-enable no-cond-assign */\n\t\t\t\t}\n\n\t\t\t\t// Force browsers to behave consistently when non-matching value is set\n\t\t\t\tif ( !optionSet ) {\n\t\t\t\t\telem.selectedIndex = -1;\n\t\t\t\t}\n\t\t\t\treturn values;\n\t\t\t}\n\t\t}\n\t}\n} );\n\n// Radios and checkboxes getter/setter\njQuery.each( [ \"radio\", \"checkbox\" ], function() {\n\tjQuery.valHooks[ this ] = {\n\t\tset: function( elem, value ) {\n\t\t\tif ( Array.isArray( value ) ) {\n\t\t\t\treturn ( elem.checked = jQuery.inArray( jQuery( elem ).val(), value ) > -1 );\n\t\t\t}\n\t\t}\n\t};\n\tif ( !support.checkOn ) {\n\t\tjQuery.valHooks[ this ].get = function( elem ) {\n\t\t\treturn elem.getAttribute( \"value\" ) === null ? \"on\" : elem.value;\n\t\t};\n\t}\n} );\n\n\n\n\n// Return jQuery for attributes-only inclusion\n\n\nsupport.focusin = \"onfocusin\" in window;\n\n\nvar rfocusMorph = /^(?:focusinfocus|focusoutblur)$/,\n\tstopPropagationCallback = function( e ) {\n\t\te.stopPropagation();\n\t};\n\njQuery.extend( jQuery.event, {\n\n\ttrigger: function( event, data, elem, onlyHandlers ) {\n\n\t\tvar i, cur, tmp, bubbleType, ontype, handle, special, lastElement,\n\t\t\teventPath = [ elem || document ],\n\t\t\ttype = hasOwn.call( event, \"type\" ) ? event.type : event,\n\t\t\tnamespaces = hasOwn.call( event, \"namespace\" ) ? event.namespace.split( \".\" ) : [];\n\n\t\tcur = lastElement = tmp = elem = elem || document;\n\n\t\t// Don't do events on text and comment nodes\n\t\tif ( elem.nodeType === 3 || elem.nodeType === 8 ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// focus/blur morphs to focusin/out; ensure we're not firing them right now\n\t\tif ( rfocusMorph.test( type + jQuery.event.triggered ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( type.indexOf( \".\" ) > -1 ) {\n\n\t\t\t// Namespaced trigger; create a regexp to match event type in handle()\n\t\t\tnamespaces = type.split( \".\" );\n\t\t\ttype = namespaces.shift();\n\t\t\tnamespaces.sort();\n\t\t}\n\t\tontype = type.indexOf( \":\" ) < 0 && \"on\" + type;\n\n\t\t// Caller can pass in a jQuery.Event object, Object, or just an event type string\n\t\tevent = event[ jQuery.expando ] ?\n\t\t\tevent :\n\t\t\tnew jQuery.Event( type, typeof event === \"object\" && event );\n\n\t\t// Trigger bitmask: & 1 for native handlers; & 2 for jQuery (always true)\n\t\tevent.isTrigger = onlyHandlers ? 2 : 3;\n\t\tevent.namespace = namespaces.join( \".\" );\n\t\tevent.rnamespace = event.namespace ?\n\t\t\tnew RegExp( \"(^|\\\\.)\" + namespaces.join( \"\\\\.(?:.*\\\\.|)\" ) + \"(\\\\.|$)\" ) :\n\t\t\tnull;\n\n\t\t// Clean up the event in case it is being reused\n\t\tevent.result = undefined;\n\t\tif ( !event.target ) {\n\t\t\tevent.target = elem;\n\t\t}\n\n\t\t// Clone any incoming data and prepend the event, creating the handler arg list\n\t\tdata = data == null ?\n\t\t\t[ event ] :\n\t\t\tjQuery.makeArray( data, [ event ] );\n\n\t\t// Allow special events to draw outside the lines\n\t\tspecial = jQuery.event.special[ type ] || {};\n\t\tif ( !onlyHandlers && special.trigger && special.trigger.apply( elem, data ) === false ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Determine event propagation path in advance, per W3C events spec (#9951)\n\t\t// Bubble up to document, then to window; watch for a global ownerDocument var (#9724)\n\t\tif ( !onlyHandlers && !special.noBubble && !isWindow( elem ) ) {\n\n\t\t\tbubbleType = special.delegateType || type;\n\t\t\tif ( !rfocusMorph.test( bubbleType + type ) ) {\n\t\t\t\tcur = cur.parentNode;\n\t\t\t}\n\t\t\tfor ( ; cur; cur = cur.parentNode ) {\n\t\t\t\teventPath.push( cur );\n\t\t\t\ttmp = cur;\n\t\t\t}\n\n\t\t\t// Only add window if we got to document (e.g., not plain obj or detached DOM)\n\t\t\tif ( tmp === ( elem.ownerDocument || document ) ) {\n\t\t\t\teventPath.push( tmp.defaultView || tmp.parentWindow || window );\n\t\t\t}\n\t\t}\n\n\t\t// Fire handlers on the event path\n\t\ti = 0;\n\t\twhile ( ( cur = eventPath[ i++ ] ) && !event.isPropagationStopped() ) {\n\t\t\tlastElement = cur;\n\t\t\tevent.type = i > 1 ?\n\t\t\t\tbubbleType :\n\t\t\t\tspecial.bindType || type;\n\n\t\t\t// jQuery handler\n\t\t\thandle = ( dataPriv.get( cur, \"events\" ) || {} )[ event.type ] &&\n\t\t\t\tdataPriv.get( cur, \"handle\" );\n\t\t\tif ( handle ) {\n\t\t\t\thandle.apply( cur, data );\n\t\t\t}\n\n\t\t\t// Native handler\n\t\t\thandle = ontype && cur[ ontype ];\n\t\t\tif ( handle && handle.apply && acceptData( cur ) ) {\n\t\t\t\tevent.result = handle.apply( cur, data );\n\t\t\t\tif ( event.result === false ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tevent.type = type;\n\n\t\t// If nobody prevented the default action, do it now\n\t\tif ( !onlyHandlers && !event.isDefaultPrevented() ) {\n\n\t\t\tif ( ( !special._default ||\n\t\t\t\tspecial._default.apply( eventPath.pop(), data ) === false ) &&\n\t\t\t\tacceptData( elem ) ) {\n\n\t\t\t\t// Call a native DOM method on the target with the same name as the event.\n\t\t\t\t// Don't do default actions on window, that's where global variables be (#6170)\n\t\t\t\tif ( ontype && isFunction( elem[ type ] ) && !isWindow( elem ) ) {\n\n\t\t\t\t\t// Don't re-trigger an onFOO event when we call its FOO() method\n\t\t\t\t\ttmp = elem[ ontype ];\n\n\t\t\t\t\tif ( tmp ) {\n\t\t\t\t\t\telem[ ontype ] = null;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Prevent re-triggering of the same event, since we already bubbled it above\n\t\t\t\t\tjQuery.event.triggered = type;\n\n\t\t\t\t\tif ( event.isPropagationStopped() ) {\n\t\t\t\t\t\tlastElement.addEventListener( type, stopPropagationCallback );\n\t\t\t\t\t}\n\n\t\t\t\t\telem[ type ]();\n\n\t\t\t\t\tif ( event.isPropagationStopped() ) {\n\t\t\t\t\t\tlastElement.removeEventListener( type, stopPropagationCallback );\n\t\t\t\t\t}\n\n\t\t\t\t\tjQuery.event.triggered = undefined;\n\n\t\t\t\t\tif ( tmp ) {\n\t\t\t\t\t\telem[ ontype ] = tmp;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn event.result;\n\t},\n\n\t// Piggyback on a donor event to simulate a different one\n\t// Used only for `focus(in | out)` events\n\tsimulate: function( type, elem, event ) {\n\t\tvar e = jQuery.extend(\n\t\t\tnew jQuery.Event(),\n\t\t\tevent,\n\t\t\t{\n\t\t\t\ttype: type,\n\t\t\t\tisSimulated: true\n\t\t\t}\n\t\t);\n\n\t\tjQuery.event.trigger( e, null, elem );\n\t}\n\n} );\n\njQuery.fn.extend( {\n\n\ttrigger: function( type, data ) {\n\t\treturn this.each( function() {\n\t\t\tjQuery.event.trigger( type, data, this );\n\t\t} );\n\t},\n\ttriggerHandler: function( type, data ) {\n\t\tvar elem = this[ 0 ];\n\t\tif ( elem ) {\n\t\t\treturn jQuery.event.trigger( type, data, elem, true );\n\t\t}\n\t}\n} );\n\n\n// Support: Firefox <=44\n// Firefox doesn't have focus(in | out) events\n// Related ticket - https://bugzilla.mozilla.org/show_bug.cgi?id=687787\n//\n// Support: Chrome <=48 - 49, Safari <=9.0 - 9.1\n// focus(in | out) events fire after focus & blur events,\n// which is spec violation - http://www.w3.org/TR/DOM-Level-3-Events/#events-focusevent-event-order\n// Related ticket - https://bugs.chromium.org/p/chromium/issues/detail?id=449857\nif ( !support.focusin ) {\n\tjQuery.each( { focus: \"focusin\", blur: \"focusout\" }, function( orig, fix ) {\n\n\t\t// Attach a single capturing handler on the document while someone wants focusin/focusout\n\t\tvar handler = function( event ) {\n\t\t\tjQuery.event.simulate( fix, event.target, jQuery.event.fix( event ) );\n\t\t};\n\n\t\tjQuery.event.special[ fix ] = {\n\t\t\tsetup: function() {\n\t\t\t\tvar doc = this.ownerDocument || this,\n\t\t\t\t\tattaches = dataPriv.access( doc, fix );\n\n\t\t\t\tif ( !attaches ) {\n\t\t\t\t\tdoc.addEventListener( orig, handler, true );\n\t\t\t\t}\n\t\t\t\tdataPriv.access( doc, fix, ( attaches || 0 ) + 1 );\n\t\t\t},\n\t\t\tteardown: function() {\n\t\t\t\tvar doc = this.ownerDocument || this,\n\t\t\t\t\tattaches = dataPriv.access( doc, fix ) - 1;\n\n\t\t\t\tif ( !attaches ) {\n\t\t\t\t\tdoc.removeEventListener( orig, handler, true );\n\t\t\t\t\tdataPriv.remove( doc, fix );\n\n\t\t\t\t} else {\n\t\t\t\t\tdataPriv.access( doc, fix, attaches );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t} );\n}\nvar location = window.location;\n\nvar nonce = Date.now();\n\nvar rquery = ( /\\?/ );\n\n\n\n// Cross-browser xml parsing\njQuery.parseXML = function( data ) {\n\tvar xml;\n\tif ( !data || typeof data !== \"string\" ) {\n\t\treturn null;\n\t}\n\n\t// Support: IE 9 - 11 only\n\t// IE throws on parseFromString with invalid input.\n\ttry {\n\t\txml = ( new window.DOMParser() ).parseFromString( data, \"text/xml\" );\n\t} catch ( e ) {\n\t\txml = undefined;\n\t}\n\n\tif ( !xml || xml.getElementsByTagName( \"parsererror\" ).length ) {\n\t\tjQuery.error( \"Invalid XML: \" + data );\n\t}\n\treturn xml;\n};\n\n\nvar\n\trbracket = /\\[\\]$/,\n\trCRLF = /\\r?\\n/g,\n\trsubmitterTypes = /^(?:submit|button|image|reset|file)$/i,\n\trsubmittable = /^(?:input|select|textarea|keygen)/i;\n\nfunction buildParams( prefix, obj, traditional, add ) {\n\tvar name;\n\n\tif ( Array.isArray( obj ) ) {\n\n\t\t// Serialize array item.\n\t\tjQuery.each( obj, function( i, v ) {\n\t\t\tif ( traditional || rbracket.test( prefix ) ) {\n\n\t\t\t\t// Treat each array item as a scalar.\n\t\t\t\tadd( prefix, v );\n\n\t\t\t} else {\n\n\t\t\t\t// Item is non-scalar (array or object), encode its numeric index.\n\t\t\t\tbuildParams(\n\t\t\t\t\tprefix + \"[\" + ( typeof v === \"object\" && v != null ? i : \"\" ) + \"]\",\n\t\t\t\t\tv,\n\t\t\t\t\ttraditional,\n\t\t\t\t\tadd\n\t\t\t\t);\n\t\t\t}\n\t\t} );\n\n\t} else if ( !traditional && toType( obj ) === \"object\" ) {\n\n\t\t// Serialize object item.\n\t\tfor ( name in obj ) {\n\t\t\tbuildParams( prefix + \"[\" + name + \"]\", obj[ name ], traditional, add );\n\t\t}\n\n\t} else {\n\n\t\t// Serialize scalar item.\n\t\tadd( prefix, obj );\n\t}\n}\n\n// Serialize an array of form elements or a set of\n// key/values into a query string\njQuery.param = function( a, traditional ) {\n\tvar prefix,\n\t\ts = [],\n\t\tadd = function( key, valueOrFunction ) {\n\n\t\t\t// If value is a function, invoke it and use its return value\n\t\t\tvar value = isFunction( valueOrFunction ) ?\n\t\t\t\tvalueOrFunction() :\n\t\t\t\tvalueOrFunction;\n\n\t\t\ts[ s.length ] = encodeURIComponent( key ) + \"=\" +\n\t\t\t\tencodeURIComponent( value == null ? \"\" : value );\n\t\t};\n\n\tif ( a == null ) {\n\t\treturn \"\";\n\t}\n\n\t// If an array was passed in, assume that it is an array of form elements.\n\tif ( Array.isArray( a ) || ( a.jquery && !jQuery.isPlainObject( a ) ) ) {\n\n\t\t// Serialize the form elements\n\t\tjQuery.each( a, function() {\n\t\t\tadd( this.name, this.value );\n\t\t} );\n\n\t} else {\n\n\t\t// If traditional, encode the \"old\" way (the way 1.3.2 or older\n\t\t// did it), otherwise encode params recursively.\n\t\tfor ( prefix in a ) {\n\t\t\tbuildParams( prefix, a[ prefix ], traditional, add );\n\t\t}\n\t}\n\n\t// Return the resulting serialization\n\treturn s.join( \"&\" );\n};\n\njQuery.fn.extend( {\n\tserialize: function() {\n\t\treturn jQuery.param( this.serializeArray() );\n\t},\n\tserializeArray: function() {\n\t\treturn this.map( function() {\n\n\t\t\t// Can add propHook for \"elements\" to filter or add form elements\n\t\t\tvar elements = jQuery.prop( this, \"elements\" );\n\t\t\treturn elements ? jQuery.makeArray( elements ) : this;\n\t\t} )\n\t\t.filter( function() {\n\t\t\tvar type = this.type;\n\n\t\t\t// Use .is( \":disabled\" ) so that fieldset[disabled] works\n\t\t\treturn this.name && !jQuery( this ).is( \":disabled\" ) &&\n\t\t\t\trsubmittable.test( this.nodeName ) && !rsubmitterTypes.test( type ) &&\n\t\t\t\t( this.checked || !rcheckableType.test( type ) );\n\t\t} )\n\t\t.map( function( i, elem ) {\n\t\t\tvar val = jQuery( this ).val();\n\n\t\t\tif ( val == null ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif ( Array.isArray( val ) ) {\n\t\t\t\treturn jQuery.map( val, function( val ) {\n\t\t\t\t\treturn { name: elem.name, value: val.replace( rCRLF, \"\\r\\n\" ) };\n\t\t\t\t} );\n\t\t\t}\n\n\t\t\treturn { name: elem.name, value: val.replace( rCRLF, \"\\r\\n\" ) };\n\t\t} ).get();\n\t}\n} );\n\n\nvar\n\tr20 = /%20/g,\n\trhash = /#.*$/,\n\trantiCache = /([?&])_=[^&]*/,\n\trheaders = /^(.*?):[ \\t]*([^\\r\\n]*)$/mg,\n\n\t// #7653, #8125, #8152: local protocol detection\n\trlocalProtocol = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,\n\trnoContent = /^(?:GET|HEAD)$/,\n\trprotocol = /^\\/\\//,\n\n\t/* Prefilters\n\t * 1) They are useful to introduce custom dataTypes (see ajax/jsonp.js for an example)\n\t * 2) These are called:\n\t *    - BEFORE asking for a transport\n\t *    - AFTER param serialization (s.data is a string if s.processData is true)\n\t * 3) key is the dataType\n\t * 4) the catchall symbol \"*\" can be used\n\t * 5) execution will start with transport dataType and THEN continue down to \"*\" if needed\n\t */\n\tprefilters = {},\n\n\t/* Transports bindings\n\t * 1) key is the dataType\n\t * 2) the catchall symbol \"*\" can be used\n\t * 3) selection will start with transport dataType and THEN go to \"*\" if needed\n\t */\n\ttransports = {},\n\n\t// Avoid comment-prolog char sequence (#10098); must appease lint and evade compression\n\tallTypes = \"*/\".concat( \"*\" ),\n\n\t// Anchor tag for parsing the document origin\n\toriginAnchor = document.createElement( \"a\" );\n\toriginAnchor.href = location.href;\n\n// Base \"constructor\" for jQuery.ajaxPrefilter and jQuery.ajaxTransport\nfunction addToPrefiltersOrTransports( structure ) {\n\n\t// dataTypeExpression is optional and defaults to \"*\"\n\treturn function( dataTypeExpression, func ) {\n\n\t\tif ( typeof dataTypeExpression !== \"string\" ) {\n\t\t\tfunc = dataTypeExpression;\n\t\t\tdataTypeExpression = \"*\";\n\t\t}\n\n\t\tvar dataType,\n\t\t\ti = 0,\n\t\t\tdataTypes = dataTypeExpression.toLowerCase().match( rnothtmlwhite ) || [];\n\n\t\tif ( isFunction( func ) ) {\n\n\t\t\t// For each dataType in the dataTypeExpression\n\t\t\twhile ( ( dataType = dataTypes[ i++ ] ) ) {\n\n\t\t\t\t// Prepend if requested\n\t\t\t\tif ( dataType[ 0 ] === \"+\" ) {\n\t\t\t\t\tdataType = dataType.slice( 1 ) || \"*\";\n\t\t\t\t\t( structure[ dataType ] = structure[ dataType ] || [] ).unshift( func );\n\n\t\t\t\t// Otherwise append\n\t\t\t\t} else {\n\t\t\t\t\t( structure[ dataType ] = structure[ dataType ] || [] ).push( func );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}\n\n// Base inspection function for prefilters and transports\nfunction inspectPrefiltersOrTransports( structure, options, originalOptions, jqXHR ) {\n\n\tvar inspected = {},\n\t\tseekingTransport = ( structure === transports );\n\n\tfunction inspect( dataType ) {\n\t\tvar selected;\n\t\tinspected[ dataType ] = true;\n\t\tjQuery.each( structure[ dataType ] || [], function( _, prefilterOrFactory ) {\n\t\t\tvar dataTypeOrTransport = prefilterOrFactory( options, originalOptions, jqXHR );\n\t\t\tif ( typeof dataTypeOrTransport === \"string\" &&\n\t\t\t\t!seekingTransport && !inspected[ dataTypeOrTransport ] ) {\n\n\t\t\t\toptions.dataTypes.unshift( dataTypeOrTransport );\n\t\t\t\tinspect( dataTypeOrTransport );\n\t\t\t\treturn false;\n\t\t\t} else if ( seekingTransport ) {\n\t\t\t\treturn !( selected = dataTypeOrTransport );\n\t\t\t}\n\t\t} );\n\t\treturn selected;\n\t}\n\n\treturn inspect( options.dataTypes[ 0 ] ) || !inspected[ \"*\" ] && inspect( \"*\" );\n}\n\n// A special extend for ajax options\n// that takes \"flat\" options (not to be deep extended)\n// Fixes #9887\nfunction ajaxExtend( target, src ) {\n\tvar key, deep,\n\t\tflatOptions = jQuery.ajaxSettings.flatOptions || {};\n\n\tfor ( key in src ) {\n\t\tif ( src[ key ] !== undefined ) {\n\t\t\t( flatOptions[ key ] ? target : ( deep || ( deep = {} ) ) )[ key ] = src[ key ];\n\t\t}\n\t}\n\tif ( deep ) {\n\t\tjQuery.extend( true, target, deep );\n\t}\n\n\treturn target;\n}\n\n/* Handles responses to an ajax request:\n * - finds the right dataType (mediates between content-type and expected dataType)\n * - returns the corresponding response\n */\nfunction ajaxHandleResponses( s, jqXHR, responses ) {\n\n\tvar ct, type, finalDataType, firstDataType,\n\t\tcontents = s.contents,\n\t\tdataTypes = s.dataTypes;\n\n\t// Remove auto dataType and get content-type in the process\n\twhile ( dataTypes[ 0 ] === \"*\" ) {\n\t\tdataTypes.shift();\n\t\tif ( ct === undefined ) {\n\t\t\tct = s.mimeType || jqXHR.getResponseHeader( \"Content-Type\" );\n\t\t}\n\t}\n\n\t// Check if we're dealing with a known content-type\n\tif ( ct ) {\n\t\tfor ( type in contents ) {\n\t\t\tif ( contents[ type ] && contents[ type ].test( ct ) ) {\n\t\t\t\tdataTypes.unshift( type );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Check to see if we have a response for the expected dataType\n\tif ( dataTypes[ 0 ] in responses ) {\n\t\tfinalDataType = dataTypes[ 0 ];\n\t} else {\n\n\t\t// Try convertible dataTypes\n\t\tfor ( type in responses ) {\n\t\t\tif ( !dataTypes[ 0 ] || s.converters[ type + \" \" + dataTypes[ 0 ] ] ) {\n\t\t\t\tfinalDataType = type;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif ( !firstDataType ) {\n\t\t\t\tfirstDataType = type;\n\t\t\t}\n\t\t}\n\n\t\t// Or just use first one\n\t\tfinalDataType = finalDataType || firstDataType;\n\t}\n\n\t// If we found a dataType\n\t// We add the dataType to the list if needed\n\t// and return the corresponding response\n\tif ( finalDataType ) {\n\t\tif ( finalDataType !== dataTypes[ 0 ] ) {\n\t\t\tdataTypes.unshift( finalDataType );\n\t\t}\n\t\treturn responses[ finalDataType ];\n\t}\n}\n\n/* Chain conversions given the request and the original response\n * Also sets the responseXXX fields on the jqXHR instance\n */\nfunction ajaxConvert( s, response, jqXHR, isSuccess ) {\n\tvar conv2, current, conv, tmp, prev,\n\t\tconverters = {},\n\n\t\t// Work with a copy of dataTypes in case we need to modify it for conversion\n\t\tdataTypes = s.dataTypes.slice();\n\n\t// Create converters map with lowercased keys\n\tif ( dataTypes[ 1 ] ) {\n\t\tfor ( conv in s.converters ) {\n\t\t\tconverters[ conv.toLowerCase() ] = s.converters[ conv ];\n\t\t}\n\t}\n\n\tcurrent = dataTypes.shift();\n\n\t// Convert to each sequential dataType\n\twhile ( current ) {\n\n\t\tif ( s.responseFields[ current ] ) {\n\t\t\tjqXHR[ s.responseFields[ current ] ] = response;\n\t\t}\n\n\t\t// Apply the dataFilter if provided\n\t\tif ( !prev && isSuccess && s.dataFilter ) {\n\t\t\tresponse = s.dataFilter( response, s.dataType );\n\t\t}\n\n\t\tprev = current;\n\t\tcurrent = dataTypes.shift();\n\n\t\tif ( current ) {\n\n\t\t\t// There's only work to do if current dataType is non-auto\n\t\t\tif ( current === \"*\" ) {\n\n\t\t\t\tcurrent = prev;\n\n\t\t\t// Convert response if prev dataType is non-auto and differs from current\n\t\t\t} else if ( prev !== \"*\" && prev !== current ) {\n\n\t\t\t\t// Seek a direct converter\n\t\t\t\tconv = converters[ prev + \" \" + current ] || converters[ \"* \" + current ];\n\n\t\t\t\t// If none found, seek a pair\n\t\t\t\tif ( !conv ) {\n\t\t\t\t\tfor ( conv2 in converters ) {\n\n\t\t\t\t\t\t// If conv2 outputs current\n\t\t\t\t\t\ttmp = conv2.split( \" \" );\n\t\t\t\t\t\tif ( tmp[ 1 ] === current ) {\n\n\t\t\t\t\t\t\t// If prev can be converted to accepted input\n\t\t\t\t\t\t\tconv = converters[ prev + \" \" + tmp[ 0 ] ] ||\n\t\t\t\t\t\t\t\tconverters[ \"* \" + tmp[ 0 ] ];\n\t\t\t\t\t\t\tif ( conv ) {\n\n\t\t\t\t\t\t\t\t// Condense equivalence converters\n\t\t\t\t\t\t\t\tif ( conv === true ) {\n\t\t\t\t\t\t\t\t\tconv = converters[ conv2 ];\n\n\t\t\t\t\t\t\t\t// Otherwise, insert the intermediate dataType\n\t\t\t\t\t\t\t\t} else if ( converters[ conv2 ] !== true ) {\n\t\t\t\t\t\t\t\t\tcurrent = tmp[ 0 ];\n\t\t\t\t\t\t\t\t\tdataTypes.unshift( tmp[ 1 ] );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Apply converter (if not an equivalence)\n\t\t\t\tif ( conv !== true ) {\n\n\t\t\t\t\t// Unless errors are allowed to bubble, catch and return them\n\t\t\t\t\tif ( conv && s.throws ) {\n\t\t\t\t\t\tresponse = conv( response );\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tresponse = conv( response );\n\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tstate: \"parsererror\",\n\t\t\t\t\t\t\t\terror: conv ? e : \"No conversion from \" + prev + \" to \" + current\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn { state: \"success\", data: response };\n}\n\njQuery.extend( {\n\n\t// Counter for holding the number of active queries\n\tactive: 0,\n\n\t// Last-Modified header cache for next request\n\tlastModified: {},\n\tetag: {},\n\n\tajaxSettings: {\n\t\turl: location.href,\n\t\ttype: \"GET\",\n\t\tisLocal: rlocalProtocol.test( location.protocol ),\n\t\tglobal: true,\n\t\tprocessData: true,\n\t\tasync: true,\n\t\tcontentType: \"application/x-www-form-urlencoded; charset=UTF-8\",\n\n\t\t/*\n\t\ttimeout: 0,\n\t\tdata: null,\n\t\tdataType: null,\n\t\tusername: null,\n\t\tpassword: null,\n\t\tcache: null,\n\t\tthrows: false,\n\t\ttraditional: false,\n\t\theaders: {},\n\t\t*/\n\n\t\taccepts: {\n\t\t\t\"*\": allTypes,\n\t\t\ttext: \"text/plain\",\n\t\t\thtml: \"text/html\",\n\t\t\txml: \"application/xml, text/xml\",\n\t\t\tjson: \"application/json, text/javascript\"\n\t\t},\n\n\t\tcontents: {\n\t\t\txml: /\\bxml\\b/,\n\t\t\thtml: /\\bhtml/,\n\t\t\tjson: /\\bjson\\b/\n\t\t},\n\n\t\tresponseFields: {\n\t\t\txml: \"responseXML\",\n\t\t\ttext: \"responseText\",\n\t\t\tjson: \"responseJSON\"\n\t\t},\n\n\t\t// Data converters\n\t\t// Keys separate source (or catchall \"*\") and destination types with a single space\n\t\tconverters: {\n\n\t\t\t// Convert anything to text\n\t\t\t\"* text\": String,\n\n\t\t\t// Text to html (true = no transformation)\n\t\t\t\"text html\": true,\n\n\t\t\t// Evaluate text as a json expression\n\t\t\t\"text json\": JSON.parse,\n\n\t\t\t// Parse text as xml\n\t\t\t\"text xml\": jQuery.parseXML\n\t\t},\n\n\t\t// For options that shouldn't be deep extended:\n\t\t// you can add your own custom options here if\n\t\t// and when you create one that shouldn't be\n\t\t// deep extended (see ajaxExtend)\n\t\tflatOptions: {\n\t\t\turl: true,\n\t\t\tcontext: true\n\t\t}\n\t},\n\n\t// Creates a full fledged settings object into target\n\t// with both ajaxSettings and settings fields.\n\t// If target is omitted, writes into ajaxSettings.\n\tajaxSetup: function( target, settings ) {\n\t\treturn settings ?\n\n\t\t\t// Building a settings object\n\t\t\tajaxExtend( ajaxExtend( target, jQuery.ajaxSettings ), settings ) :\n\n\t\t\t// Extending ajaxSettings\n\t\t\tajaxExtend( jQuery.ajaxSettings, target );\n\t},\n\n\tajaxPrefilter: addToPrefiltersOrTransports( prefilters ),\n\tajaxTransport: addToPrefiltersOrTransports( transports ),\n\n\t// Main method\n\tajax: function( url, options ) {\n\n\t\t// If url is an object, simulate pre-1.5 signature\n\t\tif ( typeof url === \"object\" ) {\n\t\t\toptions = url;\n\t\t\turl = undefined;\n\t\t}\n\n\t\t// Force options to be an object\n\t\toptions = options || {};\n\n\t\tvar transport,\n\n\t\t\t// URL without anti-cache param\n\t\t\tcacheURL,\n\n\t\t\t// Response headers\n\t\t\tresponseHeadersString,\n\t\t\tresponseHeaders,\n\n\t\t\t// timeout handle\n\t\t\ttimeoutTimer,\n\n\t\t\t// Url cleanup var\n\t\t\turlAnchor,\n\n\t\t\t// Request state (becomes false upon send and true upon completion)\n\t\t\tcompleted,\n\n\t\t\t// To know if global events are to be dispatched\n\t\t\tfireGlobals,\n\n\t\t\t// Loop variable\n\t\t\ti,\n\n\t\t\t// uncached part of the url\n\t\t\tuncached,\n\n\t\t\t// Create the final options object\n\t\t\ts = jQuery.ajaxSetup( {}, options ),\n\n\t\t\t// Callbacks context\n\t\t\tcallbackContext = s.context || s,\n\n\t\t\t// Context for global events is callbackContext if it is a DOM node or jQuery collection\n\t\t\tglobalEventContext = s.context &&\n\t\t\t\t( callbackContext.nodeType || callbackContext.jquery ) ?\n\t\t\t\t\tjQuery( callbackContext ) :\n\t\t\t\t\tjQuery.event,\n\n\t\t\t// Deferreds\n\t\t\tdeferred = jQuery.Deferred(),\n\t\t\tcompleteDeferred = jQuery.Callbacks( \"once memory\" ),\n\n\t\t\t// Status-dependent callbacks\n\t\t\tstatusCode = s.statusCode || {},\n\n\t\t\t// Headers (they are sent all at once)\n\t\t\trequestHeaders = {},\n\t\t\trequestHeadersNames = {},\n\n\t\t\t// Default abort message\n\t\t\tstrAbort = \"canceled\",\n\n\t\t\t// Fake xhr\n\t\t\tjqXHR = {\n\t\t\t\treadyState: 0,\n\n\t\t\t\t// Builds headers hashtable if needed\n\t\t\t\tgetResponseHeader: function( key ) {\n\t\t\t\t\tvar match;\n\t\t\t\t\tif ( completed ) {\n\t\t\t\t\t\tif ( !responseHeaders ) {\n\t\t\t\t\t\t\tresponseHeaders = {};\n\t\t\t\t\t\t\twhile ( ( match = rheaders.exec( responseHeadersString ) ) ) {\n\t\t\t\t\t\t\t\tresponseHeaders[ match[ 1 ].toLowerCase() + \" \" ] =\n\t\t\t\t\t\t\t\t\t( responseHeaders[ match[ 1 ].toLowerCase() + \" \" ] || [] )\n\t\t\t\t\t\t\t\t\t\t.concat( match[ 2 ] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmatch = responseHeaders[ key.toLowerCase() + \" \" ];\n\t\t\t\t\t}\n\t\t\t\t\treturn match == null ? null : match.join( \", \" );\n\t\t\t\t},\n\n\t\t\t\t// Raw string\n\t\t\t\tgetAllResponseHeaders: function() {\n\t\t\t\t\treturn completed ? responseHeadersString : null;\n\t\t\t\t},\n\n\t\t\t\t// Caches the header\n\t\t\t\tsetRequestHeader: function( name, value ) {\n\t\t\t\t\tif ( completed == null ) {\n\t\t\t\t\t\tname = requestHeadersNames[ name.toLowerCase() ] =\n\t\t\t\t\t\t\trequestHeadersNames[ name.toLowerCase() ] || name;\n\t\t\t\t\t\trequestHeaders[ name ] = value;\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\n\t\t\t\t// Overrides response content-type header\n\t\t\t\toverrideMimeType: function( type ) {\n\t\t\t\t\tif ( completed == null ) {\n\t\t\t\t\t\ts.mimeType = type;\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\n\t\t\t\t// Status-dependent callbacks\n\t\t\t\tstatusCode: function( map ) {\n\t\t\t\t\tvar code;\n\t\t\t\t\tif ( map ) {\n\t\t\t\t\t\tif ( completed ) {\n\n\t\t\t\t\t\t\t// Execute the appropriate callbacks\n\t\t\t\t\t\t\tjqXHR.always( map[ jqXHR.status ] );\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\t// Lazy-add the new callbacks in a way that preserves old ones\n\t\t\t\t\t\t\tfor ( code in map ) {\n\t\t\t\t\t\t\t\tstatusCode[ code ] = [ statusCode[ code ], map[ code ] ];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\n\t\t\t\t// Cancel the request\n\t\t\t\tabort: function( statusText ) {\n\t\t\t\t\tvar finalText = statusText || strAbort;\n\t\t\t\t\tif ( transport ) {\n\t\t\t\t\t\ttransport.abort( finalText );\n\t\t\t\t\t}\n\t\t\t\t\tdone( 0, finalText );\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t};\n\n\t\t// Attach deferreds\n\t\tdeferred.promise( jqXHR );\n\n\t\t// Add protocol if not provided (prefilters might expect it)\n\t\t// Handle falsy url in the settings object (#10093: consistency with old signature)\n\t\t// We also use the url parameter if available\n\t\ts.url = ( ( url || s.url || location.href ) + \"\" )\n\t\t\t.replace( rprotocol, location.protocol + \"//\" );\n\n\t\t// Alias method option to type as per ticket #12004\n\t\ts.type = options.method || options.type || s.method || s.type;\n\n\t\t// Extract dataTypes list\n\t\ts.dataTypes = ( s.dataType || \"*\" ).toLowerCase().match( rnothtmlwhite ) || [ \"\" ];\n\n\t\t// A cross-domain request is in order when the origin doesn't match the current origin.\n\t\tif ( s.crossDomain == null ) {\n\t\t\turlAnchor = document.createElement( \"a\" );\n\n\t\t\t// Support: IE <=8 - 11, Edge 12 - 15\n\t\t\t// IE throws exception on accessing the href property if url is malformed,\n\t\t\t// e.g. http://example.com:80x/\n\t\t\ttry {\n\t\t\t\turlAnchor.href = s.url;\n\n\t\t\t\t// Support: IE <=8 - 11 only\n\t\t\t\t// Anchor's host property isn't correctly set when s.url is relative\n\t\t\t\turlAnchor.href = urlAnchor.href;\n\t\t\t\ts.crossDomain = originAnchor.protocol + \"//\" + originAnchor.host !==\n\t\t\t\t\turlAnchor.protocol + \"//\" + urlAnchor.host;\n\t\t\t} catch ( e ) {\n\n\t\t\t\t// If there is an error parsing the URL, assume it is crossDomain,\n\t\t\t\t// it can be rejected by the transport if it is invalid\n\t\t\t\ts.crossDomain = true;\n\t\t\t}\n\t\t}\n\n\t\t// Convert data if not already a string\n\t\tif ( s.data && s.processData && typeof s.data !== \"string\" ) {\n\t\t\ts.data = jQuery.param( s.data, s.traditional );\n\t\t}\n\n\t\t// Apply prefilters\n\t\tinspectPrefiltersOrTransports( prefilters, s, options, jqXHR );\n\n\t\t// If request was aborted inside a prefilter, stop there\n\t\tif ( completed ) {\n\t\t\treturn jqXHR;\n\t\t}\n\n\t\t// We can fire global events as of now if asked to\n\t\t// Don't fire events if jQuery.event is undefined in an AMD-usage scenario (#15118)\n\t\tfireGlobals = jQuery.event && s.global;\n\n\t\t// Watch for a new set of requests\n\t\tif ( fireGlobals && jQuery.active++ === 0 ) {\n\t\t\tjQuery.event.trigger( \"ajaxStart\" );\n\t\t}\n\n\t\t// Uppercase the type\n\t\ts.type = s.type.toUpperCase();\n\n\t\t// Determine if request has content\n\t\ts.hasContent = !rnoContent.test( s.type );\n\n\t\t// Save the URL in case we're toying with the If-Modified-Since\n\t\t// and/or If-None-Match header later on\n\t\t// Remove hash to simplify url manipulation\n\t\tcacheURL = s.url.replace( rhash, \"\" );\n\n\t\t// More options handling for requests with no content\n\t\tif ( !s.hasContent ) {\n\n\t\t\t// Remember the hash so we can put it back\n\t\t\tuncached = s.url.slice( cacheURL.length );\n\n\t\t\t// If data is available and should be processed, append data to url\n\t\t\tif ( s.data && ( s.processData || typeof s.data === \"string\" ) ) {\n\t\t\t\tcacheURL += ( rquery.test( cacheURL ) ? \"&\" : \"?\" ) + s.data;\n\n\t\t\t\t// #9682: remove data so that it's not used in an eventual retry\n\t\t\t\tdelete s.data;\n\t\t\t}\n\n\t\t\t// Add or update anti-cache param if needed\n\t\t\tif ( s.cache === false ) {\n\t\t\t\tcacheURL = cacheURL.replace( rantiCache, \"$1\" );\n\t\t\t\tuncached = ( rquery.test( cacheURL ) ? \"&\" : \"?\" ) + \"_=\" + ( nonce++ ) + uncached;\n\t\t\t}\n\n\t\t\t// Put hash and anti-cache on the URL that will be requested (gh-1732)\n\t\t\ts.url = cacheURL + uncached;\n\n\t\t// Change '%20' to '+' if this is encoded form body content (gh-2658)\n\t\t} else if ( s.data && s.processData &&\n\t\t\t( s.contentType || \"\" ).indexOf( \"application/x-www-form-urlencoded\" ) === 0 ) {\n\t\t\ts.data = s.data.replace( r20, \"+\" );\n\t\t}\n\n\t\t// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.\n\t\tif ( s.ifModified ) {\n\t\t\tif ( jQuery.lastModified[ cacheURL ] ) {\n\t\t\t\tjqXHR.setRequestHeader( \"If-Modified-Since\", jQuery.lastModified[ cacheURL ] );\n\t\t\t}\n\t\t\tif ( jQuery.etag[ cacheURL ] ) {\n\t\t\t\tjqXHR.setRequestHeader( \"If-None-Match\", jQuery.etag[ cacheURL ] );\n\t\t\t}\n\t\t}\n\n\t\t// Set the correct header, if data is being sent\n\t\tif ( s.data && s.hasContent && s.contentType !== false || options.contentType ) {\n\t\t\tjqXHR.setRequestHeader( \"Content-Type\", s.contentType );\n\t\t}\n\n\t\t// Set the Accepts header for the server, depending on the dataType\n\t\tjqXHR.setRequestHeader(\n\t\t\t\"Accept\",\n\t\t\ts.dataTypes[ 0 ] && s.accepts[ s.dataTypes[ 0 ] ] ?\n\t\t\t\ts.accepts[ s.dataTypes[ 0 ] ] +\n\t\t\t\t\t( s.dataTypes[ 0 ] !== \"*\" ? \", \" + allTypes + \"; q=0.01\" : \"\" ) :\n\t\t\t\ts.accepts[ \"*\" ]\n\t\t);\n\n\t\t// Check for headers option\n\t\tfor ( i in s.headers ) {\n\t\t\tjqXHR.setRequestHeader( i, s.headers[ i ] );\n\t\t}\n\n\t\t// Allow custom headers/mimetypes and early abort\n\t\tif ( s.beforeSend &&\n\t\t\t( s.beforeSend.call( callbackContext, jqXHR, s ) === false || completed ) ) {\n\n\t\t\t// Abort if not done already and return\n\t\t\treturn jqXHR.abort();\n\t\t}\n\n\t\t// Aborting is no longer a cancellation\n\t\tstrAbort = \"abort\";\n\n\t\t// Install callbacks on deferreds\n\t\tcompleteDeferred.add( s.complete );\n\t\tjqXHR.done( s.success );\n\t\tjqXHR.fail( s.error );\n\n\t\t// Get transport\n\t\ttransport = inspectPrefiltersOrTransports( transports, s, options, jqXHR );\n\n\t\t// If no transport, we auto-abort\n\t\tif ( !transport ) {\n\t\t\tdone( -1, \"No Transport\" );\n\t\t} else {\n\t\t\tjqXHR.readyState = 1;\n\n\t\t\t// Send global event\n\t\t\tif ( fireGlobals ) {\n\t\t\t\tglobalEventContext.trigger( \"ajaxSend\", [ jqXHR, s ] );\n\t\t\t}\n\n\t\t\t// If request was aborted inside ajaxSend, stop there\n\t\t\tif ( completed ) {\n\t\t\t\treturn jqXHR;\n\t\t\t}\n\n\t\t\t// Timeout\n\t\t\tif ( s.async && s.timeout > 0 ) {\n\t\t\t\ttimeoutTimer = window.setTimeout( function() {\n\t\t\t\t\tjqXHR.abort( \"timeout\" );\n\t\t\t\t}, s.timeout );\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tcompleted = false;\n\t\t\t\ttransport.send( requestHeaders, done );\n\t\t\t} catch ( e ) {\n\n\t\t\t\t// Rethrow post-completion exceptions\n\t\t\t\tif ( completed ) {\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\n\t\t\t\t// Propagate others as results\n\t\t\t\tdone( -1, e );\n\t\t\t}\n\t\t}\n\n\t\t// Callback for when everything is done\n\t\tfunction done( status, nativeStatusText, responses, headers ) {\n\t\t\tvar isSuccess, success, error, response, modified,\n\t\t\t\tstatusText = nativeStatusText;\n\n\t\t\t// Ignore repeat invocations\n\t\t\tif ( completed ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcompleted = true;\n\n\t\t\t// Clear timeout if it exists\n\t\t\tif ( timeoutTimer ) {\n\t\t\t\twindow.clearTimeout( timeoutTimer );\n\t\t\t}\n\n\t\t\t// Dereference transport for early garbage collection\n\t\t\t// (no matter how long the jqXHR object will be used)\n\t\t\ttransport = undefined;\n\n\t\t\t// Cache response headers\n\t\t\tresponseHeadersString = headers || \"\";\n\n\t\t\t// Set readyState\n\t\t\tjqXHR.readyState = status > 0 ? 4 : 0;\n\n\t\t\t// Determine if successful\n\t\t\tisSuccess = status >= 200 && status < 300 || status === 304;\n\n\t\t\t// Get response data\n\t\t\tif ( responses ) {\n\t\t\t\tresponse = ajaxHandleResponses( s, jqXHR, responses );\n\t\t\t}\n\n\t\t\t// Convert no matter what (that way responseXXX fields are always set)\n\t\t\tresponse = ajaxConvert( s, response, jqXHR, isSuccess );\n\n\t\t\t// If successful, handle type chaining\n\t\t\tif ( isSuccess ) {\n\n\t\t\t\t// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.\n\t\t\t\tif ( s.ifModified ) {\n\t\t\t\t\tmodified = jqXHR.getResponseHeader( \"Last-Modified\" );\n\t\t\t\t\tif ( modified ) {\n\t\t\t\t\t\tjQuery.lastModified[ cacheURL ] = modified;\n\t\t\t\t\t}\n\t\t\t\t\tmodified = jqXHR.getResponseHeader( \"etag\" );\n\t\t\t\t\tif ( modified ) {\n\t\t\t\t\t\tjQuery.etag[ cacheURL ] = modified;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// if no content\n\t\t\t\tif ( status === 204 || s.type === \"HEAD\" ) {\n\t\t\t\t\tstatusText = \"nocontent\";\n\n\t\t\t\t// if not modified\n\t\t\t\t} else if ( status === 304 ) {\n\t\t\t\t\tstatusText = \"notmodified\";\n\n\t\t\t\t// If we have data, let's convert it\n\t\t\t\t} else {\n\t\t\t\t\tstatusText = response.state;\n\t\t\t\t\tsuccess = response.data;\n\t\t\t\t\terror = response.error;\n\t\t\t\t\tisSuccess = !error;\n\t\t\t\t}\n\t\t\t} else {\n\n\t\t\t\t// Extract error from statusText and normalize for non-aborts\n\t\t\t\terror = statusText;\n\t\t\t\tif ( status || !statusText ) {\n\t\t\t\t\tstatusText = \"error\";\n\t\t\t\t\tif ( status < 0 ) {\n\t\t\t\t\t\tstatus = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Set data for the fake xhr object\n\t\t\tjqXHR.status = status;\n\t\t\tjqXHR.statusText = ( nativeStatusText || statusText ) + \"\";\n\n\t\t\t// Success/Error\n\t\t\tif ( isSuccess ) {\n\t\t\t\tdeferred.resolveWith( callbackContext, [ success, statusText, jqXHR ] );\n\t\t\t} else {\n\t\t\t\tdeferred.rejectWith( callbackContext, [ jqXHR, statusText, error ] );\n\t\t\t}\n\n\t\t\t// Status-dependent callbacks\n\t\t\tjqXHR.statusCode( statusCode );\n\t\t\tstatusCode = undefined;\n\n\t\t\tif ( fireGlobals ) {\n\t\t\t\tglobalEventContext.trigger( isSuccess ? \"ajaxSuccess\" : \"ajaxError\",\n\t\t\t\t\t[ jqXHR, s, isSuccess ? success : error ] );\n\t\t\t}\n\n\t\t\t// Complete\n\t\t\tcompleteDeferred.fireWith( callbackContext, [ jqXHR, statusText ] );\n\n\t\t\tif ( fireGlobals ) {\n\t\t\t\tglobalEventContext.trigger( \"ajaxComplete\", [ jqXHR, s ] );\n\n\t\t\t\t// Handle the global AJAX counter\n\t\t\t\tif ( !( --jQuery.active ) ) {\n\t\t\t\t\tjQuery.event.trigger( \"ajaxStop\" );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn jqXHR;\n\t},\n\n\tgetJSON: function( url, data, callback ) {\n\t\treturn jQuery.get( url, data, callback, \"json\" );\n\t},\n\n\tgetScript: function( url, callback ) {\n\t\treturn jQuery.get( url, undefined, callback, \"script\" );\n\t}\n} );\n\njQuery.each( [ \"get\", \"post\" ], function( i, method ) {\n\tjQuery[ method ] = function( url, data, callback, type ) {\n\n\t\t// Shift arguments if data argument was omitted\n\t\tif ( isFunction( data ) ) {\n\t\t\ttype = type || callback;\n\t\t\tcallback = data;\n\t\t\tdata = undefined;\n\t\t}\n\n\t\t// The url can be an options object (which then must have .url)\n\t\treturn jQuery.ajax( jQuery.extend( {\n\t\t\turl: url,\n\t\t\ttype: method,\n\t\t\tdataType: type,\n\t\t\tdata: data,\n\t\t\tsuccess: callback\n\t\t}, jQuery.isPlainObject( url ) && url ) );\n\t};\n} );\n\n\njQuery._evalUrl = function( url, options ) {\n\treturn jQuery.ajax( {\n\t\turl: url,\n\n\t\t// Make this explicit, since user can override this through ajaxSetup (#11264)\n\t\ttype: \"GET\",\n\t\tdataType: \"script\",\n\t\tcache: true,\n\t\tasync: false,\n\t\tglobal: false,\n\n\t\t// Only evaluate the response if it is successful (gh-4126)\n\t\t// dataFilter is not invoked for failure responses, so using it instead\n\t\t// of the default converter is kludgy but it works.\n\t\tconverters: {\n\t\t\t\"text script\": function() {}\n\t\t},\n\t\tdataFilter: function( response ) {\n\t\t\tjQuery.globalEval( response, options );\n\t\t}\n\t} );\n};\n\n\njQuery.fn.extend( {\n\twrapAll: function( html ) {\n\t\tvar wrap;\n\n\t\tif ( this[ 0 ] ) {\n\t\t\tif ( isFunction( html ) ) {\n\t\t\t\thtml = html.call( this[ 0 ] );\n\t\t\t}\n\n\t\t\t// The elements to wrap the target around\n\t\t\twrap = jQuery( html, this[ 0 ].ownerDocument ).eq( 0 ).clone( true );\n\n\t\t\tif ( this[ 0 ].parentNode ) {\n\t\t\t\twrap.insertBefore( this[ 0 ] );\n\t\t\t}\n\n\t\t\twrap.map( function() {\n\t\t\t\tvar elem = this;\n\n\t\t\t\twhile ( elem.firstElementChild ) {\n\t\t\t\t\telem = elem.firstElementChild;\n\t\t\t\t}\n\n\t\t\t\treturn elem;\n\t\t\t} ).append( this );\n\t\t}\n\n\t\treturn this;\n\t},\n\n\twrapInner: function( html ) {\n\t\tif ( isFunction( html ) ) {\n\t\t\treturn this.each( function( i ) {\n\t\t\t\tjQuery( this ).wrapInner( html.call( this, i ) );\n\t\t\t} );\n\t\t}\n\n\t\treturn this.each( function() {\n\t\t\tvar self = jQuery( this ),\n\t\t\t\tcontents = self.contents();\n\n\t\t\tif ( contents.length ) {\n\t\t\t\tcontents.wrapAll( html );\n\n\t\t\t} else {\n\t\t\t\tself.append( html );\n\t\t\t}\n\t\t} );\n\t},\n\n\twrap: function( html ) {\n\t\tvar htmlIsFunction = isFunction( html );\n\n\t\treturn this.each( function( i ) {\n\t\t\tjQuery( this ).wrapAll( htmlIsFunction ? html.call( this, i ) : html );\n\t\t} );\n\t},\n\n\tunwrap: function( selector ) {\n\t\tthis.parent( selector ).not( \"body\" ).each( function() {\n\t\t\tjQuery( this ).replaceWith( this.childNodes );\n\t\t} );\n\t\treturn this;\n\t}\n} );\n\n\njQuery.expr.pseudos.hidden = function( elem ) {\n\treturn !jQuery.expr.pseudos.visible( elem );\n};\njQuery.expr.pseudos.visible = function( elem ) {\n\treturn !!( elem.offsetWidth || elem.offsetHeight || elem.getClientRects().length );\n};\n\n\n\n\njQuery.ajaxSettings.xhr = function() {\n\ttry {\n\t\treturn new window.XMLHttpRequest();\n\t} catch ( e ) {}\n};\n\nvar xhrSuccessStatus = {\n\n\t\t// File protocol always yields status code 0, assume 200\n\t\t0: 200,\n\n\t\t// Support: IE <=9 only\n\t\t// #1450: sometimes IE returns 1223 when it should be 204\n\t\t1223: 204\n\t},\n\txhrSupported = jQuery.ajaxSettings.xhr();\n\nsupport.cors = !!xhrSupported && ( \"withCredentials\" in xhrSupported );\nsupport.ajax = xhrSupported = !!xhrSupported;\n\njQuery.ajaxTransport( function( options ) {\n\tvar callback, errorCallback;\n\n\t// Cross domain only allowed if supported through XMLHttpRequest\n\tif ( support.cors || xhrSupported && !options.crossDomain ) {\n\t\treturn {\n\t\t\tsend: function( headers, complete ) {\n\t\t\t\tvar i,\n\t\t\t\t\txhr = options.xhr();\n\n\t\t\t\txhr.open(\n\t\t\t\t\toptions.type,\n\t\t\t\t\toptions.url,\n\t\t\t\t\toptions.async,\n\t\t\t\t\toptions.username,\n\t\t\t\t\toptions.password\n\t\t\t\t);\n\n\t\t\t\t// Apply custom fields if provided\n\t\t\t\tif ( options.xhrFields ) {\n\t\t\t\t\tfor ( i in options.xhrFields ) {\n\t\t\t\t\t\txhr[ i ] = options.xhrFields[ i ];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Override mime type if needed\n\t\t\t\tif ( options.mimeType && xhr.overrideMimeType ) {\n\t\t\t\t\txhr.overrideMimeType( options.mimeType );\n\t\t\t\t}\n\n\t\t\t\t// X-Requested-With header\n\t\t\t\t// For cross-domain requests, seeing as conditions for a preflight are\n\t\t\t\t// akin to a jigsaw puzzle, we simply never set it to be sure.\n\t\t\t\t// (it can always be set on a per-request basis or even using ajaxSetup)\n\t\t\t\t// For same-domain requests, won't change header if already provided.\n\t\t\t\tif ( !options.crossDomain && !headers[ \"X-Requested-With\" ] ) {\n\t\t\t\t\theaders[ \"X-Requested-With\" ] = \"XMLHttpRequest\";\n\t\t\t\t}\n\n\t\t\t\t// Set headers\n\t\t\t\tfor ( i in headers ) {\n\t\t\t\t\txhr.setRequestHeader( i, headers[ i ] );\n\t\t\t\t}\n\n\t\t\t\t// Callback\n\t\t\t\tcallback = function( type ) {\n\t\t\t\t\treturn function() {\n\t\t\t\t\t\tif ( callback ) {\n\t\t\t\t\t\t\tcallback = errorCallback = xhr.onload =\n\t\t\t\t\t\t\t\txhr.onerror = xhr.onabort = xhr.ontimeout =\n\t\t\t\t\t\t\t\t\txhr.onreadystatechange = null;\n\n\t\t\t\t\t\t\tif ( type === \"abort\" ) {\n\t\t\t\t\t\t\t\txhr.abort();\n\t\t\t\t\t\t\t} else if ( type === \"error\" ) {\n\n\t\t\t\t\t\t\t\t// Support: IE <=9 only\n\t\t\t\t\t\t\t\t// On a manual native abort, IE9 throws\n\t\t\t\t\t\t\t\t// errors on any property access that is not readyState\n\t\t\t\t\t\t\t\tif ( typeof xhr.status !== \"number\" ) {\n\t\t\t\t\t\t\t\t\tcomplete( 0, \"error\" );\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tcomplete(\n\n\t\t\t\t\t\t\t\t\t\t// File: protocol always yields status 0; see #8605, #14207\n\t\t\t\t\t\t\t\t\t\txhr.status,\n\t\t\t\t\t\t\t\t\t\txhr.statusText\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcomplete(\n\t\t\t\t\t\t\t\t\txhrSuccessStatus[ xhr.status ] || xhr.status,\n\t\t\t\t\t\t\t\t\txhr.statusText,\n\n\t\t\t\t\t\t\t\t\t// Support: IE <=9 only\n\t\t\t\t\t\t\t\t\t// IE9 has no XHR2 but throws on binary (trac-11426)\n\t\t\t\t\t\t\t\t\t// For XHR2 non-text, let the caller handle it (gh-2498)\n\t\t\t\t\t\t\t\t\t( xhr.responseType || \"text\" ) !== \"text\"  ||\n\t\t\t\t\t\t\t\t\ttypeof xhr.responseText !== \"string\" ?\n\t\t\t\t\t\t\t\t\t\t{ binary: xhr.response } :\n\t\t\t\t\t\t\t\t\t\t{ text: xhr.responseText },\n\t\t\t\t\t\t\t\t\txhr.getAllResponseHeaders()\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t};\n\n\t\t\t\t// Listen to events\n\t\t\t\txhr.onload = callback();\n\t\t\t\terrorCallback = xhr.onerror = xhr.ontimeout = callback( \"error\" );\n\n\t\t\t\t// Support: IE 9 only\n\t\t\t\t// Use onreadystatechange to replace onabort\n\t\t\t\t// to handle uncaught aborts\n\t\t\t\tif ( xhr.onabort !== undefined ) {\n\t\t\t\t\txhr.onabort = errorCallback;\n\t\t\t\t} else {\n\t\t\t\t\txhr.onreadystatechange = function() {\n\n\t\t\t\t\t\t// Check readyState before timeout as it changes\n\t\t\t\t\t\tif ( xhr.readyState === 4 ) {\n\n\t\t\t\t\t\t\t// Allow onerror to be called first,\n\t\t\t\t\t\t\t// but that will not handle a native abort\n\t\t\t\t\t\t\t// Also, save errorCallback to a variable\n\t\t\t\t\t\t\t// as xhr.onerror cannot be accessed\n\t\t\t\t\t\t\twindow.setTimeout( function() {\n\t\t\t\t\t\t\t\tif ( callback ) {\n\t\t\t\t\t\t\t\t\terrorCallback();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} );\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\t// Create the abort callback\n\t\t\t\tcallback = callback( \"abort\" );\n\n\t\t\t\ttry {\n\n\t\t\t\t\t// Do send the request (this may raise an exception)\n\t\t\t\t\txhr.send( options.hasContent && options.data || null );\n\t\t\t\t} catch ( e ) {\n\n\t\t\t\t\t// #14683: Only rethrow if this hasn't been notified as an error yet\n\t\t\t\t\tif ( callback ) {\n\t\t\t\t\t\tthrow e;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tabort: function() {\n\t\t\t\tif ( callback ) {\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n} );\n\n\n\n\n// Prevent auto-execution of scripts when no explicit dataType was provided (See gh-2432)\njQuery.ajaxPrefilter( function( s ) {\n\tif ( s.crossDomain ) {\n\t\ts.contents.script = false;\n\t}\n} );\n\n// Install script dataType\njQuery.ajaxSetup( {\n\taccepts: {\n\t\tscript: \"text/javascript, application/javascript, \" +\n\t\t\t\"application/ecmascript, application/x-ecmascript\"\n\t},\n\tcontents: {\n\t\tscript: /\\b(?:java|ecma)script\\b/\n\t},\n\tconverters: {\n\t\t\"text script\": function( text ) {\n\t\t\tjQuery.globalEval( text );\n\t\t\treturn text;\n\t\t}\n\t}\n} );\n\n// Handle cache's special case and crossDomain\njQuery.ajaxPrefilter( \"script\", function( s ) {\n\tif ( s.cache === undefined ) {\n\t\ts.cache = false;\n\t}\n\tif ( s.crossDomain ) {\n\t\ts.type = \"GET\";\n\t}\n} );\n\n// Bind script tag hack transport\njQuery.ajaxTransport( \"script\", function( s ) {\n\n\t// This transport only deals with cross domain or forced-by-attrs requests\n\tif ( s.crossDomain || s.scriptAttrs ) {\n\t\tvar script, callback;\n\t\treturn {\n\t\t\tsend: function( _, complete ) {\n\t\t\t\tscript = jQuery( \"<script>\" )\n\t\t\t\t\t.attr( s.scriptAttrs || {} )\n\t\t\t\t\t.prop( { charset: s.scriptCharset, src: s.url } )\n\t\t\t\t\t.on( \"load error\", callback = function( evt ) {\n\t\t\t\t\t\tscript.remove();\n\t\t\t\t\t\tcallback = null;\n\t\t\t\t\t\tif ( evt ) {\n\t\t\t\t\t\t\tcomplete( evt.type === \"error\" ? 404 : 200, evt.type );\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\n\t\t\t\t// Use native DOM manipulation to avoid our domManip AJAX trickery\n\t\t\t\tdocument.head.appendChild( script[ 0 ] );\n\t\t\t},\n\t\t\tabort: function() {\n\t\t\t\tif ( callback ) {\n\t\t\t\t\tcallback();\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n} );\n\n\n\n\nvar oldCallbacks = [],\n\trjsonp = /(=)\\?(?=&|$)|\\?\\?/;\n\n// Default jsonp settings\njQuery.ajaxSetup( {\n\tjsonp: \"callback\",\n\tjsonpCallback: function() {\n\t\tvar callback = oldCallbacks.pop() || ( jQuery.expando + \"_\" + ( nonce++ ) );\n\t\tthis[ callback ] = true;\n\t\treturn callback;\n\t}\n} );\n\n// Detect, normalize options and install callbacks for jsonp requests\njQuery.ajaxPrefilter( \"json jsonp\", function( s, originalSettings, jqXHR ) {\n\n\tvar callbackName, overwritten, responseContainer,\n\t\tjsonProp = s.jsonp !== false && ( rjsonp.test( s.url ) ?\n\t\t\t\"url\" :\n\t\t\ttypeof s.data === \"string\" &&\n\t\t\t\t( s.contentType || \"\" )\n\t\t\t\t\t.indexOf( \"application/x-www-form-urlencoded\" ) === 0 &&\n\t\t\t\trjsonp.test( s.data ) && \"data\"\n\t\t);\n\n\t// Handle iff the expected data type is \"jsonp\" or we have a parameter to set\n\tif ( jsonProp || s.dataTypes[ 0 ] === \"jsonp\" ) {\n\n\t\t// Get callback name, remembering preexisting value associated with it\n\t\tcallbackName = s.jsonpCallback = isFunction( s.jsonpCallback ) ?\n\t\t\ts.jsonpCallback() :\n\t\t\ts.jsonpCallback;\n\n\t\t// Insert callback into url or form data\n\t\tif ( jsonProp ) {\n\t\t\ts[ jsonProp ] = s[ jsonProp ].replace( rjsonp, \"$1\" + callbackName );\n\t\t} else if ( s.jsonp !== false ) {\n\t\t\ts.url += ( rquery.test( s.url ) ? \"&\" : \"?\" ) + s.jsonp + \"=\" + callbackName;\n\t\t}\n\n\t\t// Use data converter to retrieve json after script execution\n\t\ts.converters[ \"script json\" ] = function() {\n\t\t\tif ( !responseContainer ) {\n\t\t\t\tjQuery.error( callbackName + \" was not called\" );\n\t\t\t}\n\t\t\treturn responseContainer[ 0 ];\n\t\t};\n\n\t\t// Force json dataType\n\t\ts.dataTypes[ 0 ] = \"json\";\n\n\t\t// Install callback\n\t\toverwritten = window[ callbackName ];\n\t\twindow[ callbackName ] = function() {\n\t\t\tresponseContainer = arguments;\n\t\t};\n\n\t\t// Clean-up function (fires after converters)\n\t\tjqXHR.always( function() {\n\n\t\t\t// If previous value didn't exist - remove it\n\t\t\tif ( overwritten === undefined ) {\n\t\t\t\tjQuery( window ).removeProp( callbackName );\n\n\t\t\t// Otherwise restore preexisting value\n\t\t\t} else {\n\t\t\t\twindow[ callbackName ] = overwritten;\n\t\t\t}\n\n\t\t\t// Save back as free\n\t\t\tif ( s[ callbackName ] ) {\n\n\t\t\t\t// Make sure that re-using the options doesn't screw things around\n\t\t\t\ts.jsonpCallback = originalSettings.jsonpCallback;\n\n\t\t\t\t// Save the callback name for future use\n\t\t\t\toldCallbacks.push( callbackName );\n\t\t\t}\n\n\t\t\t// Call if it was a function and we have a response\n\t\t\tif ( responseContainer && isFunction( overwritten ) ) {\n\t\t\t\toverwritten( responseContainer[ 0 ] );\n\t\t\t}\n\n\t\t\tresponseContainer = overwritten = undefined;\n\t\t} );\n\n\t\t// Delegate to script\n\t\treturn \"script\";\n\t}\n} );\n\n\n\n\n// Support: Safari 8 only\n// In Safari 8 documents created via document.implementation.createHTMLDocument\n// collapse sibling forms: the second one becomes a child of the first one.\n// Because of that, this security measure has to be disabled in Safari 8.\n// https://bugs.webkit.org/show_bug.cgi?id=137337\nsupport.createHTMLDocument = ( function() {\n\tvar body = document.implementation.createHTMLDocument( \"\" ).body;\n\tbody.innerHTML = \"<form></form><form></form>\";\n\treturn body.childNodes.length === 2;\n} )();\n\n\n// Argument \"data\" should be string of html\n// context (optional): If specified, the fragment will be created in this context,\n// defaults to document\n// keepScripts (optional): If true, will include scripts passed in the html string\njQuery.parseHTML = function( data, context, keepScripts ) {\n\tif ( typeof data !== \"string\" ) {\n\t\treturn [];\n\t}\n\tif ( typeof context === \"boolean\" ) {\n\t\tkeepScripts = context;\n\t\tcontext = false;\n\t}\n\n\tvar base, parsed, scripts;\n\n\tif ( !context ) {\n\n\t\t// Stop scripts or inline event handlers from being executed immediately\n\t\t// by using document.implementation\n\t\tif ( support.createHTMLDocument ) {\n\t\t\tcontext = document.implementation.createHTMLDocument( \"\" );\n\n\t\t\t// Set the base href for the created document\n\t\t\t// so any parsed elements with URLs\n\t\t\t// are based on the document's URL (gh-2965)\n\t\t\tbase = context.createElement( \"base\" );\n\t\t\tbase.href = document.location.href;\n\t\t\tcontext.head.appendChild( base );\n\t\t} else {\n\t\t\tcontext = document;\n\t\t}\n\t}\n\n\tparsed = rsingleTag.exec( data );\n\tscripts = !keepScripts && [];\n\n\t// Single tag\n\tif ( parsed ) {\n\t\treturn [ context.createElement( parsed[ 1 ] ) ];\n\t}\n\n\tparsed = buildFragment( [ data ], context, scripts );\n\n\tif ( scripts && scripts.length ) {\n\t\tjQuery( scripts ).remove();\n\t}\n\n\treturn jQuery.merge( [], parsed.childNodes );\n};\n\n\n/**\n * Load a url into a page\n */\njQuery.fn.load = function( url, params, callback ) {\n\tvar selector, type, response,\n\t\tself = this,\n\t\toff = url.indexOf( \" \" );\n\n\tif ( off > -1 ) {\n\t\tselector = stripAndCollapse( url.slice( off ) );\n\t\turl = url.slice( 0, off );\n\t}\n\n\t// If it's a function\n\tif ( isFunction( params ) ) {\n\n\t\t// We assume that it's the callback\n\t\tcallback = params;\n\t\tparams = undefined;\n\n\t// Otherwise, build a param string\n\t} else if ( params && typeof params === \"object\" ) {\n\t\ttype = \"POST\";\n\t}\n\n\t// If we have elements to modify, make the request\n\tif ( self.length > 0 ) {\n\t\tjQuery.ajax( {\n\t\t\turl: url,\n\n\t\t\t// If \"type\" variable is undefined, then \"GET\" method will be used.\n\t\t\t// Make value of this field explicit since\n\t\t\t// user can override it through ajaxSetup method\n\t\t\ttype: type || \"GET\",\n\t\t\tdataType: \"html\",\n\t\t\tdata: params\n\t\t} ).done( function( responseText ) {\n\n\t\t\t// Save response for use in complete callback\n\t\t\tresponse = arguments;\n\n\t\t\tself.html( selector ?\n\n\t\t\t\t// If a selector was specified, locate the right elements in a dummy div\n\t\t\t\t// Exclude scripts to avoid IE 'Permission Denied' errors\n\t\t\t\tjQuery( \"<div>\" ).append( jQuery.parseHTML( responseText ) ).find( selector ) :\n\n\t\t\t\t// Otherwise use the full result\n\t\t\t\tresponseText );\n\n\t\t// If the request succeeds, this function gets \"data\", \"status\", \"jqXHR\"\n\t\t// but they are ignored because response was set above.\n\t\t// If it fails, this function gets \"jqXHR\", \"status\", \"error\"\n\t\t} ).always( callback && function( jqXHR, status ) {\n\t\t\tself.each( function() {\n\t\t\t\tcallback.apply( this, response || [ jqXHR.responseText, status, jqXHR ] );\n\t\t\t} );\n\t\t} );\n\t}\n\n\treturn this;\n};\n\n\n\n\n// Attach a bunch of functions for handling common AJAX events\njQuery.each( [\n\t\"ajaxStart\",\n\t\"ajaxStop\",\n\t\"ajaxComplete\",\n\t\"ajaxError\",\n\t\"ajaxSuccess\",\n\t\"ajaxSend\"\n], function( i, type ) {\n\tjQuery.fn[ type ] = function( fn ) {\n\t\treturn this.on( type, fn );\n\t};\n} );\n\n\n\n\njQuery.expr.pseudos.animated = function( elem ) {\n\treturn jQuery.grep( jQuery.timers, function( fn ) {\n\t\treturn elem === fn.elem;\n\t} ).length;\n};\n\n\n\n\njQuery.offset = {\n\tsetOffset: function( elem, options, i ) {\n\t\tvar curPosition, curLeft, curCSSTop, curTop, curOffset, curCSSLeft, calculatePosition,\n\t\t\tposition = jQuery.css( elem, \"position\" ),\n\t\t\tcurElem = jQuery( elem ),\n\t\t\tprops = {};\n\n\t\t// Set position first, in-case top/left are set even on static elem\n\t\tif ( position === \"static\" ) {\n\t\t\telem.style.position = \"relative\";\n\t\t}\n\n\t\tcurOffset = curElem.offset();\n\t\tcurCSSTop = jQuery.css( elem, \"top\" );\n\t\tcurCSSLeft = jQuery.css( elem, \"left\" );\n\t\tcalculatePosition = ( position === \"absolute\" || position === \"fixed\" ) &&\n\t\t\t( curCSSTop + curCSSLeft ).indexOf( \"auto\" ) > -1;\n\n\t\t// Need to be able to calculate position if either\n\t\t// top or left is auto and position is either absolute or fixed\n\t\tif ( calculatePosition ) {\n\t\t\tcurPosition = curElem.position();\n\t\t\tcurTop = curPosition.top;\n\t\t\tcurLeft = curPosition.left;\n\n\t\t} else {\n\t\t\tcurTop = parseFloat( curCSSTop ) || 0;\n\t\t\tcurLeft = parseFloat( curCSSLeft ) || 0;\n\t\t}\n\n\t\tif ( isFunction( options ) ) {\n\n\t\t\t// Use jQuery.extend here to allow modification of coordinates argument (gh-1848)\n\t\t\toptions = options.call( elem, i, jQuery.extend( {}, curOffset ) );\n\t\t}\n\n\t\tif ( options.top != null ) {\n\t\t\tprops.top = ( options.top - curOffset.top ) + curTop;\n\t\t}\n\t\tif ( options.left != null ) {\n\t\t\tprops.left = ( options.left - curOffset.left ) + curLeft;\n\t\t}\n\n\t\tif ( \"using\" in options ) {\n\t\t\toptions.using.call( elem, props );\n\n\t\t} else {\n\t\t\tcurElem.css( props );\n\t\t}\n\t}\n};\n\njQuery.fn.extend( {\n\n\t// offset() relates an element's border box to the document origin\n\toffset: function( options ) {\n\n\t\t// Preserve chaining for setter\n\t\tif ( arguments.length ) {\n\t\t\treturn options === undefined ?\n\t\t\t\tthis :\n\t\t\t\tthis.each( function( i ) {\n\t\t\t\t\tjQuery.offset.setOffset( this, options, i );\n\t\t\t\t} );\n\t\t}\n\n\t\tvar rect, win,\n\t\t\telem = this[ 0 ];\n\n\t\tif ( !elem ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Return zeros for disconnected and hidden (display: none) elements (gh-2310)\n\t\t// Support: IE <=11 only\n\t\t// Running getBoundingClientRect on a\n\t\t// disconnected node in IE throws an error\n\t\tif ( !elem.getClientRects().length ) {\n\t\t\treturn { top: 0, left: 0 };\n\t\t}\n\n\t\t// Get document-relative position by adding viewport scroll to viewport-relative gBCR\n\t\trect = elem.getBoundingClientRect();\n\t\twin = elem.ownerDocument.defaultView;\n\t\treturn {\n\t\t\ttop: rect.top + win.pageYOffset,\n\t\t\tleft: rect.left + win.pageXOffset\n\t\t};\n\t},\n\n\t// position() relates an element's margin box to its offset parent's padding box\n\t// This corresponds to the behavior of CSS absolute positioning\n\tposition: function() {\n\t\tif ( !this[ 0 ] ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar offsetParent, offset, doc,\n\t\t\telem = this[ 0 ],\n\t\t\tparentOffset = { top: 0, left: 0 };\n\n\t\t// position:fixed elements are offset from the viewport, which itself always has zero offset\n\t\tif ( jQuery.css( elem, \"position\" ) === \"fixed\" ) {\n\n\t\t\t// Assume position:fixed implies availability of getBoundingClientRect\n\t\t\toffset = elem.getBoundingClientRect();\n\n\t\t} else {\n\t\t\toffset = this.offset();\n\n\t\t\t// Account for the *real* offset parent, which can be the document or its root element\n\t\t\t// when a statically positioned element is identified\n\t\t\tdoc = elem.ownerDocument;\n\t\t\toffsetParent = elem.offsetParent || doc.documentElement;\n\t\t\twhile ( offsetParent &&\n\t\t\t\t( offsetParent === doc.body || offsetParent === doc.documentElement ) &&\n\t\t\t\tjQuery.css( offsetParent, \"position\" ) === \"static\" ) {\n\n\t\t\t\toffsetParent = offsetParent.parentNode;\n\t\t\t}\n\t\t\tif ( offsetParent && offsetParent !== elem && offsetParent.nodeType === 1 ) {\n\n\t\t\t\t// Incorporate borders into its offset, since they are outside its content origin\n\t\t\t\tparentOffset = jQuery( offsetParent ).offset();\n\t\t\t\tparentOffset.top += jQuery.css( offsetParent, \"borderTopWidth\", true );\n\t\t\t\tparentOffset.left += jQuery.css( offsetParent, \"borderLeftWidth\", true );\n\t\t\t}\n\t\t}\n\n\t\t// Subtract parent offsets and element margins\n\t\treturn {\n\t\t\ttop: offset.top - parentOffset.top - jQuery.css( elem, \"marginTop\", true ),\n\t\t\tleft: offset.left - parentOffset.left - jQuery.css( elem, \"marginLeft\", true )\n\t\t};\n\t},\n\n\t// This method will return documentElement in the following cases:\n\t// 1) For the element inside the iframe without offsetParent, this method will return\n\t//    documentElement of the parent window\n\t// 2) For the hidden or detached element\n\t// 3) For body or html element, i.e. in case of the html node - it will return itself\n\t//\n\t// but those exceptions were never presented as a real life use-cases\n\t// and might be considered as more preferable results.\n\t//\n\t// This logic, however, is not guaranteed and can change at any point in the future\n\toffsetParent: function() {\n\t\treturn this.map( function() {\n\t\t\tvar offsetParent = this.offsetParent;\n\n\t\t\twhile ( offsetParent && jQuery.css( offsetParent, \"position\" ) === \"static\" ) {\n\t\t\t\toffsetParent = offsetParent.offsetParent;\n\t\t\t}\n\n\t\t\treturn offsetParent || documentElement;\n\t\t} );\n\t}\n} );\n\n// Create scrollLeft and scrollTop methods\njQuery.each( { scrollLeft: \"pageXOffset\", scrollTop: \"pageYOffset\" }, function( method, prop ) {\n\tvar top = \"pageYOffset\" === prop;\n\n\tjQuery.fn[ method ] = function( val ) {\n\t\treturn access( this, function( elem, method, val ) {\n\n\t\t\t// Coalesce documents and windows\n\t\t\tvar win;\n\t\t\tif ( isWindow( elem ) ) {\n\t\t\t\twin = elem;\n\t\t\t} else if ( elem.nodeType === 9 ) {\n\t\t\t\twin = elem.defaultView;\n\t\t\t}\n\n\t\t\tif ( val === undefined ) {\n\t\t\t\treturn win ? win[ prop ] : elem[ method ];\n\t\t\t}\n\n\t\t\tif ( win ) {\n\t\t\t\twin.scrollTo(\n\t\t\t\t\t!top ? val : win.pageXOffset,\n\t\t\t\t\ttop ? val : win.pageYOffset\n\t\t\t\t);\n\n\t\t\t} else {\n\t\t\t\telem[ method ] = val;\n\t\t\t}\n\t\t}, method, val, arguments.length );\n\t};\n} );\n\n// Support: Safari <=7 - 9.1, Chrome <=37 - 49\n// Add the top/left cssHooks using jQuery.fn.position\n// Webkit bug: https://bugs.webkit.org/show_bug.cgi?id=29084\n// Blink bug: https://bugs.chromium.org/p/chromium/issues/detail?id=589347\n// getComputedStyle returns percent when specified for top/left/bottom/right;\n// rather than make the css module depend on the offset module, just check for it here\njQuery.each( [ \"top\", \"left\" ], function( i, prop ) {\n\tjQuery.cssHooks[ prop ] = addGetHookIf( support.pixelPosition,\n\t\tfunction( elem, computed ) {\n\t\t\tif ( computed ) {\n\t\t\t\tcomputed = curCSS( elem, prop );\n\n\t\t\t\t// If curCSS returns percentage, fallback to offset\n\t\t\t\treturn rnumnonpx.test( computed ) ?\n\t\t\t\t\tjQuery( elem ).position()[ prop ] + \"px\" :\n\t\t\t\t\tcomputed;\n\t\t\t}\n\t\t}\n\t);\n} );\n\n\n// Create innerHeight, innerWidth, height, width, outerHeight and outerWidth methods\njQuery.each( { Height: \"height\", Width: \"width\" }, function( name, type ) {\n\tjQuery.each( { padding: \"inner\" + name, content: type, \"\": \"outer\" + name },\n\t\tfunction( defaultExtra, funcName ) {\n\n\t\t// Margin is only for outerHeight, outerWidth\n\t\tjQuery.fn[ funcName ] = function( margin, value ) {\n\t\t\tvar chainable = arguments.length && ( defaultExtra || typeof margin !== \"boolean\" ),\n\t\t\t\textra = defaultExtra || ( margin === true || value === true ? \"margin\" : \"border\" );\n\n\t\t\treturn access( this, function( elem, type, value ) {\n\t\t\t\tvar doc;\n\n\t\t\t\tif ( isWindow( elem ) ) {\n\n\t\t\t\t\t// $( window ).outerWidth/Height return w/h including scrollbars (gh-1729)\n\t\t\t\t\treturn funcName.indexOf( \"outer\" ) === 0 ?\n\t\t\t\t\t\telem[ \"inner\" + name ] :\n\t\t\t\t\t\telem.document.documentElement[ \"client\" + name ];\n\t\t\t\t}\n\n\t\t\t\t// Get document width or height\n\t\t\t\tif ( elem.nodeType === 9 ) {\n\t\t\t\t\tdoc = elem.documentElement;\n\n\t\t\t\t\t// Either scroll[Width/Height] or offset[Width/Height] or client[Width/Height],\n\t\t\t\t\t// whichever is greatest\n\t\t\t\t\treturn Math.max(\n\t\t\t\t\t\telem.body[ \"scroll\" + name ], doc[ \"scroll\" + name ],\n\t\t\t\t\t\telem.body[ \"offset\" + name ], doc[ \"offset\" + name ],\n\t\t\t\t\t\tdoc[ \"client\" + name ]\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn value === undefined ?\n\n\t\t\t\t\t// Get width or height on the element, requesting but not forcing parseFloat\n\t\t\t\t\tjQuery.css( elem, type, extra ) :\n\n\t\t\t\t\t// Set width or height on the element\n\t\t\t\t\tjQuery.style( elem, type, value, extra );\n\t\t\t}, type, chainable ? margin : undefined, chainable );\n\t\t};\n\t} );\n} );\n\n\njQuery.each( ( \"blur focus focusin focusout resize scroll click dblclick \" +\n\t\"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave \" +\n\t\"change select submit keydown keypress keyup contextmenu\" ).split( \" \" ),\n\tfunction( i, name ) {\n\n\t// Handle event binding\n\tjQuery.fn[ name ] = function( data, fn ) {\n\t\treturn arguments.length > 0 ?\n\t\t\tthis.on( name, null, data, fn ) :\n\t\t\tthis.trigger( name );\n\t};\n} );\n\njQuery.fn.extend( {\n\thover: function( fnOver, fnOut ) {\n\t\treturn this.mouseenter( fnOver ).mouseleave( fnOut || fnOver );\n\t}\n} );\n\n\n\n\njQuery.fn.extend( {\n\n\tbind: function( types, data, fn ) {\n\t\treturn this.on( types, null, data, fn );\n\t},\n\tunbind: function( types, fn ) {\n\t\treturn this.off( types, null, fn );\n\t},\n\n\tdelegate: function( selector, types, data, fn ) {\n\t\treturn this.on( types, selector, data, fn );\n\t},\n\tundelegate: function( selector, types, fn ) {\n\n\t\t// ( namespace ) or ( selector, types [, fn] )\n\t\treturn arguments.length === 1 ?\n\t\t\tthis.off( selector, \"**\" ) :\n\t\t\tthis.off( types, selector || \"**\", fn );\n\t}\n} );\n\n// Bind a function to a context, optionally partially applying any\n// arguments.\n// jQuery.proxy is deprecated to promote standards (specifically Function#bind)\n// However, it is not slated for removal any time soon\njQuery.proxy = function( fn, context ) {\n\tvar tmp, args, proxy;\n\n\tif ( typeof context === \"string\" ) {\n\t\ttmp = fn[ context ];\n\t\tcontext = fn;\n\t\tfn = tmp;\n\t}\n\n\t// Quick check to determine if target is callable, in the spec\n\t// this throws a TypeError, but we will just return undefined.\n\tif ( !isFunction( fn ) ) {\n\t\treturn undefined;\n\t}\n\n\t// Simulated bind\n\targs = slice.call( arguments, 2 );\n\tproxy = function() {\n\t\treturn fn.apply( context || this, args.concat( slice.call( arguments ) ) );\n\t};\n\n\t// Set the guid of unique handler to the same of original handler, so it can be removed\n\tproxy.guid = fn.guid = fn.guid || jQuery.guid++;\n\n\treturn proxy;\n};\n\njQuery.holdReady = function( hold ) {\n\tif ( hold ) {\n\t\tjQuery.readyWait++;\n\t} else {\n\t\tjQuery.ready( true );\n\t}\n};\njQuery.isArray = Array.isArray;\njQuery.parseJSON = JSON.parse;\njQuery.nodeName = nodeName;\njQuery.isFunction = isFunction;\njQuery.isWindow = isWindow;\njQuery.camelCase = camelCase;\njQuery.type = toType;\n\njQuery.now = Date.now;\n\njQuery.isNumeric = function( obj ) {\n\n\t// As of jQuery 3.0, isNumeric is limited to\n\t// strings and numbers (primitives or objects)\n\t// that can be coerced to finite numbers (gh-2662)\n\tvar type = jQuery.type( obj );\n\treturn ( type === \"number\" || type === \"string\" ) &&\n\n\t\t// parseFloat NaNs numeric-cast false positives (\"\")\n\t\t// ...but misinterprets leading-number strings, particularly hex literals (\"0x...\")\n\t\t// subtraction forces infinities to NaN\n\t\t!isNaN( obj - parseFloat( obj ) );\n};\n\n\n\n\n// Register as a named AMD module, since jQuery can be concatenated with other\n// files that may use define, but not via a proper concatenation script that\n// understands anonymous AMD modules. A named AMD is safest and most robust\n// way to register. Lowercase jquery is used because AMD module names are\n// derived from file names, and jQuery is normally delivered in a lowercase\n// file name. Do this after creating the global so that if an AMD module wants\n// to call noConflict to hide this version of jQuery, it will work.\n\n// Note that for maximum portability, libraries that are not jQuery should\n// declare themselves as anonymous modules, and avoid setting a global if an\n// AMD loader is present. jQuery is a special case. For more information, see\n// https://github.com/jrburke/requirejs/wiki/Updating-existing-libraries#wiki-anon\n\nif ( typeof define === \"function\" && define.amd ) {\n\tdefine( \"jquery\", [], function() {\n\t\treturn jQuery;\n\t} );\n}\n\n\n\n\nvar\n\n\t// Map over jQuery in case of overwrite\n\t_jQuery = window.jQuery,\n\n\t// Map over the $ in case of overwrite\n\t_$ = window.$;\n\njQuery.noConflict = function( deep ) {\n\tif ( window.$ === jQuery ) {\n\t\twindow.$ = _$;\n\t}\n\n\tif ( deep && window.jQuery === jQuery ) {\n\t\twindow.jQuery = _jQuery;\n\t}\n\n\treturn jQuery;\n};\n\n// Expose jQuery and $ identifiers, even in AMD\n// (#7102#comment:10, https://github.com/jquery/jquery/pull/557)\n// and CommonJS for browser emulators (#13566)\nif ( !noGlobal ) {\n\twindow.jQuery = window.$ = jQuery;\n}\n\n\n\n\nreturn jQuery;\n} );\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/jquery/dist/jquery.js\n// module id = 1\n// module chunks = 0","import namespace from 'mapea-util/decorator';\r\nimport visorControl from './visorcontrol.js';\r\nimport catastroControl from './catastrocontrol.js';\r\nimport css from 'assets/css/plg_cartografia_historica.css';\r\nimport \"@fortawesome/fontawesome-free/css/all.css\";\r\n\r\n@namespace(\"M.plugin\")\r\nclass PLG_Cartografia_Historica extends M.Plugin {\r\n\r\n  /**\r\n   * @classdesc\r\n   * Main facade plugin object. This class creates a plugin\r\n   * object which has an implementation Object\r\n   *\r\n   * @constructor\r\n   * @extends {M.Plugin}\r\n   * @param {Object} impl implementation object\r\n   * @api stable\r\n   */\r\n  constructor(params) {\r\n\r\n    super();\r\n    /**\r\n     * Facade of the map\r\n     * @private\r\n     * @type {M.Map}\r\n     */\r\n    this.map_ = null;\r\n\r\n    /**\r\n     * Array of controls\r\n     * @private\r\n     * @type {Array<M.Control>}\r\n     */\r\n    this.controls_ = [];\r\n\r\n    /**\r\n     * add your variables\r\n     *\r\n     */\r\n    this.html_ = null;\r\n    this.layers_ = params.layers;\r\n\r\n    this.posx_ = null;\r\n    this.posy_ = null;\r\n    this.sizex_ = null;\r\n    this.sizey_ = null;\r\n  }\r\n\r\n  /**\r\n   * This function adds this plugin into the map\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Map} map the map to add the plugin\r\n   * @api stable\r\n   */\r\n  addTo(map) {\r\n    var visor = new M.control.visorControl(this.layers_, this);\r\n    var catastro = new M.control.catastroControl(this);\r\n    this.controls_.push(visor);\r\n    this.controls_.push(catastro);\r\n    this.map_ = map;\r\n    this.html_ = null;\r\n    //panel para agregar control - no obligatorio\r\n    this.panel_ = new M.ui.Panel(\"panelvisor\", {\r\n      collapsible: true,\r\n      position: M.ui.position.TR,\r\n      className: \"m-visor\",\r\n      collapsedButtonClass: \"g-cartografia-flecha-izquierda\"\r\n    });\r\n    this.panel_.addControls(this.controls_);\r\n    map.addPanels(this.panel_);\r\n    \r\n    map.on(M.evt.COMPLETED, function(){\r\n      setTimeout(function(){\r\n        document.querySelector(\".m-visor .m-panel-btn\").addEventListener(\"click\", function(){\r\n          if(document.querySelector(\".m-visor\").classList.contains(\"opened\") && !visor.activated && !catastro.activated){\r\n            visor.activate();\r\n          }\r\n        });\r\n      }, 100);\r\n    });\r\n  }\r\n\r\n  getPosX(){\r\n    return this.posx_;\r\n  }\r\n  getPosY(){\r\n    return this.posy_;\r\n  }\r\n  setPosX(posx){\r\n    this.posx_ = posx;\r\n  }\r\n  setPosY(posy){\r\n    this.posy_ = posy; \r\n  }\r\n\r\n  getSizeX(){\r\n    return this.sizex_;\r\n  }\r\n  getSizeY(){\r\n    return this.sizey_;\r\n  }\r\n  setSizeX(sizex){\r\n    this.sizex_ = sizex;\r\n  }\r\n  setSizeY(sizey){\r\n    this.sizey_ = sizey; \r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./plugins/plg_cartografia_historica/src/facade/js/plg_cartografia_historica.js","import namespace from 'mapea-util/decorator';\r\nimport visorImplControl from 'impl/visorcontrol';\r\nimport $ from 'jquery';\r\n\r\n@namespace(\"M.control\")\r\nexport class visorControl extends M.Control {\r\n\r\n  /**\r\n   * @classdesc\r\n   * Main constructor of the class. Creates a PluginControl\r\n   * control\r\n   *\r\n   * @constructor\r\n   * @extends {M.Control}\r\n   * @api stable\r\n   */\r\n  constructor(layers, d) {\r\n    // 1. checks if the implementation can create PluginControl\r\n    if (M.utils.isUndefined(M.impl.control.visorControl)) {\r\n      M.exception('La implementacin usada no puede crear controles visorControl');\r\n    }\r\n    // 2. implementation of this control\r\n    let impl = new M.impl.control.visorControl();\r\n    super(impl, \"visor\");\r\n    this.layers_ = layers;\r\n    this.smap_ = null;\r\n    this.html_ = null;\r\n    this.mainClass_ = d;\r\n  }\r\n  /**\r\n   * This function creates the view\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Map} map to add the control\r\n   * @api stable\r\n   */\r\n   createView(map) {\r\n     return new Promise((success, fail) => {\r\n      return M.template.compile('visor.html', {\r\n        'vars': {'layers': this.layers_}\r\n      }).then(html => {\r\n        /** Aadir cdigo dependiente del DOM */\r\n        this.html_ = html;\r\n        this.smap_ = null;\r\n        this.initControl();\r\n        success(html);\r\n      });\r\n    });\r\n   }\r\n  /**\r\n   * This function is called on the control activation\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   */\r\n  activate() {\r\n    var _this = this;\r\n    super.activate(); //calls super to manage de/activation\r\n    //Crecin del div\r\n    this.getImpl().fixZoom(_this.map_);\r\n    let div = document.createElement(\"div\");\r\n    div.id = \"visor\";\r\n    div.style.position = \"absolute\";\r\n    if(_this.getPosX() == null){\r\n      _this.setSizeX(_this.map_.gf.map_.mb.offsetWidth/4);\r\n      _this.setSizeY(_this.map_.gf.map_.mb.offsetHeight/2);\r\n      _this.setPosX(_this.map_.gf.map_.mb.offsetWidth/4 - _this.getSizeX()/2);\r\n      _this.setPosY(_this.map_.gf.map_.mb.offsetHeight/2 - _this.getSizeY()/2);\r\n    }\r\n    div.style.top = _this.getPosY() + \"px\";\r\n    div.style.left = _this.getPosX() + \"px\";\r\n    div.style.width = _this.getSizeX()+\"px\";\r\n    div.style.height = _this.getSizeY()+\"px\";\r\n    div.style.border = \"solid 7px rgba(8,112,31,.8) \";\r\n    div.style.borderRadius = \"5px\";\r\n    div.style.userSelect = \"none\";\r\n\r\n    div.style.webkitBoxShadow = \"0px 0px 11px 4px rgba(0,0,0,0.75)\";\r\n    div.style.MozBoxShadow = \"0px 0px 10px 3px rgba(0,0,0,0.75)\";\r\n    div.style.boxShadow = \"0px 0px 10px 3px rgba(0,0,0,0.75);\";\r\n\r\n    var mousePositionX = null;\r\n    var mousePositionY = null;\r\n    var relativeX = null;\r\n    var relativeY = null;\r\n\r\n    //Creacin de icono de resize\r\n    let divResize = document.createElement(\"div\");\r\n    divResize.style.position = \"absolute\";\r\n    divResize.style.right=\"0px\";\r\n    divResize.style.bottom=\"0px\";\r\n    divResize.style.width=\"20px\";\r\n    divResize.style.height=\"20px\";\r\n    divResize.style.cursor=\"nwse-resize\";\r\n    divResize.style.backgroundImage = \"url('https://raw.githubusercontent.com/danielcarpio/PLG_Cartografia_Historica/master/assets/img/arrow.png')\";\r\n    divResize.style.backgroundSize = \"100%\";\r\n\r\n    //Creacin de icono de cierre\r\n    let divClose = document.createElement(\"div\");\r\n    divClose.style.position = \"absolute\";\r\n    divClose.style.right=\"0px\";\r\n    divClose.style.top=\"0px\";\r\n    divClose.style.width=\"15px\";\r\n    divClose.style.height=\"15px\";\r\n    divClose.style.filter = \"saturate(0%)\";\r\n    divClose.style.cursor=\"pointer\";\r\n    divClose.style.backgroundImage = \"url('https://raw.githubusercontent.com/danielcarpio/PLG_Cartografia_Historica/master/assets/img/close.png')\";\r\n    divClose.style.backgroundSize = \"100%\";\r\n\r\n    divClose.addEventListener(\"click\", function(){\r\n      _this.deactivate();\r\n    });\r\n\r\n    //Resize\r\n    var lockedResize = 1;\r\n    var coordsResizeX = null;\r\n    var coordsResizeY = null;\r\n\r\n    var unlockResizeFunc = function unlockResize(coords){\r\n      lockedResize = 0;\r\n      coordsResizeX = coords.clientX;\r\n      coordsResizeY = coords.clientY;\r\n      if(coordsResizeX == null){\r\n        coordsResizeX = coords.touches[0].screenX;\r\n        coordsResizeY = coords.touches[0].screenY;\r\n      }\r\n    };\r\n    var lockFunc = function lock(){\r\n      lockedResize = 1;\r\n      locked = 1;\r\n    };\r\n    divResize.addEventListener(\"mousedown\", unlockResizeFunc);\r\n    divResize.addEventListener(\"touchstart\", unlockResizeFunc);\r\n    _this.map_.gf.map_.mb.addEventListener(\"mouseup\", lockFunc);\r\n    _this.map_.gf.map_.mb.addEventListener(\"mouseleave\", lockFunc);\r\n    \r\n    var moveResizeFunc = function(coord){\r\n      if(lockedResize == 0){\r\n        var newCoordX = coord.clientX;\r\n        var newCoordY = coord.clientY;\r\n        if(newCoordX == null){\r\n          newCoordX = coord.touches[0].screenX;\r\n          newCoordY = coord.touches[0].screenY;\r\n        }\r\n        var oldSizeX = _this.getSizeX();\r\n        var oldSizeY = _this.getSizeY();\r\n        _this.setSizeX(_this.getSizeX() + (newCoordX - coordsResizeX));\r\n        _this.setSizeY(_this.getSizeY() + (newCoordY - coordsResizeY));\r\n        if(_this.getSizeX() < 40) _this.setSizeX(40);\r\n        if(_this.getSizeY() < 40) _this.setSizeY(40);\r\n        if(_this.getPosX() + 2*parseInt(div.style.borderWidth)+_this.getSizeX() > _this.map_.gf.map_.mb.offsetWidth)\r\n          _this.setSizeX(_this.map_.gf.map_.mb.offsetWidth-_this.getPosX()-2*parseInt(div.style.borderWidth));\r\n        if(_this.getPosY() + 2*parseInt(div.style.borderWidth)+_this.getSizeY() > _this.map_.gf.map_.mb.offsetHeight)\r\n          _this.setSizeY(_this.map_.gf.map_.mb.offsetHeight-_this.getPosY()-2*parseInt(div.style.borderWidth));\r\n        if(oldSizeX < 50 && oldSizeY < 50){\r\n          if(_this.getSizeX() > oldSizeX && _this.getSizeY() > oldSizeY){\r\n            resizeBoth();\r\n          }else if(_this.getSizeX() > oldSizeX){\r\n            resizeX();\r\n            _this.setSizeY(oldSizeY);\r\n          } else if(_this.getSizeY() > oldSizeY){\r\n            resizeY();\r\n            _this.setSizeX(oldSizeX);\r\n          } else {\r\n            _this.setSizeX(oldSizeX);\r\n            _this.setSizeY(oldSizeY);\r\n          }\r\n        } else if(oldSizeX < 50){\r\n          resizeY();\r\n          if(oldSizeX < _this.getSizeX()){\r\n            resizeX();\r\n          } else {\r\n            _this.setSizeX(oldSizeX);\r\n          }\r\n        } else if(oldSizeY < 50){\r\n          resizeX();\r\n          if(oldSizeY < _this.getPosY()){\r\n            resizeY();\r\n          }else{\r\n            _this.setSizeY(oldSizeY);\r\n          }\r\n        } else {\r\n          resizeBoth();\r\n        }\r\n        _this.getImpl().updateZoom(secondmap, _this.map_);\r\n        var newCoordMap = _this.getImpl().coordinatesFromPixel(_this.map_, _this.getPosX()+parseInt(div.style.borderWidth)+(_this.getSizeX()/2), _this.getPosY()+parseInt(div.style.borderWidth)+(_this.getSizeY()/2));\r\n        secondmap.setCenter({\r\n          x: newCoordMap[0],\r\n          y: newCoordMap[1],\r\n          draw: false\r\n        });\r\n        _this.getImpl().updateSize(secondmap);\r\n      }\r\n\r\n      function resizeX(){\r\n        div.style.width = _this.getSizeX()+\"px\";\r\n        coordsResizeX = newCoordX;\r\n      }\r\n\r\n      function resizeY(){\r\n        div.style.height = _this.getSizeY()+\"px\";\r\n        coordsResizeY = newCoordY;\r\n      }\r\n\r\n      function resizeBoth(){\r\n        div.style.width = _this.getSizeX()+\"px\";\r\n        div.style.height = _this.getSizeY()+\"px\";\r\n        coordsResizeX = newCoordX;\r\n        coordsResizeY = newCoordY;\r\n      }\r\n    };\r\n\r\n    _this.map_.gf.map_.mb.addEventListener(\"mousemove\", moveResizeFunc);\r\n    _this.map_.gf.map_.mb.addEventListener(\"touchmove\", moveResizeFunc);\r\n    \r\n    //Movimiento del visor\r\n    var locked = 1;\r\n \r\n    var unlockMoveFunc = function(coord){\r\n      locked = 0;\r\n      if(coord.clientX != null){\r\n        relativeX = coord.clientX - _this.getPosX();\r\n        relativeY = coord.clientY - _this.getPosY();  \r\n      }else{\r\n        relativeX = coord.touches[0].screenX - _this.getPosX();\r\n        relativeY = coord.touches[0].screenY - _this.getPosY();    \r\n      }\r\n    };\r\n    div.addEventListener(\"mousedown\", unlockMoveFunc);\r\n    div.addEventListener(\"touchstart\", unlockMoveFunc);\r\n\r\n    div.addEventListener(\"mouseup\", lockFunc);\r\n    div.addEventListener(\"touchend\", lockFunc);\r\n    \r\n    var moveFunct = function(coord){\r\n      if(locked == 0 && lockedResize == 1){\r\n        mousePositionX = coord.clientX;\r\n        mousePositionY = coord.clientY;\r\n        if(mousePositionX == null){\r\n          mousePositionX = coord.touches[0].screenX;\r\n          mousePositionY = coord.touches[0].screenY;\r\n        }\r\n        _this.setPosX(mousePositionX - relativeX);\r\n        _this.setPosY(mousePositionY - relativeY);\r\n        if(_this.getPosX() < 0) _this.setPosX(0);\r\n        if(_this.getPosX()+_this.getSizeX()+2*parseInt(div.style.borderWidth) > _this.map_.gf.map_.mb.offsetWidth)\r\n          _this.setPosX(_this.map_.gf.map_.mb.offsetWidth - 2*parseInt(div.style.borderWidth) - _this.getSizeX());\r\n        if(_this.getPosY() < 0) _this.setPosY(0);\r\n        if(_this.getPosY()+_this.getSizeY()+2*parseInt(div.style.borderWidth) > _this.map_.gf.map_.mb.offsetHeight)\r\n          _this.setPosY(_this.map_.gf.map_.mb.offsetHeight - 2*parseInt(div.style.borderWidth) - _this.getSizeY());\r\n\r\n        div.style.top = _this.getPosY()+\"px\";\r\n        div.style.left = _this.getPosX()+\"px\";\r\n        _this.getImpl().updateZoom(secondmap, _this.map_);\r\n        var coordMap = _this.getImpl().coordinatesFromPixel(_this.map_, _this.getPosX()+_this.getSizeX()/2+parseInt(div.style.borderWidth), _this.getPosY()+_this.getSizeY()/2+parseInt(div.style.borderWidth));\r\n        secondmap.setCenter({\r\n          x: coordMap[0],\r\n          y: coordMap[1],\r\n          draw: false\r\n        });\r\n      }\r\n    };\r\n\r\n    div.addEventListener(\"mousemove\", moveFunct);\r\n    div.addEventListener(\"touchmove\", moveFunct);\r\n    _this.map_.gf.map_.mb.addEventListener(\"mousemove\", moveFunct);\r\n    _this.map_.gf.map_.mb.addEventListener(\"touchmove\", moveFunct);\r\n    \r\n    //Creacin del mapa del visor\r\n    this.map_.getContainer().appendChild(div);\r\n    var secondmap = M.map({\r\n      container:\"visor\"\r\n    });\r\n\r\n    //Select del HTML    \r\n    var htmlSelect = this.html_.querySelector(\"#div-visor-cartografia\");\r\n    htmlSelect.style.display = \"block\";\r\n    \r\n    var firstOnDic = _this.layers_[Object.keys(_this.layers_)[0]];\r\n    var selected = firstOnDic[Object.keys(firstOnDic)[0]];\r\n    _this.changeLayer(secondmap, selected);\r\n\r\n    $(window).resize(function(){\r\n      setTimeout(function(){\r\n        _this.setSizeX(_this.map_.gf.map_.mb.offsetWidth/4);\r\n        _this.setSizeY(_this.map_.gf.map_.mb.offsetHeight/2);\r\n        _this.setPosX(_this.map_.gf.map_.mb.offsetWidth/4 - _this.getSizeX()/2);\r\n        _this.setPosY(_this.map_.gf.map_.mb.offsetHeight/2 - _this.getSizeY()/2);\r\n      \r\n        div.style.width = _this.getSizeX()+\"px\";\r\n        div.style.left = _this.getPosX()+\"px\";\r\n        div.style.height = _this.getSizeY()+\"px\";\r\n        div.style.top = _this.getPosY()+\"px\";\r\n\r\n        _this.getImpl().updateZoom(secondmap, _this.map_);\r\n        var coordMap = _this.getImpl().coordinatesFromPixel(_this.map_, _this.getPosX()+_this.getSizeX()/2+parseInt(div.style.borderWidth), _this.getPosY()+_this.getSizeY()/2+parseInt(div.style.borderWidth));\r\n        secondmap.setCenter({\r\n          x: coordMap[0],\r\n          y: coordMap[1],\r\n          draw: false\r\n        });\r\n        _this.getImpl().updateSize(secondmap);\r\n      }, 100);\r\n    });\r\n\r\n    secondmap.on(M.evt.COMPLETED, function(){\r\n      var oldCoord = _this.getImpl().coordinatesFromPixel(_this.map_, _this.getPosX()+_this.getSizeX()/2+parseInt(div.style.borderWidth), _this.getPosY()+_this.getSizeY()/2+parseInt(div.style.borderWidth));\r\n      secondmap.setResolutions(_this.map_.getResolutions());\r\n      _this.getImpl().updateZoom(secondmap, _this.map_);\r\n      secondmap.setCenter({x: oldCoord[0], y: oldCoord[1], draw: false});\r\n    });\r\n    this.smap_ = secondmap;\r\n\r\n    //Actualizacin del visor cuando se mueve el mapa o se hace zoom\r\n    _this.getImpl().interactionInMap(this, _this.map_, secondmap, div);\r\n\r\n    secondmap.getContainer().appendChild(divResize);\r\n    secondmap.getContainer().appendChild(divClose);\r\n\r\n    this.getImpl().noInteractions(secondmap); \r\n    this.filters();\r\n\r\n    //this.getImpl().activateClick(this.map_);\r\n  }\r\n\r\n  /**\r\n   * This function is called on the control deactivation\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   */\r\n  deactivate() {\r\n    super.deactivate(); //calls super to manage de/activation\r\n    let div = document.getElementById(\"visor\");\r\n    this.map_.getContainer().removeChild(div);\r\n    var htmlSelect = this.html_.querySelector(\"#m-visor-select\");\r\n    htmlSelect.getElementsByClassName(\"layerSelected\")[0].classList.remove(\"layerSelected\");\r\n    htmlSelect.querySelector(\"#firstLi\").classList.add(\"layerSelected\");\r\n    document.querySelector(\"#div-visor-cartografia\").style.display = \"none\";\r\n\r\n    this.deactivateFilters();\r\n    //this.getImpl().deactivateClick(this.map_);\r\n  }\r\n   /**\r\n   * This function gets activation button\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {HTML} html of control\r\n   * @api stable\r\n   */\r\n  getActivationButton(html) {\r\n    return html.querySelector('.m-visor #ctrlCartografia');\r\n  };\r\n  \r\n  /**\r\n   * This function compares controls\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Control} control to compare\r\n   * @api stable\r\n   */\r\n  equals(control) {\r\n    return control instanceof visorControl;\r\n  }\r\n\r\n  //** Add your own functions */\r\n\r\n  changeLayer(secondmap, layer){\r\n    if(layer[\"type\"] === \"WMS\"){\r\n      secondmap.removeLayers(secondmap.getLayers());\r\n      secondmap.addWMS(new M.layer.WMS({\r\n        url: layer[\"url\"],\r\n        name: layer[\"name\"],\r\n        tiled: false\r\n      }));\r\n    }else if(layer[\"type\"] === \"WMTS\"){\r\n      secondmap.removeLayers(secondmap.getLayers());\r\n      secondmap.addWMTS(new M.layer.WMTS({\r\n        url: layer[\"url\"],\r\n        name: layer[\"name\"],\r\n        matrixSet: \"EPSG:25830\"\r\n      }));\r\n    }\r\n  }\r\n\r\n  initControl(){\r\n    var _this = this;\r\n    for(const l of _this.html_.getElementsByClassName(\"selectableToChangeLayer\")){\r\n      l.addEventListener(\"click\", function(){\r\n        _this.changeLayer(_this.smap_, _this.findLayer(l.innerHTML));\r\n        document.getElementsByClassName(\"layerSelected\")[0].classList.remove(\"layerSelected\");\r\n        l.classList.add(\"layerSelected\");\r\n      });\r\n    }\r\n    $(_this.html_).find(\".selectableToHide\").find(\".selectTitle\").click(function(e){\r\n      $(this).parent().find(\".selectableGroup\").toggle();\r\n    });\r\n\r\n    $(_this.html_).find(\"#div-options-visor\").toggle();\r\n    $(_this.html_).find(\"#options-title-visor\").click(function(){\r\n      $(_this.html_).find(\"#div-options-visor\").toggle();\r\n    });\r\n  }\r\n\r\n  findLayer(name){\r\n    var _this = this;\r\n    for(const [cat, lay] of Object.entries(_this.layers_)){\r\n      for(const [nameLa, values] of Object.entries(lay)){\r\n        if(nameLa === name){\r\n          return values;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  getPosX(){\r\n    return this.mainClass_.getPosX();\r\n  }\r\n  getPosY(){\r\n    return this.mainClass_.getPosY();\r\n  }\r\n  setPosX(posx){\r\n    this.mainClass_.setPosX(posx);\r\n  }\r\n  setPosY(posy){\r\n    this.mainClass_.setPosY(posy); \r\n  }\r\n\r\n  getSizeX(){\r\n    return this.mainClass_.getSizeX();\r\n  }\r\n  getSizeY(){\r\n    return this.mainClass_.getSizeY();\r\n  }\r\n  setSizeX(sizex){\r\n    this.mainClass_.setSizeX(sizex);\r\n  }\r\n  setSizeY(sizey){\r\n    this.mainClass_.setSizeY(sizey); \r\n  }\r\n\r\n  filters(){\r\n    var _this = this;\r\n    var enhance = new ol.filter.Colorize({ operation:'enhance'});\r\n    _this.getImpl().addFilter(_this.smap_, enhance);\r\n    \r\n    var filter = new ol.filter.Colorize();\r\n    _this.getImpl().addFilter(_this.smap_, filter);\r\n    \r\n    enhance.setActive($(\"#div-visor\").find(\"#div-options-visor\").find(\"#enhance\").prop(\"checked\"));\r\n    filter.setActive($(\"#div-visor\").find(\"#div-options-visor\").find(\"#active\").prop(\"checked\") );\r\n\r\n    function setFilter(){\r\n      enhance.setActive($(\"#div-visor\").find(\"#div-options-visor\").find(\"#enhance\").prop(\"checked\"));\r\n      filter.setActive($(\"#div-visor\").find(\"#div-options-visor\").find(\"#active\").prop(\"checked\") );\r\n      \r\n      var f = $(\"#div-visor\").find(\"#div-options-visor\").find(\"#filter\").val();\r\n      switch(f){\r\n        case 'grayscale':\r\n\t\t\t\tcase 'invert':\r\n\t\t\t\tcase 'sepia':\r\n          filter.setFilter(f);\r\n          _this.html_.querySelector(\"#option-values\").style.display= \"none\";\r\n\t\t\t\tbreak;\r\n        default:\r\n          filter.setFilter({\r\n            operation: f,\r\n            red: Number($(\"#div-visor\").find(\"#div-options-visor\").find(\"#m-visor-red\").val()),\r\n            green: Number($(\"#div-visor\").find(\"#div-options-visor\").find(\"#m-visor-green\").val()),\r\n            blue: Number($(\"#div-visor\").find(\"#div-options-visor\").find(\"#m-visor-blue\").val()),\r\n            value: Number($(\"#div-visor\").find(\"#div-options-visor\").find(\"#m-visor-val\").val())\r\n          });\r\n          _this.html_.querySelector(\"#option-values\").style.display= \"block\";\r\n        break;\r\n      }\r\n    }\r\n    setFilter();\r\n    $(\".input-option\").on('input', setFilter);\r\n  }\r\n\r\n  deactivateFilters(){\r\n    $(\"#div-visor\").find(\"#div-options-visor\").find(\"#enhance\").prop(\"checked\", false);\r\n    $(\"#div-visor\").find(\"#div-options-visor\").find(\"#active\").prop(\"checked\", false);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./plugins/plg_cartografia_historica/src/facade/js/visorcontrol.js","import namespace from 'mapea-util/decorator';\r\n\r\n@namespace(\"M.impl.control\")\r\nexport class visorControl extends M.impl.Control {\r\n  /**\r\n   * @classdesc\r\n   * Main constructor of the visorControl.\r\n   *\r\n   * @constructor\r\n   * @extends {M.impl.Control}\r\n   * @api stable\r\n   */\r\n  constructor() {\r\n    super();\r\n  }\r\n  /**\r\n   * This function adds the control to the specified map\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Map} map to add the plugin\r\n   * @param {HTMLElement} html of the plugin\r\n   * @api stable\r\n   */\r\n  addTo(map, html) {\r\n    super.addTo(map, html);\r\n  }\r\n\r\n   //** Add your own functions */\r\n\r\n  noInteractions(map){\r\n    map.on(M.evt.COMPLETED, function(){\r\n      map.removeControls(map.getControls());\r\n      map.getMapImpl().getInteractions().forEach((i) => {\r\n        i.setActive(false);\r\n      });\r\n    });\r\n  }\r\n\r\n  coordinatesFromPixel(map, x, y){\r\n    return map.getMapImpl().getCoordinateFromPixel([x, y]);\r\n  }\r\n\r\n  updateSize(map){\r\n    map.getMapImpl().updateSize();\r\n  }\r\n\r\n  updateZoom(mapToChange, mapOrigin){\r\n    mapToChange.setZoom(mapOrigin.getZoom());\r\n    //mapToChange.getMapImpl().getView().setZoom(mapOrigin.getMapImpl().getView().getZoom());\r\n  }\r\n\r\n  interactionInMap(d, map, secondmap, div){\r\n    var _this = d;\r\n    var _thisClass = this;\r\n\r\n    map.getMapImpl().getView().on('propertychange', function(e) {\r\n        var coords = _thisClass.coordinatesFromPixel(map, _this.getPosX()+_this.getSizeX()/2+parseInt(div.style.borderWidth), _this.getPosY()+_this.getSizeY()/2+parseInt(div.style.borderWidth));\r\n        secondmap.setCenter({\r\n          x: coords[0],\r\n          y: coords[1],\r\n          draw: false\r\n        });\r\n        //secondmap.getMapImpl().getView().setZoom(_this.map_.getMapImpl().getView().getZoom());\r\n        _thisClass.updateZoom(secondmap, map);\r\n    });\r\n  }\r\n\r\n  fixZoom(map){\r\n    map.getMapImpl().getView().setZoom(Math.round(map.getMapImpl().getView().getZoom()));\r\n  }\r\n\r\n  addFilter(map, filter){\r\n    map.getMapImpl().addFilter(filter);\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./plugins/plg_cartografia_historica/src/impl/ol/js/visorcontrol.js","import namespace from 'mapea-util/decorator';\r\nimport catastroImplControl from 'impl/catastrocontrol';\r\nimport $ from 'jquery';\r\nimport flatpickr from \"flatpickr\";\r\nimport { Spanish } from \"flatpickr/dist/l10n/es.js\";\r\nimport dist from \"openlayers-ext\";\r\nrequire(\"flatpickr/dist/themes/airbnb.css\");\r\n\r\n@namespace(\"M.control\")\r\nexport class catastroControl extends M.Control {\r\n\r\n  /**\r\n   * @classdesc\r\n   * Main constructor of the class. Creates a PluginControl\r\n   * control\r\n   *\r\n   * @constructor\r\n   * @extends {M.Control}\r\n   * @api stable\r\n   */\r\n  constructor(d) {\r\n    // 1. checks if the implementation can create PluginControl\r\n    if (M.utils.isUndefined(M.impl.control.catastroControl)) {\r\n      M.exception('La implementacin usada no puede crear controles catastroControl');\r\n    }\r\n    // 2. implementation of this control\r\n    let impl = new M.impl.control.catastroControl();\r\n    super(impl, \"visor\");\r\n    this.html_ = null;\r\n    this.mainClass_ = d;\r\n  }\r\n  /**\r\n   * This function creates the view\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Map} map to add the control\r\n   * @api stable\r\n   */\r\n   createView(map) {\r\n     return new Promise((success, fail) => {\r\n      return M.template.compile('catastro.html').then(html => {\r\n         /** Aadir cdigo dependiente del DOM */\r\n          this.html_ = html;\r\n          this.initControl();\r\n          success(html);\r\n        });\r\n    });\r\n   }\r\n  /**\r\n   * This function is called on the control activation\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   */\r\n  activate() {\r\n    var _this = this;\r\n    super.activate(); //calls super to manage de/activation\r\n    //Crecin del div\r\n    this.getImpl().fixZoom(_this.map_);\r\n    let div = document.createElement(\"div\");\r\n    div.id = \"catastro\";\r\n    div.style.position = \"absolute\";\r\n    if(_this.getPosX() == null){\r\n      _this.setSizeX(_this.map_.gf.map_.mb.offsetWidth/4);\r\n      _this.setSizeY(_this.map_.gf.map_.mb.offsetHeight/2);\r\n      _this.setPosX(_this.map_.gf.map_.mb.offsetWidth/4 - _this.getSizeX()/2);\r\n      _this.setPosY(_this.map_.gf.map_.mb.offsetHeight/2 - _this.getSizeY()/2);\r\n    }\r\n    div.style.width = _this.getSizeX()+\"px\";\r\n    div.style.height = _this.getSizeY()+\"px\";\r\n    div.style.top = _this.getPosY() + \"px\";\r\n    div.style.left = _this.getPosX() + \"px\";\r\n    div.style.border = \"solid 7px rgba(8,112,31,.8) \";\r\n    div.style.borderRadius = \"5px\";\r\n    div.style.userSelect = \"none\";\r\n\r\n    div.style.webkitBoxShadow = \"0px 0px 11px 4px rgba(0,0,0,0.75)\";\r\n    div.style.MozBoxShadow = \"0px 0px 10px 3px rgba(0,0,0,0.75)\";\r\n    div.style.boxShadow = \"0px 0px 10px 3px rgba(0,0,0,0.75);\";\r\n\r\n    var mousePositionX = null;\r\n    var mousePositionY = null;\r\n    var relativeX = null;\r\n    var relativeY = null;\r\n\r\n    //Creacin de icono de resize\r\n    let divResize = document.createElement(\"div\");\r\n    divResize.style.position = \"absolute\";\r\n    divResize.style.right=\"0px\";\r\n    divResize.style.bottom=\"0px\";\r\n    divResize.style.width=\"20px\";\r\n    divResize.style.height=\"20px\";\r\n    divResize.style.cursor=\"nwse-resize\";\r\n    divResize.style.backgroundImage = \"url('https://raw.githubusercontent.com/danielcarpio/PLG_Cartografia_Historica/master/assets/img/arrow.png')\";\r\n    divResize.style.backgroundSize = \"100%\";\r\n\r\n    //Creacin de icono de cerrar\r\n    let divClose = document.createElement(\"div\");\r\n    divClose.style.position = \"absolute\";\r\n    divClose.style.right=\"0px\";\r\n    divClose.style.top=\"0px\";\r\n    divClose.style.width=\"15px\";\r\n    divClose.style.height=\"15px\";\r\n    divClose.style.filter = \"saturate(0%)\";\r\n    divClose.style.cursor=\"pointer\";\r\n    divClose.style.backgroundImage = \"url('https://raw.githubusercontent.com/danielcarpio/PLG_Cartografia_Historica/master/assets/img/close.png')\";\r\n    divClose.style.backgroundSize = \"100%\";\r\n\r\n    divClose.addEventListener(\"click\", function(){\r\n      _this.deactivate();\r\n    });\r\n\r\n    //Resize\r\n    //Resize\r\n    var lockedResize = 1;\r\n    var coordsResizeX = null;\r\n    var coordsResizeY = null;\r\n\r\n    var unlockResizeFunc = function unlockResize(coords){\r\n      lockedResize = 0;\r\n      coordsResizeX = coords.clientX;\r\n      coordsResizeY = coords.clientY;\r\n      if(coordsResizeX == null){\r\n        coordsResizeX = coords.touches[0].screenX;\r\n        coordsResizeY = coords.touches[0].screenY;\r\n      }\r\n    };\r\n    var lockFunc = function lock(){\r\n      lockedResize = 1;\r\n      locked = 1;\r\n    };\r\n    divResize.addEventListener(\"mousedown\", unlockResizeFunc);\r\n    divResize.addEventListener(\"touchstart\", unlockResizeFunc);\r\n    _this.map_.gf.map_.mb.addEventListener(\"mouseup\", lockFunc);\r\n    _this.map_.gf.map_.mb.addEventListener(\"mouseleave\", lockFunc);\r\n    \r\n    var moveResizeFunc = function(coord){\r\n      if(lockedResize == 0){\r\n        var newCoordX = coord.clientX;\r\n        var newCoordY = coord.clientY;\r\n        if(newCoordX == null){\r\n          newCoordX = coord.touches[0].screenX;\r\n          newCoordY = coord.touches[0].screenY;\r\n        }\r\n        var oldSizeX = _this.getSizeX();\r\n        var oldSizeY = _this.getSizeY();\r\n        _this.setSizeX(_this.getSizeX() + (newCoordX - coordsResizeX));\r\n        _this.setSizeY(_this.getSizeY() + (newCoordY - coordsResizeY));\r\n        if(_this.getSizeX() < 40) _this.setSizeX(40);\r\n        if(_this.getSizeY() < 40) _this.setSizeY(40);\r\n        if(_this.getPosX() + 2*parseInt(div.style.borderWidth)+_this.getSizeX() > _this.map_.gf.map_.mb.offsetWidth)\r\n          _this.setSizeX(_this.map_.gf.map_.mb.offsetWidth-_this.getPosX()-2*parseInt(div.style.borderWidth));\r\n        if(_this.getPosY() + 2*parseInt(div.style.borderWidth)+_this.getSizeY() > _this.map_.gf.map_.mb.offsetHeight)\r\n          _this.setSizeY(_this.map_.gf.map_.mb.offsetHeight-_this.getPosY()-2*parseInt(div.style.borderWidth));\r\n        if(oldSizeX < 50 && oldSizeY < 50){\r\n          if(_this.getSizeX() > oldSizeX && _this.getSizeY() > oldSizeY){\r\n            resizeBoth();\r\n          }else if(_this.getSizeX() > oldSizeX){\r\n            resizeX();\r\n            _this.setSizeY(oldSizeY);\r\n          } else if(_this.getSizeY() > oldSizeY){\r\n            resizeY();\r\n            _this.setSizeX(oldSizeX);\r\n          } else {\r\n            _this.setSizeX(oldSizeX);\r\n            _this.setSizeY(oldSizeY);\r\n          }\r\n        } else if(oldSizeX < 50){\r\n          resizeY();\r\n          if(oldSizeX < _this.getSizeX()){\r\n            resizeX();\r\n          } else {\r\n            _this.setSizeX(oldSizeX);\r\n          }\r\n        } else if(oldSizeY < 50){\r\n          resizeX();\r\n          if(oldSizeY < _this.getPosY()){\r\n            resizeY();\r\n          }else{\r\n            _this.setSizeY(oldSizeY);\r\n          }\r\n        } else {\r\n          resizeBoth();\r\n        }\r\n        _this.getImpl().updateZoom(secondmap, _this.map_);\r\n        var newCoordMap = _this.getImpl().coordinatesFromPixel(_this.map_, _this.getPosX()+parseInt(div.style.borderWidth)+(_this.getSizeX()/2), _this.getPosY()+parseInt(div.style.borderWidth)+(_this.getSizeY()/2));\r\n        secondmap.setCenter({\r\n          x: newCoordMap[0],\r\n          y: newCoordMap[1],\r\n          draw: false\r\n        });\r\n        _this.getImpl().updateSize(secondmap);\r\n      }\r\n\r\n      function resizeX(){\r\n        div.style.width = _this.getSizeX()+\"px\";\r\n        coordsResizeX = newCoordX;\r\n      }\r\n\r\n      function resizeY(){\r\n        div.style.height = _this.getSizeY()+\"px\";\r\n        coordsResizeY = newCoordY;\r\n      }\r\n\r\n      function resizeBoth(){\r\n        div.style.width = _this.getSizeX()+\"px\";\r\n        div.style.height = _this.getSizeY()+\"px\";\r\n        coordsResizeX = newCoordX;\r\n        coordsResizeY = newCoordY;\r\n      }\r\n    };\r\n\r\n    _this.map_.gf.map_.mb.addEventListener(\"mousemove\", moveResizeFunc);\r\n    _this.map_.gf.map_.mb.addEventListener(\"touchmove\", moveResizeFunc);\r\n    \r\n    //Movimiento del visor\r\n    var locked = 1;\r\n \r\n    var unlockMoveFunc = function(coord){\r\n      locked = 0;\r\n      if(coord.clientX != null){\r\n        relativeX = coord.clientX - _this.getPosX();\r\n        relativeY = coord.clientY - _this.getPosY();  \r\n      }else{\r\n        relativeX = coord.touches[0].screenX - _this.getPosX();\r\n        relativeY = coord.touches[0].screenY - _this.getPosY();    \r\n      }\r\n    };\r\n    div.addEventListener(\"mousedown\", unlockMoveFunc);\r\n    div.addEventListener(\"touchstart\", unlockMoveFunc);\r\n\r\n    div.addEventListener(\"mouseup\", lockFunc);\r\n    div.addEventListener(\"touchend\", lockFunc);\r\n    \r\n    var moveFunct = function(coord){\r\n      if(locked == 0 && lockedResize == 1){\r\n        mousePositionX = coord.clientX;\r\n        mousePositionY = coord.clientY;\r\n        if(mousePositionX == null){\r\n          mousePositionX = coord.touches[0].screenX;\r\n          mousePositionY = coord.touches[0].screenY;\r\n        }\r\n        _this.setPosX(mousePositionX - relativeX);\r\n        _this.setPosY(mousePositionY - relativeY);\r\n        if(_this.getPosX() < 0) _this.setPosX(0);\r\n        if(_this.getPosX()+_this.getSizeX()+2*parseInt(div.style.borderWidth) > _this.map_.gf.map_.mb.offsetWidth)\r\n          _this.setPosX(_this.map_.gf.map_.mb.offsetWidth - 2*parseInt(div.style.borderWidth) - _this.getSizeX());\r\n        if(_this.getPosY() < 0) _this.setPosY(0);\r\n        if(_this.getPosY()+_this.getSizeY()+2*parseInt(div.style.borderWidth) > _this.map_.gf.map_.mb.offsetHeight)\r\n          _this.setPosY(_this.map_.gf.map_.mb.offsetHeight - 2*parseInt(div.style.borderWidth) - _this.getSizeY());\r\n\r\n        div.style.top = _this.getPosY()+\"px\";\r\n        div.style.left = _this.getPosX()+\"px\";\r\n        _this.getImpl().updateZoom(secondmap, _this.map_);\r\n        var coordMap = _this.getImpl().coordinatesFromPixel(_this.map_, _this.getPosX()+_this.getSizeX()/2+parseInt(div.style.borderWidth), _this.getPosY()+_this.getSizeY()/2+parseInt(div.style.borderWidth));\r\n        secondmap.setCenter({\r\n          x: coordMap[0],\r\n          y: coordMap[1],\r\n          draw: false\r\n        });\r\n      }\r\n    };\r\n\r\n    div.addEventListener(\"mousemove\", moveFunct);\r\n    div.addEventListener(\"touchmove\", moveFunct);\r\n    _this.map_.gf.map_.mb.addEventListener(\"mousemove\", moveFunct);\r\n    _this.map_.gf.map_.mb.addEventListener(\"touchmove\", moveFunct);\r\n    \r\n    //Creacin del mapa del visor\r\n    this.map_.getContainer().appendChild(div);\r\n    var secondmap = M.map({\r\n      container:\"catastro\",\r\n      layer: []\r\n    });\r\n    secondmap.removeLayers(secondmap.getLayers());\r\n    secondmap.addWMS(new M.layer.WMS({\r\n      url: 'https://ovc.catastro.meh.es/Cartografia/WMS/ServidorWMS.aspx?',\r\n      name: 'Catastro',\r\n      tiled: false\r\n    }));\r\n    \r\n    //Actualizacin del visor cuando se mueve el mapa o se hace zoom\r\n    this.getImpl().interactionInMap(this, _this.map_, secondmap, div);\r\n\r\n    //Calendario\r\n    flatpickr(\"#input-date-catastro\", {\r\n      \"locale\": Spanish,\r\n      inline: true,\r\n      onChange: function(selectedDates, dateStr, instance){\r\n        secondmap.removeLayers(secondmap.getLayers());\r\n        secondmap.addWMS(new M.layer.WMS({\r\n          url: 'https://ovc.catastro.meh.es/Cartografia/WMS/ServidorWMS.aspx?TIME='+dateStr,\r\n          name: 'Catastro',\r\n          tiled: false\r\n        }));\r\n      },\r\n      //dateFormat: \"d.m.Y\",\r\n      minDate: \"2003-10-23\",\r\n      maxDate: \"today\"\r\n    });\r\n\r\n    //HTML\r\n    this.html_.querySelector(\"#div-visor-catastro\").style.display = \"block\";\r\n  \r\n    $(window).resize(function(){\r\n      setTimeout(function(){\r\n        _this.setSizeX(_this.map_.gf.map_.mb.offsetWidth/4);\r\n        _this.setSizeY(_this.map_.gf.map_.mb.offsetHeight/2);\r\n        _this.setPosX(_this.map_.gf.map_.mb.offsetWidth/4 - _this.getSizeX()/2);\r\n        _this.setPosY(_this.map_.gf.map_.mb.offsetHeight/2 - _this.getSizeY()/2);\r\n      \r\n        div.style.width = _this.getSizeX()+\"px\";\r\n        div.style.left = _this.getPosX()+\"px\";\r\n        div.style.height = _this.getSizeY()+\"px\";\r\n        div.style.top = _this.getPosY()+\"px\";\r\n\r\n        _this.getImpl().updateZoom(secondmap, _this.map_);\r\n        var coordMap = _this.getImpl().coordinatesFromPixel(_this.map_, _this.getPosX()+_this.getSizeX()/2+parseInt(div.style.borderWidth), _this.getPosY()+_this.getSizeY()/2+parseInt(div.style.borderWidth));\r\n        secondmap.setCenter({\r\n          x: coordMap[0],\r\n          y: coordMap[1],\r\n          draw: false\r\n        });\r\n      _this.getImpl().updateSize(secondmap);\r\n      }, 100);\r\n    });\r\n\r\n\r\n    secondmap.on(M.evt.COMPLETED, function(){\r\n      var oldCoord = _this.getImpl().coordinatesFromPixel(_this.map_, _this.getPosX()+_this.getSizeX()/2+parseInt(div.style.borderWidth), _this.getPosY()+_this.getSizeY()/2+parseInt(div.style.borderWidth));\r\n      secondmap.setResolutions(_this.map_.getResolutions());\r\n      _this.getImpl().updateZoom(secondmap, _this.map_);\r\n      secondmap.setCenter({x: oldCoord[0], y: oldCoord[1], draw: false});\r\n    });\r\n    this.smap_ = secondmap;\r\n\r\n    secondmap.getContainer().appendChild(divResize);\r\n    secondmap.getContainer().appendChild(divClose);\r\n\r\n    this.getImpl().noInteractions(secondmap); \r\n    //this.getImpl().activateClick(this.map_);\r\n    this.filters();\r\n\r\n  }\r\n\r\n  /**\r\n   * This function is called on the control deactivation\r\n   *\r\n   * @public\r\n   * @function\r\n   * @api stable\r\n   */\r\n  deactivate() {\r\n    super.deactivate(); //calls super to manage de/activation\r\n    let div = document.getElementById(\"catastro\");\r\n    this.map_.getContainer().removeChild(div);\r\n    var htmlSelect = this.html_.querySelector(\"#div-visor-catastro\");\r\n    htmlSelect.style.display = \"none\";\r\n    this.deactivateFilters();\r\n    //this.getImpl().deactivateClick(this.map_);\r\n  }\r\n   /**\r\n   * This function gets activation button\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {HTML} html of control\r\n   * @api stable\r\n   */\r\n  getActivationButton(html) {\r\n    return html.querySelector('.m-visor #ctrlCatastro');\r\n  };\r\n  \r\n  /**\r\n   * This function compares controls\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Control} control to compare\r\n   * @api stable\r\n   */\r\n  equals(control) {\r\n    return control instanceof catastroControl;\r\n  }\r\n\r\n  //** Add your own functions */\r\n  getPosX(){\r\n    return this.mainClass_.getPosX();\r\n  }\r\n  getPosY(){\r\n    return this.mainClass_.getPosY();\r\n  }\r\n  setPosX(posx){\r\n    this.mainClass_.setPosX(posx);\r\n  }\r\n  setPosY(posy){\r\n    this.mainClass_.setPosY(posy); \r\n  }\r\n\r\n  getSizeX(){\r\n    return this.mainClass_.getSizeX();\r\n  }\r\n  getSizeY(){\r\n    return this.mainClass_.getSizeY();\r\n  }\r\n  setSizeX(sizex){\r\n    this.mainClass_.setSizeX(sizex);\r\n  }\r\n  setSizeY(sizey){\r\n    this.mainClass_.setSizeY(sizey); \r\n  }\r\n\r\n  initControl(){\r\n    var _this = this;\r\n    $(_this.html_).find(\"#div-options-catastro\").toggle();\r\n    $(_this.html_).find(\"#options-title-catastro\").click(function(){\r\n      $(_this.html_).find(\"#div-options-catastro\").toggle();\r\n    });\r\n  }\r\n\r\n  filters(){\r\n    var _this = this;\r\n\r\n    var brightness = 100;\r\n    var invert = 0;\r\n    var contrast = 100;\r\n    \r\n    $(\"#div-catastro\").find(\"#div-options-catastro\").find(\"input\").on(\"input\", function(){\r\n      if($(\"#div-catastro\").find(\"#div-options-catastro\").find(\"#input-white\").prop(\"checked\")){\r\n        brightness = 0;\r\n        invert = 100;\r\n      }else{\r\n        brightness = 100;\r\n        invert = 0;\r\n      }\r\n      contrast = $(\"#div-catastro\").find(\"#div-options-catastro\").find(\"#input-enhance\").val();\r\n      $(_this.smap_.gf.map_.mb).find(\"canvas\").css(\"filter\", \"brightness(\"+brightness+\"%) invert(\"+invert+\"%) contrast(\"+contrast+\"%)\");\r\n    });\r\n\r\n  }\r\n\r\n  deactivateFilters(){\r\n    $(\"#div-catastro\").find(\"#div-options-catastro\").find(\"#input-white\").prop(\"checked\", false);\r\n    $(\"#div-catastro\").find(\"#div-options-catastro\").find(\"#input-enhance\").val(100);\r\n  }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./plugins/plg_cartografia_historica/src/facade/js/catastrocontrol.js","import namespace from 'mapea-util/decorator';\r\nimport $ from 'jquery';\r\n\r\n@namespace(\"M.impl.control\")\r\nexport class catastroControl extends M.impl.Control {\r\n  /**\r\n   * @classdesc\r\n   * Main constructor of the catastroControl.\r\n   *\r\n   * @constructor\r\n   * @extends {M.impl.Control}\r\n   * @api stable\r\n   */\r\n  constructor() {\r\n    super();\r\n  }\r\n  /**\r\n   * This function adds the control to the specified map\r\n   *\r\n   * @public\r\n   * @function\r\n   * @param {M.Map} map to add the plugin\r\n   * @param {HTMLElement} html of the plugin\r\n   * @api stable\r\n   */\r\n  addTo(map, html) {\r\n    // super addTo - don't delete\r\n    super.addTo(map, html);\r\n  }\r\n\r\n  noInteractions(map){\r\n    map.on(M.evt.COMPLETED, function(){\r\n      map.removeControls(map.getControls());\r\n      map.getMapImpl().getInteractions().forEach((i) => {\r\n          i.setActive(false);\r\n      });\r\n    });\r\n  }\r\n\r\n  coordinatesFromPixel(map, x, y){\r\n    return map.getMapImpl().getCoordinateFromPixel([x, y]);\r\n  }\r\n\r\n  updateSize(map){\r\n    map.getMapImpl().updateSize();\r\n  }\r\n\r\n  updateZoom(mapToChange, mapOrigin){\r\n    mapToChange.setZoom(mapOrigin.getZoom());\r\n    //mapToChange.getMapImpl().getView().setZoom(mapOrigin.getMapImpl().getView().getZoom());\r\n  }\r\n\r\n  interactionInMap(d, map, secondmap, div){\r\n    var _this = d;\r\n    var _thisClass = this;\r\n\r\n    map.getMapImpl().getView().on('propertychange', function(e) {\r\n      var coords = _thisClass.coordinatesFromPixel(map, _this.getPosX()+_this.getSizeX()/2+parseInt(div.style.borderWidth), _this.getPosY()+_this.getSizeY()/2+parseInt(div.style.borderWidth));\r\n      secondmap.setCenter({\r\n        x: coords[0],\r\n        y: coords[1],\r\n        draw: false\r\n      });\r\n      _thisClass.updateZoom(secondmap, map);\r\n      //secondmap.getMapImpl().getView().setZoom(_this.map_.getMapImpl().getView().getZoom());\r\n    });\r\n  }\r\n\r\n  fixZoom(map){\r\n    map.getMapImpl().getView().setZoom(Math.round(map.getMapImpl().getView().getZoom()));\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./plugins/plg_cartografia_historica/src/impl/ol/js/catastrocontrol.js","/* flatpickr v4.5.7, @license MIT */\n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    (global = global || self, global.flatpickr = factory());\n}(this, function () { 'use strict';\n\n    /*! *****************************************************************************\r\n    Copyright (c) Microsoft Corporation. All rights reserved.\r\n    Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\n    this file except in compliance with the License. You may obtain a copy of the\r\n    License at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\n    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\n    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\n    MERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\n    See the Apache Version 2.0 License for specific language governing permissions\r\n    and limitations under the License.\r\n    ***************************************************************************** */\r\n\r\n    var __assign = function() {\r\n        __assign = Object.assign || function __assign(t) {\r\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n                s = arguments[i];\r\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n            }\r\n            return t;\r\n        };\r\n        return __assign.apply(this, arguments);\r\n    };\n\n    var HOOKS = [\n        \"onChange\",\n        \"onClose\",\n        \"onDayCreate\",\n        \"onDestroy\",\n        \"onKeyDown\",\n        \"onMonthChange\",\n        \"onOpen\",\n        \"onParseConfig\",\n        \"onReady\",\n        \"onValueUpdate\",\n        \"onYearChange\",\n        \"onPreCalendarPosition\",\n    ];\n    var defaults = {\n        _disable: [],\n        _enable: [],\n        allowInput: false,\n        altFormat: \"F j, Y\",\n        altInput: false,\n        altInputClass: \"form-control input\",\n        animate: typeof window === \"object\" &&\n            window.navigator.userAgent.indexOf(\"MSIE\") === -1,\n        ariaDateFormat: \"F j, Y\",\n        clickOpens: true,\n        closeOnSelect: true,\n        conjunction: \", \",\n        dateFormat: \"Y-m-d\",\n        defaultHour: 12,\n        defaultMinute: 0,\n        defaultSeconds: 0,\n        disable: [],\n        disableMobile: false,\n        enable: [],\n        enableSeconds: false,\n        enableTime: false,\n        errorHandler: function (err) {\n            return typeof console !== \"undefined\" && console.warn(err);\n        },\n        getWeek: function (givenDate) {\n            var date = new Date(givenDate.getTime());\n            date.setHours(0, 0, 0, 0);\n            // Thursday in current week decides the year.\n            date.setDate(date.getDate() + 3 - ((date.getDay() + 6) % 7));\n            // January 4 is always in week 1.\n            var week1 = new Date(date.getFullYear(), 0, 4);\n            // Adjust to Thursday in week 1 and count number of weeks from date to week1.\n            return (1 +\n                Math.round(((date.getTime() - week1.getTime()) / 86400000 -\n                    3 +\n                    ((week1.getDay() + 6) % 7)) /\n                    7));\n        },\n        hourIncrement: 1,\n        ignoredFocusElements: [],\n        inline: false,\n        locale: \"default\",\n        minuteIncrement: 5,\n        mode: \"single\",\n        nextArrow: \"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M13.207 8.472l-7.854 7.854-0.707-0.707 7.146-7.146-7.146-7.148 0.707-0.707 7.854 7.854z' /></svg>\",\n        noCalendar: false,\n        now: new Date(),\n        onChange: [],\n        onClose: [],\n        onDayCreate: [],\n        onDestroy: [],\n        onKeyDown: [],\n        onMonthChange: [],\n        onOpen: [],\n        onParseConfig: [],\n        onReady: [],\n        onValueUpdate: [],\n        onYearChange: [],\n        onPreCalendarPosition: [],\n        plugins: [],\n        position: \"auto\",\n        positionElement: undefined,\n        prevArrow: \"<svg version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 17 17'><g></g><path d='M5.207 8.471l7.146 7.147-0.707 0.707-7.853-7.854 7.854-7.853 0.707 0.707-7.147 7.146z' /></svg>\",\n        shorthandCurrentMonth: false,\n        showMonths: 1,\n        static: false,\n        time_24hr: false,\n        weekNumbers: false,\n        wrap: false\n    };\n\n    var english = {\n        weekdays: {\n            shorthand: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n            longhand: [\n                \"Sunday\",\n                \"Monday\",\n                \"Tuesday\",\n                \"Wednesday\",\n                \"Thursday\",\n                \"Friday\",\n                \"Saturday\",\n            ]\n        },\n        months: {\n            shorthand: [\n                \"Jan\",\n                \"Feb\",\n                \"Mar\",\n                \"Apr\",\n                \"May\",\n                \"Jun\",\n                \"Jul\",\n                \"Aug\",\n                \"Sep\",\n                \"Oct\",\n                \"Nov\",\n                \"Dec\",\n            ],\n            longhand: [\n                \"January\",\n                \"February\",\n                \"March\",\n                \"April\",\n                \"May\",\n                \"June\",\n                \"July\",\n                \"August\",\n                \"September\",\n                \"October\",\n                \"November\",\n                \"December\",\n            ]\n        },\n        daysInMonth: [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31],\n        firstDayOfWeek: 0,\n        ordinal: function (nth) {\n            var s = nth % 100;\n            if (s > 3 && s < 21)\n                return \"th\";\n            switch (s % 10) {\n                case 1:\n                    return \"st\";\n                case 2:\n                    return \"nd\";\n                case 3:\n                    return \"rd\";\n                default:\n                    return \"th\";\n            }\n        },\n        rangeSeparator: \" to \",\n        weekAbbreviation: \"Wk\",\n        scrollTitle: \"Scroll to increment\",\n        toggleTitle: \"Click to toggle\",\n        amPM: [\"AM\", \"PM\"],\n        yearAriaLabel: \"Year\"\n    };\n\n    var pad = function (number) { return (\"0\" + number).slice(-2); };\n    var int = function (bool) { return (bool === true ? 1 : 0); };\n    /* istanbul ignore next */\n    function debounce(func, wait, immediate) {\n        if (immediate === void 0) { immediate = false; }\n        var timeout;\n        return function () {\n            var context = this, args = arguments;\n            timeout !== null && clearTimeout(timeout);\n            timeout = window.setTimeout(function () {\n                timeout = null;\n                if (!immediate)\n                    func.apply(context, args);\n            }, wait);\n            if (immediate && !timeout)\n                func.apply(context, args);\n        };\n    }\n    var arrayify = function (obj) {\n        return obj instanceof Array ? obj : [obj];\n    };\n\n    function toggleClass(elem, className, bool) {\n        if (bool === true)\n            return elem.classList.add(className);\n        elem.classList.remove(className);\n    }\n    function createElement(tag, className, content) {\n        var e = window.document.createElement(tag);\n        className = className || \"\";\n        content = content || \"\";\n        e.className = className;\n        if (content !== undefined)\n            e.textContent = content;\n        return e;\n    }\n    function clearNode(node) {\n        while (node.firstChild)\n            node.removeChild(node.firstChild);\n    }\n    function findParent(node, condition) {\n        if (condition(node))\n            return node;\n        else if (node.parentNode)\n            return findParent(node.parentNode, condition);\n        return undefined; // nothing found\n    }\n    function createNumberInput(inputClassName, opts) {\n        var wrapper = createElement(\"div\", \"numInputWrapper\"), numInput = createElement(\"input\", \"numInput \" + inputClassName), arrowUp = createElement(\"span\", \"arrowUp\"), arrowDown = createElement(\"span\", \"arrowDown\");\n        if (navigator.userAgent.indexOf(\"MSIE 9.0\") === -1) {\n            numInput.type = \"number\";\n        }\n        else {\n            numInput.type = \"text\";\n            numInput.pattern = \"\\\\d*\";\n        }\n        if (opts !== undefined)\n            for (var key in opts)\n                numInput.setAttribute(key, opts[key]);\n        wrapper.appendChild(numInput);\n        wrapper.appendChild(arrowUp);\n        wrapper.appendChild(arrowDown);\n        return wrapper;\n    }\n    function getEventTarget(event) {\n        if (typeof event.composedPath === \"function\") {\n            var path = event.composedPath();\n            return path[0];\n        }\n        return event.target;\n    }\n\n    var do_nothing = function () { return undefined; };\n    var monthToStr = function (monthNumber, shorthand, locale) { return locale.months[shorthand ? \"shorthand\" : \"longhand\"][monthNumber]; };\n    var revFormat = {\n        D: do_nothing,\n        F: function (dateObj, monthName, locale) {\n            dateObj.setMonth(locale.months.longhand.indexOf(monthName));\n        },\n        G: function (dateObj, hour) {\n            dateObj.setHours(parseFloat(hour));\n        },\n        H: function (dateObj, hour) {\n            dateObj.setHours(parseFloat(hour));\n        },\n        J: function (dateObj, day) {\n            dateObj.setDate(parseFloat(day));\n        },\n        K: function (dateObj, amPM, locale) {\n            dateObj.setHours((dateObj.getHours() % 12) +\n                12 * int(new RegExp(locale.amPM[1], \"i\").test(amPM)));\n        },\n        M: function (dateObj, shortMonth, locale) {\n            dateObj.setMonth(locale.months.shorthand.indexOf(shortMonth));\n        },\n        S: function (dateObj, seconds) {\n            dateObj.setSeconds(parseFloat(seconds));\n        },\n        U: function (_, unixSeconds) { return new Date(parseFloat(unixSeconds) * 1000); },\n        W: function (dateObj, weekNum) {\n            var weekNumber = parseInt(weekNum);\n            return new Date(dateObj.getFullYear(), 0, 2 + (weekNumber - 1) * 7, 0, 0, 0, 0);\n        },\n        Y: function (dateObj, year) {\n            dateObj.setFullYear(parseFloat(year));\n        },\n        Z: function (_, ISODate) { return new Date(ISODate); },\n        d: function (dateObj, day) {\n            dateObj.setDate(parseFloat(day));\n        },\n        h: function (dateObj, hour) {\n            dateObj.setHours(parseFloat(hour));\n        },\n        i: function (dateObj, minutes) {\n            dateObj.setMinutes(parseFloat(minutes));\n        },\n        j: function (dateObj, day) {\n            dateObj.setDate(parseFloat(day));\n        },\n        l: do_nothing,\n        m: function (dateObj, month) {\n            dateObj.setMonth(parseFloat(month) - 1);\n        },\n        n: function (dateObj, month) {\n            dateObj.setMonth(parseFloat(month) - 1);\n        },\n        s: function (dateObj, seconds) {\n            dateObj.setSeconds(parseFloat(seconds));\n        },\n        u: function (_, unixMillSeconds) {\n            return new Date(parseFloat(unixMillSeconds));\n        },\n        w: do_nothing,\n        y: function (dateObj, year) {\n            dateObj.setFullYear(2000 + parseFloat(year));\n        }\n    };\n    var tokenRegex = {\n        D: \"(\\\\w+)\",\n        F: \"(\\\\w+)\",\n        G: \"(\\\\d\\\\d|\\\\d)\",\n        H: \"(\\\\d\\\\d|\\\\d)\",\n        J: \"(\\\\d\\\\d|\\\\d)\\\\w+\",\n        K: \"\",\n        M: \"(\\\\w+)\",\n        S: \"(\\\\d\\\\d|\\\\d)\",\n        U: \"(.+)\",\n        W: \"(\\\\d\\\\d|\\\\d)\",\n        Y: \"(\\\\d{4})\",\n        Z: \"(.+)\",\n        d: \"(\\\\d\\\\d|\\\\d)\",\n        h: \"(\\\\d\\\\d|\\\\d)\",\n        i: \"(\\\\d\\\\d|\\\\d)\",\n        j: \"(\\\\d\\\\d|\\\\d)\",\n        l: \"(\\\\w+)\",\n        m: \"(\\\\d\\\\d|\\\\d)\",\n        n: \"(\\\\d\\\\d|\\\\d)\",\n        s: \"(\\\\d\\\\d|\\\\d)\",\n        u: \"(.+)\",\n        w: \"(\\\\d\\\\d|\\\\d)\",\n        y: \"(\\\\d{2})\"\n    };\n    var formats = {\n        // get the date in UTC\n        Z: function (date) { return date.toISOString(); },\n        // weekday name, short, e.g. Thu\n        D: function (date, locale, options) {\n            return locale.weekdays.shorthand[formats.w(date, locale, options)];\n        },\n        // full month name e.g. January\n        F: function (date, locale, options) {\n            return monthToStr(formats.n(date, locale, options) - 1, false, locale);\n        },\n        // padded hour 1-12\n        G: function (date, locale, options) {\n            return pad(formats.h(date, locale, options));\n        },\n        // hours with leading zero e.g. 03\n        H: function (date) { return pad(date.getHours()); },\n        // day (1-30) with ordinal suffix e.g. 1st, 2nd\n        J: function (date, locale) {\n            return locale.ordinal !== undefined\n                ? date.getDate() + locale.ordinal(date.getDate())\n                : date.getDate();\n        },\n        // AM/PM\n        K: function (date, locale) { return locale.amPM[int(date.getHours() > 11)]; },\n        // shorthand month e.g. Jan, Sep, Oct, etc\n        M: function (date, locale) {\n            return monthToStr(date.getMonth(), true, locale);\n        },\n        // seconds 00-59\n        S: function (date) { return pad(date.getSeconds()); },\n        // unix timestamp\n        U: function (date) { return date.getTime() / 1000; },\n        W: function (date, _, options) {\n            return options.getWeek(date);\n        },\n        // full year e.g. 2016\n        Y: function (date) { return date.getFullYear(); },\n        // day in month, padded (01-30)\n        d: function (date) { return pad(date.getDate()); },\n        // hour from 1-12 (am/pm)\n        h: function (date) { return (date.getHours() % 12 ? date.getHours() % 12 : 12); },\n        // minutes, padded with leading zero e.g. 09\n        i: function (date) { return pad(date.getMinutes()); },\n        // day in month (1-30)\n        j: function (date) { return date.getDate(); },\n        // weekday name, full, e.g. Thursday\n        l: function (date, locale) {\n            return locale.weekdays.longhand[date.getDay()];\n        },\n        // padded month number (01-12)\n        m: function (date) { return pad(date.getMonth() + 1); },\n        // the month number (1-12)\n        n: function (date) { return date.getMonth() + 1; },\n        // seconds 0-59\n        s: function (date) { return date.getSeconds(); },\n        // Unix Milliseconds\n        u: function (date) { return date.getTime(); },\n        // number of the day of the week\n        w: function (date) { return date.getDay(); },\n        // last two digits of year e.g. 16 for 2016\n        y: function (date) { return String(date.getFullYear()).substring(2); }\n    };\n\n    var createDateFormatter = function (_a) {\n        var _b = _a.config, config = _b === void 0 ? defaults : _b, _c = _a.l10n, l10n = _c === void 0 ? english : _c;\n        return function (dateObj, frmt, overrideLocale) {\n            var locale = overrideLocale || l10n;\n            if (config.formatDate !== undefined) {\n                return config.formatDate(dateObj, frmt, locale);\n            }\n            return frmt\n                .split(\"\")\n                .map(function (c, i, arr) {\n                return formats[c] && arr[i - 1] !== \"\\\\\"\n                    ? formats[c](dateObj, locale, config)\n                    : c !== \"\\\\\"\n                        ? c\n                        : \"\";\n            })\n                .join(\"\");\n        };\n    };\n    var createDateParser = function (_a) {\n        var _b = _a.config, config = _b === void 0 ? defaults : _b, _c = _a.l10n, l10n = _c === void 0 ? english : _c;\n        return function (date, givenFormat, timeless, customLocale) {\n            if (date !== 0 && !date)\n                return undefined;\n            var locale = customLocale || l10n;\n            var parsedDate;\n            var date_orig = date;\n            if (date instanceof Date)\n                parsedDate = new Date(date.getTime());\n            else if (typeof date !== \"string\" &&\n                date.toFixed !== undefined // timestamp\n            )\n                // create a copy\n                parsedDate = new Date(date);\n            else if (typeof date === \"string\") {\n                // date string\n                var format = givenFormat || (config || defaults).dateFormat;\n                var datestr = String(date).trim();\n                if (datestr === \"today\") {\n                    parsedDate = new Date();\n                    timeless = true;\n                }\n                else if (/Z$/.test(datestr) ||\n                    /GMT$/.test(datestr) // datestrings w/ timezone\n                )\n                    parsedDate = new Date(date);\n                else if (config && config.parseDate)\n                    parsedDate = config.parseDate(date, format);\n                else {\n                    parsedDate =\n                        !config || !config.noCalendar\n                            ? new Date(new Date().getFullYear(), 0, 1, 0, 0, 0, 0)\n                            : new Date(new Date().setHours(0, 0, 0, 0));\n                    var matched = void 0, ops = [];\n                    for (var i = 0, matchIndex = 0, regexStr = \"\"; i < format.length; i++) {\n                        var token_1 = format[i];\n                        var isBackSlash = token_1 === \"\\\\\";\n                        var escaped = format[i - 1] === \"\\\\\" || isBackSlash;\n                        if (tokenRegex[token_1] && !escaped) {\n                            regexStr += tokenRegex[token_1];\n                            var match = new RegExp(regexStr).exec(date);\n                            if (match && (matched = true)) {\n                                ops[token_1 !== \"Y\" ? \"push\" : \"unshift\"]({\n                                    fn: revFormat[token_1],\n                                    val: match[++matchIndex]\n                                });\n                            }\n                        }\n                        else if (!isBackSlash)\n                            regexStr += \".\"; // don't really care\n                        ops.forEach(function (_a) {\n                            var fn = _a.fn, val = _a.val;\n                            return (parsedDate = fn(parsedDate, val, locale) || parsedDate);\n                        });\n                    }\n                    parsedDate = matched ? parsedDate : undefined;\n                }\n            }\n            /* istanbul ignore next */\n            if (!(parsedDate instanceof Date && !isNaN(parsedDate.getTime()))) {\n                config.errorHandler(new Error(\"Invalid date provided: \" + date_orig));\n                return undefined;\n            }\n            if (timeless === true)\n                parsedDate.setHours(0, 0, 0, 0);\n            return parsedDate;\n        };\n    };\n    /**\n     * Compute the difference in dates, measured in ms\n     */\n    function compareDates(date1, date2, timeless) {\n        if (timeless === void 0) { timeless = true; }\n        if (timeless !== false) {\n            return (new Date(date1.getTime()).setHours(0, 0, 0, 0) -\n                new Date(date2.getTime()).setHours(0, 0, 0, 0));\n        }\n        return date1.getTime() - date2.getTime();\n    }\n    var isBetween = function (ts, ts1, ts2) {\n        return ts > Math.min(ts1, ts2) && ts < Math.max(ts1, ts2);\n    };\n    var duration = {\n        DAY: 86400000\n    };\n\n    if (typeof Object.assign !== \"function\") {\n        Object.assign = function (target) {\n            var args = [];\n            for (var _i = 1; _i < arguments.length; _i++) {\n                args[_i - 1] = arguments[_i];\n            }\n            if (!target) {\n                throw TypeError(\"Cannot convert undefined or null to object\");\n            }\n            var _loop_1 = function (source) {\n                if (source) {\n                    Object.keys(source).forEach(function (key) { return (target[key] = source[key]); });\n                }\n            };\n            for (var _a = 0, args_1 = args; _a < args_1.length; _a++) {\n                var source = args_1[_a];\n                _loop_1(source);\n            }\n            return target;\n        };\n    }\n\n    var DEBOUNCED_CHANGE_MS = 300;\n    function FlatpickrInstance(element, instanceConfig) {\n        var self = {\n            config: __assign({}, flatpickr.defaultConfig),\n            l10n: english\n        };\n        self.parseDate = createDateParser({ config: self.config, l10n: self.l10n });\n        self._handlers = [];\n        self._bind = bind;\n        self._setHoursFromDate = setHoursFromDate;\n        self._positionCalendar = positionCalendar;\n        self.changeMonth = changeMonth;\n        self.changeYear = changeYear;\n        self.clear = clear;\n        self.close = close;\n        self._createElement = createElement;\n        self.destroy = destroy;\n        self.isEnabled = isEnabled;\n        self.jumpToDate = jumpToDate;\n        self.open = open;\n        self.redraw = redraw;\n        self.set = set;\n        self.setDate = setDate;\n        self.toggle = toggle;\n        function setupHelperFunctions() {\n            self.utils = {\n                getDaysInMonth: function (month, yr) {\n                    if (month === void 0) { month = self.currentMonth; }\n                    if (yr === void 0) { yr = self.currentYear; }\n                    if (month === 1 && ((yr % 4 === 0 && yr % 100 !== 0) || yr % 400 === 0))\n                        return 29;\n                    return self.l10n.daysInMonth[month];\n                }\n            };\n        }\n        function init() {\n            self.element = self.input = element;\n            self.isOpen = false;\n            parseConfig();\n            setupLocale();\n            setupInputs();\n            setupDates();\n            setupHelperFunctions();\n            if (!self.isMobile)\n                build();\n            bindEvents();\n            if (self.selectedDates.length || self.config.noCalendar) {\n                if (self.config.enableTime) {\n                    setHoursFromDate(self.config.noCalendar\n                        ? self.latestSelectedDateObj || self.config.minDate\n                        : undefined);\n                }\n                updateValue(false);\n            }\n            setCalendarWidth();\n            self.showTimeInput =\n                self.selectedDates.length > 0 || self.config.noCalendar;\n            var isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n            /* TODO: investigate this further\n        \n              Currently, there is weird positioning behavior in safari causing pages\n              to scroll up. https://github.com/chmln/flatpickr/issues/563\n        \n              However, most browsers are not Safari and positioning is expensive when used\n              in scale. https://github.com/chmln/flatpickr/issues/1096\n            */\n            if (!self.isMobile && isSafari) {\n                positionCalendar();\n            }\n            triggerEvent(\"onReady\");\n        }\n        function bindToInstance(fn) {\n            return fn.bind(self);\n        }\n        function setCalendarWidth() {\n            var config = self.config;\n            if (config.weekNumbers === false && config.showMonths === 1)\n                return;\n            else if (config.noCalendar !== true) {\n                window.requestAnimationFrame(function () {\n                    if (self.calendarContainer !== undefined) {\n                        self.calendarContainer.style.visibility = \"hidden\";\n                        self.calendarContainer.style.display = \"block\";\n                    }\n                    if (self.daysContainer !== undefined) {\n                        var daysWidth = (self.days.offsetWidth + 1) * config.showMonths;\n                        self.daysContainer.style.width = daysWidth + \"px\";\n                        self.calendarContainer.style.width =\n                            daysWidth +\n                                (self.weekWrapper !== undefined\n                                    ? self.weekWrapper.offsetWidth\n                                    : 0) +\n                                \"px\";\n                        self.calendarContainer.style.removeProperty(\"visibility\");\n                        self.calendarContainer.style.removeProperty(\"display\");\n                    }\n                });\n            }\n        }\n        /**\n         * The handler for all events targeting the time inputs\n         */\n        function updateTime(e) {\n            if (self.selectedDates.length === 0) {\n                setDefaultTime();\n            }\n            if (e !== undefined && e.type !== \"blur\") {\n                timeWrapper(e);\n            }\n            var prevValue = self._input.value;\n            setHoursFromInputs();\n            updateValue();\n            if (self._input.value !== prevValue) {\n                self._debouncedChange();\n            }\n        }\n        function ampm2military(hour, amPM) {\n            return (hour % 12) + 12 * int(amPM === self.l10n.amPM[1]);\n        }\n        function military2ampm(hour) {\n            switch (hour % 24) {\n                case 0:\n                case 12:\n                    return 12;\n                default:\n                    return hour % 12;\n            }\n        }\n        /**\n         * Syncs the selected date object time with user's time input\n         */\n        function setHoursFromInputs() {\n            if (self.hourElement === undefined || self.minuteElement === undefined)\n                return;\n            var hours = (parseInt(self.hourElement.value.slice(-2), 10) || 0) % 24, minutes = (parseInt(self.minuteElement.value, 10) || 0) % 60, seconds = self.secondElement !== undefined\n                ? (parseInt(self.secondElement.value, 10) || 0) % 60\n                : 0;\n            if (self.amPM !== undefined) {\n                hours = ampm2military(hours, self.amPM.textContent);\n            }\n            var limitMinHours = self.config.minTime !== undefined ||\n                (self.config.minDate &&\n                    self.minDateHasTime &&\n                    self.latestSelectedDateObj &&\n                    compareDates(self.latestSelectedDateObj, self.config.minDate, true) ===\n                        0);\n            var limitMaxHours = self.config.maxTime !== undefined ||\n                (self.config.maxDate &&\n                    self.maxDateHasTime &&\n                    self.latestSelectedDateObj &&\n                    compareDates(self.latestSelectedDateObj, self.config.maxDate, true) ===\n                        0);\n            if (limitMaxHours) {\n                var maxTime = self.config.maxTime !== undefined\n                    ? self.config.maxTime\n                    : self.config.maxDate;\n                hours = Math.min(hours, maxTime.getHours());\n                if (hours === maxTime.getHours())\n                    minutes = Math.min(minutes, maxTime.getMinutes());\n                if (minutes === maxTime.getMinutes())\n                    seconds = Math.min(seconds, maxTime.getSeconds());\n            }\n            if (limitMinHours) {\n                var minTime = self.config.minTime !== undefined\n                    ? self.config.minTime\n                    : self.config.minDate;\n                hours = Math.max(hours, minTime.getHours());\n                if (hours === minTime.getHours())\n                    minutes = Math.max(minutes, minTime.getMinutes());\n                if (minutes === minTime.getMinutes())\n                    seconds = Math.max(seconds, minTime.getSeconds());\n            }\n            setHours(hours, minutes, seconds);\n        }\n        /**\n         * Syncs time input values with a date\n         */\n        function setHoursFromDate(dateObj) {\n            var date = dateObj || self.latestSelectedDateObj;\n            if (date)\n                setHours(date.getHours(), date.getMinutes(), date.getSeconds());\n        }\n        function setDefaultHours() {\n            var hours = self.config.defaultHour;\n            var minutes = self.config.defaultMinute;\n            var seconds = self.config.defaultSeconds;\n            if (self.config.minDate !== undefined) {\n                var min_hr = self.config.minDate.getHours();\n                var min_minutes = self.config.minDate.getMinutes();\n                hours = Math.max(hours, min_hr);\n                if (hours === min_hr)\n                    minutes = Math.max(min_minutes, minutes);\n                if (hours === min_hr && minutes === min_minutes)\n                    seconds = self.config.minDate.getSeconds();\n            }\n            if (self.config.maxDate !== undefined) {\n                var max_hr = self.config.maxDate.getHours();\n                var max_minutes = self.config.maxDate.getMinutes();\n                hours = Math.min(hours, max_hr);\n                if (hours === max_hr)\n                    minutes = Math.min(max_minutes, minutes);\n                if (hours === max_hr && minutes === max_minutes)\n                    seconds = self.config.maxDate.getSeconds();\n            }\n            setHours(hours, minutes, seconds);\n        }\n        /**\n         * Sets the hours, minutes, and optionally seconds\n         * of the latest selected date object and the\n         * corresponding time inputs\n         * @param {Number} hours the hour. whether its military\n         *                 or am-pm gets inferred from config\n         * @param {Number} minutes the minutes\n         * @param {Number} seconds the seconds (optional)\n         */\n        function setHours(hours, minutes, seconds) {\n            if (self.latestSelectedDateObj !== undefined) {\n                self.latestSelectedDateObj.setHours(hours % 24, minutes, seconds || 0, 0);\n            }\n            if (!self.hourElement || !self.minuteElement || self.isMobile)\n                return;\n            self.hourElement.value = pad(!self.config.time_24hr\n                ? ((12 + hours) % 12) + 12 * int(hours % 12 === 0)\n                : hours);\n            self.minuteElement.value = pad(minutes);\n            if (self.amPM !== undefined)\n                self.amPM.textContent = self.l10n.amPM[int(hours >= 12)];\n            if (self.secondElement !== undefined)\n                self.secondElement.value = pad(seconds);\n        }\n        /**\n         * Handles the year input and incrementing events\n         * @param {Event} event the keyup or increment event\n         */\n        function onYearInput(event) {\n            var year = parseInt(event.target.value) + (event.delta || 0);\n            if (year / 1000 > 1 ||\n                (event.key === \"Enter\" && !/[^\\d]/.test(year.toString()))) {\n                changeYear(year);\n            }\n        }\n        /**\n         * Essentially addEventListener + tracking\n         * @param {Element} element the element to addEventListener to\n         * @param {String} event the event name\n         * @param {Function} handler the event handler\n         */\n        function bind(element, event, handler, options) {\n            if (event instanceof Array)\n                return event.forEach(function (ev) { return bind(element, ev, handler, options); });\n            if (element instanceof Array)\n                return element.forEach(function (el) { return bind(el, event, handler, options); });\n            element.addEventListener(event, handler, options);\n            self._handlers.push({\n                element: element,\n                event: event,\n                handler: handler,\n                options: options\n            });\n        }\n        /**\n         * A mousedown handler which mimics click.\n         * Minimizes latency, since we don't need to wait for mouseup in most cases.\n         * Also, avoids handling right clicks.\n         *\n         * @param {Function} handler the event handler\n         */\n        function onClick(handler) {\n            return function (evt) {\n                evt.which === 1 && handler(evt);\n            };\n        }\n        function triggerChange() {\n            triggerEvent(\"onChange\");\n        }\n        /**\n         * Adds all the necessary event listeners\n         */\n        function bindEvents() {\n            if (self.config.wrap) {\n                [\"open\", \"close\", \"toggle\", \"clear\"].forEach(function (evt) {\n                    Array.prototype.forEach.call(self.element.querySelectorAll(\"[data-\" + evt + \"]\"), function (el) {\n                        return bind(el, \"click\", self[evt]);\n                    });\n                });\n            }\n            if (self.isMobile) {\n                setupMobile();\n                return;\n            }\n            var debouncedResize = debounce(onResize, 50);\n            self._debouncedChange = debounce(triggerChange, DEBOUNCED_CHANGE_MS);\n            if (self.daysContainer && !/iPhone|iPad|iPod/i.test(navigator.userAgent))\n                bind(self.daysContainer, \"mouseover\", function (e) {\n                    if (self.config.mode === \"range\")\n                        onMouseOver(e.target);\n                });\n            bind(window.document.body, \"keydown\", onKeyDown);\n            if (!self.config.static)\n                bind(self._input, \"keydown\", onKeyDown);\n            if (!self.config.inline && !self.config.static)\n                bind(window, \"resize\", debouncedResize);\n            if (window.ontouchstart !== undefined)\n                bind(window.document, \"click\", documentClick);\n            else\n                bind(window.document, \"mousedown\", onClick(documentClick));\n            bind(window.document, \"focus\", documentClick, { capture: true });\n            if (self.config.clickOpens === true) {\n                bind(self._input, \"focus\", self.open);\n                bind(self._input, \"mousedown\", onClick(self.open));\n            }\n            if (self.daysContainer !== undefined) {\n                bind(self.monthNav, \"mousedown\", onClick(onMonthNavClick));\n                bind(self.monthNav, [\"keyup\", \"increment\"], onYearInput);\n                bind(self.daysContainer, \"mousedown\", onClick(selectDate));\n            }\n            if (self.timeContainer !== undefined &&\n                self.minuteElement !== undefined &&\n                self.hourElement !== undefined) {\n                var selText = function (e) {\n                    return e.target.select();\n                };\n                bind(self.timeContainer, [\"increment\"], updateTime);\n                bind(self.timeContainer, \"blur\", updateTime, { capture: true });\n                bind(self.timeContainer, \"mousedown\", onClick(timeIncrement));\n                bind([self.hourElement, self.minuteElement], [\"focus\", \"click\"], selText);\n                if (self.secondElement !== undefined)\n                    bind(self.secondElement, \"focus\", function () { return self.secondElement && self.secondElement.select(); });\n                if (self.amPM !== undefined) {\n                    bind(self.amPM, \"mousedown\", onClick(function (e) {\n                        updateTime(e);\n                        triggerChange();\n                    }));\n                }\n            }\n        }\n        /**\n         * Set the calendar view to a particular date.\n         * @param {Date} jumpDate the date to set the view to\n         */\n        function jumpToDate(jumpDate) {\n            var jumpTo = jumpDate !== undefined\n                ? self.parseDate(jumpDate)\n                : self.latestSelectedDateObj ||\n                    (self.config.minDate && self.config.minDate > self.now\n                        ? self.config.minDate\n                        : self.config.maxDate && self.config.maxDate < self.now\n                            ? self.config.maxDate\n                            : self.now);\n            try {\n                if (jumpTo !== undefined) {\n                    self.currentYear = jumpTo.getFullYear();\n                    self.currentMonth = jumpTo.getMonth();\n                }\n            }\n            catch (e) {\n                /* istanbul ignore next */\n                e.message = \"Invalid date supplied: \" + jumpTo;\n                self.config.errorHandler(e);\n            }\n            self.redraw();\n        }\n        /**\n         * The up/down arrow handler for time inputs\n         * @param {Event} e the click event\n         */\n        function timeIncrement(e) {\n            if (~e.target.className.indexOf(\"arrow\"))\n                incrementNumInput(e, e.target.classList.contains(\"arrowUp\") ? 1 : -1);\n        }\n        /**\n         * Increments/decrements the value of input associ-\n         * ated with the up/down arrow by dispatching an\n         * \"increment\" event on the input.\n         *\n         * @param {Event} e the click event\n         * @param {Number} delta the diff (usually 1 or -1)\n         * @param {Element} inputElem the input element\n         */\n        function incrementNumInput(e, delta, inputElem) {\n            var target = e && e.target;\n            var input = inputElem ||\n                (target && target.parentNode && target.parentNode.firstChild);\n            var event = createEvent(\"increment\");\n            event.delta = delta;\n            input && input.dispatchEvent(event);\n        }\n        function build() {\n            var fragment = window.document.createDocumentFragment();\n            self.calendarContainer = createElement(\"div\", \"flatpickr-calendar\");\n            self.calendarContainer.tabIndex = -1;\n            if (!self.config.noCalendar) {\n                fragment.appendChild(buildMonthNav());\n                self.innerContainer = createElement(\"div\", \"flatpickr-innerContainer\");\n                if (self.config.weekNumbers) {\n                    var _a = buildWeeks(), weekWrapper = _a.weekWrapper, weekNumbers = _a.weekNumbers;\n                    self.innerContainer.appendChild(weekWrapper);\n                    self.weekNumbers = weekNumbers;\n                    self.weekWrapper = weekWrapper;\n                }\n                self.rContainer = createElement(\"div\", \"flatpickr-rContainer\");\n                self.rContainer.appendChild(buildWeekdays());\n                if (!self.daysContainer) {\n                    self.daysContainer = createElement(\"div\", \"flatpickr-days\");\n                    self.daysContainer.tabIndex = -1;\n                }\n                buildDays();\n                self.rContainer.appendChild(self.daysContainer);\n                self.innerContainer.appendChild(self.rContainer);\n                fragment.appendChild(self.innerContainer);\n            }\n            if (self.config.enableTime) {\n                fragment.appendChild(buildTime());\n            }\n            toggleClass(self.calendarContainer, \"rangeMode\", self.config.mode === \"range\");\n            toggleClass(self.calendarContainer, \"animate\", self.config.animate === true);\n            toggleClass(self.calendarContainer, \"multiMonth\", self.config.showMonths > 1);\n            self.calendarContainer.appendChild(fragment);\n            var customAppend = self.config.appendTo !== undefined &&\n                self.config.appendTo.nodeType !== undefined;\n            if (self.config.inline || self.config.static) {\n                self.calendarContainer.classList.add(self.config.inline ? \"inline\" : \"static\");\n                if (self.config.inline) {\n                    if (!customAppend && self.element.parentNode)\n                        self.element.parentNode.insertBefore(self.calendarContainer, self._input.nextSibling);\n                    else if (self.config.appendTo !== undefined)\n                        self.config.appendTo.appendChild(self.calendarContainer);\n                }\n                if (self.config.static) {\n                    var wrapper = createElement(\"div\", \"flatpickr-wrapper\");\n                    if (self.element.parentNode)\n                        self.element.parentNode.insertBefore(wrapper, self.element);\n                    wrapper.appendChild(self.element);\n                    if (self.altInput)\n                        wrapper.appendChild(self.altInput);\n                    wrapper.appendChild(self.calendarContainer);\n                }\n            }\n            if (!self.config.static && !self.config.inline)\n                (self.config.appendTo !== undefined\n                    ? self.config.appendTo\n                    : window.document.body).appendChild(self.calendarContainer);\n        }\n        function createDay(className, date, dayNumber, i) {\n            var dateIsEnabled = isEnabled(date, true), dayElement = createElement(\"span\", \"flatpickr-day \" + className, date.getDate().toString());\n            dayElement.dateObj = date;\n            dayElement.$i = i;\n            dayElement.setAttribute(\"aria-label\", self.formatDate(date, self.config.ariaDateFormat));\n            if (className.indexOf(\"hidden\") === -1 &&\n                compareDates(date, self.now) === 0) {\n                self.todayDateElem = dayElement;\n                dayElement.classList.add(\"today\");\n                dayElement.setAttribute(\"aria-current\", \"date\");\n            }\n            if (dateIsEnabled) {\n                dayElement.tabIndex = -1;\n                if (isDateSelected(date)) {\n                    dayElement.classList.add(\"selected\");\n                    self.selectedDateElem = dayElement;\n                    if (self.config.mode === \"range\") {\n                        toggleClass(dayElement, \"startRange\", self.selectedDates[0] &&\n                            compareDates(date, self.selectedDates[0], true) === 0);\n                        toggleClass(dayElement, \"endRange\", self.selectedDates[1] &&\n                            compareDates(date, self.selectedDates[1], true) === 0);\n                        if (className === \"nextMonthDay\")\n                            dayElement.classList.add(\"inRange\");\n                    }\n                }\n            }\n            else {\n                dayElement.classList.add(\"disabled\");\n            }\n            if (self.config.mode === \"range\") {\n                if (isDateInRange(date) && !isDateSelected(date))\n                    dayElement.classList.add(\"inRange\");\n            }\n            if (self.weekNumbers &&\n                self.config.showMonths === 1 &&\n                className !== \"prevMonthDay\" &&\n                dayNumber % 7 === 1) {\n                self.weekNumbers.insertAdjacentHTML(\"beforeend\", \"<span class='flatpickr-day'>\" + self.config.getWeek(date) + \"</span>\");\n            }\n            triggerEvent(\"onDayCreate\", dayElement);\n            return dayElement;\n        }\n        function focusOnDayElem(targetNode) {\n            targetNode.focus();\n            if (self.config.mode === \"range\")\n                onMouseOver(targetNode);\n        }\n        function getFirstAvailableDay(delta) {\n            var startMonth = delta > 0 ? 0 : self.config.showMonths - 1;\n            var endMonth = delta > 0 ? self.config.showMonths : -1;\n            for (var m = startMonth; m != endMonth; m += delta) {\n                var month = self.daysContainer.children[m];\n                var startIndex = delta > 0 ? 0 : month.children.length - 1;\n                var endIndex = delta > 0 ? month.children.length : -1;\n                for (var i = startIndex; i != endIndex; i += delta) {\n                    var c = month.children[i];\n                    if (c.className.indexOf(\"hidden\") === -1 && isEnabled(c.dateObj))\n                        return c;\n                }\n            }\n            return undefined;\n        }\n        function getNextAvailableDay(current, delta) {\n            var givenMonth = current.className.indexOf(\"Month\") === -1\n                ? current.dateObj.getMonth()\n                : self.currentMonth;\n            var endMonth = delta > 0 ? self.config.showMonths : -1;\n            var loopDelta = delta > 0 ? 1 : -1;\n            for (var m = givenMonth - self.currentMonth; m != endMonth; m += loopDelta) {\n                var month = self.daysContainer.children[m];\n                var startIndex = givenMonth - self.currentMonth === m\n                    ? current.$i + delta\n                    : delta < 0\n                        ? month.children.length - 1\n                        : 0;\n                var numMonthDays = month.children.length;\n                for (var i = startIndex; i >= 0 && i < numMonthDays && i != (delta > 0 ? numMonthDays : -1); i += loopDelta) {\n                    var c = month.children[i];\n                    if (c.className.indexOf(\"hidden\") === -1 &&\n                        isEnabled(c.dateObj) &&\n                        Math.abs(current.$i - i) >= Math.abs(delta))\n                        return focusOnDayElem(c);\n                }\n            }\n            self.changeMonth(loopDelta);\n            focusOnDay(getFirstAvailableDay(loopDelta), 0);\n            return undefined;\n        }\n        function focusOnDay(current, offset) {\n            var dayFocused = isInView(document.activeElement || document.body);\n            var startElem = current !== undefined\n                ? current\n                : dayFocused\n                    ? document.activeElement\n                    : self.selectedDateElem !== undefined && isInView(self.selectedDateElem)\n                        ? self.selectedDateElem\n                        : self.todayDateElem !== undefined && isInView(self.todayDateElem)\n                            ? self.todayDateElem\n                            : getFirstAvailableDay(offset > 0 ? 1 : -1);\n            if (startElem === undefined)\n                return self._input.focus();\n            if (!dayFocused)\n                return focusOnDayElem(startElem);\n            getNextAvailableDay(startElem, offset);\n        }\n        function buildMonthDays(year, month) {\n            var firstOfMonth = (new Date(year, month, 1).getDay() - self.l10n.firstDayOfWeek + 7) % 7;\n            var prevMonthDays = self.utils.getDaysInMonth((month - 1 + 12) % 12);\n            var daysInMonth = self.utils.getDaysInMonth(month), days = window.document.createDocumentFragment(), isMultiMonth = self.config.showMonths > 1, prevMonthDayClass = isMultiMonth ? \"prevMonthDay hidden\" : \"prevMonthDay\", nextMonthDayClass = isMultiMonth ? \"nextMonthDay hidden\" : \"nextMonthDay\";\n            var dayNumber = prevMonthDays + 1 - firstOfMonth, dayIndex = 0;\n            // prepend days from the ending of previous month\n            for (; dayNumber <= prevMonthDays; dayNumber++, dayIndex++) {\n                days.appendChild(createDay(prevMonthDayClass, new Date(year, month - 1, dayNumber), dayNumber, dayIndex));\n            }\n            // Start at 1 since there is no 0th day\n            for (dayNumber = 1; dayNumber <= daysInMonth; dayNumber++, dayIndex++) {\n                days.appendChild(createDay(\"\", new Date(year, month, dayNumber), dayNumber, dayIndex));\n            }\n            // append days from the next month\n            for (var dayNum = daysInMonth + 1; dayNum <= 42 - firstOfMonth &&\n                (self.config.showMonths === 1 || dayIndex % 7 !== 0); dayNum++, dayIndex++) {\n                days.appendChild(createDay(nextMonthDayClass, new Date(year, month + 1, dayNum % daysInMonth), dayNum, dayIndex));\n            }\n            //updateNavigationCurrentMonth();\n            var dayContainer = createElement(\"div\", \"dayContainer\");\n            dayContainer.appendChild(days);\n            return dayContainer;\n        }\n        function buildDays() {\n            if (self.daysContainer === undefined) {\n                return;\n            }\n            clearNode(self.daysContainer);\n            // TODO: week numbers for each month\n            if (self.weekNumbers)\n                clearNode(self.weekNumbers);\n            var frag = document.createDocumentFragment();\n            for (var i = 0; i < self.config.showMonths; i++) {\n                var d = new Date(self.currentYear, self.currentMonth, 1);\n                d.setMonth(self.currentMonth + i);\n                frag.appendChild(buildMonthDays(d.getFullYear(), d.getMonth()));\n            }\n            self.daysContainer.appendChild(frag);\n            self.days = self.daysContainer.firstChild;\n            if (self.config.mode === \"range\" && self.selectedDates.length === 1) {\n                onMouseOver();\n            }\n        }\n        function buildMonth() {\n            var container = createElement(\"div\", \"flatpickr-month\");\n            var monthNavFragment = window.document.createDocumentFragment();\n            var monthElement = createElement(\"span\", \"cur-month\");\n            var yearInput = createNumberInput(\"cur-year\", { tabindex: \"-1\" });\n            var yearElement = yearInput.getElementsByTagName(\"input\")[0];\n            yearElement.setAttribute(\"aria-label\", self.l10n.yearAriaLabel);\n            if (self.config.minDate) {\n                yearElement.setAttribute(\"min\", self.config.minDate.getFullYear().toString());\n            }\n            if (self.config.maxDate) {\n                yearElement.setAttribute(\"max\", self.config.maxDate.getFullYear().toString());\n                yearElement.disabled =\n                    !!self.config.minDate &&\n                        self.config.minDate.getFullYear() === self.config.maxDate.getFullYear();\n            }\n            var currentMonth = createElement(\"div\", \"flatpickr-current-month\");\n            currentMonth.appendChild(monthElement);\n            currentMonth.appendChild(yearInput);\n            monthNavFragment.appendChild(currentMonth);\n            container.appendChild(monthNavFragment);\n            return {\n                container: container,\n                yearElement: yearElement,\n                monthElement: monthElement\n            };\n        }\n        function buildMonths() {\n            clearNode(self.monthNav);\n            self.monthNav.appendChild(self.prevMonthNav);\n            if (self.config.showMonths) {\n                self.yearElements = [];\n                self.monthElements = [];\n            }\n            for (var m = self.config.showMonths; m--;) {\n                var month = buildMonth();\n                self.yearElements.push(month.yearElement);\n                self.monthElements.push(month.monthElement);\n                self.monthNav.appendChild(month.container);\n            }\n            self.monthNav.appendChild(self.nextMonthNav);\n        }\n        function buildMonthNav() {\n            self.monthNav = createElement(\"div\", \"flatpickr-months\");\n            self.yearElements = [];\n            self.monthElements = [];\n            self.prevMonthNav = createElement(\"span\", \"flatpickr-prev-month\");\n            self.prevMonthNav.innerHTML = self.config.prevArrow;\n            self.nextMonthNav = createElement(\"span\", \"flatpickr-next-month\");\n            self.nextMonthNav.innerHTML = self.config.nextArrow;\n            buildMonths();\n            Object.defineProperty(self, \"_hidePrevMonthArrow\", {\n                get: function () { return self.__hidePrevMonthArrow; },\n                set: function (bool) {\n                    if (self.__hidePrevMonthArrow !== bool) {\n                        toggleClass(self.prevMonthNav, \"disabled\", bool);\n                        self.__hidePrevMonthArrow = bool;\n                    }\n                }\n            });\n            Object.defineProperty(self, \"_hideNextMonthArrow\", {\n                get: function () { return self.__hideNextMonthArrow; },\n                set: function (bool) {\n                    if (self.__hideNextMonthArrow !== bool) {\n                        toggleClass(self.nextMonthNav, \"disabled\", bool);\n                        self.__hideNextMonthArrow = bool;\n                    }\n                }\n            });\n            self.currentYearElement = self.yearElements[0];\n            updateNavigationCurrentMonth();\n            return self.monthNav;\n        }\n        function buildTime() {\n            self.calendarContainer.classList.add(\"hasTime\");\n            if (self.config.noCalendar)\n                self.calendarContainer.classList.add(\"noCalendar\");\n            self.timeContainer = createElement(\"div\", \"flatpickr-time\");\n            self.timeContainer.tabIndex = -1;\n            var separator = createElement(\"span\", \"flatpickr-time-separator\", \":\");\n            var hourInput = createNumberInput(\"flatpickr-hour\");\n            self.hourElement = hourInput.getElementsByTagName(\"input\")[0];\n            var minuteInput = createNumberInput(\"flatpickr-minute\");\n            self.minuteElement = minuteInput.getElementsByTagName(\"input\")[0];\n            self.hourElement.tabIndex = self.minuteElement.tabIndex = -1;\n            self.hourElement.value = pad(self.latestSelectedDateObj\n                ? self.latestSelectedDateObj.getHours()\n                : self.config.time_24hr\n                    ? self.config.defaultHour\n                    : military2ampm(self.config.defaultHour));\n            self.minuteElement.value = pad(self.latestSelectedDateObj\n                ? self.latestSelectedDateObj.getMinutes()\n                : self.config.defaultMinute);\n            self.hourElement.setAttribute(\"step\", self.config.hourIncrement.toString());\n            self.minuteElement.setAttribute(\"step\", self.config.minuteIncrement.toString());\n            self.hourElement.setAttribute(\"min\", self.config.time_24hr ? \"0\" : \"1\");\n            self.hourElement.setAttribute(\"max\", self.config.time_24hr ? \"23\" : \"12\");\n            self.minuteElement.setAttribute(\"min\", \"0\");\n            self.minuteElement.setAttribute(\"max\", \"59\");\n            self.timeContainer.appendChild(hourInput);\n            self.timeContainer.appendChild(separator);\n            self.timeContainer.appendChild(minuteInput);\n            if (self.config.time_24hr)\n                self.timeContainer.classList.add(\"time24hr\");\n            if (self.config.enableSeconds) {\n                self.timeContainer.classList.add(\"hasSeconds\");\n                var secondInput = createNumberInput(\"flatpickr-second\");\n                self.secondElement = secondInput.getElementsByTagName(\"input\")[0];\n                self.secondElement.value = pad(self.latestSelectedDateObj\n                    ? self.latestSelectedDateObj.getSeconds()\n                    : self.config.defaultSeconds);\n                self.secondElement.setAttribute(\"step\", self.minuteElement.getAttribute(\"step\"));\n                self.secondElement.setAttribute(\"min\", \"0\");\n                self.secondElement.setAttribute(\"max\", \"59\");\n                self.timeContainer.appendChild(createElement(\"span\", \"flatpickr-time-separator\", \":\"));\n                self.timeContainer.appendChild(secondInput);\n            }\n            if (!self.config.time_24hr) {\n                // add self.amPM if appropriate\n                self.amPM = createElement(\"span\", \"flatpickr-am-pm\", self.l10n.amPM[int((self.latestSelectedDateObj\n                    ? self.hourElement.value\n                    : self.config.defaultHour) > 11)]);\n                self.amPM.title = self.l10n.toggleTitle;\n                self.amPM.tabIndex = -1;\n                self.timeContainer.appendChild(self.amPM);\n            }\n            return self.timeContainer;\n        }\n        function buildWeekdays() {\n            if (!self.weekdayContainer)\n                self.weekdayContainer = createElement(\"div\", \"flatpickr-weekdays\");\n            else\n                clearNode(self.weekdayContainer);\n            for (var i = self.config.showMonths; i--;) {\n                var container = createElement(\"div\", \"flatpickr-weekdaycontainer\");\n                self.weekdayContainer.appendChild(container);\n            }\n            updateWeekdays();\n            return self.weekdayContainer;\n        }\n        function updateWeekdays() {\n            var firstDayOfWeek = self.l10n.firstDayOfWeek;\n            var weekdays = self.l10n.weekdays.shorthand.slice();\n            if (firstDayOfWeek > 0 && firstDayOfWeek < weekdays.length) {\n                weekdays = weekdays.splice(firstDayOfWeek, weekdays.length).concat(weekdays.splice(0, firstDayOfWeek));\n            }\n            for (var i = self.config.showMonths; i--;) {\n                self.weekdayContainer.children[i].innerHTML = \"\\n      <span class='flatpickr-weekday'>\\n        \" + weekdays.join(\"</span><span class='flatpickr-weekday'>\") + \"\\n      </span>\\n      \";\n            }\n        }\n        /* istanbul ignore next */\n        function buildWeeks() {\n            self.calendarContainer.classList.add(\"hasWeeks\");\n            var weekWrapper = createElement(\"div\", \"flatpickr-weekwrapper\");\n            weekWrapper.appendChild(createElement(\"span\", \"flatpickr-weekday\", self.l10n.weekAbbreviation));\n            var weekNumbers = createElement(\"div\", \"flatpickr-weeks\");\n            weekWrapper.appendChild(weekNumbers);\n            return {\n                weekWrapper: weekWrapper,\n                weekNumbers: weekNumbers\n            };\n        }\n        function changeMonth(value, is_offset) {\n            if (is_offset === void 0) { is_offset = true; }\n            var delta = is_offset ? value : value - self.currentMonth;\n            if ((delta < 0 && self._hidePrevMonthArrow === true) ||\n                (delta > 0 && self._hideNextMonthArrow === true))\n                return;\n            self.currentMonth += delta;\n            if (self.currentMonth < 0 || self.currentMonth > 11) {\n                self.currentYear += self.currentMonth > 11 ? 1 : -1;\n                self.currentMonth = (self.currentMonth + 12) % 12;\n                triggerEvent(\"onYearChange\");\n            }\n            buildDays();\n            triggerEvent(\"onMonthChange\");\n            updateNavigationCurrentMonth();\n        }\n        function clear(triggerChangeEvent, toInitial) {\n            if (triggerChangeEvent === void 0) { triggerChangeEvent = true; }\n            if (toInitial === void 0) { toInitial = true; }\n            self.input.value = \"\";\n            if (self.altInput !== undefined)\n                self.altInput.value = \"\";\n            if (self.mobileInput !== undefined)\n                self.mobileInput.value = \"\";\n            self.selectedDates = [];\n            self.latestSelectedDateObj = undefined;\n            if (toInitial === true) {\n                self.currentYear = self._initialDate.getFullYear();\n                self.currentMonth = self._initialDate.getMonth();\n            }\n            self.showTimeInput = false;\n            if (self.config.enableTime === true) {\n                setDefaultHours();\n            }\n            self.redraw();\n            if (triggerChangeEvent)\n                // triggerChangeEvent is true (default) or an Event\n                triggerEvent(\"onChange\");\n        }\n        function close() {\n            self.isOpen = false;\n            if (!self.isMobile) {\n                if (self.calendarContainer !== undefined) {\n                    self.calendarContainer.classList.remove(\"open\");\n                }\n                if (self._input !== undefined) {\n                    self._input.classList.remove(\"active\");\n                }\n            }\n            triggerEvent(\"onClose\");\n        }\n        function destroy() {\n            if (self.config !== undefined)\n                triggerEvent(\"onDestroy\");\n            for (var i = self._handlers.length; i--;) {\n                var h = self._handlers[i];\n                h.element.removeEventListener(h.event, h.handler, h.options);\n            }\n            self._handlers = [];\n            if (self.mobileInput) {\n                if (self.mobileInput.parentNode)\n                    self.mobileInput.parentNode.removeChild(self.mobileInput);\n                self.mobileInput = undefined;\n            }\n            else if (self.calendarContainer && self.calendarContainer.parentNode) {\n                if (self.config.static && self.calendarContainer.parentNode) {\n                    var wrapper = self.calendarContainer.parentNode;\n                    wrapper.lastChild && wrapper.removeChild(wrapper.lastChild);\n                    if (wrapper.parentNode) {\n                        while (wrapper.firstChild)\n                            wrapper.parentNode.insertBefore(wrapper.firstChild, wrapper);\n                        wrapper.parentNode.removeChild(wrapper);\n                    }\n                }\n                else\n                    self.calendarContainer.parentNode.removeChild(self.calendarContainer);\n            }\n            if (self.altInput) {\n                self.input.type = \"text\";\n                if (self.altInput.parentNode)\n                    self.altInput.parentNode.removeChild(self.altInput);\n                delete self.altInput;\n            }\n            if (self.input) {\n                self.input.type = self.input._type;\n                self.input.classList.remove(\"flatpickr-input\");\n                self.input.removeAttribute(\"readonly\");\n                self.input.value = \"\";\n            }\n            [\n                \"_showTimeInput\",\n                \"latestSelectedDateObj\",\n                \"_hideNextMonthArrow\",\n                \"_hidePrevMonthArrow\",\n                \"__hideNextMonthArrow\",\n                \"__hidePrevMonthArrow\",\n                \"isMobile\",\n                \"isOpen\",\n                \"selectedDateElem\",\n                \"minDateHasTime\",\n                \"maxDateHasTime\",\n                \"days\",\n                \"daysContainer\",\n                \"_input\",\n                \"_positionElement\",\n                \"innerContainer\",\n                \"rContainer\",\n                \"monthNav\",\n                \"todayDateElem\",\n                \"calendarContainer\",\n                \"weekdayContainer\",\n                \"prevMonthNav\",\n                \"nextMonthNav\",\n                \"currentMonthElement\",\n                \"currentYearElement\",\n                \"navigationCurrentMonth\",\n                \"selectedDateElem\",\n                \"config\",\n            ].forEach(function (k) {\n                try {\n                    delete self[k];\n                }\n                catch (_) { }\n            });\n        }\n        function isCalendarElem(elem) {\n            if (self.config.appendTo && self.config.appendTo.contains(elem))\n                return true;\n            return self.calendarContainer.contains(elem);\n        }\n        function documentClick(e) {\n            if (self.isOpen && !self.config.inline) {\n                var eventTarget_1 = getEventTarget(e);\n                var isCalendarElement = isCalendarElem(eventTarget_1);\n                var isInput = eventTarget_1 === self.input ||\n                    eventTarget_1 === self.altInput ||\n                    self.element.contains(eventTarget_1) ||\n                    // web components\n                    // e.path is not present in all browsers. circumventing typechecks\n                    (e.path &&\n                        e.path.indexOf &&\n                        (~e.path.indexOf(self.input) ||\n                            ~e.path.indexOf(self.altInput)));\n                var lostFocus = e.type === \"blur\"\n                    ? isInput &&\n                        e.relatedTarget &&\n                        !isCalendarElem(e.relatedTarget)\n                    : !isInput &&\n                        !isCalendarElement &&\n                        !isCalendarElem(e.relatedTarget);\n                var isIgnored = !self.config.ignoredFocusElements.some(function (elem) {\n                    return elem.contains(eventTarget_1);\n                });\n                if (lostFocus && isIgnored) {\n                    self.close();\n                    if (self.config.mode === \"range\" && self.selectedDates.length === 1) {\n                        self.clear(false);\n                        self.redraw();\n                    }\n                }\n            }\n        }\n        function changeYear(newYear) {\n            if (!newYear ||\n                (self.config.minDate && newYear < self.config.minDate.getFullYear()) ||\n                (self.config.maxDate && newYear > self.config.maxDate.getFullYear()))\n                return;\n            var newYearNum = newYear, isNewYear = self.currentYear !== newYearNum;\n            self.currentYear = newYearNum || self.currentYear;\n            if (self.config.maxDate &&\n                self.currentYear === self.config.maxDate.getFullYear()) {\n                self.currentMonth = Math.min(self.config.maxDate.getMonth(), self.currentMonth);\n            }\n            else if (self.config.minDate &&\n                self.currentYear === self.config.minDate.getFullYear()) {\n                self.currentMonth = Math.max(self.config.minDate.getMonth(), self.currentMonth);\n            }\n            if (isNewYear) {\n                self.redraw();\n                triggerEvent(\"onYearChange\");\n            }\n        }\n        function isEnabled(date, timeless) {\n            if (timeless === void 0) { timeless = true; }\n            var dateToCheck = self.parseDate(date, undefined, timeless); // timeless\n            if ((self.config.minDate &&\n                dateToCheck &&\n                compareDates(dateToCheck, self.config.minDate, timeless !== undefined ? timeless : !self.minDateHasTime) < 0) ||\n                (self.config.maxDate &&\n                    dateToCheck &&\n                    compareDates(dateToCheck, self.config.maxDate, timeless !== undefined ? timeless : !self.maxDateHasTime) > 0))\n                return false;\n            if (self.config.enable.length === 0 && self.config.disable.length === 0)\n                return true;\n            if (dateToCheck === undefined)\n                return false;\n            var bool = self.config.enable.length > 0, array = bool ? self.config.enable : self.config.disable;\n            for (var i = 0, d = void 0; i < array.length; i++) {\n                d = array[i];\n                if (typeof d === \"function\" &&\n                    d(dateToCheck) // disabled by function\n                )\n                    return bool;\n                else if (d instanceof Date &&\n                    dateToCheck !== undefined &&\n                    d.getTime() === dateToCheck.getTime())\n                    // disabled by date\n                    return bool;\n                else if (typeof d === \"string\" && dateToCheck !== undefined) {\n                    // disabled by date string\n                    var parsed = self.parseDate(d, undefined, true);\n                    return parsed && parsed.getTime() === dateToCheck.getTime()\n                        ? bool\n                        : !bool;\n                }\n                else if (\n                // disabled by range\n                typeof d === \"object\" &&\n                    dateToCheck !== undefined &&\n                    d.from &&\n                    d.to &&\n                    dateToCheck.getTime() >= d.from.getTime() &&\n                    dateToCheck.getTime() <= d.to.getTime())\n                    return bool;\n            }\n            return !bool;\n        }\n        function isInView(elem) {\n            if (self.daysContainer !== undefined)\n                return (elem.className.indexOf(\"hidden\") === -1 &&\n                    self.daysContainer.contains(elem));\n            return false;\n        }\n        function onKeyDown(e) {\n            // e.key                      e.keyCode\n            // \"Backspace\"                        8\n            // \"Tab\"                              9\n            // \"Enter\"                           13\n            // \"Escape\"     (IE \"Esc\")           27\n            // \"ArrowLeft\"  (IE \"Left\")          37\n            // \"ArrowUp\"    (IE \"Up\")            38\n            // \"ArrowRight\" (IE \"Right\")         39\n            // \"ArrowDown\"  (IE \"Down\")          40\n            // \"Delete\"     (IE \"Del\")           46\n            var isInput = e.target === self._input;\n            var allowInput = self.config.allowInput;\n            var allowKeydown = self.isOpen && (!allowInput || !isInput);\n            var allowInlineKeydown = self.config.inline && isInput && !allowInput;\n            if (e.keyCode === 13 && isInput) {\n                if (allowInput) {\n                    self.setDate(self._input.value, true, e.target === self.altInput\n                        ? self.config.altFormat\n                        : self.config.dateFormat);\n                    return e.target.blur();\n                }\n                else\n                    self.open();\n            }\n            else if (isCalendarElem(e.target) ||\n                allowKeydown ||\n                allowInlineKeydown) {\n                var isTimeObj = !!self.timeContainer &&\n                    self.timeContainer.contains(e.target);\n                switch (e.keyCode) {\n                    case 13:\n                        if (isTimeObj) {\n                            updateTime();\n                            focusAndClose();\n                        }\n                        else\n                            selectDate(e);\n                        break;\n                    case 27: // escape\n                        e.preventDefault();\n                        focusAndClose();\n                        break;\n                    case 8:\n                    case 46:\n                        if (isInput && !self.config.allowInput) {\n                            e.preventDefault();\n                            self.clear();\n                        }\n                        break;\n                    case 37:\n                    case 39:\n                        if (!isTimeObj) {\n                            e.preventDefault();\n                            if (self.daysContainer !== undefined &&\n                                (allowInput === false ||\n                                    (document.activeElement && isInView(document.activeElement)))) {\n                                var delta_1 = e.keyCode === 39 ? 1 : -1;\n                                if (!e.ctrlKey)\n                                    focusOnDay(undefined, delta_1);\n                                else {\n                                    e.stopPropagation();\n                                    changeMonth(delta_1);\n                                    focusOnDay(getFirstAvailableDay(1), 0);\n                                }\n                            }\n                        }\n                        else if (self.hourElement)\n                            self.hourElement.focus();\n                        break;\n                    case 38:\n                    case 40:\n                        e.preventDefault();\n                        var delta = e.keyCode === 40 ? 1 : -1;\n                        if ((self.daysContainer && e.target.$i !== undefined) ||\n                            e.target === self.input) {\n                            if (e.ctrlKey) {\n                                e.stopPropagation();\n                                changeYear(self.currentYear - delta);\n                                focusOnDay(getFirstAvailableDay(1), 0);\n                            }\n                            else if (!isTimeObj)\n                                focusOnDay(undefined, delta * 7);\n                        }\n                        else if (self.config.enableTime) {\n                            if (!isTimeObj && self.hourElement)\n                                self.hourElement.focus();\n                            updateTime(e);\n                            self._debouncedChange();\n                        }\n                        break;\n                    case 9:\n                        if (isTimeObj) {\n                            var elems = [\n                                self.hourElement,\n                                self.minuteElement,\n                                self.secondElement,\n                                self.amPM,\n                            ].filter(function (x) { return x; });\n                            var i = elems.indexOf(e.target);\n                            if (i !== -1) {\n                                var target = elems[i + (e.shiftKey ? -1 : 1)];\n                                if (target !== undefined) {\n                                    e.preventDefault();\n                                    target.focus();\n                                }\n                                else if (e.shiftKey) {\n                                    e.preventDefault();\n                                    self._input.focus();\n                                }\n                            }\n                        }\n                        break;\n                    default:\n                        break;\n                }\n            }\n            if (self.amPM !== undefined && e.target === self.amPM) {\n                switch (e.key) {\n                    case self.l10n.amPM[0].charAt(0):\n                    case self.l10n.amPM[0].charAt(0).toLowerCase():\n                        self.amPM.textContent = self.l10n.amPM[0];\n                        setHoursFromInputs();\n                        updateValue();\n                        break;\n                    case self.l10n.amPM[1].charAt(0):\n                    case self.l10n.amPM[1].charAt(0).toLowerCase():\n                        self.amPM.textContent = self.l10n.amPM[1];\n                        setHoursFromInputs();\n                        updateValue();\n                        break;\n                }\n            }\n            triggerEvent(\"onKeyDown\", e);\n        }\n        function onMouseOver(elem) {\n            if (self.selectedDates.length !== 1 ||\n                (elem &&\n                    (!elem.classList.contains(\"flatpickr-day\") ||\n                        elem.classList.contains(\"disabled\"))))\n                return;\n            var hoverDate = elem\n                ? elem.dateObj.getTime()\n                : self.days.firstElementChild.dateObj.getTime(), initialDate = self.parseDate(self.selectedDates[0], undefined, true).getTime(), rangeStartDate = Math.min(hoverDate, self.selectedDates[0].getTime()), rangeEndDate = Math.max(hoverDate, self.selectedDates[0].getTime()), lastDate = self.daysContainer.lastChild\n                .lastChild.dateObj.getTime();\n            var containsDisabled = false;\n            var minRange = 0, maxRange = 0;\n            for (var t = rangeStartDate; t < lastDate; t += duration.DAY) {\n                if (!isEnabled(new Date(t), true)) {\n                    containsDisabled =\n                        containsDisabled || (t > rangeStartDate && t < rangeEndDate);\n                    if (t < initialDate && (!minRange || t > minRange))\n                        minRange = t;\n                    else if (t > initialDate && (!maxRange || t < maxRange))\n                        maxRange = t;\n                }\n            }\n            for (var m = 0; m < self.config.showMonths; m++) {\n                var month = self.daysContainer.children[m];\n                var prevMonth = self.daysContainer.children[m - 1];\n                var _loop_1 = function (i, l) {\n                    var dayElem = month.children[i], date = dayElem.dateObj;\n                    var timestamp = date.getTime();\n                    var outOfRange = (minRange > 0 && timestamp < minRange) ||\n                        (maxRange > 0 && timestamp > maxRange);\n                    if (outOfRange) {\n                        dayElem.classList.add(\"notAllowed\");\n                        [\"inRange\", \"startRange\", \"endRange\"].forEach(function (c) {\n                            dayElem.classList.remove(c);\n                        });\n                        return \"continue\";\n                    }\n                    else if (containsDisabled && !outOfRange)\n                        return \"continue\";\n                    [\"startRange\", \"inRange\", \"endRange\", \"notAllowed\"].forEach(function (c) {\n                        dayElem.classList.remove(c);\n                    });\n                    if (elem !== undefined) {\n                        elem.classList.add(hoverDate < self.selectedDates[0].getTime()\n                            ? \"startRange\"\n                            : \"endRange\");\n                        if (month.contains(elem) ||\n                            !(m > 0 &&\n                                prevMonth &&\n                                prevMonth.lastChild.dateObj.getTime() >= timestamp)) {\n                            if (initialDate < hoverDate && timestamp === initialDate)\n                                dayElem.classList.add(\"startRange\");\n                            else if (initialDate > hoverDate && timestamp === initialDate)\n                                dayElem.classList.add(\"endRange\");\n                            if (timestamp >= minRange &&\n                                (maxRange === 0 || timestamp <= maxRange) &&\n                                isBetween(timestamp, initialDate, hoverDate))\n                                dayElem.classList.add(\"inRange\");\n                        }\n                    }\n                };\n                for (var i = 0, l = month.children.length; i < l; i++) {\n                    _loop_1(i, l);\n                }\n            }\n        }\n        function onResize() {\n            if (self.isOpen && !self.config.static && !self.config.inline)\n                positionCalendar();\n        }\n        function setDefaultTime() {\n            self.setDate(self.config.minDate !== undefined\n                ? new Date(self.config.minDate.getTime())\n                : new Date(), false);\n            setDefaultHours();\n            updateValue();\n        }\n        function open(e, positionElement) {\n            if (positionElement === void 0) { positionElement = self._positionElement; }\n            if (self.isMobile === true) {\n                if (e) {\n                    e.preventDefault();\n                    e.target && e.target.blur();\n                }\n                if (self.mobileInput !== undefined) {\n                    self.mobileInput.focus();\n                    self.mobileInput.click();\n                }\n                triggerEvent(\"onOpen\");\n                return;\n            }\n            if (self._input.disabled || self.config.inline)\n                return;\n            var wasOpen = self.isOpen;\n            self.isOpen = true;\n            if (!wasOpen) {\n                self.calendarContainer.classList.add(\"open\");\n                self._input.classList.add(\"active\");\n                triggerEvent(\"onOpen\");\n                positionCalendar(positionElement);\n            }\n            if (self.config.enableTime === true && self.config.noCalendar === true) {\n                if (self.selectedDates.length === 0) {\n                    setDefaultTime();\n                }\n                if (self.config.allowInput === false &&\n                    (e === undefined ||\n                        !self.timeContainer.contains(e.relatedTarget))) {\n                    setTimeout(function () { return self.hourElement.select(); }, 50);\n                }\n            }\n        }\n        function minMaxDateSetter(type) {\n            return function (date) {\n                var dateObj = (self.config[\"_\" + type + \"Date\"] = self.parseDate(date, self.config.dateFormat));\n                var inverseDateObj = self.config[\"_\" + (type === \"min\" ? \"max\" : \"min\") + \"Date\"];\n                if (dateObj !== undefined) {\n                    self[type === \"min\" ? \"minDateHasTime\" : \"maxDateHasTime\"] =\n                        dateObj.getHours() > 0 ||\n                            dateObj.getMinutes() > 0 ||\n                            dateObj.getSeconds() > 0;\n                }\n                if (self.selectedDates) {\n                    self.selectedDates = self.selectedDates.filter(function (d) { return isEnabled(d); });\n                    if (!self.selectedDates.length && type === \"min\")\n                        setHoursFromDate(dateObj);\n                    updateValue();\n                }\n                if (self.daysContainer) {\n                    redraw();\n                    if (dateObj !== undefined)\n                        self.currentYearElement[type] = dateObj.getFullYear().toString();\n                    else\n                        self.currentYearElement.removeAttribute(type);\n                    self.currentYearElement.disabled =\n                        !!inverseDateObj &&\n                            dateObj !== undefined &&\n                            inverseDateObj.getFullYear() === dateObj.getFullYear();\n                }\n            };\n        }\n        function parseConfig() {\n            var boolOpts = [\n                \"wrap\",\n                \"weekNumbers\",\n                \"allowInput\",\n                \"clickOpens\",\n                \"time_24hr\",\n                \"enableTime\",\n                \"noCalendar\",\n                \"altInput\",\n                \"shorthandCurrentMonth\",\n                \"inline\",\n                \"static\",\n                \"enableSeconds\",\n                \"disableMobile\",\n            ];\n            var userConfig = __assign({}, instanceConfig, JSON.parse(JSON.stringify(element.dataset || {})));\n            var formats = {};\n            self.config.parseDate = userConfig.parseDate;\n            self.config.formatDate = userConfig.formatDate;\n            Object.defineProperty(self.config, \"enable\", {\n                get: function () { return self.config._enable; },\n                set: function (dates) {\n                    self.config._enable = parseDateRules(dates);\n                }\n            });\n            Object.defineProperty(self.config, \"disable\", {\n                get: function () { return self.config._disable; },\n                set: function (dates) {\n                    self.config._disable = parseDateRules(dates);\n                }\n            });\n            var timeMode = userConfig.mode === \"time\";\n            if (!userConfig.dateFormat && (userConfig.enableTime || timeMode)) {\n                formats.dateFormat =\n                    userConfig.noCalendar || timeMode\n                        ? \"H:i\" + (userConfig.enableSeconds ? \":S\" : \"\")\n                        : flatpickr.defaultConfig.dateFormat +\n                            \" H:i\" +\n                            (userConfig.enableSeconds ? \":S\" : \"\");\n            }\n            if (userConfig.altInput &&\n                (userConfig.enableTime || timeMode) &&\n                !userConfig.altFormat) {\n                formats.altFormat =\n                    userConfig.noCalendar || timeMode\n                        ? \"h:i\" + (userConfig.enableSeconds ? \":S K\" : \" K\")\n                        : flatpickr.defaultConfig.altFormat +\n                            (\" h:i\" + (userConfig.enableSeconds ? \":S\" : \"\") + \" K\");\n            }\n            Object.defineProperty(self.config, \"minDate\", {\n                get: function () { return self.config._minDate; },\n                set: minMaxDateSetter(\"min\")\n            });\n            Object.defineProperty(self.config, \"maxDate\", {\n                get: function () { return self.config._maxDate; },\n                set: minMaxDateSetter(\"max\")\n            });\n            var minMaxTimeSetter = function (type) { return function (val) {\n                self.config[type === \"min\" ? \"_minTime\" : \"_maxTime\"] = self.parseDate(val, \"H:i\");\n            }; };\n            Object.defineProperty(self.config, \"minTime\", {\n                get: function () { return self.config._minTime; },\n                set: minMaxTimeSetter(\"min\")\n            });\n            Object.defineProperty(self.config, \"maxTime\", {\n                get: function () { return self.config._maxTime; },\n                set: minMaxTimeSetter(\"max\")\n            });\n            if (userConfig.mode === \"time\") {\n                self.config.noCalendar = true;\n                self.config.enableTime = true;\n            }\n            Object.assign(self.config, formats, userConfig);\n            for (var i = 0; i < boolOpts.length; i++)\n                self.config[boolOpts[i]] =\n                    self.config[boolOpts[i]] === true ||\n                        self.config[boolOpts[i]] === \"true\";\n            HOOKS.filter(function (hook) { return self.config[hook] !== undefined; }).forEach(function (hook) {\n                self.config[hook] = arrayify(self.config[hook] || []).map(bindToInstance);\n            });\n            self.isMobile =\n                !self.config.disableMobile &&\n                    !self.config.inline &&\n                    self.config.mode === \"single\" &&\n                    !self.config.disable.length &&\n                    !self.config.enable.length &&\n                    !self.config.weekNumbers &&\n                    /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);\n            for (var i = 0; i < self.config.plugins.length; i++) {\n                var pluginConf = self.config.plugins[i](self) || {};\n                for (var key in pluginConf) {\n                    if (HOOKS.indexOf(key) > -1) {\n                        self.config[key] = arrayify(pluginConf[key])\n                            .map(bindToInstance)\n                            .concat(self.config[key]);\n                    }\n                    else if (typeof userConfig[key] === \"undefined\")\n                        self.config[key] = pluginConf[key];\n                }\n            }\n            triggerEvent(\"onParseConfig\");\n        }\n        function setupLocale() {\n            if (typeof self.config.locale !== \"object\" &&\n                typeof flatpickr.l10ns[self.config.locale] === \"undefined\")\n                self.config.errorHandler(new Error(\"flatpickr: invalid locale \" + self.config.locale));\n            self.l10n = __assign({}, flatpickr.l10ns[\"default\"], (typeof self.config.locale === \"object\"\n                ? self.config.locale\n                : self.config.locale !== \"default\"\n                    ? flatpickr.l10ns[self.config.locale]\n                    : undefined));\n            tokenRegex.K = \"(\" + self.l10n.amPM[0] + \"|\" + self.l10n.amPM[1] + \"|\" + self.l10n.amPM[0].toLowerCase() + \"|\" + self.l10n.amPM[1].toLowerCase() + \")\";\n            self.formatDate = createDateFormatter(self);\n            self.parseDate = createDateParser({ config: self.config, l10n: self.l10n });\n        }\n        function positionCalendar(customPositionElement) {\n            if (self.calendarContainer === undefined)\n                return;\n            triggerEvent(\"onPreCalendarPosition\");\n            var positionElement = customPositionElement || self._positionElement;\n            var calendarHeight = Array.prototype.reduce.call(self.calendarContainer.children, (function (acc, child) { return acc + child.offsetHeight; }), 0), calendarWidth = self.calendarContainer.offsetWidth, configPos = self.config.position.split(\" \"), configPosVertical = configPos[0], configPosHorizontal = configPos.length > 1 ? configPos[1] : null, inputBounds = positionElement.getBoundingClientRect(), distanceFromBottom = window.innerHeight - inputBounds.bottom, showOnTop = configPosVertical === \"above\" ||\n                (configPosVertical !== \"below\" &&\n                    distanceFromBottom < calendarHeight &&\n                    inputBounds.top > calendarHeight);\n            var top = window.pageYOffset +\n                inputBounds.top +\n                (!showOnTop ? positionElement.offsetHeight + 2 : -calendarHeight - 2);\n            toggleClass(self.calendarContainer, \"arrowTop\", !showOnTop);\n            toggleClass(self.calendarContainer, \"arrowBottom\", showOnTop);\n            if (self.config.inline)\n                return;\n            var left = window.pageXOffset +\n                inputBounds.left -\n                (configPosHorizontal != null && configPosHorizontal === \"center\"\n                    ? (calendarWidth - inputBounds.width) / 2\n                    : 0);\n            var right = window.document.body.offsetWidth - inputBounds.right;\n            var rightMost = left + calendarWidth > window.document.body.offsetWidth;\n            var centerMost = right + calendarWidth > window.document.body.offsetWidth;\n            toggleClass(self.calendarContainer, \"rightMost\", rightMost);\n            if (self.config.static)\n                return;\n            self.calendarContainer.style.top = top + \"px\";\n            if (!rightMost) {\n                self.calendarContainer.style.left = left + \"px\";\n                self.calendarContainer.style.right = \"auto\";\n            }\n            else if (!centerMost) {\n                self.calendarContainer.style.left = \"auto\";\n                self.calendarContainer.style.right = right + \"px\";\n            }\n            else {\n                var doc = document.styleSheets[0];\n                // some testing environments don't have css support\n                if (doc === undefined)\n                    return;\n                var bodyWidth = window.document.body.offsetWidth;\n                var centerLeft = Math.max(0, bodyWidth / 2 - calendarWidth / 2);\n                var centerBefore = \".flatpickr-calendar.centerMost:before\";\n                var centerAfter = \".flatpickr-calendar.centerMost:after\";\n                var centerIndex = doc.cssRules.length;\n                var centerStyle = \"{left:\" + inputBounds.left + \"px;right:auto;}\";\n                toggleClass(self.calendarContainer, \"rightMost\", false);\n                toggleClass(self.calendarContainer, \"centerMost\", true);\n                doc.insertRule(centerBefore + \",\" + centerAfter + centerStyle, centerIndex);\n                self.calendarContainer.style.left = centerLeft + \"px\";\n                self.calendarContainer.style.right = \"auto\";\n            }\n        }\n        function redraw() {\n            if (self.config.noCalendar || self.isMobile)\n                return;\n            updateNavigationCurrentMonth();\n            buildDays();\n        }\n        function focusAndClose() {\n            self._input.focus();\n            if (window.navigator.userAgent.indexOf(\"MSIE\") !== -1 ||\n                navigator.msMaxTouchPoints !== undefined) {\n                // hack - bugs in the way IE handles focus keeps the calendar open\n                setTimeout(self.close, 0);\n            }\n            else {\n                self.close();\n            }\n        }\n        function selectDate(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            var isSelectable = function (day) {\n                return day.classList &&\n                    day.classList.contains(\"flatpickr-day\") &&\n                    !day.classList.contains(\"disabled\") &&\n                    !day.classList.contains(\"notAllowed\");\n            };\n            var t = findParent(e.target, isSelectable);\n            if (t === undefined)\n                return;\n            var target = t;\n            var selectedDate = (self.latestSelectedDateObj = new Date(target.dateObj.getTime()));\n            var shouldChangeMonth = (selectedDate.getMonth() < self.currentMonth ||\n                selectedDate.getMonth() >\n                    self.currentMonth + self.config.showMonths - 1) &&\n                self.config.mode !== \"range\";\n            self.selectedDateElem = target;\n            if (self.config.mode === \"single\")\n                self.selectedDates = [selectedDate];\n            else if (self.config.mode === \"multiple\") {\n                var selectedIndex = isDateSelected(selectedDate);\n                if (selectedIndex)\n                    self.selectedDates.splice(parseInt(selectedIndex), 1);\n                else\n                    self.selectedDates.push(selectedDate);\n            }\n            else if (self.config.mode === \"range\") {\n                if (self.selectedDates.length === 2) {\n                    self.clear(false, false);\n                }\n                self.latestSelectedDateObj = selectedDate;\n                self.selectedDates.push(selectedDate);\n                // unless selecting same date twice, sort ascendingly\n                if (compareDates(selectedDate, self.selectedDates[0], true) !== 0)\n                    self.selectedDates.sort(function (a, b) { return a.getTime() - b.getTime(); });\n            }\n            setHoursFromInputs();\n            if (shouldChangeMonth) {\n                var isNewYear = self.currentYear !== selectedDate.getFullYear();\n                self.currentYear = selectedDate.getFullYear();\n                self.currentMonth = selectedDate.getMonth();\n                if (isNewYear)\n                    triggerEvent(\"onYearChange\");\n                triggerEvent(\"onMonthChange\");\n            }\n            updateNavigationCurrentMonth();\n            buildDays();\n            updateValue();\n            if (self.config.enableTime)\n                setTimeout(function () { return (self.showTimeInput = true); }, 50);\n            // maintain focus\n            if (!shouldChangeMonth &&\n                self.config.mode !== \"range\" &&\n                self.config.showMonths === 1)\n                focusOnDayElem(target);\n            else if (self.selectedDateElem !== undefined &&\n                self.hourElement === undefined) {\n                self.selectedDateElem && self.selectedDateElem.focus();\n            }\n            if (self.hourElement !== undefined)\n                self.hourElement !== undefined && self.hourElement.focus();\n            if (self.config.closeOnSelect) {\n                var single = self.config.mode === \"single\" && !self.config.enableTime;\n                var range = self.config.mode === \"range\" &&\n                    self.selectedDates.length === 2 &&\n                    !self.config.enableTime;\n                if (single || range) {\n                    focusAndClose();\n                }\n            }\n            triggerChange();\n        }\n        var CALLBACKS = {\n            locale: [setupLocale, updateWeekdays],\n            showMonths: [buildMonths, setCalendarWidth, buildWeekdays]\n        };\n        function set(option, value) {\n            if (option !== null && typeof option === \"object\")\n                Object.assign(self.config, option);\n            else {\n                self.config[option] = value;\n                if (CALLBACKS[option] !== undefined)\n                    CALLBACKS[option].forEach(function (x) { return x(); });\n                else if (HOOKS.indexOf(option) > -1)\n                    self.config[option] = arrayify(value);\n            }\n            self.redraw();\n            updateValue(false);\n        }\n        function setSelectedDate(inputDate, format) {\n            var dates = [];\n            if (inputDate instanceof Array)\n                dates = inputDate.map(function (d) { return self.parseDate(d, format); });\n            else if (inputDate instanceof Date || typeof inputDate === \"number\")\n                dates = [self.parseDate(inputDate, format)];\n            else if (typeof inputDate === \"string\") {\n                switch (self.config.mode) {\n                    case \"single\":\n                    case \"time\":\n                        dates = [self.parseDate(inputDate, format)];\n                        break;\n                    case \"multiple\":\n                        dates = inputDate\n                            .split(self.config.conjunction)\n                            .map(function (date) { return self.parseDate(date, format); });\n                        break;\n                    case \"range\":\n                        dates = inputDate\n                            .split(self.l10n.rangeSeparator)\n                            .map(function (date) { return self.parseDate(date, format); });\n                        break;\n                    default:\n                        break;\n                }\n            }\n            else\n                self.config.errorHandler(new Error(\"Invalid date supplied: \" + JSON.stringify(inputDate)));\n            self.selectedDates = dates.filter(function (d) { return d instanceof Date && isEnabled(d, false); });\n            if (self.config.mode === \"range\")\n                self.selectedDates.sort(function (a, b) { return a.getTime() - b.getTime(); });\n        }\n        function setDate(date, triggerChange, format) {\n            if (triggerChange === void 0) { triggerChange = false; }\n            if (format === void 0) { format = self.config.dateFormat; }\n            if ((date !== 0 && !date) || (date instanceof Array && date.length === 0))\n                return self.clear(triggerChange);\n            setSelectedDate(date, format);\n            self.showTimeInput = self.selectedDates.length > 0;\n            self.latestSelectedDateObj = self.selectedDates[0];\n            self.redraw();\n            jumpToDate();\n            setHoursFromDate();\n            updateValue(triggerChange);\n            if (triggerChange)\n                triggerEvent(\"onChange\");\n        }\n        function parseDateRules(arr) {\n            return arr\n                .slice()\n                .map(function (rule) {\n                if (typeof rule === \"string\" ||\n                    typeof rule === \"number\" ||\n                    rule instanceof Date) {\n                    return self.parseDate(rule, undefined, true);\n                }\n                else if (rule &&\n                    typeof rule === \"object\" &&\n                    rule.from &&\n                    rule.to)\n                    return {\n                        from: self.parseDate(rule.from, undefined),\n                        to: self.parseDate(rule.to, undefined)\n                    };\n                return rule;\n            })\n                .filter(function (x) { return x; }); // remove falsy values\n        }\n        function setupDates() {\n            self.selectedDates = [];\n            self.now = self.parseDate(self.config.now) || new Date();\n            // Workaround IE11 setting placeholder as the input's value\n            var preloadedDate = self.config.defaultDate ||\n                ((self.input.nodeName === \"INPUT\" ||\n                    self.input.nodeName === \"TEXTAREA\") &&\n                    self.input.placeholder &&\n                    self.input.value === self.input.placeholder\n                    ? null\n                    : self.input.value);\n            if (preloadedDate)\n                setSelectedDate(preloadedDate, self.config.dateFormat);\n            self._initialDate =\n                self.selectedDates.length > 0\n                    ? self.selectedDates[0]\n                    : self.config.minDate &&\n                        self.config.minDate.getTime() > self.now.getTime()\n                        ? self.config.minDate\n                        : self.config.maxDate &&\n                            self.config.maxDate.getTime() < self.now.getTime()\n                            ? self.config.maxDate\n                            : self.now;\n            self.currentYear = self._initialDate.getFullYear();\n            self.currentMonth = self._initialDate.getMonth();\n            if (self.selectedDates.length > 0)\n                self.latestSelectedDateObj = self.selectedDates[0];\n            if (self.config.minTime !== undefined)\n                self.config.minTime = self.parseDate(self.config.minTime, \"H:i\");\n            if (self.config.maxTime !== undefined)\n                self.config.maxTime = self.parseDate(self.config.maxTime, \"H:i\");\n            self.minDateHasTime =\n                !!self.config.minDate &&\n                    (self.config.minDate.getHours() > 0 ||\n                        self.config.minDate.getMinutes() > 0 ||\n                        self.config.minDate.getSeconds() > 0);\n            self.maxDateHasTime =\n                !!self.config.maxDate &&\n                    (self.config.maxDate.getHours() > 0 ||\n                        self.config.maxDate.getMinutes() > 0 ||\n                        self.config.maxDate.getSeconds() > 0);\n            Object.defineProperty(self, \"showTimeInput\", {\n                get: function () { return self._showTimeInput; },\n                set: function (bool) {\n                    self._showTimeInput = bool;\n                    if (self.calendarContainer)\n                        toggleClass(self.calendarContainer, \"showTimeInput\", bool);\n                    self.isOpen && positionCalendar();\n                }\n            });\n        }\n        function setupInputs() {\n            self.input = self.config.wrap\n                ? element.querySelector(\"[data-input]\")\n                : element;\n            /* istanbul ignore next */\n            if (!self.input) {\n                self.config.errorHandler(new Error(\"Invalid input element specified\"));\n                return;\n            }\n            // hack: store previous type to restore it after destroy()\n            self.input._type = self.input.type;\n            self.input.type = \"text\";\n            self.input.classList.add(\"flatpickr-input\");\n            self._input = self.input;\n            if (self.config.altInput) {\n                // replicate self.element\n                self.altInput = createElement(self.input.nodeName, self.input.className + \" \" + self.config.altInputClass);\n                self._input = self.altInput;\n                self.altInput.placeholder = self.input.placeholder;\n                self.altInput.disabled = self.input.disabled;\n                self.altInput.required = self.input.required;\n                self.altInput.tabIndex = self.input.tabIndex;\n                self.altInput.type = \"text\";\n                self.input.setAttribute(\"type\", \"hidden\");\n                if (!self.config.static && self.input.parentNode)\n                    self.input.parentNode.insertBefore(self.altInput, self.input.nextSibling);\n            }\n            if (!self.config.allowInput)\n                self._input.setAttribute(\"readonly\", \"readonly\");\n            self._positionElement = self.config.positionElement || self._input;\n        }\n        function setupMobile() {\n            var inputType = self.config.enableTime\n                ? self.config.noCalendar\n                    ? \"time\"\n                    : \"datetime-local\"\n                : \"date\";\n            self.mobileInput = createElement(\"input\", self.input.className + \" flatpickr-mobile\");\n            self.mobileInput.step = self.input.getAttribute(\"step\") || \"any\";\n            self.mobileInput.tabIndex = 1;\n            self.mobileInput.type = inputType;\n            self.mobileInput.disabled = self.input.disabled;\n            self.mobileInput.required = self.input.required;\n            self.mobileInput.placeholder = self.input.placeholder;\n            self.mobileFormatStr =\n                inputType === \"datetime-local\"\n                    ? \"Y-m-d\\\\TH:i:S\"\n                    : inputType === \"date\"\n                        ? \"Y-m-d\"\n                        : \"H:i:S\";\n            if (self.selectedDates.length > 0) {\n                self.mobileInput.defaultValue = self.mobileInput.value = self.formatDate(self.selectedDates[0], self.mobileFormatStr);\n            }\n            if (self.config.minDate)\n                self.mobileInput.min = self.formatDate(self.config.minDate, \"Y-m-d\");\n            if (self.config.maxDate)\n                self.mobileInput.max = self.formatDate(self.config.maxDate, \"Y-m-d\");\n            self.input.type = \"hidden\";\n            if (self.altInput !== undefined)\n                self.altInput.type = \"hidden\";\n            try {\n                if (self.input.parentNode)\n                    self.input.parentNode.insertBefore(self.mobileInput, self.input.nextSibling);\n            }\n            catch (_a) { }\n            bind(self.mobileInput, \"change\", function (e) {\n                self.setDate(e.target.value, false, self.mobileFormatStr);\n                triggerEvent(\"onChange\");\n                triggerEvent(\"onClose\");\n            });\n        }\n        function toggle(e) {\n            if (self.isOpen === true)\n                return self.close();\n            self.open(e);\n        }\n        function triggerEvent(event, data) {\n            // If the instance has been destroyed already, all hooks have been removed\n            if (self.config === undefined)\n                return;\n            var hooks = self.config[event];\n            if (hooks !== undefined && hooks.length > 0) {\n                for (var i = 0; hooks[i] && i < hooks.length; i++)\n                    hooks[i](self.selectedDates, self.input.value, self, data);\n            }\n            if (event === \"onChange\") {\n                self.input.dispatchEvent(createEvent(\"change\"));\n                // many front-end frameworks bind to the input event\n                self.input.dispatchEvent(createEvent(\"input\"));\n            }\n        }\n        function createEvent(name) {\n            var e = document.createEvent(\"Event\");\n            e.initEvent(name, true, true);\n            return e;\n        }\n        function isDateSelected(date) {\n            for (var i = 0; i < self.selectedDates.length; i++) {\n                if (compareDates(self.selectedDates[i], date) === 0)\n                    return \"\" + i;\n            }\n            return false;\n        }\n        function isDateInRange(date) {\n            if (self.config.mode !== \"range\" || self.selectedDates.length < 2)\n                return false;\n            return (compareDates(date, self.selectedDates[0]) >= 0 &&\n                compareDates(date, self.selectedDates[1]) <= 0);\n        }\n        function updateNavigationCurrentMonth() {\n            if (self.config.noCalendar || self.isMobile || !self.monthNav)\n                return;\n            self.yearElements.forEach(function (yearElement, i) {\n                var d = new Date(self.currentYear, self.currentMonth, 1);\n                d.setMonth(self.currentMonth + i);\n                self.monthElements[i].textContent =\n                    monthToStr(d.getMonth(), self.config.shorthandCurrentMonth, self.l10n) +\n                        \" \";\n                yearElement.value = d.getFullYear().toString();\n            });\n            self._hidePrevMonthArrow =\n                self.config.minDate !== undefined &&\n                    (self.currentYear === self.config.minDate.getFullYear()\n                        ? self.currentMonth <= self.config.minDate.getMonth()\n                        : self.currentYear < self.config.minDate.getFullYear());\n            self._hideNextMonthArrow =\n                self.config.maxDate !== undefined &&\n                    (self.currentYear === self.config.maxDate.getFullYear()\n                        ? self.currentMonth + 1 > self.config.maxDate.getMonth()\n                        : self.currentYear > self.config.maxDate.getFullYear());\n        }\n        function getDateStr(format) {\n            return self.selectedDates\n                .map(function (dObj) { return self.formatDate(dObj, format); })\n                .filter(function (d, i, arr) {\n                return self.config.mode !== \"range\" ||\n                    self.config.enableTime ||\n                    arr.indexOf(d) === i;\n            })\n                .join(self.config.mode !== \"range\"\n                ? self.config.conjunction\n                : self.l10n.rangeSeparator);\n        }\n        /**\n         * Updates the values of inputs associated with the calendar\n         */\n        function updateValue(triggerChange) {\n            if (triggerChange === void 0) { triggerChange = true; }\n            if (self.selectedDates.length === 0)\n                return self.clear(triggerChange);\n            if (self.mobileInput !== undefined && self.mobileFormatStr) {\n                self.mobileInput.value =\n                    self.latestSelectedDateObj !== undefined\n                        ? self.formatDate(self.latestSelectedDateObj, self.mobileFormatStr)\n                        : \"\";\n            }\n            self.input.value = getDateStr(self.config.dateFormat);\n            if (self.altInput !== undefined) {\n                self.altInput.value = getDateStr(self.config.altFormat);\n            }\n            if (triggerChange !== false)\n                triggerEvent(\"onValueUpdate\");\n        }\n        function onMonthNavClick(e) {\n            e.preventDefault();\n            var isPrevMonth = self.prevMonthNav.contains(e.target);\n            var isNextMonth = self.nextMonthNav.contains(e.target);\n            if (isPrevMonth || isNextMonth) {\n                changeMonth(isPrevMonth ? -1 : 1);\n            }\n            else if (self.yearElements.indexOf(e.target) >= 0) {\n                e.target.select();\n            }\n            else if (e.target.classList.contains(\"arrowUp\")) {\n                self.changeYear(self.currentYear + 1);\n            }\n            else if (e.target.classList.contains(\"arrowDown\")) {\n                self.changeYear(self.currentYear - 1);\n            }\n        }\n        function timeWrapper(e) {\n            e.preventDefault();\n            var isKeyDown = e.type === \"keydown\", input = e.target;\n            if (self.amPM !== undefined && e.target === self.amPM) {\n                self.amPM.textContent =\n                    self.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];\n            }\n            var min = parseFloat(input.getAttribute(\"min\")), max = parseFloat(input.getAttribute(\"max\")), step = parseFloat(input.getAttribute(\"step\")), curValue = parseInt(input.value, 10), delta = e.delta ||\n                (isKeyDown ? (e.which === 38 ? 1 : -1) : 0);\n            var newValue = curValue + step * delta;\n            if (typeof input.value !== \"undefined\" && input.value.length === 2) {\n                var isHourElem = input === self.hourElement, isMinuteElem = input === self.minuteElement;\n                if (newValue < min) {\n                    newValue =\n                        max +\n                            newValue +\n                            int(!isHourElem) +\n                            (int(isHourElem) && int(!self.amPM));\n                    if (isMinuteElem)\n                        incrementNumInput(undefined, -1, self.hourElement);\n                }\n                else if (newValue > max) {\n                    newValue =\n                        input === self.hourElement ? newValue - max - int(!self.amPM) : min;\n                    if (isMinuteElem)\n                        incrementNumInput(undefined, 1, self.hourElement);\n                }\n                if (self.amPM &&\n                    isHourElem &&\n                    (step === 1\n                        ? newValue + curValue === 23\n                        : Math.abs(newValue - curValue) > step)) {\n                    self.amPM.textContent =\n                        self.l10n.amPM[int(self.amPM.textContent === self.l10n.amPM[0])];\n                }\n                input.value = pad(newValue);\n            }\n        }\n        init();\n        return self;\n    }\n    /* istanbul ignore next */\n    function _flatpickr(nodeList, config) {\n        // static list\n        var nodes = Array.prototype.slice\n            .call(nodeList)\n            .filter(function (x) { return x instanceof HTMLElement; });\n        var instances = [];\n        for (var i = 0; i < nodes.length; i++) {\n            var node = nodes[i];\n            try {\n                if (node.getAttribute(\"data-fp-omit\") !== null)\n                    continue;\n                if (node._flatpickr !== undefined) {\n                    node._flatpickr.destroy();\n                    node._flatpickr = undefined;\n                }\n                node._flatpickr = FlatpickrInstance(node, config || {});\n                instances.push(node._flatpickr);\n            }\n            catch (e) {\n                console.error(e);\n            }\n        }\n        return instances.length === 1 ? instances[0] : instances;\n    }\n    /* istanbul ignore next */\n    if (typeof HTMLElement !== \"undefined\") {\n        // browser env\n        HTMLCollection.prototype.flatpickr = NodeList.prototype.flatpickr = function (config) {\n            return _flatpickr(this, config);\n        };\n        HTMLElement.prototype.flatpickr = function (config) {\n            return _flatpickr([this], config);\n        };\n    }\n    /* istanbul ignore next */\n    var flatpickr = function (selector, config) {\n        if (typeof selector === \"string\") {\n            return _flatpickr(window.document.querySelectorAll(selector), config);\n        }\n        else if (selector instanceof Node) {\n            return _flatpickr([selector], config);\n        }\n        else {\n            return _flatpickr(selector, config);\n        }\n    };\n    /* istanbul ignore next */\n    flatpickr.defaultConfig = defaults;\n    flatpickr.l10ns = {\n        en: __assign({}, english),\n        \"default\": __assign({}, english)\n    };\n    flatpickr.localize = function (l10n) {\n        flatpickr.l10ns[\"default\"] = __assign({}, flatpickr.l10ns[\"default\"], l10n);\n    };\n    flatpickr.setDefaults = function (config) {\n        flatpickr.defaultConfig = __assign({}, flatpickr.defaultConfig, config);\n    };\n    flatpickr.parseDate = createDateParser({});\n    flatpickr.formatDate = createDateFormatter({});\n    flatpickr.compareDates = compareDates;\n    /* istanbul ignore next */\n    if (typeof jQuery !== \"undefined\") {\n        jQuery.fn.flatpickr = function (config) {\n            return _flatpickr(this, config);\n        };\n    }\n    Date.prototype.fp_incr = function (days) {\n        return new Date(this.getFullYear(), this.getMonth(), this.getDate() + (typeof days === \"string\" ? parseInt(days, 10) : days));\n    };\n    if (typeof window !== \"undefined\") {\n        window.flatpickr = flatpickr;\n    }\n\n    return flatpickr;\n\n}));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/flatpickr/dist/flatpickr.js\n// module id = 7\n// module chunks = 0","(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :\n  typeof define === 'function' && define.amd ? define(['exports'], factory) :\n  (global = global || self, factory(global.es = {}));\n}(this, function (exports) { 'use strict';\n\n  var fp = typeof window !== \"undefined\" && window.flatpickr !== undefined\n      ? window.flatpickr\n      : {\n          l10ns: {}\n      };\n  var Spanish = {\n      weekdays: {\n          shorthand: [\"Dom\", \"Lun\", \"Mar\", \"Mi\", \"Jue\", \"Vie\", \"Sb\"],\n          longhand: [\n              \"Domingo\",\n              \"Lunes\",\n              \"Martes\",\n              \"Mircoles\",\n              \"Jueves\",\n              \"Viernes\",\n              \"Sbado\",\n          ]\n      },\n      months: {\n          shorthand: [\n              \"Ene\",\n              \"Feb\",\n              \"Mar\",\n              \"Abr\",\n              \"May\",\n              \"Jun\",\n              \"Jul\",\n              \"Ago\",\n              \"Sep\",\n              \"Oct\",\n              \"Nov\",\n              \"Dic\",\n          ],\n          longhand: [\n              \"Enero\",\n              \"Febrero\",\n              \"Marzo\",\n              \"Abril\",\n              \"Mayo\",\n              \"Junio\",\n              \"Julio\",\n              \"Agosto\",\n              \"Septiembre\",\n              \"Octubre\",\n              \"Noviembre\",\n              \"Diciembre\",\n          ]\n      },\n      ordinal: function () {\n          return \"\";\n      },\n      firstDayOfWeek: 1,\n      rangeSeparator: \" a \"\n  };\n  fp.l10ns.es = Spanish;\n  var es = fp.l10ns;\n\n  exports.Spanish = Spanish;\n  exports.default = es;\n\n  Object.defineProperty(exports, '__esModule', { value: true });\n\n}));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/flatpickr/dist/l10n/es.js\n// module id = 8\n// module chunks = 0","/**\n * ol-ext - A set of cool extensions for OpenLayers (ol) in node modules structure\n * @description ol3,openlayers,popup,menu,symbol,renderer,filter,canvas,interaction,split,statistic,charts,pie,LayerSwitcher,toolbar,animation\n * @version v3.1.2\n * @author Jean-Marc Viglino\n * @see https://github.com/Viglino/ol-ext#,\n * @license BSD-3-Clause\n */\n/** @namespace  ol.ext\n */\n/*global ol*/\nif (window.ol && !ol.ext) {\n  ol.ext = {};\n}\n/** Inherit the prototype methods from one constructor into another.\n * replace deprecated ol method\n *\n * @param {!Function} childCtor Child constructor.\n * @param {!Function} parentCtor Parent constructor.\n * @function module:ol.inherits\n * @api\n */\nol.ext.inherits = function(child,parent) {\n  child.prototype = Object.create(parent.prototype);\n  child.prototype.constructor = child;\n};\n// Compatibilty with ol > 5 to be removed when v6 is out\nif (window.ol) {\n  if (!ol.inherits) ol.inherits = ol.ext.inherits;\n}\n\n/** Ajax request\n * @fires success\n * @fires error\n * @param {*} options\n *  @param {string} options.auth Authorisation as btoa(\"username:password\");\n *  @param {string} options.dataType The type of data that you're expecting back from the server, default JSON\n */\nol.ext.Ajax = function(options) {\n  options = options || {};\n\tol.Object.call(this);\n  this._auth = options.auth;\n  this.set('dataType', options.dataType || 'JSON');\n};\nol.inherits(ol.ext.Ajax, ol.Object);\n/** Helper for get\n * @param {*} options\n *  @param {string} options.url\n *  @param {string} options.auth Authorisation as btoa(\"username:password\");\n *  @param {string} options.dataType The type of data that you're expecting back from the server, default JSON\n *  @param {string} options.success\n *  @param {string} options.error\n */\nol.ext.Ajax.get = function(options) {\n  var ajax = new ol.ext.Ajax(options);\n  if (options.success) ajax.on('success', function(e) { options.success(e.response, e); } );\n  if (options.error) ajax.on('error', function(e) { options.error(e); } );\n  ajax.send(options.url, options.data);\n};\n/** Send an ajax request (GET)\n * @fires success\n * @fires error\n * @param {string} url\n * @param {*} data Data to send to the server as key / value\n * @param {*} options a set of options that are returned in the \n *  @param {boolean} options.abort false to prevent aborting the current request, default true\n */\nol.ext.Ajax.prototype.send = function (url, data, options){\n\tvar self = this;\n  // Url\n  url = encodeURI(url);\n  // Parameters\n  var parameters = '';\n\tfor (var index in data) {\n\t\tif (data.hasOwnProperty(index) && data[index]!==undefined) {\n      parameters += (parameters ? '&' : '?') + index + '=' + encodeURIComponent(data[index]);\n    }\n\t}\n\t// Abort previous request\n\tif (this._request && options.abort!==false) {\n\t\tthis._request.abort();\n\t}\n\t// New request\n\tvar ajax = this._request = new XMLHttpRequest();\n\tajax.open('GET', url + parameters, true);\n\tif (this._auth) {\n\t\tajax.setRequestHeader(\"Authorization\", \"Basic \" + this._auth);\n\t}\n  // Load complete\n  this.dispatchEvent ({ type: 'loadstart' });\n\tajax.onload = function() {\n\t\tself._request = null;\n    self.dispatchEvent ({ type: 'loadend' });\n    if (this.status >= 200 && this.status < 400) {\n      var response;\n      // Decode response\n      try {\n        switch (self.get('dataType')) {\n          case 'JSON': {\n            response = JSON.parse(this.response);\n            break;\n          }\n          default: {\n            response = this.response;\n          }\n        }\n      } catch(e) {\n        // Error\n        self.dispatchEvent ({ \n          type: 'error',\n          status: 0,\n          statusText: 'parsererror',\n          error: e,\n          options: options,\n          jqXHR: this\n        });\n        return;\n      }\n      // Success\n      //console.log('response',response)\n      self.dispatchEvent ({ \n        type: 'success',\n        response: response,\n        status: this.status,\n        statusText: this.statusText,\n        options: options,\n        jqXHR: this\n      });\n    } else {\n      self.dispatchEvent ({ \n        type: 'error',\n        status: this.status,\n        statusText: this.statusText,\n        options: options,\n        jqXHR: this\n      });\n    }\n\t};\n\t// Oops\n\tajax.onerror = function() {\n    self._request = null;\n    self.dispatchEvent ({ type: 'loadend' });\n    self.dispatchEvent ({ \n      type: 'error',\n      status: this.status,\n      statusText: this.statusText,\n      options: options,\n      jqXHR: this\n    });\n  };\n\t// GO!\n\tajax.send();\n};\n\n/** Vanilla JS helper to manipulate DOM without jQuery\n * @see https://github.com/nefe/You-Dont-Need-jQuery\n * @see https://plainjs.com/javascript/\n * @see http://youmightnotneedjquery.com/\n */\n ol.ext.element = {};\n/**\n * Create an element\n * @param {string} tagName The element tag, use 'TEXT' to create a text node\n * @param {*} options\n *  @param {string} options.className className The element class name \n *  @param {Element} options.parent Parent to append the element as child\n *  @param {Element|string} options.html Content of the element\n *  @param {string} options.* Any other attribut to add to the element\n */\nol.ext.element.create = function (tagName, options) {\n  options = options || {};\n  var elt;\n  // Create text node\n  if (tagName === 'TEXT') {\n    elt = document.createTextNode(options.html||'');\n    if (options.parent) options.parent.appendChild(elt);\n  } else {\n    // Other element\n    elt = document.createElement(tagName);\n    if (/button/i.test(tagName)) elt.setAttribute('type', 'button');\n    for (var attr in options) {\n      switch (attr) {\n        case 'className': {\n          if (options.className && options.className.trim) elt.setAttribute('class', options.className.trim());\n          break;\n        }\n        case 'html': {\n          if (options.html instanceof Element) elt.appendChild(options.html)\n          else if (options.html!==undefined) elt.innerHTML = options.html;\n          break;\n        }\n        case 'parent': {\n          options.parent.appendChild(elt);\n          break;\n        }\n        case 'style': {\n          this.setStyle(elt, options.style);\n          break;\n        }\n        case 'click': {\n          ol.ext.element.addListener(elt, attr, options[attr]);\n          break;\n        }\n        case 'on': {\n          for (var e in options.on) {\n            ol.ext.element.addListener(elt, e, options.on[e]);\n          }\n          break;\n        }\n        case 'checked': {\n          elt.checked = !!options.checked;\n          break;\n        }\n        default: {\n          elt.setAttribute(attr, options[attr]);\n          break;\n        }\n      }\n    }\n  }\n  return elt;\n};\n/** Set inner html or append a child element to an element\n * @param {Element} element\n * @param {Element|string} html Content of the element\n */\nol.ext.element.setHTML = function(element, html) {\n  if (html instanceof Element) element.appendChild(html)\n  else if (html!==undefined) element.innerHTML = html;\n};\n/**\n * Add a set of event listener to an element\n * @param {Element} element\n * @param {string|Array<string>} eventType\n * @param {function} fn\n */\nol.ext.element.addListener = function (element, eventType, fn) {\n  if (typeof eventType === 'string') eventType = eventType.split(' ');\n  eventType.forEach(function(e) {\n    element.addEventListener(e, fn);\n  });\n};\n/**\n * Add a set of event listener to an element\n * @param {Element} element\n * @param {string|Array<string>} eventType\n * @param {function} fn\n */\nol.ext.element.removeListener = function (element, eventType, fn) {\n  if (typeof eventType === 'string') eventType = eventType.split(' ');\n  eventType.forEach(function(e) {\n    element.removeEventListener(e, fn);\n  });\n};\n/**\n * Show an element\n * @param {Element} element\n */\nol.ext.element.show = function (element) {\n  element.style.display = '';\n};\n/**\n * Hide an element\n * @param {Element} element\n */\nol.ext.element.hide = function (element) {\n  element.style.display = 'none';\n};\n/**\n * Test if an element is hihdden\n * @param {Element} element\n * @return {boolean}\n */\nol.ext.element.hidden = function (element) {\n  return ol.ext.element.getStyle(element, 'display') === 'none';\n};\n/**\n * Toggle an element\n * @param {Element} element\n */\nol.ext.element.toggle = function (element) {\n  element.style.display = (element.style.display==='none' ? '' : 'none');\n};\n/** Set style of an element\n * @param {DOMElement} el the element\n * @param {*} st list of style\n */\nol.ext.element.setStyle = function(el, st) {\n  for (var s in st) {\n    switch (s) {\n      case 'top':\n      case 'left':\n      case 'bottom':\n      case 'right':\n      case 'minWidth':\n      case 'maxWidth':\n      case 'width':\n      case 'height': {\n        if (typeof(st[s]) === 'number') {\n          el.style[s] = st[s]+'px';\n        } else {\n          el.style[s] = st[s];\n        }\n        break;\n      }\n      default: {\n        el.style[s] = st[s];\n      }\n    }\n  }\n};\n/**\n * Get style propertie of an element\n * @param {DOMElement} el the element\n * @param {string} styleProp Propertie name\n * @return {*} style value\n */\nol.ext.element.getStyle = function(el, styleProp) {\n  var value, defaultView = (el.ownerDocument || document).defaultView;\n  // W3C standard way:\n  if (defaultView && defaultView.getComputedStyle) {\n    // sanitize property name to css notation\n    // (hypen separated words eg. font-Size)\n    styleProp = styleProp.replace(/([A-Z])/g, \"-$1\").toLowerCase();\n    value = defaultView.getComputedStyle(el, null).getPropertyValue(styleProp);\n  } else if (el.currentStyle) { // IE\n    // sanitize property name to camelCase\n    styleProp = styleProp.replace(/-(\\w)/g, function(str, letter) {\n      return letter.toUpperCase();\n    });\n    value = el.currentStyle[styleProp];\n    // convert other units to pixels on IE\n    if (/^\\d+(em|pt|%|ex)?$/i.test(value)) { \n      return (function(value) {\n        var oldLeft = el.style.left, oldRsLeft = el.runtimeStyle.left;\n        el.runtimeStyle.left = el.currentStyle.left;\n        el.style.left = value || 0;\n        value = el.style.pixelLeft + \"px\";\n        el.style.left = oldLeft;\n        el.runtimeStyle.left = oldRsLeft;\n        return value;\n      })(value);\n    }\n  }\n  if (/px$/.test(value)) return parseInt(value);\n  return value;\n};\n/** Get outerHeight of an elemen\n * @param {DOMElement} elt\n * @return {number}\n */\nol.ext.element.outerHeight = function(elt) {\n  return elt.offsetHeight + ol.ext.element.getStyle(elt, 'marginBottom')\n};\n/** Get outerWidth of an elemen\n * @param {DOMElement} elt\n * @return {number}\n */\nol.ext.element.outerWidth = function(elt) {\n  return elt.offsetWidth + ol.ext.element.getStyle(elt, 'marginLeft')\n};\n/** Get element offset rect\n * @param {DOMElement} elt\n * @return {*} \n */\nol.ext.element.offsetRect = function(elt) {\n  var rect = elt.getBoundingClientRect();\n  return {\n    top: rect.top + (window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0),\n    left: rect.left + (window.pageXOffset || document.documentElement.scrollLeft || document.body.scrollLeft || 0),\n    height: rect.height || (rect.bottom - rect.top),\n    width: rect.widtth || (rect.right - rect.left)\n  }\n};\n/** Make a div scrollable without scrollbar.\n * On touch devices the default behavior is preserved\n * @param {DOMElement} elt\n * @param {function} onmove a function that takes a boolean indicating that the div is scrolling\n */\nol.ext.element.scrollDiv = function(elt, options) {\n  var pos = false;\n  var speed = 0;\n  var d, dt = 0;\n  var onmove = (typeof(options.onmove) === 'function' ? options.onmove : function(){});\n  var page = options.vertical ? 'pageY' : 'pageX';\n  var scroll = options.vertical ? 'scrollTop' : 'scrollLeft';\n  // Prevent image dragging\n  elt.querySelectorAll('img').forEach(function(i) {\n    i.ondragstart = function(){ return false; };\n  });\n  // Start scrolling\n  ol.ext.element.addListener(elt, ['mousedown'], function(e) {\n    pos = e[page];\n    dt = new Date();\n    elt.classList.add('ol-move');\n  });\n  // Register scroll\n  ol.ext.element.addListener(window, ['mousemove'], function(e) {\n    if (pos !== false) {\n      var delta = pos - e[page];\n      elt[scroll] += delta;\n      d = new Date();\n      if (d-dt) {\n        speed = (speed + delta / (d - dt))/2;\n      }\n      pos = e[page];\n      dt = d;\n      // Tell we are moving\n      if (delta) onmove(true);\n    } else {\n      // Not moving yet\n      onmove(false);\n    }\n  });\n  // Stop scrolling\n  ol.ext.element.addListener(window, ['mouseup'], function(e) {\n    elt.classList.remove('ol-move');\n    dt = new Date() - dt;\n    if (dt>100) {\n      // User stop: no speed\n      speed = 0;\n    } else if (dt>0) {\n      // Calculate new speed\n      speed = ((speed||0) + (pos - e[page]) / dt) / 2;\n    }\n    elt[scroll] += speed*100;\n    pos = false;\n    speed = 0;\n    dt = 0;\n  });\n  // Handle mousewheel\n  if (options.mousewheel && !elt.classList.contains('ol-touch')) {\n    ol.ext.element.addListener(elt, \n      ['mousewheel', 'DOMMouseScroll', 'onmousewheel'], \n      function(e) {\n        var delta = Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail)));\n        elt.classList.add('ol-move');\n        elt[scroll] -= delta*30;\n        return false;\n      }\n    );\n  }\n};\n\n/* global ol */\n/* Create ol.sphere for backward compatibility with ol < 5.0\n * To use with Openlayers package\n */\nif (window.ol && !ol.sphere) {\n  ol.sphere = {};\n  ol.sphere.getDistance = function (c1, c2, radius) {\n    var sphere = new ol.Sphere(radius || 6371008.8);\n    return sphere.haversineDistance(c1, c2);\n  }\n  ol.sphere.getArea = ol.Sphere.getArea;\n  ol.sphere.getLength = ol.Sphere.getLength;\n}\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search Control.\n * This is the base class for search controls. You can use it for simple custom search or as base to new class.\n * @see ol.control.SearchFeature\n * @see ol.control.SearchPhoton\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires select\n * @fires change:input\n * @param {Object=} options\n *  @param {string} options.className control class name\n *  @param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *  @param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *  @param {string | undefined} options.inputLabel label for the input, default none\n *  @param {string | undefined} options.noCollapse prevent collapsing on input blur, default false\n *  @param {number | undefined} options.typing a delay on each typing to start searching (ms) use -1 to prevent autocompletion, default 300.\n *  @param {integer | undefined} options.minLength minimum length to start searching, default 1\n *  @param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *  @param {integer | undefined} options.maxHistory maximum number of items to display in history. Set -1 if you don't want history, default maxItems\n *  @param {function} options.getTitle a function that takes a feature and return the name to display in the index.\n *  @param {function} options.autocomplete a function that take a search string and callback function to send an array\n */\nol.control.Search = function(options) {\n  var self = this;\n  if (!options) options = {};\n  if (options.typing == undefined) options.typing = 300;\n  // Class name for history\n  this._classname = options.className || 'search';\n  var classNames = (options.className||'')+ ' ol-search'\n    + (options.target ? '' : ' ol-unselectable ol-control ol-collapsed');\n  var element = ol.ext.element.create('DIV',{\n    className: classNames\n  })\n  if (!options.target) {\n    this.button = document.createElement(\"BUTTON\");\n    this.button.setAttribute(\"type\", \"button\");\n    this.button.setAttribute(\"title\", options.label||\"search\");\n    this.button.addEventListener(\"click\", function() {\n      element.classList.toggle(\"ol-collapsed\");\n      if (!element.classList.contains(\"ol-collapsed\")) {\n        element.querySelector(\"input.search\").focus();\n        var listElements = element.querySelectorAll(\"li\");\n        for (var i = 0; i < listElements.length; i++) {\n          listElements[i].classList.remove(\"select\");\n        }\n        // Display history\n        if (!input.value) {\n          self.drawList_();\n        }\n      }\n    });\n    element.appendChild(this.button);\n  }\n  // Input label\n  if (options.inputLabel) {\n    var label = document.createElement(\"LABEL\");\n    label.innerText = options.inputLabel;\n    element.appendChild(label);\n  }\n  // Search input\n  var tout, cur=\"\";\n  var input = this._input = document.createElement(\"INPUT\");\n  input.setAttribute(\"type\", \"search\");\n  input.setAttribute(\"class\", \"search\");\n  input.setAttribute(\"placeholder\", options.placeholder||\"Search...\");\n  input.addEventListener(\"change\", function(e) {\n    self.dispatchEvent({ type:\"change:input\", input:e, value:input.value });\n  });\n  var doSearch = function(e) {\n    // console.log(e.type+\" \"+e.key)'\n    var li  = element.querySelector(\"ul.autocomplete li.select\");\n    var\tval = input.value;\n    // move up/down\n    if (e.key=='ArrowDown' || e.key=='ArrowUp' || e.key=='Down' || e.key=='Up') {\n      if (li) {\n        li.classList.remove(\"select\");\n        li = (/Down/.test(e.key)) ? li.nextElementSibling : li.previousElementSibling;\n        if (li) li.classList.add(\"select\");\n      }\n      else element.querySelector(\"ul.autocomplete li\").classList.add(\"select\");\n    }\n    // Clear input\n    else if (e.type=='input' && !val) {\n      self.drawList_();\n    }\n    // Select in the list\n    else if (li && (e.type==\"search\" || e.key ==\"Enter\")) {\n      if (element.classList.contains(\"ol-control\")) input.blur();\n      li.classList.remove(\"select\");\n      cur = val;\n      self._handleSelect(self._list[li.getAttribute(\"data-search\")]);\n    }\n    // Search / autocomplete\n    else if ( (e.type==\"search\" || e.key =='Enter')\n      || (cur!=val && options.typing>=0)) {\n      // current search\n      cur = val;\n      if (cur) {\n        // prevent searching on each typing\n        if (tout) clearTimeout(tout);\n        tout = setTimeout(function() {\n          if (cur.length >= self.get(\"minLength\")) {\n            var s = self.autocomplete (cur, function(auto) { self.drawList_(auto); });\n            if (s) self.drawList_(s);\n          }\n          else self.drawList_();\n        }, options.typing);\n      }\n      else self.drawList_();\n    }\n    // Clear list selection\n    else {\n      li = element.querySelector(\"ul.autocomplete li\");\n      if (li) li.classList.remove('select');\n    }\n  };\n  input.addEventListener(\"keyup\", doSearch);\n  input.addEventListener(\"search\", doSearch);\n  input.addEventListener(\"cut\", doSearch);\n  input.addEventListener(\"paste\", doSearch);\n  input.addEventListener(\"input\", doSearch);\n  if (!options.noCollapse) {\n    input.addEventListener('blur', function() {\n      setTimeout(function(){ element.classList.add('ol-collapsed') }, 200);\n    });\n    input.addEventListener('focus', function() {\n      element.classList.remove('ol-collapsed');\n    });\n  }\n  element.appendChild(input);\n  // Autocomplete list\n  var ul = document.createElement('UL');\n  ul.classList.add('autocomplete');\n  element.appendChild(ul);\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  if (typeof (options.getTitle)=='function') this.getTitle = options.getTitle;\n  if (typeof (options.autocomplete)=='function') this.autocomplete = options.autocomplete;\n  // Options\n  this.set('minLength', options.minLength || 1);\n  this.set('maxItems', options.maxItems || 10);\n  this.set('maxHistory', options.maxHistory || options.maxItems || 10);\n  // History\n  this.restoreHistory();\n  this.drawList_();\n};\nol.inherits(ol.control.Search, ol.control.Control);\n/** Get the input field\n*\t@return {Element} \n*\t@api\n*/\nol.control.Search.prototype.getInputField = function () {\n  return this._input;\n};\n/** Returns the text to be displayed in the menu\n*\t@param {any} f feature to be displayed\n*\t@return {string} the text to be displayed in the index, default f.name\n*\t@api\n*/\nol.control.Search.prototype.getTitle = function (f) {\n  return f.name || \"No title\";\n};\n/** Force search to refresh\n */\nol.control.Search.prototype.search = function () {\n  var search = this.element.querySelector(\"input.search\");\n  this._triggerCustomEvent('search', search);\n};\n/** Trigger custom event on elemebt\n * @param {*} eventName \n * @param {*} element \n * @private\n */\nol.control.Search.prototype._triggerCustomEvent = function (eventName, element) {\n  var event;\n  if (window.CustomEvent) {\n    event = new CustomEvent(eventName);\n  } else {\n    event = document.createEvent(\"CustomEvent\");\n    event.initCustomEvent(eventName, true, true, {});\n  }\n  element.dispatchEvent(event);\n};\n/** Set the input value in the form (for initialisation purpose)\n*\t@param {string} value\n*\t@param {boolean} search to start a search\n*\t@api\n*/\nol.control.Search.prototype.setInput = function (value, search) {\n  var input = this.element.querySelector(\"input.search\");\n  input.value = value;\n  if (search) this._triggerCustomEvent(\"keyup\", input);\n};\n/** A ligne has been clicked in the menu > dispatch event\n*\t@param {any} f the feature, as passed in the autocomplete\n*\t@api\n*/\nol.control.Search.prototype.select = function (f) {\n  this.dispatchEvent({ type:\"select\", search:f });\n};\n/**\n * Save history and select\n * @param {*} f \n * @private\n */\nol.control.Search.prototype._handleSelect = function (f) {\n  if (!f) return;\n  // Save input in history\n  var hist = this.get('history');\n  // Prevent error on stringify\n  var i;\n  try {\n    var fstr = JSON.stringify(f);\n    for (i=hist.length-1; i>=0; i--) {\n      if (!hist[i] || JSON.stringify(hist[i]) === fstr) {\n        hist.splice(i,1);\n      }\n    }\n  } catch (e) {\n    for (i=hist.length-1; i>=0; i--) {\n      if (hist[i] === f) {\n        hist.splice(i,1);\n      }\n    }\n  }\n  hist.unshift(f);\n  while (hist.length > (this.get('maxHistory')||10)) {\n    hist.pop();\n  } \n  this.saveHistory();\n  // Select feature\n  this.select(f);\n  //this.drawList_();\n};\n/** Save history (in the localstorage)\n */\nol.control.Search.prototype.saveHistory = function () {\n  if (this.get('maxHistory')>=0) {\n    try {\n      localStorage[\"ol@search-\"+this._classname] = JSON.stringify(this.get('history'));\n    } catch (e) { /* ok */ }\n  } else {\n    localStorage.removeItem(\"ol@search-\"+this._classname);\n  }\n};\n/** Restore history (from the localstorage) \n */\nol.control.Search.prototype.restoreHistory = function () {\n  try {\n    this.set('history', JSON.parse(localStorage[\"ol@search-\"+this._classname]) );\n  } catch(e) {\n    this.set('history', []);\n  }\n};\n/**\n * Remove previous history\n */\nol.control.Search.prototype.clearHistory = function () {\n  this.set('history', []);\n  this.saveHistory();\n  this.drawList_();\n};\n/**\n * Get history table\n */\nol.control.Search.prototype.getHistory = function () {\n  return this.get('history');\n};\n/** Autocomplete function\n* @param {string} s search string\n* @param {function} cback a callback function that takes an array to display in the autocomplete field (for asynchronous search)\n* @return {Array|false} an array of search solutions or false if the array is send with the cback argument (asnchronous)\n* @api\n*/\nol.control.Search.prototype.autocomplete = function (s, cback) {\n  cback ([]);\n  return false;\n  // or just return [];\n};\n/** Draw the list\n* @param {Array} auto an array of search result\n* @private\n*/\nol.control.Search.prototype.drawList_ = function (auto) {\n  var self = this;\n  var ul = this.element.querySelector(\"ul.autocomplete\");\n  ul.innerHTML = '';\n  this._list = [];\n  if (!auto) {\n    var input = this.element.querySelector(\"input.search\");\n    var value = input.value;\n    if (!value) {\n      auto = this.get('history');\n    } else {\n      return;\n    }\n    ul.setAttribute('class', 'autocomplete history');\n  } else {\n    ul.setAttribute('class', 'autocomplete');\n  }\n  var li, max = Math.min (self.get(\"maxItems\"),auto.length);\n  for (var i=0; i<max; i++) {\t\n    if (auto[i]) {\n      if (!i || !self.equalFeatures(auto[i], auto[i-1])) {\n        li = document.createElement(\"LI\");\n        li.setAttribute(\"data-search\", this._list.length);\n        this._list.push(auto[i]);\n        li.addEventListener(\"click\", function(e) {\n          self._handleSelect(self._list[e.currentTarget.getAttribute(\"data-search\")]);\n        });\n        li.innerHTML = self.getTitle(auto[i]);\n        ul.appendChild(li);\n      }\n    }\n  }\n  if (max && this.get(\"copy\")) {\n    li = document.createElement(\"LI\");\n    li.classList.add(\"copy\");\n    li.innerHTML = this.get(\"copy\");\n    ul.appendChild(li);\n  }\n};\n/** Test if 2 features are equal\n * @param {any} f1\n * @param {any} f2\n * @return {boolean}\n */\nol.control.Search.prototype.equalFeatures = function (/* f1, f2 */) {\n  return false;\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * This is the base class for search controls that use a json service to search features.\n * You can use it for simple custom search or as base to new class.\n *\n * @constructor\n * @extends {ol.control.Search}\n * @fires select\n * @param {any} options extend ol.control.Search options\n *\t@param {string} options.className control class name\n *\t@param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *\t@param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *\t@param {number | undefined} options.typing a delay on each typing to start searching (ms), default 1000.\n *\t@param {integer | undefined} options.minLength minimum length to start searching, default 3\n *\t@param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *  @param {function | undefined} options.handleResponse Handle server response to pass the features array to the list\n *\n *\t@param {string|undefined} options.url Url of the search api\n *\t@param {string | undefined} options.authentication: basic authentication for the search API as btoa(\"login:pwd\")\n */\nol.control.SearchJSON = function(options)\n{\toptions = options || {};\n\toptions.className = options.className || 'JSON';\n\tdelete options.autocomplete;\n\toptions.minLength = options.minLength || 3;\n\toptions.typing = options.typing || 800;\n\tol.control.Search.call(this, options);\n\t// Handle Mix Content Warning\n\t// If the current connection is an https connection all other connections must be https either\n\tvar url = options.url || \"\";\n\tif (window.location.protocol === \"https:\") {\n\t\tvar parser = document.createElement('a');\n\t\tparser.href = url;\n\t\tparser.protocol = window.location.protocol;\n\t\turl = parser.href;\n\t}\n\tthis.set('url', url);\n\tthis._auth = options.authentication;\n\t// Overwrite handleResponse\n\tif (typeof(options.handleResponse)==='function') this.handleResponse = options.handleResponse;\n};\nol.inherits(ol.control.SearchJSON, ol.control.Search);\n/** Autocomplete function (ajax request to the server)\n* @param {string} s search string\n* @param {function} cback a callback function that takes an array of {name, feature} to display in the autocomplete field\n*/\nol.control.SearchJSON.prototype.autocomplete = function (s, cback)\n{\tvar data = this.requestData(s);\n\tvar url = encodeURI(this.get('url'));\n\tvar parameters = '';\n\tfor (var index in data) {\n\t\tparameters += (parameters) ? '&' : '?';\n\t\tif (data.hasOwnProperty(index)) parameters += index + '=' + encodeURIComponent(data[index]);\n\t}\n\tthis.ajax(url + parameters, \n\t\tfunction (resp) {\n\t\t\tif (resp.status >= 200 && resp.status < 400) {\n\t\t\t\tvar data = JSON.parse(resp.response);\n\t\t\t\tcback(this.handleResponse(data));\n\t\t\t} else {\n\t\t\t\tconsole.log(url + parameters, arguments);\n\t\t\t}\n\t\t}, function(){\n\t\t\tconsole.log(url + parameters, arguments);\n\t\t});\n};\n/** Send an ajax request (GET)\n * @param {string} url\n * @param {function} onsuccess callback\n * @param {function} onerror callback\n */\nol.control.SearchJSON.prototype.ajax = function (url, onsuccess, onerror){\n\tvar self = this;\n\t// Abort previous request\n\tif (this._request) {\n\t\tthis._request.abort();\n\t}\n\t// New request\n\tvar ajax = this._request = new XMLHttpRequest();\n\tajax.open('GET', url, true);\n\tif (this._auth) {\n\t\tajax.setRequestHeader(\"Authorization\", \"Basic \" + this._auth);\n\t}\n\tthis.element.classList.add('searching');\n\t// Load complete\n\tajax.onload = function() {\n\t\tself._request = null;\n\t\tself.element.classList.remove('searching');\n\t\tonsuccess.call(self, this);\n\t};\n\t// Oops, TODO do something ?\n\tajax.onerror = function() {\n\t\tself._request = null;\n\t\tself.element.classList.remove('searching');\n\t\tif (onerror) onerror.call(self);\n\t};\n\t// GO!\n\tajax.send();\n};\n/**\n * @param {string} s the search string\n * @return {Object} request data (as key:value)\n * @api\n */\nol.control.SearchJSON.prototype.requestData = function (s){\n\treturn { q: s };\n};\n/**\n * Handle server response to pass the features array to the display list\n * @param {any} response server response\n * @return {Array<any>} an array of feature\n * @api\n */\nol.control.SearchJSON.prototype.handleResponse = function (response) {\n\treturn response;\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search places using the photon API.\n *\n * @constructor\n * @extends {ol.control.SearchJSON}\n * @fires select\n * @param {Object=} Control options.\n *\t@param {string} options.className control class name\n *\t@param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *\t@param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *\t@param {number | undefined} options.typing a delay on each typing to start searching (ms), default 1000.\n *\t@param {integer | undefined} options.minLength minimum length to start searching, default 3\n *\t@param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *  @param {function | undefined} options.handleResponse Handle server response to pass the features array to the list\n * \n *\t@param {string|undefined} options.url Url to photon api, default \"http://photon.komoot.de/api/\"\n *\t@param {string|undefined} options.lang Force preferred language, default none\n *\t@param {boolean} options.position Search, with priority to geo position, default false\n *\t@param {function} options.getTitle a function that takes a feature and return the name to display in the index, default return street + name + contry\n */\nol.control.SearchPhoton = function(options)\n{\toptions = options || {};\n\toptions.className = options.className || 'photon';\n\toptions.url = options.url || \"http://photon.komoot.de/api/\";\n\tol.control.SearchJSON.call(this, options);\n\tthis.set('lang', options.lang);\n\tthis.set('position', options.position);\n\tthis.set(\"copy\",\"<a href='http://www.openstreetmap.org/copyright' target='new'>&copy; OpenStreetMap contributors</a>\");\n};\nol.inherits(ol.control.SearchPhoton, ol.control.SearchJSON);\n/** Returns the text to be displayed in the menu\n*\t@param {ol.Feature} f the feature\n*\t@return {string} the text to be displayed in the index\n*\t@api\n*/\nol.control.SearchPhoton.prototype.getTitle = function (f)\n{\tvar p = f.properties;\n\treturn (p.housenumber||\"\")\n\t\t+ \" \"+(p.street || p.name || \"\")\n\t\t+ \"<i>\"\n\t\t+ \" \"+(p.postcode||\"\")\n\t\t+ \" \"+(p.city||\"\")\n\t\t+ \" (\"+p.country\n\t\t+ \")</i>\";\n};\n/** \n * @param {string} s the search string\n * @return {Object} request data (as key:value)\n * @api\n */\nol.control.SearchPhoton.prototype.requestData = function (s)\n{\tvar data =\n\t{\tq: s,\n\t\tlang: this.get('lang'),\n\t\tlimit: this.get('maxItems')\n\t}\n\t// Handle position proirity\n\tif (this.get('position'))\n\t{\tvar view = this.getMap().getView();\n\t\tvar pt = new ol.geom.Point(view.getCenter());\n\t\tpt = (pt.transform (view.getProjection(), \"EPSG:4326\")).getCoordinates();\n\t\tdata.lon = pt[0];\n\t\tdata.lat = pt[1];\n\t}\n\treturn data;\n};\n/**\n * Handle server response to pass the features array to the list\n * @param {any} response server response\n * @return {Array<any>} an array of feature\n */\nol.control.SearchPhoton.prototype.handleResponse = function (response) {\n\treturn response.features;\n};\n/** Prevent same feature to be drawn twice: test equality\n * @param {} f1 First feature to compare\n * @param {} f2 Second feature to compare\n * @return {boolean}\n * @api\n */\nol.control.SearchPhoton.prototype.equalFeatures = function (f1, f2) {\n\treturn (this.getTitle(f1) === this.getTitle(f2)\n\t\t&& f1.geometry.coordinates[0] === f2.geometry.coordinates[0]\n\t\t&& f1.geometry.coordinates[1] === f2.geometry.coordinates[1]);\n};\n/** A ligne has been clicked in the menu > dispatch event\n*\t@param {any} f the feature, as passed in the autocomplete\n*\t@api\n*/\nol.control.SearchPhoton.prototype.select = function (f)\n{\tvar c = f.geometry.coordinates;\n\t// Add coordinate to the event\n\ttry {\n\t\tc = ol.proj.transform (f.geometry.coordinates, 'EPSG:4326', this.getMap().getView().getProjection());\n\t} catch(e) { /* ok */ }\n\tthis.dispatchEvent({ type:\"select\", search:f, coordinate: c });\n};\n/** */\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search places using the French National Base Address (BAN) API.\n *\n * @constructor\n * @extends {ol.control.SearchJSON}\n * @fires select\n * @param {any} options extend ol.control.SearchJSON options\n *\t@param {string} options.className control class name\n *\t@param {boolean | undefined} options.apiKey the service api key.\n *\t@param {string | undefined} options.authentication: basic authentication for the service API as btoa(\"login:pwd\")\n *\t@param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *\t@param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *\t@param {number | undefined} options.typing a delay on each typing to start searching (ms), default 500.\n *\t@param {integer | undefined} options.minLength minimum length to start searching, default 3\n *\t@param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *\n *\t@param {StreetAddress|PositionOfInterest|CadastralParcel|Commune} options.type type of search. Using Commune will return the INSEE code, default StreetAddress,PositionOfInterest\n * @see {@link https://geoservices.ign.fr/documentation/geoservices/geocodage.html}\n */\nol.control.SearchGeoportail = function(options) {\n  options = options || {};\n  options.className = options.className || 'IGNF';\n  options.typing = options.typing || 500;\n  options.url = \"https://wxs.ign.fr/\"+options.apiKey+\"/ols/apis/completion\";\n  ol.control.SearchJSON.call(this, options);\n\tthis.set(\"copy\",\"<a href='https://www.geoportail.gouv.fr/' target='new'>&copy; IGN-Goportail</a>\");\n  this.set('type', options.type || 'StreetAddress,PositionOfInterest');\n};\nol.inherits(ol.control.SearchGeoportail, ol.control.SearchJSON);\n/** Returns the text to be displayed in the menu\n *\t@param {ol.Feature} f the feature\n *\t@return {string} the text to be displayed in the index\n *\t@api\n */\nol.control.SearchGeoportail.prototype.getTitle = function (f) {\n    var title = f.fulltext;\n    return (title);\n};\n/** \n * @param {string} s the search string\n * @return {Object} request data (as key:value)\n * @api\n */\nol.control.SearchGeoportail.prototype.requestData = function (s) {\n\treturn { \n        text: s, \n        type: this.get('type')==='Commune' ? 'PositionOfInterest' : this.get('type') || 'StreetAddress,PositionOfInterest', \n        maximumResponses: this.get('maxItems')\n    };\n};\n/**\n * Handle server response to pass the features array to the display list\n * @param {any} response server response\n * @return {Array<any>} an array of feature\n * @api\n */\nol.control.SearchGeoportail.prototype.handleResponse = function (response) {\n  var features = response.results;\n  if (this.get('type') === 'Commune') {\n    for (var i=features.length-1; i>=0; i--) {\n      if ( features[i].kind \n        && (features[i].classification>5 || features[i].kind==\"Dpartement\") ) {\n          features.splice(i,1);\n      }\n    }\n\t}\n\treturn features;\n};\n/** A ligne has been clicked in the menu > dispatch event\n *\t@param {any} f the feature, as passed in the autocomplete\n *\t@api\n */\nol.control.SearchGeoportail.prototype.select = function (f){\n  if (f.x || f.y) {\n    var c = [Number(f.x), Number(f.y)];\n    // Add coordinate to the event\n    try {\n        c = ol.proj.transform (c, 'EPSG:4326', this.getMap().getView().getProjection());\n    } catch(e) { /* ok */}\n    // Get insee commune ?\n    if (this.get('type')==='Commune') {\n      this.searchCommune(f, function () {\n        this.dispatchEvent({ type:\"select\", search:f, coordinate: c });\n      });\n    } else {\n      this.dispatchEvent({ type:\"select\", search:f, coordinate: c });\n    }\n  } else {\n    this.searchCommune(f);\n  }\n};\n/** Search if no position and get the INSEE code\n * @param {string} s le nom de la commune\n */\nol.control.SearchGeoportail.prototype.searchCommune = function (f, cback) {\n  var request = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>'\n\t+'<XLS xmlns:xls=\"http://www.opengis.net/xls\" xmlns:gml=\"http://www.opengis.net/gml\" xmlns=\"http://www.opengis.net/xls\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" version=\"1.2\" xsi:schemaLocation=\"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.2/olsAll.xsd\">'\n\t\t+'<RequestHeader/>'\n\t\t+'<Request requestID=\"1\" version=\"1.2\" methodName=\"LocationUtilityService\">'\n\t\t\t+'<GeocodeRequest returnFreeForm=\"false\">'\n\t\t\t\t+'<Address countryCode=\"PositionOfInterest\">'\n\t\t\t\t+'<freeFormAddress>'+f.fulltext+'+</freeFormAddress>'\n\t\t\t\t+'</Address>'\n\t\t\t+'</GeocodeRequest>'\n\t\t+'</Request>'\n\t+'</XLS>'\n  var url = this.get('url').replace('ols/apis/completion','geoportail/ols')+\"?xls=\"+encodeURIComponent(request);\n  this.ajax (url, function(resp) {\n    var xml = resp.response;\n    if (xml) {\n      xml = xml.replace(/\\n|\\r/g,'');\n      var p = (xml.replace(/.*<gml:pos>(.*)<\\/gml:pos>.*/, \"$1\")).split(' ');\n      f.x = Number(p[1]);\n      f.y = Number(p[0]);\n      f.kind = (xml.replace(/.*<Place type=\"Nature\">([^<]*)<\\/Place>.*/, \"$1\"));\n      f.insee = (xml.replace(/.*<Place type=\"INSEE\">([^<]*)<\\/Place>.*/, \"$1\"));\n      if (f.x || f.y) {\n        if (cback) cback.call(this, [f]);\n        else this._handleSelect(f);\n      }\n    }\n  });\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc OpenLayers 3 Layer Switcher Control.\n * @fires drawlist\n * \n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options\n *  @param {function} displayInLayerSwitcher function that takes a layer and return a boolean if the layer is displayed in the switcher, default test the displayInLayerSwitcher layer attribute\n *  @param {boolean} options.show_progress show a progress bar on tile layers, default false\n *  @param {boolean} mouseover show the panel on mouseover, default false\n *  @param {boolean} reordering allow layer reordering, default true\n *  @param {boolean} trash add a trash button to delete the layer, default false\n *  @param {function} oninfo callback on click on info button, if none no info button is shown DEPRECATED: use on(info) instead\n *  @param {boolean} extent add an extent button to zoom to the extent of the layer\n *  @param {function} onextent callback when click on extent, default fits view to extent\n *\n * Layers attributes that control the switcher\n *\t- allwaysOnTop {boolean} true to force layer stay on top of the others while reordering, default false\n *\t- displayInLayerSwitcher {boolean} display in switcher, default true\n *\t- noSwitcherDelete {boolean} to prevent layer deletion (w. trash option = true), default false\n */\nol.control.LayerSwitcher = function(options) {\n  options = options || {};\n  var self = this;\n  this.dcount = 0;\n  this.show_progress = options.show_progress;\n  this.oninfo = (typeof (options.oninfo) == \"function\" ? options.oninfo: null);\n  this.onextent = (typeof (options.onextent) == \"function\" ? options.onextent: null);\n  this.hasextent = options.extent || options.onextent;\n  this.hastrash = options.trash;\n  this.reordering = (options.reordering!==false);\n  this._layers = [];\n  // displayInLayerSwitcher\n  if (typeof(options.displayInLayerSwitcher) === 'function') {\n    this.displayInLayerSwitcher = options.displayInLayerSwitcher;\n  }\n  var element;\n  if (options.target) {\n    element = ol.ext.element.create('DIV', {\n      className: options.switcherClass || \"ol-layerswitcher\"\n    });\n  } else {\n    element = ol.ext.element.create('DIV', {\n      className: (options.switcherClass || \"ol-layerswitcher\") +' ol-unselectable ol-control ol-collapsed'\n    });\n    this.button = ol.ext.element.create('BUTTON', {\n      type: 'button',\n      parent: element\n    });\n    this.button.addEventListener('touchstart', function(e){\n      element.classList.toggle('ol-collapsed'); \n      e.preventDefault(); \n      self.overflow();\n    });\n    this.button.addEventListener('click', function(){\n      element.classList.toggle(\"ol-forceopen\");\n      element.classList.add(\"ol-collapsed\"); \n      self.overflow();\n    });\n    if (options.mouseover) {\n      element.addEventListener ('mouseleave', function(){ element.classList.add(\"ol-collapsed\"); });\n      element.addEventListener ('mouseover', function(){ element.classList.remove(\"ol-collapsed\"); });\n    }\n    this.topv = ol.ext.element.create('DIV', {\n      className: 'ol-switchertopdiv',\n      parent: element,\n      click: function() {\n        self.overflow(\"+50%\");\n      }\n    });\n    this.botv = ol.ext.element.create('DIV', {\n      className: 'ol-switcherbottomdiv',\n      parent: element,\n      click: function() {\n        self.overflow(\"-50%\");\n      }\n    });\n  }\n  this.panel_ = ol.ext.element.create ('UL', {\n    className: 'panel',\n    parent: element\n  });\n  ol.ext.element.addListener (this.panel_, 'mousewheel DOMMouseScroll onmousewheel', function(e) {\n    if (self.overflow(Math.max(-1, Math.min(1, (e.wheelDelta || -e.detail))))) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  });\n  this.header_ = ol.ext.element.create('LI', {\n    className: 'ol-header',\n    parent: this.panel_\n  });\n  ol.control.Control.call (this, {\n    element: element,\n    target: options.target\n  });\n};\nol.inherits(ol.control.LayerSwitcher, ol.control.Control);\n/** List of tips for internationalization purposes\n*/\nol.control.LayerSwitcher.prototype.tip = {\n  up: \"up/down\",\n  down: \"down\",\n  info: \"informations...\",\n  extent: \"zoom to extent\",\n  trash: \"remove layer\",\n  plus: \"expand/shrink\"\n};\n/** Test if a layer should be displayed in the switcher\n * @param {ol.layer} layer\n * @return {boolean} true if the layer is displayed\n */\nol.control.LayerSwitcher.prototype.displayInLayerSwitcher = function(layer) {\n  return (layer.get(\"displayInLayerSwitcher\")!==false);\n};\n/**\n * Set the map instance the control is associated with.\n * @param {_ol_Map_} map The map instance.\n */\nol.control.LayerSwitcher.prototype.setMap = function(map) {\n  ol.control.Control.prototype.setMap.call(this, map);\n  this.drawPanel();\n  if (this._listener) {\n    if (this._listener) ol.Observable.unByKey(this._listener.change);\n    if (this._listener) ol.Observable.unByKey(this._listener.moveend);\n    if (this._listener) ol.Observable.unByKey(this._listener.size);\n  }\n  this._listener = null;\n  // Get change (new layer added or removed)\n  if (map) {\n    this._listener = {\n      change: map.getLayerGroup().on('change', this.drawPanel.bind(this)),\n      moveend: map.on('moveend', this.viewChange.bind(this)),\n      size: map.on('change:size', this.overflow.bind(this))\n    }\n  }\n};\n/** Show control\n */\nol.control.LayerSwitcher.prototype.show = function() {\n  this.element.classList.add(\"ol-forceopen\");\n  this.overflow();\n};\n/** Hide control\n */\nol.control.LayerSwitcher.prototype.hide = function() {\n  this.element.classList.remove(\"ol-forceopen\");\n  this.overflow();\n};\n/** Toggle control\n */\nol.control.LayerSwitcher.prototype.toggle = function() {\n  this.element.classList.toggle(\"ol-forceopen\");\n  this.overflow();\n};\n/** Is control open\n * @return {boolean}\n */\nol.control.LayerSwitcher.prototype.isOpen = function() {\n  return this.element.classList.contains(\"ol-forceopen\");\n};\n/** Add a custom header\n * @param {Element|string} html content html\n */\nol.control.LayerSwitcher.prototype.setHeader = function(html) {\n  ol.ext.element.setHTML(this.header_, html);\n};\n/** Calculate overflow and add scrolls\n *\t@param {Number} dir scroll direction -1|0|1|'+50%'|'-50%'\n */\nol.control.LayerSwitcher.prototype.overflow = function(dir) {\t\n  if (this.button) {\n    // Nothing to show\n    if (ol.ext.element.hidden(this.panel_)) {\n      ol.ext.element.setStyle(this.element, { height: 'auto' });\n      return;\n    }\n    // Calculate offset\n    var h = ol.ext.element.outerHeight(this.element);\n    var hp = ol.ext.element.outerHeight(this.panel_);\n    var dh = this.button.offsetTop + ol.ext.element.outerHeight(this.button);\n    //var dh = this.button.position().top + this.button.outerHeight(true);\n    var top = this.panel_.offsetTop - dh;\n    if (hp > h-dh) {\n      // Bug IE: need to have an height defined\n      ol.ext.element.setStyle(this.element, { height: '100%' });\n      var lh = 2 * ol.ext.element.getStyle(this.panel_.querySelectorAll('li.visible .li-content')[0], 'height');\n      switch (dir) {\n        case 1: top += lh; break;\n        case -1: top -= lh; break;\n        case \"+50%\": top += Math.round(h/2); break;\n        case \"-50%\": top -= Math.round(h/2); break;\n        default: break;\n      }\n      // Scroll div\n      if (top+hp <= h-3*dh/2) {\n        top = h-3*dh/2-hp;\n        ol.ext.element.hide(this.botv);\n      } else {\n        ol.ext.element.show(this.botv);\n      }\n      if (top >= 0) {\n        top = 0;\n        ol.ext.element.hide(this.topv);\n      } else {\n        ol.ext.element.show(this.topv);\n      }\n      // Scroll ?\n      ol.ext.element.setStyle(this.panel_, { top: top+\"px\" });\n      return true;\n    } else {\n      ol.ext.element.setStyle(this.element, { height: \"auto\" });\n      ol.ext.element.setStyle(this.panel_, { top: 0 });\n      ol.ext.element.hide(this.botv);\n      ol.ext.element.hide(this.topv);\n      return false;\n    }\n  }\n  else return false;\n};\n/** Set the layer associated with a li\n * @param {Element} li\n * @param {ol.layer} layer\n */\nol.control.LayerSwitcher.prototype._setLayerForLI = function(li, layer) {\n  this._layers.push({ li:li, layer:layer });\n};\n/** Get the layer associated with a li\n * @param {Element} li\n * @return {ol.layer}\n */\nol.control.LayerSwitcher.prototype._getLayerForLI = function(li) {\n  for (var i=0, l; l=this._layers[i]; i++) {\n    if (l.li===li) return l.layer;\n  }\n  return null;\n};\n/**\n * On view change hide layer depending on resolution / extent\n * @private\n */\nol.control.LayerSwitcher.prototype.viewChange = function() {\n  var map = this.getMap();\n  var res = map.getView().getResolution();\n  this.panel_.querySelectorAll('li').forEach( function(li) {\n    var l = this._getLayerForLI(li);\n    if (l) {\n      if (l.getMaxResolution()<=res || l.getMinResolution()>=res) {\n        li.classList.add('ol-layer-hidden');\n      } else {\n        var ex0 = l.getExtent();\n        if (ex0) {\n          var ex = map.getView().calculateExtent(map.getSize());\n          if (!ol.extent.intersects(ex, ex0)) {\n            li.classList.add('ol-layer-hidden');\n          } else {\n            li.classList.remove('ol-layer-hidden');\n          }\n        } else {\n          li.classList.remove('ol-layer-hidden');\n        }\n      }\n    }\n  }.bind(this));\n};\n/**\n *\tDraw the panel control (prevent multiple draw due to layers manipulation on the map with a delay function)\n*/\nol.control.LayerSwitcher.prototype.drawPanel = function() {\n  if (!this.getMap()) return;\n  var self = this;\n  // Multiple event simultaneously / draw once => put drawing in the event queue\n  this.dcount++;\n  setTimeout (function(){ self.drawPanel_(); }, 0);\n};\n/** Delayed draw panel control \n * @private\n */\nol.control.LayerSwitcher.prototype.drawPanel_ = function() {\n  if (--this.dcount || this.dragging_) return;\n  // Remove existing layers\n  this._layers = [];\n  this.panel_.querySelectorAll('li').forEach (function(li) {\n    if (!li.classList.contains('ol-header')) li.remove();\n  }.bind(this));\n  // Draw list\n  this.drawList (this.panel_, this.getMap().getLayers());\n};\n/** Change layer visibility according to the baselayer option\n * @param {ol.layer}\n * @param {Array<ol.layer>} related layers\n */\nol.control.LayerSwitcher.prototype.switchLayerVisibility = function(l, layers) {\n  if (!l.get('baseLayer')) {\n    l.setVisible(!l.getVisible());\n  } else {\n    if (!l.getVisible()) l.setVisible(true);\n    layers.forEach(function(li) {\n      if (l!==li && li.get('baseLayer') && li.getVisible()) li.setVisible(false);\n    });\n  }\n};\n/** Check if layer is on the map (depending on zoom and extent)\n * @param {ol.layer}\n * @return {boolean}\n */\nol.control.LayerSwitcher.prototype.testLayerVisibility = function(layer) {\n  if (this.getMap())\n  {\tvar res = this.getMap().getView().getResolution();\n    if (layer.getMaxResolution()<=res || layer.getMinResolution()>=res) return false;\n    else \n    {\tvar ex0 = layer.getExtent();\n      if (ex0)\n      {\tvar ex = this.getMap().getView().calculateExtent(this.getMap().getSize());\n        return ol.extent.intersects(ex, ex0);\n      }\n      return true;\n    }\n  }\n  return true;\n};\n/** Start ordering the list\n*\t@param {event} e drag event\n*\t@private\n*/\nol.control.LayerSwitcher.prototype.dragOrdering_ = function(e) {\n  e.stopPropagation();\n  e.preventDefault();\n  // Get params\n  var self = this;\n  var elt = e.currentTarget.parentNode.parentNode;\n  var start = true;\n  var panel = this.panel_; \n  var pageY;\n  var pageY0 = e.pageY \n    || (e.touches && e.touches.length && e.touches[0].pageY) \n    || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY);\n  var target, dragElt;\n  var layer, group;\n  elt.parentNode.classList.add('drag');\n  // Stop ordering\n  function stop() {\n    if (target) {\n      // Get drag on parent\n      var drop = layer;\n      if (drop && target) {\n        var collection ;\n        if (group) collection = group.getLayers();\n        else collection = self.getMap().getLayers();\n        var layers = collection.getArray();\n        // Switch layers\n        for (var i=0; i<layers.length; i++) {\n          if (layers[i]==drop) {\n            collection.removeAt (i);\n            break;\n          }\n        }\n        for (var j=0; j<layers.length; j++) {\n          if (layers[j]==target) {\n            if (i>j) collection.insertAt (j,drop);\n            else collection.insertAt (j+1,drop);\n            break;\n          }\n        }\n      }\n    }\n    elt.parentNode.querySelectorAll('li').forEach(function(li){\n      li.classList.remove('dropover');\n      li.classList.remove('dropover-after');\n      li.classList.remove('dropover-before');\n    });\n    elt.classList.remove(\"drag\");\n    elt.parentNode.classList.remove(\"drag\");\n    self.element.classList.remove('drag');\n    if (dragElt) dragElt.remove();\n    ol.ext.element.removeListener(document, 'mousemove touchmove', move);\n    ol.ext.element.removeListener(document, 'mouseup touchend touchcancel', stop);\n  }\n  // Ordering\n  function move(e) {\n    // First drag (more than 2 px) => show drag element (ghost)\n    pageY = e.pageY \n        || (e.touches && e.touches.length && e.touches[0].pageY) \n        || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageY);\n    if (start && Math.abs(pageY0 - pageY) > 2) {\n      start = false;\n      elt.classList.add(\"drag\");\n      layer = self._getLayerForLI(elt);\n      target = false;\n      group = self._getLayerForLI(elt.parentNode.parentNode);\n      // Ghost div\n      dragElt = ol.ext.element.create('LI', { \n        className: 'ol-dragover',\n        html: elt.innerHTML,\n        style: { \n          position: \"absolute\", \n          \"z-index\": 10000, \n          left: elt.offsetLeft, \n          opacity: 0.5,\n          width: ol.ext.element.outerWidth(elt),\n          height: ol.ext.element.getStyle(elt,'height'),\n        },\n        parent: panel \n      });\n      self.element.classList.add('drag');\n    }\n    // Start a new drag sequence\n    if (!start) {\n      e.preventDefault();\n      e.stopPropagation();\n      // Ghost div\n      ol.ext.element.setStyle(dragElt, { top: pageY - ol.ext.element.offsetRect(panel).top + panel.scrollTop +5 });\n      var li;\n      if (!e.touches) {\n        li = e.target;\n      } else {\n        li = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY);\n      }\n      if (li.classList.contains(\"ol-switcherbottomdiv\")) {\n        self.overflow(-1);\n      } else if (li.classList.contains(\"ol-switchertopdiv\")) {\n        self.overflow(1);\n      }\n      // Get associated li\n      while (li && li.tagName!=='LI') {\n        li = li.parentNode;\n      }\n      if (!li || !li.classList.contains('dropover')) {\n        elt.parentNode.querySelectorAll('li').forEach(function(li) {\n          li.classList.remove('dropover');\n          li.classList.remove('dropover-after');\n          li.classList.remove('dropover-before');\n        });\n      }\n      if (li && li.parentNode.classList.contains('drag') && li !== elt) {\n        target = self._getLayerForLI(li);\n        // Don't mix layer level\n        if (target && !target.get('allwaysOnTop') == !layer.get('allwaysOnTop')) {\n          li.classList.add(\"dropover\");\n          li.classList.add((elt.offsetTop < li.offsetTop) ? 'dropover-after' : 'dropover-before');\n        } else {\n          target = false;\n        }\n        ol.ext.element.show(dragElt);\n      } else {\n        target = false;\n        if (li===elt) ol.ext.element.hide(dragElt);\n        else ol.ext.element.show(dragElt);\n      }\n      if (!target) dragElt.classList.add(\"forbidden\");\n      else dragElt.classList.remove(\"forbidden\");\n    }\n  }\n  // Start ordering\n  ol.ext.element.addListener(document, 'mousemove touchmove', move);\n  ol.ext.element.addListener(document, 'mouseup touchend touchcancel', stop);\n};\n/** Change opacity on drag \n*\t@param {event} e drag event\n*\t@private\n*/\nol.control.LayerSwitcher.prototype.dragOpacity_ = function(e) {\n  e.stopPropagation();\n  e.preventDefault();\n  var self = this\n  // Register start params\n  var elt = e.target;\n  var layer = this._getLayerForLI(elt.parentNode.parentNode.parentNode);\n  if (!layer) return;\n  var x = e.pageX \n    || (e.touches && e.touches.length && e.touches[0].pageX) \n    || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX);\n  var start = ol.ext.element.getStyle (elt, 'left') - x;\n  self.dragging_ = true;\n  // stop dragging\n  function stop() {\n    ol.ext.element.removeListener(document, \"mouseup touchend touchcancel\", stop);\n    ol.ext.element.removeListener(document, \"mousemove touchmove\", move);\n    self.dragging_ = false;\n  }\n  // On draggin\n  function move(e) {\n    var x = e.pageX \n      || (e.touches && e.touches.length && e.touches[0].pageX) \n      || (e.changedTouches && e.changedTouches.length && e.changedTouches[0].pageX);\n    var delta = (start + x) / ol.ext.element.getStyle(elt.parentNode, 'width');\n    var opacity = Math.max (0, Math.min(1, delta));\n    ol.ext.element.setStyle (elt, { left: (opacity*100) + \"%\" });\n    elt.parentNode.nextElementSibling.innerHTML = Math.round(opacity*100);\n    layer.setOpacity(opacity);\n  }\n  // Register move\n  ol.ext.element.addListener(document, \"mouseup touchend touchcancel\", stop);\n  ol.ext.element.addListener(document, \"mousemove touchmove\", move);\n};\n/** Render a list of layer\n * @param {Elemen} element to render\n * @layers {Array{ol.layer}} list of layer to show\n * @api stable\n */\nol.control.LayerSwitcher.prototype.drawList = function(ul, collection) {\n  var self = this;\n  var layers = collection.getArray();\n  // Change layer visibility\n  var setVisibility = function(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    var l = self._getLayerForLI(this.parentNode.parentNode);\n    self.switchLayerVisibility(l, collection);\n  };\n  // Info button click\n  function onInfo(e) {\n    e.stopPropagation();\n    e.preventDefault(); \n    var l = self._getLayerForLI(this.parentNode.parentNode);\n    self.oninfo(l); \n    self.dispatchEvent({ type: \"info\", layer: l });\n  }\n  // Zoom to extent button\n  function zoomExtent(e) {\n    e.stopPropagation();\n    e.preventDefault(); \n    var l = self._getLayerForLI(this.parentNode.parentNode);\n    if (self.onextent) self.onextent(l); \n    else self.getMap().getView().fit (l.getExtent(), self.getMap().getSize()); \n    self.dispatchEvent({ type: \"extent\", layer: l });\n  }\n  // Remove a layer on trash click\n  function removeLayer(e) {\n    e.stopPropagation();\n    e.preventDefault();\n    var li = this.parentNode.parentNode.parentNode.parentNode;\n    var layer, group = self._getLayerForLI(li);\n    // Remove the layer from a group or from a map\n    if (group) {\n      layer = self._getLayerForLI(this.parentNode.parentNode);\n      group.getLayers().remove(layer);\n      if (group.getLayers().getLength()==0 && !group.get('noSwitcherDelete')) {\n        removeLayer.call(li.querySelectorAll('.layerTrash')[0], e);\n      }\n    } else {\n      li = this.parentNode.parentNode;\n      self.getMap().removeLayer(self._getLayerForLI(li));\n    }\n  }\n  // Add the layer list\n  for (var i=layers.length-1; i>=0; i--) {\n    var layer = layers[i];\n    if (!self.displayInLayerSwitcher(layer)) continue;\n    var li = ol.ext.element.create('LI', {\n      className: (layer.getVisible()?\"visible \":\" \")+(layer.get('baseLayer')?\"baselayer\":\"\"),\n      parent: ul\n    });\n    this._setLayerForLI(li, layer);\n    var layer_buttons = ol.ext.element.create('DIV', {\n      className: 'ol-layerswitcher-buttons',\n      parent: li\n    });\n    // Content div\n    var d = ol.ext.element.create('DIV', {\n      className: 'li-content' + (this.testLayerVisibility(layer) ? '' : ' ol-layer-hidden'),\n      parent: li\n    });\n    // Visibility\n    ol.ext.element.create('INPUT', {\n      type: layer.get('baseLayer') ? 'radio' : 'checkbox',\n      checked: layer.getVisible(),\n      click: setVisibility,\n      parent: d\n    });\n    // Label\n    ol.ext.element.create('LABEL', {\n      html: layer.get(\"title\") || layer.get(\"name\"),\n      title: layer.get(\"title\") || layer.get(\"name\"),\n      click: setVisibility,\n      unselectable: 'on',\n      style: {\n        userSelect: 'none'\n      },\n      parent: d\n    }).addEventListener('selectstart', function(){ return false; });\n    //  up/down\n    if (this.reordering) {\n      if ( (i<layers.length-1 && (layer.get(\"allwaysOnTop\") || !layers[i+1].get(\"allwaysOnTop\")) )\n      || (i>0 && (!layer.get(\"allwaysOnTop\") || layers[i-1].get(\"allwaysOnTop\")) ) ) {\n        ol.ext.element.create('DIV', {\n          className: 'layerup',\n          title: this.tip.up,\n          on: { 'mousedown touchstart': function(e) { self.dragOrdering_(e) } },\n          parent: layer_buttons\n        });\n      }\n    }\n    // Show/hide sub layers\n    if (layer.getLayers) {\n      var nb = 0;\n      layer.getLayers().forEach(function(l) {\n        if (self.displayInLayerSwitcher(l)) nb++;\n      });\n      if (nb) {\n        ol.ext.element.create('DIV', {\n          className: layer.get(\"openInLayerSwitcher\") ? \"collapse-layers\" : \"expend-layers\",\n          title: this.tip.plus,\n          click: function() {\n            var l = self._getLayerForLI(this.parentNode.parentNode);\n            l.set(\"openInLayerSwitcher\", !l.get(\"openInLayerSwitcher\") )\n          },\n          parent: layer_buttons\n        });\n      }\n    }\n    // Info button\n    if (this.oninfo) {\n      ol.ext.element.create('DIV', {\n        className: 'layerInfo',\n        title: this.tip.info,\n        click: onInfo,\n        parent: layer_buttons\n      });\n    }\n    // Layer remove\n    if (this.hastrash && !layer.get(\"noSwitcherDelete\")) {\n      ol.ext.element.create('DIV', {\n        className: 'layerTrash',\n        title: this.tip.trash,\n        click: removeLayer,\n        parent: layer_buttons\n      });\n    }\n    // Layer extent\n    if (this.hasextent && layers[i].getExtent()) {\n      var ex = layers[i].getExtent();\n      if (ex.length==4 && ex[0]<ex[2] && ex[1]<ex[3]) {\n        ol.ext.element.create('DIV', {\n          className: 'layerExtent',\n          title: this.tip.extent,\n          click: zoomExtent,\n          parent: layer_buttons  \n        });\n      }\n    }\n    // Progress\n    if (this.show_progress && layer instanceof ol.layer.Tile) {\n      var p = ol.ext.element.create('DIV', {\n        className: 'layerswitcher-progress',\n        parent: d\n      });\n      this.setprogress_(layer);\n      layer.layerswitcher_progress = ol.ext.element.create('DIV', { parent: p });\n    }\n    // Opacity\n    var opacity = ol.ext.element.create('DIV', {\n      className: 'layerswitcher-opacity',\n      // Click on the opacity line\n      click: function(e){\n        if (e.target !== this) return;\n        e.stopPropagation();\n        e.preventDefault();\n        var op = Math.max ( 0, Math.min( 1, e.offsetX / ol.ext.element.getStyle(this, 'width')));\n        self._getLayerForLI(this.parentNode.parentNode).setOpacity(op);\n      },\n      parent: d\n    });\n    // Start dragging\n    ol.ext.element.create('DIV', {\n      className: 'layerswitcher-opacity-cursor',\n      style: { left: (layer.getOpacity()*100)+\"%\" },\n      on: {\n        'mousedown touchstart': function(e) { self.dragOpacity_ (e); }\n      },\n      parent: opacity\n    });\n    // Percent\n    ol.ext.element.create('DIV', {\n      className: 'layerswitcher-opacity-label',\n      html: Math.round(layer.getOpacity()*100),\n      parent: d\n    });\n    // Layer group\n    if (layer.getLayers) {\n      li.classList.add('ol-layer-group');\n      if (layer.get(\"openInLayerSwitcher\") === true) {\n        var ul2 = ol.ext.element.create('UL', {\n          parent: li\n        });\n        this.drawList (ul2, layer.getLayers());\n      }\n    }\n    else if (layer instanceof ol.layer.Vector) li.classList.add('ol-layer-vector');\n    else if (layer instanceof ol.layer.VectorTile) li.classList.add('ol-layer-vector');\n    else if (layer instanceof ol.layer.Tile) li.classList.add('ol-layer-tile');\n    else if (layer instanceof ol.layer.Image) li.classList.add('ol-layer-image');\n    else if (layer instanceof ol.layer.Heatmap) li.classList.add('ol-layer-heatmap');\n    // Dispatch a dralist event to allow customisation\n    this.dispatchEvent({ type:'drawlist', layer:layer, li:li });\n  }\n  this.viewChange();\n  if (ul === this.panel_) this.overflow();\n};\n/** Handle progress bar for a layer\n*\t@private\n*/\nol.control.LayerSwitcher.prototype.setprogress_ = function(layer) {\n  if (!layer.layerswitcher_progress) {\n    var loaded = 0;\n    var loading = 0;\n    var draw = function() {\n      if (loading === loaded) {\n        loading = loaded = 0;\n        ol.ext.element.setStyle(layer.layerswitcher_progress, { width: 0 });// layer.layerswitcher_progress.width(0);\n      } else {\n        ol.ext.element.setStyle(layer.layerswitcher_progress, { width: (loaded / loading * 100).toFixed(1) + '%' });// layer.layerswitcher_progress.css('width', (loaded / loading * 100).toFixed(1) + '%');\n      }\n    }\n    layer.getSource().on('tileloadstart', function() {\n      loading++;\n      draw();\n    });\n    layer.getSource().on('tileloadend', function() {\n      loaded++;\n      draw();\n    });\n    layer.getSource().on('tileloaderror', function() {\n      loaded++;\n      draw();\n    });\n  }\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Control bar for OL3\n * The control bar is a container for other controls. It can be used to create toolbars.\n * Control bars can be nested and combined with ol.control.Toggle to handle activate/deactivate.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {bool} options.group is a group, default false\n *\t@param {bool} options.toggleOne only one toggle control is active at a time, default false\n *\t@param {bool} options.autoDeactivate used with subbar to deactivate all control when top level control deactivate, default false\n *\t@param {Array<_ol_control_>} options.controls a list of control to add to the bar\n */\nol.control.Bar = function(options) {\n  if (!options) options={};\n\tvar element = document.createElement(\"div\");\n      element.classList.add('ol-unselectable', 'ol-control', 'ol-bar');\n\tif (options.className) {\n\t\tvar classes = options.className.split(' ').filter(function(className) {\n\t\t\treturn className.length > 0;\n\t\t});\n\t\telement.classList.add.apply(element.classList, classes)\n\t}\n\tif (options.group) element.classList.add('ol-group');\n\tol.control.Control.call(this, {\n    element: element,\n\t\ttarget: options.target\n\t});\n\tthis.set('toggleOne', options.toggleOne);\n\tthis.set('autoDeactivate', options.autoDeactivate);\n\tthis.controls_ = [];\n\tif (options.controls instanceof Array) {\n    for (var i=0; i<options.controls.length; i++) {\n      this.addControl(options.controls[i]);\n\t\t}\n\t}\n};\nol.inherits(ol.control.Bar, ol.control.Control);\n/** Set the control visibility\n* @param {boolean} b\n*/\nol.control.Bar.prototype.setVisible = function (val) {\n\tif (val) this.element.style.display = '';\n\telse this.element.style.display = 'none';\n}\n/** Get the control visibility\n* @return {boolean} b\n*/\nol.control.Bar.prototype.getVisible = function () {\n  return this.element.style.display != 'none';\n}\n/**\n * Set the map instance the control is associated with\n * and add its controls associated to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol.control.Bar.prototype.setMap = function (map) {\n  ol.control.Control.prototype.setMap.call(this, map);\n\tfor (var i=0; i<this.controls_.length; i++) {\n    var c = this.controls_[i];\n\t\t// map.addControl(c);\n\t\tc.setMap(map);\n\t}\n};\n/** Get controls in the panel\n*\t@param {Array<_ol_control_>}\n*/\nol.control.Bar.prototype.getControls = function () {\n  return this.controls_;\n};\n/** Set tool bar position\n*\t@param {top|left|bottom|right} pos\n*/\nol.control.Bar.prototype.setPosition = function (pos) {\n  this.element.classList.remove('ol-left', 'ol-top', 'ol-bottom', 'ol-right');\n\tpos=pos.split ('-');\n\tfor (var i=0; i<pos.length; i++) {\n    switch (pos[i]) {\n      case 'top':\n\t\t\tcase 'left':\n\t\t\tcase 'bottom':\n\t\t\tcase 'right':\n\t\t\t\tthis.element.classList.add(\"ol-\"+pos[i]);\n\t\t\t\tbreak;\n\t\t\tdefault: break;\n\t\t}\n\t}\n};\n/** Add a control to the bar\n*\t@param {_ol_control_} c control to add\n*/\nol.control.Bar.prototype.addControl = function (c) {\n  this.controls_.push(c);\n\tc.setTarget(this.element);\n\tif (this.getMap()) {\n    this.getMap().addControl(c);\n\t}\n\t// Activate and toogleOne\n\tc.on ('change:active', this.onActivateControl_.bind(this));\n\tif (c.getActive && c.getActive()) {\n    c.dispatchEvent({ type:'change:active', key:'active', oldValue:false, active:true });\n\t}\n};\n/** Deativate all controls in a bar\n* @param {_ol_control_} except a control\n*/\nol.control.Bar.prototype.deactivateControls = function (except) {\n  for (var i=0; i<this.controls_.length; i++) {\n  if (this.controls_[i] !== except && this.controls_[i].setActive) {\n    this.controls_[i].setActive(false);\n\t\t}\n\t}\n};\nol.control.Bar.prototype.getActiveControls = function () {\n  var active = [];\n\tfor (var i=0, c; c=this.controls_[i]; i++) {\n    if (c.getActive && c.getActive()) active.push(c);\n\t}\n\treturn active;\n}\n/** Auto activate/deactivate controls in the bar\n* @param {boolean} b activate/deactivate\n*/\nol.control.Bar.prototype.setActive = function (b) {\n  if (!b && this.get(\"autoDeactivate\")) {\n    this.deactivateControls();\n\t}\n\tif (b) {\n    var ctrls = this.getControls();\n\t\tfor (var i=0, sb; (sb = ctrls[i]); i++) {\n      if (sb.get(\"autoActivate\")) sb.setActive(true);\n\t\t}\n\t}\n}\n/** Post-process an activated/deactivated control\n*\t@param {ol.event} e :an object with a target {_ol_control_} and active flag {bool}\n*/\nol.control.Bar.prototype.onActivateControl_ = function (e) {\n\tif (this.get('toggleOne')) {\n    if (e.active) {\n      var n;\n\t\t\tvar ctrl = e.target;\n\t\t\tfor (n=0; n<this.controls_.length; n++) {\n        if (this.controls_[n]===ctrl) break;\n\t\t\t}\n\t\t\t// Not here!\n\t\t\tif (n==this.controls_.length) return;\n\t\t\tthis.deactivateControls (this.controls_[n]);\n\t\t} else {\n      // No one active > test auto activate\n\t\t\tif (!this.getActiveControls().length) {\n        for (var i=0, c; c=this.controls_[i]; i++) {\n          if (c.get(\"autoActivate\")) {\n            c.setActive(true);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n};\n/**\n * @param {string} name of the control to search\n * @return {ol.control.Control}\n */\nol.control.Bar.prototype.getControlsByName = function(name) {\n\tvar controls = this.getControls();\n\treturn controls.filter(\n\t\tfunction(control) {\n\t\t\treturn (control.get('name') === name);\n\t\t}\n\t);\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A simple push button control\n* @constructor\n* @extends {ol.control.Control}\n* @param {Object=} options Control options.\n*\t@param {String} options.className class of the control\n*\t@param {String} options.title title of the control\n*\t@param {String} options.name an optional name, default none\n*\t@param {String} options.html html to insert in the control\n*\t@param {function} options.handleClick callback when control is clicked (or use change:active event)\n*/\nol.control.Button = function(options)\n{\toptions = options || {};\n\tvar element = document.createElement(\"div\");\n\telement.className = (options.className || '') + \" ol-button ol-unselectable ol-control\";\n\tvar self = this;\n\tvar bt = this.button_ = document.createElement(/ol-text-button/.test(options.className) ? \"div\": \"button\");\n\tbt.type = \"button\";\n\tif (options.title) bt.title = options.title;\n\tif (options.html instanceof Element) bt.appendChild(options.html)\n\telse bt.innerHTML = options.html || \"\";\n\tvar evtFunction = function(e) {\n\t\tif (e && e.preventDefault) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t}\n\t\tif (options.handleClick) {\n\t\t\toptions.handleClick.call(self, e);\n\t\t}\n\t};\n\tbt.addEventListener(\"click\", evtFunction);\n\tbt.addEventListener(\"touchstart\", evtFunction);\n\telement.appendChild(bt);\n\t// Try to get a title in the button content\n\tif (!options.title && bt.firstElementChild) {\n\t\tbt.title = bt.firstElementChild.title;\n\t}\n\tol.control.Control.call(this,\n\t{\telement: element,\n\t\ttarget: options.target\n\t});\n\tif (options.title) {\n\t\tthis.set(\"title\", options.title);\n\t}\n\tif (options.title) this.set(\"title\", options.title);\n\tif (options.name) this.set(\"name\", options.name);\n};\nol.inherits(ol.control.Button, ol.control.Control);\n/** Set the control visibility\n* @param {boolean} b \n*/\nol.control.Button.prototype.setVisible = function (val) {\n\tif (val) ol.ext.element.show(this.element);\n\telse ol.ext.element.hide(this.element);\n}\n/**\n * Set the button title\n * @param {string} title\n * @returns {undefined}\n */\nol.control.Button.prototype.setTitle = function(title) {\n    this.button_.setAttribute('title', title);\n};\n/**\n * Set the button html\n * @param {string} html\n * @returns {undefined}\n */\nol.control.Button.prototype.setHtml = function(html) {\n\tol.ext.element.setHTML (this.button_, html);\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc \n *   OpenLayers 3 Attribution Control integrated in the canvas (for jpeg/png \n * @see http://www.kreidefossilien.de/webgis/dokumentation/beispiele/export-map-to-png-with-scale\n *\n * @constructor\n * @extends {ol.control.Attribution}\n * @param {Object=} options extend the ol.control.Attribution options.\n * \t@param {ol.style.Style} options.style  option is usesd to draw the text.\n */\nol.control.CanvasAttribution = function(options)\n{\tif (!options) options = {};\n\tol.control.Attribution.call(this, options);\n\t// Draw in canvas\n\tthis.isCanvas_ = !!options.canvas;\n\t// Get style options\n\tif (!options) options={};\n\tif (!options.style) options.style = new ol.style.Style();\n\tthis.setStyle (options.style);\n}\nol.inherits(ol.control.CanvasAttribution, ol.control.Attribution);\n/**\n * Draw attribution on canvas\n * @param {boolean} b draw the attribution on canvas.\n */\nol.control.CanvasAttribution.prototype.setCanvas = function (b)\n{\tthis.isCanvas_ = b;\n\tthis.element.style.visibility = b ? \"hidden\":\"visible\";\n\tif (this.map_) this.map_.renderSync();\n};\n/**\n * Change the control style\n * @param {ol.style.Style} style\n */\nol.control.CanvasAttribution.prototype.setStyle = function (style)\n{\tvar text = style.getText();\n\tthis.font_ = text ? text.getFont() : \"10px Arial\";\n\tvar stroke = text ? text.getStroke() : null;\n\tvar fill = text ? text.getFill() : null;\n\tthis.fontStrokeStyle_ = stroke ? ol.color.asString(stroke.getColor()) : \"#fff\";\n\tthis.fontFillStyle_ = fill ? ol.color.asString(fill.getColor()) : \"#000\";\n\tthis.fontStrokeWidth_ = stroke ? stroke.getWidth() : 3;\n\tif (this.getMap()) this.getMap().render();\n};\n/**\n * Remove the control from its current map and attach it to the new map.\n * Subclasses may set up event handlers to get notified about changes to\n * the map here.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.control.CanvasAttribution.prototype.setMap = function (map)\n{\tvar oldmap = this.getMap();\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.control.ScaleLine.prototype.setMap.call(this, map);\n\tif (oldmap) oldmap.renderSync();\n\t// Get change (new layer added or removed)\n\tif (map) {\n\t\tthis._listener = map.on('postcompose', this.drawAttribution_.bind(this));\n\t}\n\tthis.map_ = map;\n\tthis.setCanvas (this.isCanvas_);\n};\n/** \n * Draw attribution in the final canvas\n * @private\n */\nol.control.CanvasAttribution.prototype.drawAttribution_ = function(e)\n{\tvar ctx = e.context;\n\tif (!this.isCanvas_) return;\n\tvar text = \"\";\n\tArray.prototype.slice.call(this.element.querySelectorAll('li'))\n\t\t.filter(function(el) {\n\t\t\treturn el.style.display !== \"none\";\n\t\t})\n\t\t.map(function(el) {\n\t\t\ttext += (text ? \" - \":\"\") + el.textContent;\n\t\t});\n\t// Get size of the scale div\n\tvar position = {left: this.element.offsetLeft, top: this.element.offsetTop};\n\t// Retina device\n\tvar ratio = e.frameState.pixelRatio;\n\tctx.save();\n\tctx.scale(ratio,ratio);\n\t// Position if transform:scale()\n\tvar container = this.getMap().getTargetElement();\n\tvar scx = container.offsetWidth / container.getBoundingClientRect().width;\n\tvar scy = container.offsetHeight / container.getBoundingClientRect().height;\n\tposition.left *= scx;\n\tposition.top *= scy;\n\tposition.right = position.left + this.element.offsetWidth;\n\tposition.bottom = position.top + this.element.offsetHeight;\n\t// Draw scale text\n\tctx.beginPath();\n\t\tctx.strokeStyle = this.fontStrokeStyle_;\n\t\tctx.fillStyle = this.fontFillStyle_;\n\t\tctx.lineWidth = this.fontStrokeWidth_;\n\t\tctx.textAlign = \"right\";\n\tctx.textBaseline =\"bottom\";\n\t\tctx.font = this.font_;\n\tctx.strokeText(text, position.right, position.bottom);\n\t\tctx.fillText(text, position.right, position.bottom);\n\tctx.closePath();\n\tctx.restore();\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc \n *    OpenLayers 3 Scale Line Control integrated in the canvas (for jpeg/png \n * @see http://www.kreidefossilien.de/webgis/dokumentation/beispiele/export-map-to-png-with-scale\n *\n * @constructor\n * @extends {ol.control.ScaleLine}\n * @param {Object=} options extend the ol.control.ScaleLine options.\n * \t@param {ol.style.Style} options.style used to draw the scale line (default is black/white, 10px Arial).\n */\nol.control.CanvasScaleLine = function(options)\n{\tol.control.ScaleLine.call(this, options);\n\tthis.scaleHeight_ = 6;\n\t// Get style options\n\tif (!options) options={};\n\tif (!options.style) options.style = new ol.style.Style();\n\tthis.setStyle(options.style);\n}\nol.inherits(ol.control.CanvasScaleLine, ol.control.ScaleLine);\n/**\n * Remove the control from its current map and attach it to the new map.\n * Subclasses may set up event handlers to get notified about changes to\n * the map here.\n * @param {_ol_Map_} map Map.\n * @api stable\n */\nol.control.CanvasScaleLine.prototype.setMap = function (map)\n{\tvar oldmap = this.getMap();\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.control.ScaleLine.prototype.setMap.call(this, map);\n\tif (oldmap) oldmap.renderSync();\n\t// Add postcompose on the map\n\tif (map) {\n\t\tthis._listener = map.on('postcompose', this.drawScale_.bind(this));\n\t} \n\t// Hide the default DOM element\n\tthis.element.style.visibility = 'hidden';\n\tthis.olscale = this.element.querySelector(\".ol-scale-line-inner\");\n}\n/**\n * Change the control style\n * @param {_ol_style_Style_} style\n */\nol.control.CanvasScaleLine.prototype.setStyle = function (style)\n{\tvar stroke = style.getStroke();\n\tthis.strokeStyle_ = stroke ? ol.color.asString(stroke.getColor()) : \"#000\";\n\tthis.strokeWidth_ = stroke ? stroke.getWidth() : 2;\n\tvar fill = style.getFill();\n\tthis.fillStyle_ = fill ? ol.color.asString(fill.getColor()) : \"#fff\";\n\tvar text = style.getText();\n\tthis.font_ = text ? text.getFont() : \"10px Arial\";\n\tstroke = text ? text.getStroke() : null;\n\tfill = text ? text.getFill() : null;\n\tthis.fontStrokeStyle_ = stroke ? ol.color.asString(stroke.getColor()) : this.fillStyle_;\n\tthis.fontStrokeWidth_ = stroke ? stroke.getWidth() : 3;\n\tthis.fontFillStyle_ = fill ? ol.color.asString(fill.getColor()) : this.strokeStyle_;\n\t// refresh\n\tif (this.getMap()) this.getMap().render();\n}\n/** \n * Draw attribution in the final canvas\n * @private\n */\nol.control.CanvasScaleLine.prototype.drawScale_ = function(e)\n{\tif ( this.element.style.visibility!==\"hidden\" ) return;\n\tvar ctx = e.context;\n\t// Get size of the scale div\n\tvar scalewidth = parseInt(this.olscale.style.width);\n\tif (!scalewidth) return;\n\tvar text = this.olscale.textContent;\n\tvar position = {left: this.element.offsetLeft, top: this.element.offsetTop};\n\t// Retina device\n\tvar ratio = e.frameState.pixelRatio;\n\tctx.save();\n\tctx.scale(ratio,ratio);\n/*\n\t// Position if transform:scale()\n\tvar container = this.getMap().getTargetElement();\n\tvar scx = container.offsetWidth / container.getBoundingClientRect().width;\n\tvar scy = container.offsetHeight / container.getBoundingClientRect().height;\n\tposition.left *= scx;\n\tposition.top *= scy;\n*/\n\t// On top\n\tposition.top += this.element.clientHeight - this.scaleHeight_;\n\t// Draw scale text\n\tctx.beginPath();\n    ctx.strokeStyle = this.fontStrokeStyle_;\n    ctx.fillStyle = this.fontFillStyle_;\n    ctx.lineWidth = this.fontStrokeWidth_;\n    ctx.textAlign = \"center\";\n\tctx.textBaseline =\"bottom\";\n    ctx.font = this.font_;\n\tctx.strokeText(text, position.left+scalewidth/2, position.top);\n    ctx.fillText(text, position.left+scalewidth/2, position.top);\n\tctx.closePath();\n\t// Draw scale bar\n\tposition.top += 2;\n\tctx.lineWidth = this.strokeWidth_;\n\tctx.strokeStyle = this.strokeStyle_;\n\tvar max = 4;\n\tvar n = parseInt(text);\n\twhile (n%10 === 0) n/=10;\n\tif (n%5 === 0) max = 5;\n\tfor (var i=0; i<max; i++)\n\t{\tctx.beginPath();\n\t\tctx.fillStyle = i%2 ? this.fillStyle_ : this.strokeStyle_;\n\t\tctx.rect(position.left+i*scalewidth/max, position.top, scalewidth/max, this.scaleHeight_);\n\t\tctx.stroke();\n\t\tctx.fill();\n\t\tctx.closePath();\n\t}\n\tctx.restore();\n}\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * OpenLayers 3 Title Control integrated in the canvas (for jpeg/png \n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options extend the ol.control options. \n * \t@param {ol.style.Style} options.style style usesd to draw the title.\n */\nol.control.CanvasTitle = function(options)\n{\tif (!options) options={};\n\t// Get style options\n\tif (!options.style) options.style = new ol.style.Style();\n\tthis.setStyle(options.style);\n\t// Initialize parent\n\tvar elt = document.createElement('div');\n\telt.textContent = this.text_;\n\telt.className = 'ol-title ol-unselectable';\n\tvar css = {\n\t\tfont: this.font_,\n\t\tposition: 'absolute',\n\t\ttop:0,\n\t\tleft:0,\n\t\tright:0,\n\t\tdisplay: 'block',\n\t\tvisibility: 'hidden'\n\t};\n\tObject.keys(css).forEach(function(key) {\n\t\telt.style[key] = css[key];\n\t});\n\tol.control.Control.call(this,\n\t{\telement: elt,\n\t\ttarget: options.target\n\t});\n}\nol.inherits(ol.control.CanvasTitle, ol.control.Control);\n/**\n * Remove the control from its current map and attach it to the new map.\n * Subclasses may set up event handlers to get notified about changes to\n * the map here.\n * @param {_ol_Map_} map Map.\n * @api stable\n */\nol.control.CanvasTitle.prototype.setMap = function (map)\n{\tvar oldmap = this.getMap();\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.control.Control.prototype.setMap.call(this, map);\n\tif (oldmap) oldmap.renderSync();\n\t// Get change (new layer added or removed)\n\tif (map) {\n\t\tthis._listener = map.on('postcompose', this.drawTitle_.bind(this));\n\t}\n}\n/**\n * Change the control style\n * @param {ol.style.Style} style\n */\nol.control.CanvasTitle.prototype.setStyle = function (style)\n{\tvar text = style.getText();\n\tthis.font_ = text ? text.getFont() || \"20px Arial\" : \"20px Arial\";\n\tthis.text_ = text ? text.getText() : \"\";\n\tvar stroke = text ? text.getStroke() : null;\n\tvar fill = text ? text.getFill() : null;\n\tthis.strokeStyle_ = stroke ? ol.color.asString(stroke.getColor()) : \"#fff\";\n\tthis.fillStyle_ = fill ? ol.color.asString(fill.getColor()) : \"#000\";\n\tif (this.element) \n\t{\tthis.element.textContent = this.text_;\n\t\tthis.element.style.font = this.font_;\n\t}\n\t// refresh\n\tif (this.getMap()) this.getMap().render();\n}\n/**\n * Set the map title \n * @param {string} map title.\n * @api stable\n */\nol.control.CanvasTitle.prototype.setTitle = function (title)\n{\tthis.text_ = title;\n\tthis.element.textContent = this.text_;\n\tif (this.getMap()) this.getMap().renderSync();\n}\n/**\n * Get the map title \n * @param {string} map title.\n * @api stable\n */\nol.control.CanvasTitle.prototype.getTitle = function ()\n{\treturn this.text_;\n}\n/**\n * Set control visibility\n * @param {bool} b\n * @api stable\n */\nol.control.CanvasTitle.prototype.setVisible = function (b)\n{\tif (b) this.element.style.display = '';\n\telse this.element.style.display = 'none';\n\tif (this.getMap()) this.getMap().renderSync();\n}\n/**\n * Get control visibility\n * @return {bool} \n * @api stable\n */\nol.control.CanvasTitle.prototype.getVisible = function ()\n{\treturn this.element.style.display !== 'none';\n}\n/** Draw scale line in the final canvas\n*/\nol.control.CanvasTitle.prototype.drawTitle_ = function(e)\n{\tif (!this.getVisible()) return;\n\tvar ctx = e.context;\n\t// Retina device\n\tvar ratio = e.frameState.pixelRatio;\n\tctx.save();\n\tctx.scale(ratio,ratio);\n\tvar w = ctx.canvas.width/ratio;\n\tvar h = this.element.clientHeight;\n\tvar position = { top:0, left:w/2 };\n\tctx.beginPath();\n\tctx.fillStyle = this.strokeStyle_;\n\tctx.rect(0,0, w, h);\n\tctx.fill();\n\tctx.closePath();\n\tctx.beginPath();\n\tctx.fillStyle = this.fillStyle_;\n\tctx.textAlign = \"center\";\n\tctx.textBaseline = \"middle\";\n\tctx.font = this.font_;\n\tctx.fillText(this.text_, position.left, position.top +h/2);\n\tctx.closePath();\n\tctx.restore();\n}\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Draw a compass on the map. The position/size of the control is defined in the css.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options Control options. The style {_ol_style_Stroke_} option is usesd to draw the text.\n *\t@param {string} options.className class name for the control\n *\t@param {Image} options.image an image, default use the src option or a default image\n *\t@param {string} options.src image src, default use the image option or a default image\n *\t@param {boolean} options.rotateVithView rotate vith view (false to show watermark), default true\n *\t@param {_ol_style_Stroke_} options.style style to draw the lines, default draw no lines\n */\nol.control.Compass = function(options)\n{\tvar self = this;\n\tif (!options) options = {};\n\t// Initialize parent\n\tvar elt = document.createElement(\"div\");\n\telt.className = \"ol-compassctrl ol-unselectable ol-hidden\" + (options.className ? \" \"+options.className : \"\");\n\telt.style.position = \"absolute\";\n\telt.style.visibility = \"hidden\";\n\tol.control.Control.call(this, { element: elt });\n\tthis.set('rotateVithView', options.rotateWithView!==false);\n\t// Style to draw the lines\n\tthis.style = options.style;\n\t// The image\n\tif (options.image)\n\t{\tthis.img_ = options.image;\n\t}\n\telse if (options.src)\n\t{\tthis.img_ = new Image();\n\t\tthis.img_.onload = function(){ if (self.getMap()) self.getMap().renderSync(); }\n\t\tthis.img_.src = options.src;\n\t}\n\telse this.img_ = this.defaultCompass_(this.element.clientWidth, this.style ? this.style.getColor():\"\");\n\t// 8 angles\n\tthis.da_ = [];\n\tfor (var i=0; i<8; i++) this.da_[i] = [ Math.cos(Math.PI*i/8), Math.sin(Math.PI*i/8) ];\n};\nol.inherits(ol.control.Compass, ol.control.Control);\n/**\n * Remove the control from its current map and attach it to the new map.\n * @param {_ol_Map_} map Map.\n * @api stable\n */\nol.control.Compass.prototype.setMap = function (map)\n{\tvar oldmap = this.getMap();\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.control.Control.prototype.setMap.call(this, map);\n\tif (oldmap) oldmap.renderSync();\n\t// Get change (new layer added or removed)\n\tif (map) this._listener = map.on('postcompose', this.drawCompass_.bind(this));\n};\n/**\n * Create a default image.\n * @param {number} s the size of the compass\n * @private\n */\nol.control.Compass.prototype.defaultCompass_ = function (s, color)\n{\tvar canvas = document.createElement('canvas');\n\tvar ctx = canvas.getContext(\"2d\");\n\ts = canvas.width = canvas.height = s || 150;\n\tvar r = s/2;\n\tvar r2 = 0.22*r;\n\tfunction draw (r, r2)\n\t{\tctx.fillStyle = color ||\"#963\";\n\t\tctx.beginPath();\n\t\tctx.moveTo (0,0); \n\t\tctx.lineTo (r,0); ctx.lineTo (r2,r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (-r,0); ctx.lineTo (-r2,-r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (0,r); ctx.lineTo (-r2,r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (0,-r); ctx.lineTo (r2,-r2); ctx.moveTo (0,0);\n\t\tctx.fill();\n\t\tctx.stroke();\n\t}\n\tfunction draw2 (r, r2)\n\t{\tctx.globalCompositeOperation = \"destination-out\";\n\t\tctx.fillStyle = \"#fff\";\n\t\tctx.beginPath();\n\t\tctx.moveTo (0,0); \n\t\tctx.lineTo (r,0); ctx.lineTo (r2,-r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (-r,0); ctx.lineTo (-r2,r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (0,r); ctx.lineTo (r2,r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (0,-r); ctx.lineTo (-r2,-r2); ctx.moveTo (0,0);\n\t\tctx.fill();\n\t\tctx.globalCompositeOperation=\"source-over\";\n\t\tctx.beginPath();\n\t\tctx.moveTo (0,0); \n\t\tctx.lineTo (r,0); ctx.lineTo (r2,-r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (-r,0); ctx.lineTo (-r2,r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (0,r); ctx.lineTo (r2,r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (0,-r); ctx.lineTo (-r2,-r2); ctx.moveTo (0,0);\n\t\tctx.stroke();\n\t}\n\tctx.translate(r,r);\n\tctx.strokeStyle = color || \"#963\";\n\tctx.lineWidth = 1.5;\n\tctx.beginPath();\n\tctx.arc (0,0, s*0.41, 0, 2*Math.PI);\n\tctx.arc (0,0, s*0.44, 0, 2*Math.PI);\n\tctx.stroke();\n\tctx.rotate(Math.PI/4)\n\tdraw (r*0.9, r2*0.8);\n\tdraw2 (r*0.9, r2*0.8);\n\tctx.rotate(-Math.PI/4)\n\tdraw (r, r2);\n\tdraw2 (r, r2);\n\treturn canvas;\n};\n/** Draw compass\n* @param {ol.event} e postcompose event\n* @private\n*/\nol.control.Compass.prototype.drawCompass_ = function(e)\n{\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\t// Retina device\n\tvar ratio = e.frameState.pixelRatio;\n\tctx.save();\n\tctx.scale(ratio,ratio);\n\tvar w = this.element.clientWidth;\n\tvar h = this.element.clientHeight;\n\tvar pos = {left: this.element.offsetLeft, top: this.element.offsetTop};\n\tvar compass = this.img_;\n\tvar rot = e.frameState.viewState.rotation;\n\tctx.beginPath();\n\t\tctx.translate(pos.left+w/2, pos.top+h/2);\n\t\tif (this.get('rotateVithView')) ctx.rotate(rot);\n\t\t/*\n\t\tctx.globalCompositeOperation = \"multiply\";\n\t\tctx.globalAlpha = this.opacity || 1;\n\t\t*/\n\t\tif (this.style)\n\t\t{\tctx.beginPath();\n\t\t\t\tctx.strokeStyle = this.style.getColor();\n\t\t\t\tctx.lineWidth = this.style.getWidth();\n\t\t\t\tvar m = Math.max(canvas.width, canvas.height);\n\t\t\t\tfor (var i=0; i<8; i++)\n\t\t\t\t{\tctx.moveTo (-this.da_[i][0]*m, -this.da_[i][1]*m);\n\t\t\t\t\tctx.lineTo (this.da_[i][0]*m, this.da_[i][1]*m);\n\t\t\t\t}\n\t\t\tctx.stroke();\n\t\t}\n\t\tif (compass.width)\n\t\t{\tctx.drawImage (compass, -w/2, -h/2, w, h);\n\t\t}\n\tctx.closePath();\n\tctx.restore();\n};\n\n/** A simple control to disable all actions on the map.\n * The control will create an invisible div over the map.\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options Control options.\n *\t\t@param {String} options.class class of the control\n *\t\t@param {String} options.html html code to insert in the control\n *\t\t@param {bool} options.on the control is on\n *\t\t@param {function} options.toggleFn callback when control is clicked \n */\nol.control.Disable = function(options)\n{\toptions = options||{};\n\tvar element = document.createElement(\"div\");\n\t\t\telement.className = (options.className||\"\"+' ol-disable ol-unselectable ol-control').trim();\n\tvar stylesOptions = { top:\"0px\", left:\"0px\", right:\"0px\", bottom:\"0px\", \"zIndex\":10000, background:\"none\", display:\"none\" };\n\tObject.keys(stylesOptions).forEach(function(styleKey) {\n\t\telement.style[styleKey] = stylesOptions[styleKey];\n\t});\n\tol.control.Control.call(this,\n\t{\telement: element\n\t});\n}\nol.inherits(ol.control.Disable, ol.control.Control);\n/** Test if the control is on\n * @return {bool}\n * @api stable\n */\nol.control.Disable.prototype.isOn = function()\n{\treturn this.element.classList.contains(\"ol-disable\");\n}\n/** Disable all action on the map\n * @param {bool} b, default false\n * @api stable\n */\nol.control.Disable.prototype.disableMap = function(b)\n{\tif (b) \n\t{\tthis.element.classList.add(\"ol-enable\").show();\n\t}\n\telse \n\t{\tthis.element.classList.remove(\"ol-enable\").hide();\n\t}\n}\n\n/** Control bar for editing in a layer\n * @constructor\n * @extends {ol.control.Bar}\n * @fires info\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {String} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {boolean} options.edition false to remove the edition tools, default true\n *\t@param {Object} options.interactions List of interactions to add to the bar \n *    ie. Select, Delete, Info, DrawPoint, DrawLine, DrawPolygon\n *    Each interaction can be an interaction or true (to get the default one) or false to remove it from bar\n *\t@param {ol.source.Vector} options.source Source for the drawn features. \n */\nol.control.EditBar = function(options) {\n  options = options || {};\n  options.interactions = options.interactions || {};\n  // New bar\n\tol.control.Bar.call(this, {\n    className: (options.className ? options.className+' ': '') + 'ol-editbar',\n    toggleOne: true,\n\t\ttarget: options.target\n  });\n  this._source = options.source;\n  // Add buttons / interaction\n  this._interactions = {};\n  this._setSelectInteraction(options);\n  if (options.edition!==false) this._setEditInteraction(options);\n  this._setModifyInteraction(options);\n};\nol.inherits(ol.control.EditBar, ol.control.Bar);\n/**\n * Set the map instance the control is associated with\n * and add its controls associated to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol.control.EditBar.prototype.setMap = function (map) {\n  if (this.getMap()) {\n    if (this._interactions.Delete) this.getMap().removeInteraction(this._interactions.Delete);\n    if (this._interactions.ModifySelect) this.getMap().removeInteraction(this._interactions.ModifySelect);\n  }\n  ol.control.Bar.prototype.setMap.call(this, map);\n  if (this.getMap()) {\n    if (this._interactions.Delete) this.getMap().addInteraction(this._interactions.Delete);\n    if (this._interactions.ModifySelect) this.getMap().addInteraction(this._interactions.ModifySelect);\n  }\n};\n/** Get an interaction associated with the bar\n * @param {string} name \n */\nol.control.EditBar.prototype.getInteraction = function (name) {\n  return this._interactions[name];\n};\n/** Get the option title */\nol.control.EditBar.prototype._getTitle = function (option) {\n  return (option && option.title) ? option.title : option;\n};\n/** Add selection tool:\n * 1. a toggle control with a select interaction\n * 2. an option bar to delete / get information on the selected feature\n * @private\n */\nol.control.EditBar.prototype._setSelectInteraction = function (options) {\n  var self = this;\n  // Sub bar\n  var sbar = new ol.control.Bar();\n  var selectCtrl;\n  // Delete button\n  if (options.interactions.Delete !== false) {\n    if (options.interactions.Delete instanceof ol.interaction.Delete) {\n      this._interactions.Delete = options.interactions.Delete; \n    } else {\n      this._interactions.Delete = new ol.interaction.Delete();\n    }\n    var del = this._interactions.Delete;\n    del.setActive(false);\n    if (this.getMap()) this.getMap().addInteraction(del);\n    sbar.addControl (new ol.control.Button({\n      className: 'ol-delete',\n      title: this._getTitle(options.interactions.Delete) || \"Delete\",\n      handleClick: function(e) {\n        // Delete selection\n        del.delete(selectCtrl.getInteraction().getFeatures());\n        console.log('del')\n        var evt = {\n          type: 'select',\n          selected: [],\n          deselected: selectCtrl.getInteraction().getFeatures().getArray().slice(),\n          mapBrowserEvent: e.mapBrowserEvent\n        };\n        selectCtrl.getInteraction().getFeatures().clear();\n        selectCtrl.getInteraction().dispatchEvent(evt);\n      }\n    }));\n  }\n  // Info button\n  if (options.interactions.Info !== false) {\n    sbar.addControl (new ol.control.Button({\n      className: 'ol-info',\n      title: this._getTitle(options.interactions.Info) || \"Show informations\",\n      handleClick: function() {\n        self.dispatchEvent({ \n          type: 'info', \n          features: selectCtrl.getInteraction().getFeatures() \n        });\n      }\n    }));\n  }\n  // Select button\n  if (options.interactions.Select !== false) {\n    if (options.interactions.Select instanceof ol.interaction.Select) {\n      this._interactions.Select = options.interactions.Select\n    } else {\n      this._interactions.Select = new ol.interaction.Select({\n        condition: ol.events.condition.click\n      });\n    }\n    var sel = this._interactions.Select;\n    selectCtrl = new ol.control.Toggle({\n      className: 'ol-selection',\n      title: this._getTitle(options.interactions.Select) || \"Select\",\n      interaction: sel,\n      bar: sbar.getControls().length ? sbar : undefined,\n      autoActivate:true,\n      active:true\n    });\n    this.addControl(selectCtrl);\n    sel.on('change:active', function() {\n      sel.getFeatures().clear();\n    });\n  }\n};\n/** Add editing tools\n * @private\n */ \nol.control.EditBar.prototype._setEditInteraction = function (options) {\n  if (options.interactions.DrawPoint !== false) {\n    if (options.interactions.DrawPoint instanceof ol.interaction.Draw) {\n      this._interactions.DrawPoint = options.interactions.DrawPoint;\n    } else {\n      this._interactions.DrawPoint = new ol.interaction.Draw({\n        type: 'Point',\n        source: this._source\n      });\n    }\n    var pedit = new ol.control.Toggle({\n      className: 'ol-drawpoint',\n      title: this._getTitle(options.interactions.DrawPoint) || 'Point',\n      interaction: this._interactions.DrawPoint\n    });\n    this.addControl ( pedit );\n  }\n  if (options.interactions.DrawLine !== false) {\n    if (options.interactions.DrawLine instanceof ol.interaction.Draw) {\n      this._interactions.DrawLine = options.interactions.DrawLine\n    } else {\n      this._interactions.DrawLine = new ol.interaction.Draw ({\n        type: 'LineString',\n        source: this._source,\n        // Count inserted points\n        geometryFunction: function(coordinates, geometry) {\n          if (geometry) geometry.setCoordinates(coordinates);\n          else geometry = new ol.geom.LineString(coordinates);\n          this.nbpts = geometry.getCoordinates().length;\n          return geometry;\n        }\n      });\n    }\n    var ledit = new ol.control.Toggle({\n      className: 'ol-drawline',\n      title: this._getTitle(options.interactions.DrawLine) || 'LineString',\n      interaction: this._interactions.DrawLine,\n      // Options bar associated with the control\n      bar: new ol.control.Bar ({\n        controls:[ \n          new ol.control.TextButton({\n            html: this._getTitle(options.interactions.UndoDraw) || 'undo',\n            title: this._getTitle(options.interactions.UndoDraw) || \"delete last point\",\n            handleClick: function() {\n              if (ledit.getInteraction().nbpts>1) ledit.getInteraction().removeLastPoint();\n            }\n          }),\n          new ol.control.TextButton ({\n            html: this._getTitle(options.interactions.FinishDraw) || 'finish',\n            title: this._getTitle(options.interactions.FinishDraw) || \"finish\",\n            handleClick: function() {\n              // Prevent null objects on finishDrawing\n              if (ledit.getInteraction().nbpts>2) ledit.getInteraction().finishDrawing();\n            }\n          })\n        ]\n      }) \n    });\n    this.addControl ( ledit );\n  }\n  if (options.interactions.DrawPolygon !== false) {\n    if (options.interactions.DrawPolygon instanceof ol.interaction.Draw){\n      this._interactions.DrawPolygon = options.interactions.DrawPolygon\n    } else {\n      this._interactions.DrawPolygon = new ol.interaction.Draw ({\n        type: 'Polygon',\n        source: this._source,\n        // Count inserted points\n        geometryFunction: function(coordinates, geometry) {\n          this.nbpts = coordinates[0].length;\n          if (geometry) geometry.setCoordinates([coordinates[0].concat([coordinates[0][0]])]);\n          else geometry = new ol.geom.Polygon(coordinates);\n          return geometry;\n        }\n      });\n    }\n    this._setDrawPolygon(\n      'ol-drawpolygon', \n      this._interactions.DrawPolygon, \n      this._getTitle(options.interactions.DrawPolygon) || 'Polygon', \n      options\n    );\n  }\n  // Draw hole\n  if (options.interactions.DrawHole !== false) {\n    if (options.interactions.DrawHole instanceof ol.interaction.DrawHole){\n      this._interactions.DrawHole = options.interactions.DrawHole;\n    } else {\n      this._interactions.DrawHole = new ol.interaction.DrawHole ();\n    }\n    this._setDrawPolygon(\n      'ol-drawhole', \n      this._interactions.DrawHole, \n      this._getTitle(options.interactions.DrawHole) || 'Hole', \n      options\n    );\n  }\n  // Draw regular\n  if (options.interactions.DrawRegular !== false) {\n    if (options.interactions.DrawRegular instanceof ol.interaction.DrawRegular) {\n      this._interactions.DrawRegular = options.interactions.DrawRegular\n    } else {\n      this._interactions.DrawRegular = new ol.interaction.DrawRegular ({\n        source: this._source,\n        sides: 4\n      });\n    }\n    var regular = this._interactions.DrawRegular;\n    var div = document.createElement('DIV');\n    var down = ol.ext.element.create('DIV', { parent: div });\n    ol.ext.element.addListener(down, ['click', 'touchstart'], function() {\n      var sides = regular.getSides() -1;\n      if (sides < 2) sides = 2;\n      regular.setSides (sides);\n      text.textContent = sides>2 ? sides+' pts' : 'circle';\n    }.bind(this));\n    var text = ol.ext.element.create('TEXT', { html:'4 pts', parent: div });\n    var up = ol.ext.element.create('DIV', { parent: div });\n    ol.ext.element.addListener(up, ['click', 'touchstart'], function() {\n      var sides = regular.getSides() +1;\n      if (sides<3) sides=3;\n      regular.setSides(sides);\n      text.textContent = sides+' pts';\n    }.bind(this));\n    var ctrl = new ol.control.Toggle({\n      className: 'ol-drawregular',\n      title: this._getTitle(options.interactions.DrawRegular) || 'Regular',\n      interaction: this._interactions.DrawRegular,\n      // Options bar associated with the control\n      bar: new ol.control.Bar ({\n        controls:[ \n          new ol.control.TextButton({\n            html: div\n          })\n        ]\n      }) \n    });\n    this.addControl (ctrl);\n  }\n};\n/**\n * @private\n */\nol.control.EditBar.prototype._setDrawPolygon = function (className, interaction, title, options) {\n  var fedit = new ol.control.Toggle ({\n    className: className,\n    title: title,\n    interaction: interaction,\n    // Options bar associated with the control\n    bar: new ol.control.Bar({\n      controls:[ \n        new ol.control.TextButton ({\n          html: this._getTitle(options.interactions.UndoDraw) || 'undo',\n          title: this._getTitle(options.interactions.UndoDraw) || 'undo last point',\n          handleClick: function(){\n            if (fedit.getInteraction().nbpts>1) fedit.getInteraction().removeLastPoint();\n          }\n        }),\n        new ol.control.TextButton({\n          html: this._getTitle(options.interactions.FinishDraw) || 'finish',\n          title: this._getTitle(options.interactions.FinishDraw) || 'finish',\n          handleClick: function() {\n            // Prevent null objects on finishDrawing\n            if (fedit.getInteraction().nbpts>3) fedit.getInteraction().finishDrawing();\n          }\n        })\n      ]\n    }) \n  });\n  this.addControl (fedit);\n};\n/** Add modify tools\n * @private\n */ \nol.control.EditBar.prototype._setModifyInteraction = function (options) {\n  // Modify on selected features\n  if (options.interactions.ModifySelect !== false && options.interactions.Select !== false) {\n    if (options.interactions.ModifySelect instanceof ol.interaction.ModifyFeature) {\n      this._interactions.ModifySelect = options.interactions.ModifySelect;\n    } else {\n      this._interactions.ModifySelect = new ol.interaction.ModifyFeature({\n        features: this.getInteraction('Select').getFeatures()\n      });\n    }\n    if (this.getMap()) this.getMap().addInteraction(this._interactions.ModifySelect);\n    // Activate with select\n    this._interactions.ModifySelect.setActive(this._interactions.Select.getActive());\n    this._interactions.Select.on('change:active', function() {\n      this._interactions.ModifySelect.setActive(this._interactions.Select.getActive());\n    }.bind(this));\n  }\n  if (options.interactions.Transform !== false) {\n    if (options.interactions.Transform instanceof ol.interaction.Transform) {\n      this._interactions.Transform = options.interactions.Transform;\n    } else {\n      this._interactions.Transform = new ol.interaction.Transform ({\n        addCondition: ol.events.condition.shiftKeyOnly\n      });\n    }\n    var transform = new ol.control.Toggle ({\n      html: '<i></i>',\n      className: 'ol-transform',\n      title: this._getTitle(options.interactions.Transform) || 'Transform',\n      interaction: this._interactions.Transform\n    });\n    this.addControl (transform);\n  }\n  if (options.interactions.Split !== false) {\n    if (options.interactions.Split instanceof ol.interaction.Split) {\n      this._interactions.Split = options.interactions.Split;\n    } else {\n      this._interactions.Split = new ol.interaction.Split ({\n          sources: this._source\n      });\n    }\n    var split = new ol.control.Toggle ({\n      className: 'ol-split',\n      title: this._getTitle(options.interactions.Split) || 'Split',\n      interaction: this._interactions.Split\n    });\n    this.addControl (split);\n  }\n  if (options.interactions.Offset !== false) {\n    if (options.interactions.Offset instanceof ol.interaction.Offset) {\n      this._interactions.Offset = options.interactions.Offset;\n    } else {\n      this._interactions.Offset = new ol.interaction.Offset ({\n          source: this._source\n      });\n    }\n    var offset = new ol.control.Toggle ({\n      html: '<i></i>',\n      className: 'ol-offset',\n      title: this._getTitle(options.interactions.Offset) || 'Offset',\n      interaction: this._interactions.Offset\n    });\n    this.addControl (offset);\n  }\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A simple gauge control to display level information on the map.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options Control options.\n *\t\t@param {String} options.className class of the control\n *\t\t@param {String} options.title title of the control\n *\t\t@param {number} options.max maximum value, default 100;\n *\t\t@param {number} options.val the value, default 0\n */\nol.control.Gauge = function(options)\n{\toptions = options || {};\n\tvar element = document.createElement(\"div\");\n\t\t\telement.className = ((options.className||\"\") + ' ol-gauge ol-unselectable ol-control').trim();\n\tthis.title_ = document.createElement(\"span\");\n\telement.appendChild(this.title_);\n\tthis.gauge_ = document.createElement(\"button\");\n\tthis.gauge_.setAttribute('type','button');\n\telement.appendChild(document.createElement(\"div\").appendChild(this.gauge_))\n\tthis.gauge_.style.width = '0px';\n\tol.control.Control.call(this,\n\t{\telement: element,\n\t\ttarget: options.target\n\t});\n\tthis.setTitle(options.title);\n\tthis.val(options.val);\n\tthis.set(\"max\", options.max||100);\n};\nol.inherits(ol.control.Gauge, ol.control.Control);\n/** Set the control title\n* @param {string} title\n*/\nol.control.Gauge.prototype.setTitle = function(title)\n{\tthis.title_.innerHTML = title||\"\";\n\tif (!title) this.title_.display = 'none';\n\telse this.title_.display = '';\n};\n/** Set/get the gauge value\n* @param {number|undefined} v the value or undefined to get it\n* @return {number} the value\n*/\nol.control.Gauge.prototype.val = function(v)\n{\tif (v!==undefined)\n\t{\tthis.val_ = v;\n\t\tthis.gauge_.style.width = (v/this.get('max')*100)+\"%\";\n\t}\n\treturn this.val_;\n};\n\n/** Bookmark positions on ol maps.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires add\n * @fires remove\n * @param {} options Geobookmark's options\n *  @param {string} options.className default ol-bookmark\n *  @param {string} options.placeholder input placeholder, default Add a new geomark...\n *  @param {bool} options.editable enable modification, default true\n *  @param {string} options.namespace a namespace to save the boolmark (if more than one on a page), default ol\n *  @param {Array<any>} options.marks a list of default bookmarks: \n * @see [Geobookmark example](../../examples/map.control.geobookmark.html)\n * @example \nvar bm = new GeoBookmark ({ \n  marks: {\n    \"Paris\": {pos:_ol_proj_.transform([2.351828, 48.856578], 'EPSG:4326', 'EPSG:3857'), zoom:11, permanent: true },\n    \"London\": {pos:_ol_proj_.transform([-0.1275,51.507222], 'EPSG:4326', 'EPSG:3857'), zoom:12}\n  }\n});\n */\nol.control.GeoBookmark = function(options) {\n  options = options || {};\n  var self = this;\n  var element = document.createElement('div');\n  if (options.target) {\n    element.className = options.className || \"ol-bookmark\";\n  } else {\n    element.className = (options.className || \"ol-bookmark\") +\n          \" ol-unselectable ol-control ol-collapsed\";\n    element.addEventListener(\"mouseleave\", function() {\n      if (input !== document.activeElement) {\n        menu.style.display = 'none';\n      }\n    });\n    // Show bookmarks on click\n    this.button = document.createElement('button');\n    this.button.setAttribute('type', 'button');\n    this.button.addEventListener('click', function() {\n      menu.style.display = (menu.style.display === '' || menu.style.display === 'none' ? 'block': 'none');\n    });\n    element.appendChild(this.button);\n  }\n  // The menu\n  var menu = document.createElement('div');\n  element.appendChild(menu);\n  var ul = document.createElement('ul');\n  menu.appendChild(ul);\n  var input = document.createElement('input');\n  input.setAttribute(\"placeholder\", options.placeholder || \"Add a new geomark...\")\n  input.addEventListener(\"change\", function() {\n    var title = this.value;\n    if (title) {\n      self.addBookmark(title);\n      this.value = '';\n      self.dispatchEvent({\n        type: \"add\",\n        name: title\n      });\n    }\n    menu.style.display = 'none';\n  });\n  input.addEventListener(\"blur\", function() {\n    menu.style.display = 'none';\n  });\n  menu.appendChild(input);\n  // Init\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  this.on(\"propertychange\", function(e) {\n    if (e.key==='editable') {\n      element.className = element.className.replace(\" ol-editable\",\"\");\n      if (this.get('editable')) {\n        element.className += \" ol-editable\";\n      }\n    }\n    // console.log(e);\n  }.bind(this));\n  this.set(\"namespace\", options.namespace || 'ol');\n  this.set(\"editable\", options.editable !== false);\n  // Set default bmark\n  this.setBookmarks(localStorage[this.get('namespace')+\"@bookmark\"] ? null:options.marks);\n};\nol.inherits(ol.control.GeoBookmark, ol.control.Control);\n/** Set bookmarks\n* @param {} bmark a list of bookmarks, default retreave in the localstorage\n* @example \nbm.setBookmarks({ \n  \"Paris\": {pos:_ol_proj_.transform([2.351828, 48.856578], 'EPSG:4326', 'EPSG:3857'), zoom:11, permanent: true },\n  \"London\": {pos:_ol_proj_.transform([-0.1275,51.507222], 'EPSG:4326', 'EPSG:3857'), zoom:12}\n});\n*/\nol.control.GeoBookmark.prototype.setBookmarks = function(bmark) {\n  if (!bmark) bmark = JSON.parse(localStorage[this.get('namespace')+\"@bookmark\"] || \"{}\");\n  var modify = this.get(\"editable\");\n  var ul = this.element.querySelector(\"ul\");\n  var menu = this.element.querySelector(\"div\");\n  var self = this;\n  ul.innerHTML = '';\n  for (var b in bmark) {\n    var li = document.createElement('li');\n    li.textContent = b;\n    li.setAttribute('data-bookmark', JSON.stringify(bmark[b]));\n    li.addEventListener('click', function() {\n      var bm = JSON.parse(this.getAttribute(\"data-bookmark\"));\n      self.getMap().getView().setCenter(bm.pos);\n      self.getMap().getView().setZoom(bm.zoom);\n      menu.style.display = 'none';\n    });\n    ul.appendChild(li);\n    if (modify && !bmark[b].permanent) {\n      var button = document.createElement('button');\n      button.setAttribute('data-name', b);\n      button.setAttribute(\"title\", \"Suppr.\");\n      button.addEventListener('click', function(e) {\n        self.removeBookmark(this.getAttribute(\"data-name\"));\n        self.dispatchEvent({ type: \"remove\", name: this.getAttribute(\"data-name\") });\n        e.stopPropagation();\n      });\n      li.appendChild(button);\n    }\n  }\n  localStorage[this.get('namespace')+\"@bookmark\"] = JSON.stringify(bmark);\n};\n/** Get Geo bookmarks\n* @return {any} a list of bookmarks : { BM1:{pos:ol.coordinates, zoom: integer}, BM2:{pos:ol.coordinates, zoom: integer} }\n*/\nol.control.GeoBookmark.prototype.getBookmarks = function() {\n  return JSON.parse(localStorage[this.get('namespace')+\"@bookmark\"] || \"{}\");\n};\n/** Remove a Geo bookmark\n* @param {string} name\n*/\nol.control.GeoBookmark.prototype.removeBookmark = function(name) {\n  if (!name) {\n    return;\n  }\n  var bmark = this.getBookmarks();\n  delete bmark[name];\n  this.setBookmarks(bmark);\n};\n/** Add a new Geo bookmark (replace existing one if any)\n* @param {string} name name of the bookmark (display in the menu)\n* @param {_ol_coordinate_} position default current position\n* @param {number} zoom default current map zoom\n* @param {bool} permanent prevent from deletion, default false\n*/\nol.control.GeoBookmark.prototype.addBookmark = function(name, position, zoom, permanent)\n{\n  if (!name) return;\n  var bmark = this.getBookmarks();\n  // Don't override permanent bookmark\n  if (bmark[name] && bmark[name].permanent) return;\n  // Create or override\n  bmark[name] = {\n    pos: position || this.getMap().getView().getCenter(),\n    zoom: zoom || this.getMap().getView().getZoom(),\n\tpermanent: !!permanent\n  };\n  this.setBookmarks(bmark);\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Control bar for OL3\n * The control bar is a container for other controls. It can be used to create toolbars.\n * Control bars can be nested and combined with ol.control.Toggle to handle activate/deactivate.\n *\n * @constructor\n * @extends {ol.control.Bar}\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {String} options.centerLabel label for center button, default center\n */\nol.control.GeolocationBar = function(options) {\n  if (!options) options = {};\n  options.className = options.className || 'ol-geobar';\n  ol.control.Bar.call(this, options);\n  this.setPosition(options.position || 'bottom-right');\n  var element = this.element;\n  // Geolocation draw interaction\n  var interaction = new ol.interaction.GeolocationDraw({\n    source: options.source,\n    zoom: options.zoom,\n    followTrack: options.followTrack,\n    minAccuracy: options.minAccuracy || 10000\n  });\n  this._geolocBt = new ol.control.Toggle ({\n    className: 'geolocBt',\n    interaction: interaction,\n    onToggle: function() {\n      interaction.pause(true);\n      interaction.setFollowTrack(options.followTrack);\n      element.classList.remove('pauseTrack');\n    }\n  });\n  this.addControl(this._geolocBt);\n  this._geolocBt.setActive(false);\n  // Buttons\n  var bar = new ol.control.Bar();\n  this.addControl(bar);\n  var centerBt = new ol.control.TextButton ({\n    className: 'centerBt',\n    html: options.centerLabel ||'center',\n    handleClick: function() {\n      interaction.setFollowTrack('auto');\n    }\n  });\n  bar.addControl(centerBt);\n  var startBt = new ol.control.Button ({\n    className: 'startBt',\n    handleClick: function(){\n      interaction.pause(false);\n      interaction.setFollowTrack('auto');\n      element.classList.add('pauseTrack');\n    }\n  });\n  bar.addControl(startBt);\n  var pauseBt = new ol.control.Button ({\n    className: 'pauseBt',\n    handleClick: function(){\n      interaction.pause(true);\n      interaction.setFollowTrack('auto');\n      element.classList.remove('pauseTrack');\n    }\n  });\n  bar.addControl(pauseBt);\n  interaction.on('follow', function(e) {\n    if (e.following) {\n      element.classList.remove('centerTrack');\n    } else {\n      element.classList.add('centerTrack');\n    }\n  });\n  // Activate\n  this._geolocBt.on('change:active', function(e) {\n    if (e.active) {\n      element.classList.add('ol-active');\n    } else {\n      element.classList.remove('ol-active');\n    }\n  });\n};\nol.inherits(ol.control.GeolocationBar, ol.control.Bar);\n/** Get the ol.interaction.GeolocationDraw associatedwith the bar\n * \n */\nol.control.GeolocationBar.prototype.getInteraction = function () {\n  return this._geolocBt.getInteraction();\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * OpenLayers 3 lobe Overview Control.\n * The globe can rotate with map (follow.) \n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options Control options.\n * \t@param {boolean} follow follow the map when center change, default false\n * \t@param {top|bottom-left|right} align position as top-left, etc.\n * \t@param {Array<ol.layer>} layers list of layers to display on the globe\n * \t@param {ol.style.Style | Array.<ol.style.Style> | undefined} style style to draw the position on the map , default a marker\n */\nol.control.Globe = function(opt_options)\n{\tvar options = opt_options || {};\n\tvar self = this;\n\t// API\n\tvar element;\n\tif (options.target)\n\t{\telement = document.createElement(\"div\");\n\t\tthis.panel_ = options.target;\n\t}\n\telse\n\t{\telement = document.createElement(\"div\");\n\t\telement.classList.add('ol-globe', 'ol-unselectable', 'ol-control');\n\t\tif (/top/.test(options.align)) element.classList.add('ol-control-top');\n\t\tif (/right/.test(options.align)) element.classList.add('ol-control-right');\n\t\tthis.panel_ = document.createElement(\"div\");\n\t\tthis.panel_.classList.add(\"panel\")\n\t\telement.appendChild(this.panel_);\n\t\tthis.pointer_ = document.createElement(\"div\");\n\t\tthis.pointer_.classList.add(\"ol-pointer\");\n\t\telement.appendChild(this.pointer_);\n\t}\n\tol.control.Control.call(this,\n\t{\telement: element,\n\t\ttarget: options.target\n\t});\n// http://openlayers.org/en/latest/examples/sphere-mollweide.html ???\n\t// Create a globe map\n\tthis.ovmap_ = new ol.Map(\n\t{\tcontrols: new ol.Collection(),\n\t\tinteractions: new ol.Collection(),\n\t\ttarget: this.panel_,\n\t\tview: new ol.View\n\t\t\t({\tzoom: 0,\n\t\t\t\tcenter: [0,0]\n\t\t\t}),\n\t\tlayers: options.layers\n\t});\n\tsetTimeout (function()\n\t{\tself.ovmap_.updateSize(); \n\t}, 0);\n\tthis.set('follow', options.follow || false);\n\t// Cache extent\n\tthis.extentLayer = new ol.layer.Vector(\n\t{\tname: 'Cache extent',\n\t\tsource: new ol.source.Vector(),\n\t\tstyle: options.style || [new ol.style.Style(\n\t\t\t\t\t{\timage: new ol.style.Circle(\n\t\t\t\t\t\t{\tfill: new ol.style.Fill({\n\t\t\t\t\t\t\t\tcolor: 'rgba(255,0,0, 1)'\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tstroke: new ol.style.Stroke(\n\t\t\t\t\t\t\t{\twidth: 7,\n\t\t\t\t\t\t\t\tcolor: 'rgba(255,0,0, 0.8)'\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tradius: 5\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t)]\n\t})\n\tthis.ovmap_.addLayer(this.extentLayer);\n};\nol.inherits(ol.control.Globe, ol.control.Control);\n/**\n * Set the map instance the control associated with.\n * @param {ol.Map} map The map instance.\n */\nol.control.Globe.prototype.setMap = function(map) {\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.control.Control.prototype.setMap.call(this, map);\n\t// Get change (new layer added or removed)\n\tif (map) \n\t{\tthis._listener = map.getView().on('propertychange', this.setView.bind(this));\n\t\tthis.setView();\n\t}\n};\n/** Set the globe center with the map center\n*/\nol.control.Globe.prototype.setView = function()\n{\tif (this.getMap() && this.get('follow'))\n\t{\tthis.setCenter(this.getMap().getView().getCenter());\n\t}\n}\n/** Get globe map\n*\t@return {ol.Map}\n*/\nol.control.Globe.prototype.getGlobe = function()\n{\treturn this.ovmap_;\n}\n/** Show/hide the globe\n*/\nol.control.Globe.prototype.show = function(b)\n{\tif (b!==false) this.element.classList.remove(\"ol-collapsed\");\n\telse this.element.classList.add(\"ol-collapsed\");\n\tthis.ovmap_.updateSize();\n}\n/** Set position on the map\n*\t@param {top|bottom-left|right}  align\n*/\nol.control.Globe.prototype.setPosition = function(align)\n{\tif (/top/.test(align)) this.element.classList.add(\"ol-control-top\");\n\telse this.element.classList.remove(\"ol-control-top\");\n\tif (/right/.test(align)) this.element.classList.add(\"ol-control-right\");\n\telse this.element.classList.remove(\"ol-control-right\");\n}\n/** Set the globe center\n* @param {_ol_coordinate_} center the point to center to\n* @param {boolean} show show a pointer on the map, defaylt true\n*/\nol.control.Globe.prototype.setCenter = function (center, show)\n{\tvar self = this;\n\tthis.pointer_.classList.add(\"hidden\");\n\tif (center)\n\t{\tvar map = this.ovmap_;\n\t\tvar p = map.getPixelFromCoordinate(center);\n\t\tif (p) {\n\t\t\tif (show!==false) {\n\t\t\t\tvar h = this.element.clientHeight;\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tself.pointer_.style.top = String(Math.min(Math.max(p[1],0),h)) + 'px';\n\t\t\t\t\tself.pointer_.style.left = \"50%\";\n\t\t\t\t\tself.pointer_.classList.remove(\"hidden\");\n\t\t\t\t}, 800);\n\t\t\t}\n\t\t\tmap.getView().animate({ center: [center[0],0] });\n\t\t}\n\t}\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Draw a graticule on the map.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} _ol_control_ options.\n *\t- projection {ol.projectionLike} projection to use for the graticule, default EPSG:4326 \n *\t- maxResolution {number} max resolution to display the graticule\n *\t- style {ol.style.Style} Style to use for drawing the graticule, default black.\n *\t- step {number} step beetween lines (in proj units), default 1\n *\t- stepCoord {number} show a coord every stepCoord, default 1\n *\t- spacing {number} spacing beetween lines (in px), default 40px \n *\t- borderWidth {number} width of the border (in px), default 5px \n *\t- margin {number} margin of the border (in px), default 0px \n */\nol.control.Graticule = function(options) {\n\tif (!options) options = {};\n\t// Initialize parent\n\tvar elt = document.createElement(\"div\");\n\telt.className = \"ol-graticule ol-unselectable ol-hidden\";\n\tol.control.Control.call(this, { element: elt });\n\tthis.set('projection', options.projection || 'EPSG:4326');\n\t// Use to limit calculation \n\tvar p = new ol.proj.Projection({code:this.get('projection')});\n\tvar m = p.getMetersPerUnit();\n\tthis.fac = 1;\n\twhile (m/this.fac>10)\n\t{\tthis.fac *= 10;\n\t}\n\tthis.fac = 10000/this.fac;\n\tthis.set('maxResolution', options.maxResolution || Infinity);\n\tthis.set('step', options.step || 0.1);\n\tthis.set('stepCoord', options.stepCoord || 1);\n\tthis.set('spacing', options.spacing || 40);\n\tthis.set('margin', options.margin || 0);\n\tthis.set('borderWidth', options.borderWidth || 5);\n\tthis.set('stroke', options.stroke!==false);\n\tthis.formatCoord = options.formatCoord || function(c){return c;};\n\tif (options.style instanceof ol.style.Style) this.style = options.style;\n\telse this.style = new ol.style.Style(\n\t\t{\tstroke: new ol.style.Stroke({ color:\"#000\", width:1 }),\n\t\t\tfill: new ol.style.Fill({ color: \"#fff\" }),\n\t\t\ttext: new ol.style.Text(\n\t\t\t{\tstroke: new ol.style.Stroke({ color:\"#fff\", width:2 }),\n\t\t\t\tfill: new ol.style.Fill({ color:\"#000\" }),\n\t\t\t}) \n\t\t});\n};\nol.inherits(ol.control.Graticule, ol.control.Control);\n/**\n * Remove the control from its current map and attach it to the new map.\n * @param {_ol_Map_} map Map.\n * @api stable\n */\nol.control.Graticule.prototype.setMap = function (map) {\n\tvar oldmap = this.getMap();\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.control.Control.prototype.setMap.call(this, map);\n\tif (oldmap) oldmap.renderSync();\n\t// Get change (new layer added or removed)\n\tif (map) {\n\t\tthis._listener = map.on('postcompose', this.drawGraticule_.bind(this));\n\t}\n};\nol.control.Graticule.prototype.setStyle = function (style)\n{\tthis.style = style;\n};\nol.control.Graticule.prototype.getStyle = function (style)\n{\treturn style;\n};\nol.control.Graticule.prototype.drawGraticule_ = function (e)\n{\tif (this.get('maxResolution')<e.frameState.viewState.resolution) return;\n\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tvar ratio = e.frameState.pixelRatio;\n\tvar w = canvas.width/ratio;\n\tvar h = canvas.height/ratio;\n\tvar proj = this.get('projection');\n\tvar map = this.getMap();\n\tvar bbox = \n\t[\tmap.getCoordinateFromPixel([0,0]),\n\t\tmap.getCoordinateFromPixel([w,0]),\n\t\tmap.getCoordinateFromPixel([w,h]),\n\t\tmap.getCoordinateFromPixel([0,h])\n\t];\n\tvar xmax = -Infinity;\n\tvar xmin = Infinity;\n\tvar ymax = -Infinity;\n\tvar ymin = Infinity;\n\tfor (var i=0, c; c=bbox[i]; i++)\n\t{\tbbox[i] = ol.proj.transform (c, map.getView().getProjection(), proj);\n\t\txmax = Math.max (xmax, bbox[i][0]);\n\t\txmin = Math.min (xmin, bbox[i][0]);\n\t\tymax = Math.max (ymax, bbox[i][1]);\n\t\tymin = Math.min (ymin, bbox[i][1]);\n\t}\n\tvar spacing = this.get('spacing');\n\tvar step = this.get('step');\n\tvar step2 = this.get('stepCoord');\n\tvar borderWidth = this.get('borderWidth');\n\tvar margin = this.get('margin');\n\t// Limit max line draw\n\tvar ds = (xmax-xmin)/step*spacing;\n\tif (ds>w) \n\t{\tvar dt = Math.round((xmax-xmin)/w*spacing /step);\n\t\tstep *= dt;\n\t\tif (step>this.fac) step = Math.round(step/this.fac)*this.fac;\n\t}\n\txmin = (Math.floor(xmin/step))*step -step;\n\tymin = (Math.floor(ymin/step))*step -step;\n\txmax = (Math.floor(xmax/step))*step +2*step;\n\tymax = (Math.floor(ymax/step))*step +2*step;\n\tvar extent = ol.proj.get(proj).getExtent();\n\tif (extent)\n\t{\tif (xmin < extent[0]) xmin = extent[0];\n\t\tif (ymin < extent[1]) ymin = extent[1];\n\t\tif (xmax > extent[2]) xmax = extent[2]+step;\n\t\tif (ymax > extent[3]) ymax = extent[3]+step;\n\t}\n\tvar hasLines = this.style.getStroke() && this.get(\"stroke\");\n\tvar hasText = this.style.getText();\n\tvar hasBorder = this.style.getFill();\n\tctx.save();\n\t\tctx.scale(ratio,ratio);\n\t\tctx.beginPath();\n\t\tctx.rect(margin, margin, w-2*margin, h-2*margin);\n\t\tctx.clip();\n\t\tctx.beginPath();\n\t\tvar txt = {top:[],left:[],bottom:[], right:[]};\n\t\tvar x, y, p, p0, p1;\n\t\tfor (x=xmin; x<xmax; x += step)\n\t\t{\tp0 = ol.proj.transform ([x, ymin], proj, map.getView().getProjection());\n\t\t\tp0 = map.getPixelFromCoordinate(p0);\n\t\t\tif (hasLines) ctx.moveTo(p0[0], p0[1]);\n\t\t\tp = p0;\n\t\t\tfor (y=ymin+step; y<=ymax; y+=step)\n\t\t\t{\tp1 = ol.proj.transform ([x, y], proj, map.getView().getProjection());\n\t\t\t\tp1 = map.getPixelFromCoordinate(p1);\n\t\t\t\tif (hasLines) ctx.lineTo(p1[0], p1[1]);\n\t\t\t\tif (p[1]>0 && p1[1]<0) txt.top.push([x, p]);\n\t\t\t\tif (p[1]>h && p1[1]<h) txt.bottom.push([x,p]);\n\t\t\t\tp = p1;\n\t\t\t}\n\t\t}\n\t\tfor (y=ymin; y<ymax; y += step)\n\t\t{\tp0 = ol.proj.transform ([xmin, y], proj, map.getView().getProjection());\n\t\t\tp0 = map.getPixelFromCoordinate(p0);\n\t\t\tif (hasLines) ctx.moveTo(p0[0], p0[1]);\n\t\t\tp = p0;\n\t\t\tfor (x=xmin+step; x<=xmax; x+=step)\n\t\t\t{\tp1 = ol.proj.transform ([x, y], proj, map.getView().getProjection());\n\t\t\t\tp1 = map.getPixelFromCoordinate(p1);\n\t\t\t\tif (hasLines) ctx.lineTo(p1[0], p1[1]);\n\t\t\t\tif (p[0]<0 && p1[0]>0) txt.left.push([y,p]);\n\t\t\t\tif (p[0]<w && p1[0]>w) txt.right.push([y,p]);\n\t\t\t\tp = p1;\n\t\t\t}\n\t\t}\n\t\tif (hasLines)\n\t\t{\tctx.strokeStyle = this.style.getStroke().getColor();\n\t\t\tctx.lineWidth = this.style.getStroke().getWidth();\n\t\t\tctx.stroke();\n\t\t}\n\t\t// Draw text\n\t\tif (hasText)\n\t\t{\n\t\t\tctx.fillStyle = this.style.getText().getFill().getColor();\n\t\t\tctx.strokeStyle = this.style.getText().getStroke().getColor();\n\t\t\tctx.lineWidth = this.style.getText().getStroke().getWidth();\n\t\t\tctx.textAlign = 'center';\n\t\t\tctx.textBaseline = 'hanging';\n\t\t\tvar t, tf;\n\t\t\tvar offset = (hasBorder ? borderWidth : 0) + margin + 2;\n\t\t\tfor (i=0; t = txt.top[i]; i++) if (!(Math.round(t[0]/this.get('step'))%step2))\n\t\t\t{\ttf = this.formatCoord(t[0]);\n\t\t\t\tctx.strokeText(tf, t[1][0], offset);\n\t\t\t\tctx.fillText(tf, t[1][0], offset);\n\t\t\t}\n\t\t\tctx.textBaseline = 'alphabetic';\n\t\t\tfor (i=0; t = txt.bottom[i]; i++) if (!(Math.round(t[0]/this.get('step'))%step2))\n\t\t\t{\ttf = this.formatCoord(t[0]);\n\t\t\t\tctx.strokeText(tf, t[1][0], h-offset);\n\t\t\t\tctx.fillText(tf, t[1][0], h-offset);\n\t\t\t}\n\t\t\tctx.textBaseline = 'middle';\n\t\t\tctx.textAlign = 'left';\n\t\t\tfor (i=0; t = txt.left[i]; i++) if (!(Math.round(t[0]/this.get('step'))%step2))\n\t\t\t{\ttf = this.formatCoord(t[0]);\n\t\t\t\tctx.strokeText(tf, offset, t[1][1]);\n\t\t\t\tctx.fillText(tf, offset, t[1][1]);\n\t\t\t}\n\t\t\tctx.textAlign = 'right';\n\t\t\tfor (i=0; t = txt.right[i]; i++) if (!(Math.round(t[0]/this.get('step'))%step2))\n\t\t\t{\ttf = this.formatCoord(t[0]);\n\t\t\t\tctx.strokeText(tf, w-offset, t[1][1]);\n\t\t\t\tctx.fillText(tf, w-offset, t[1][1]);\n\t\t\t}\n\t\t}\n\t\t// Draw border\n\t\tif (hasBorder)\n\t\t{\tvar fillColor = this.style.getFill().getColor();\n\t\t\tvar color, stroke;\n\t\t\tif (stroke = this.style.getStroke())\n\t\t\t{\tcolor = this.style.getStroke().getColor();\n\t\t\t}\n\t\t\telse\n\t\t\t{\tcolor = fillColor;\n\t\t\t\tfillColor = \"#fff\";\n\t\t\t}\n\t\t\tctx.strokeStyle = color;\n\t\t\tctx.lineWidth = stroke ? stroke.getWidth() : 1;\n\t\t\t// \n\t\t\tfor (i=1; i<txt.top.length; i++)\n\t\t\t{\tctx.beginPath();\n\t\t\t\tctx.rect(txt.top[i-1][1][0], margin, txt.top[i][1][0]-txt.top[i-1][1][0], borderWidth);\n\t\t\t\tctx.fillStyle = Math.round(txt.top[i][0]/step)%2 ? color: fillColor;\n\t\t\t\tctx.fill(); \n\t\t\t\tctx.stroke(); \n\t\t\t}\n\t\t\tfor (i=1; i<txt.bottom.length; i++)\n\t\t\t{\tctx.beginPath();\n\t\t\t\tctx.rect(txt.bottom[i-1][1][0], h-borderWidth-margin, txt.bottom[i][1][0]-txt.bottom[i-1][1][0], borderWidth);\n\t\t\t\tctx.fillStyle = Math.round(txt.bottom[i][0]/step)%2 ? color: fillColor;\n\t\t\t\tctx.fill(); \n\t\t\t\tctx.stroke(); \n\t\t\t}\n\t\t\tfor (i=1; i<txt.left.length; i++)\n\t\t\t{\tctx.beginPath();\n\t\t\t\tctx.rect(margin, txt.left[i-1][1][1], borderWidth, txt.left[i][1][1]-txt.left[i-1][1][1]);\n\t\t\t\tctx.fillStyle = Math.round(txt.left[i][0]/step)%2 ? color: fillColor;\n\t\t\t\tctx.fill(); \n\t\t\t\tctx.stroke(); \n\t\t\t}\n\t\t\tfor (i=1; i<txt.right.length; i++)\n\t\t\t{\tctx.beginPath();\n\t\t\t\tctx.rect(w-borderWidth-margin, txt.right[i-1][1][1], borderWidth, txt.right[i][1][1]-txt.right[i-1][1][1]);\n\t\t\t\tctx.fillStyle = Math.round(txt.right[i][0]/step)%2 ? color: fillColor;\n\t\t\t\tctx.fill(); \n\t\t\t\tctx.stroke(); \n\t\t\t}\n\t\t\tctx.beginPath();\n\t\t\tctx.fillStyle = color;\n\t\t\tctx.rect(margin,margin, borderWidth, borderWidth);\n\t\t\tctx.rect(margin,h-borderWidth-margin, borderWidth,borderWidth);\n\t\t\tctx.rect(w-borderWidth-margin,margin, borderWidth, borderWidth);\n\t\t\tctx.rect(w-borderWidth-margin,h-borderWidth-margin, borderWidth,borderWidth);\n\t\t\tctx.fill(); \n\t\t}\n\tctx.restore();\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Draw a grid reference on the map and add an index.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires select\n * @param {Object=} Control options.\n *\t- style {ol.style.Style} Style to use for drawing the grid (stroke and text), default black.\n *\t- maxResolution {number} max resolution to display the graticule\n *\t- extent {ol.extent} extent of the grid, required\n *\t- size {ol.size} number of lines and cols, required\n *\t- margin {number} margin to display text (in px), default 0px\n *\t- source {ol.source.Vector} source to use for the index, default none (use setIndex to reset the index)\n *\t- property {string | function} a property to display in the index or a function that takes a feature and return the name to display in the index, default 'name'.\n *\t- sortFeatures {function|undefined} sort function to sort 2 features in the index, default sort on property option\n *\t- indexTitle {function|undefined} a function that takes a feature and return the title to display in the index, default the first letter of property option\n *\t- filterLabel {string} label to display in the search bar, default 'filter'\n */\nol.control.GridReference = function(options) {\n\tif (!options) options = {};\n\t// Initialize parent\n\tvar elt = document.createElement(\"div\");\n\telt.className = (!options.target ? \"ol-control \":\"\") +\"ol-gridreference ol-unselectable \"+(options.className||\"\");\n\tol.control.Control.call(this,\n\t\t{\telement: elt,\n\t\t\ttarget: options.target\n\t\t});\n\tif (typeof (options.property)=='function') this.getFeatureName = options.property;\n\tif (typeof (options.sortFeatures)=='function') this.sortFeatures = options.sortFeatures;\n\tif (typeof (options.indexTitle)=='function') this.indexTitle = options.indexTitle;\n\t// Set index using the source\n\tthis.source_ = options.source;\n\tif (options.source)\n\t{\tthis.setIndex(options.source.getFeatures(), options);\n\t\t// reload on ready\n\t\toptions.source.once('change',function()\n\t\t\t{\tif (options.source.getState() === 'ready')\n\t\t\t\t{   this.setIndex(options.source.getFeatures(), options);\n\t\t\t\t}\n\t\t\t}.bind(this));\n\t}\n\t// Options\n\tthis.set('maxResolution', options.maxResolution || Infinity);\n\tthis.set('extent', options.extent);\n\tthis.set('size', options.size);\n\tthis.set('margin', options.margin || 0);\n\tthis.set('property', options.property || 'name');\n\tthis.set('filterLabel', options.filterLabel || 'filter');\n\tif (options.style instanceof ol.style.Style) this.style = options.style;\n\telse this.style = new ol.style.Style(\n\t\t{\tstroke: new ol.style.Stroke({ color:\"#000\", width:1 }),\n\t\t\ttext: new ol.style.Text(\n\t\t\t{\tfont: \"bold 14px Arial\",\n\t\t\t\tstroke: new ol.style.Stroke({ color:\"#fff\", width:2 }),\n\t\t\t\tfill: new ol.style.Fill({ color:\"#000\" }),\n\t\t\t})\n\t\t});\n};\nol.inherits(ol.control.GridReference, ol.control.Control);\n/** Returns the text to be displayed in the index\n*\t@param {ol.Feature} f the feature\n*\t@return {string} the text to be displayed in the index\n*\t@api\n*/\nol.control.GridReference.prototype.getFeatureName = function (f)\n{\treturn f.get(this.get('property')||'name');\n};\n/** Sort function\n*\t@param {ol.Feature} a first feature\n*\t@param {ol.Feature} b second feature\n*\t@return {Number} 0 if a==b, -1 if a<b, 1 if a>b\n*\t@api\n*/\nol.control.GridReference.prototype.sortFeatures = function (a,b)\n{\treturn (this.getFeatureName(a) == this.getFeatureName(b)) ? 0 : (this.getFeatureName(a) < this.getFeatureName(b)) ? -1 : 1; \n};\n/** Get the feature title\n*\t@param {ol.Feature} f\n*\t@return the first letter of the eature name (getFeatureName)\n*\t@api\n*/\nol.control.GridReference.prototype.indexTitle = function (f)\n{\treturn this.getFeatureName(f).charAt(0);\n};\n/** Display features in the index\n*\t@param { Array<ol.Feature> | ol.Collection<ol.Feature> } features\n*/\nol.control.GridReference.prototype.setIndex = function (features)\n{\tif (!this.getMap()) return;\n\tvar self = this;\n\tif (features.getArray) features = features.getArray();\n\tfeatures.sort ( function(a,b) { return self.sortFeatures(a,b); } );\n\tthis.element.innerHTML = \"\";\n\tvar elt = this.element;\n\tvar search = document.createElement(\"input\");\n\t\t\tsearch.setAttribute('type', 'search');\n\t\t\tsearch.setAttribute('placeholder', this.get('filterLabel') || 'filter');\n\t\t\tvar searchKeyupFunction = function()\n\t\t\t{\tvar v = this.value.replace(/^\\*/,'');\n\t\t\t\t// console.log(v)\n\t\t\t\tvar r = new RegExp (v, 'i');\n\t\t\t\tul.querySelectorAll('li').forEach(function(li) {\n\t\t\t\t\tif (li.classList.contains('ol-title')) li.style.display = '';\n\t\t\t\t\telse\n\t\t\t\t\t{\tif (r.test(li.querySelector('.ol-name').textContent)) li.style.display = '';\n\t\t\t\t\t\telse li.style.display = 'none';\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tul.querySelectorAll(\"li.ol-title\").forEach(function(li)\n\t\t\t\t{\n\t\t\t\t\tvar nextAll = false;\n\t\t\t\t\tnextAll = [].filter.call(li.parentNode.children, function (htmlElement) {\n\t\t\t\t\t\treturn (htmlElement.previousElementSibling === li) ? nextAll = true : nextAll;\n\t\t\t\t\t});\n\t\t\t\t\tconsole.log(nextAll);\n\t\t\t\t\tvar nextVisible = nextAll[0];\n\t\t\t\t\tif (nextVisible.length && !nextVisible.classList.contains('ol-title')) li.style.display = '';\n\t\t\t\t\telse li.style.display = 'none';\n\t\t\t\t});\n\t\t\t};\n\t\t\tsearch.addEventListener('search', searchKeyupFunction);\n\t\t\tsearch.addEventListener('keyup', searchKeyupFunction);\n\t\t\telt.appendChild(search);\n\tvar ul = document.createElement(\"ul\");\n\telt.appendChild(ul);\n\tvar r, title;\n\tfor (var i=0, f; f=features[i]; i++)\n\t{\n\t\t(function(feat) {\n\t\t\tr = self.getReference(feat.getGeometry().getFirstCoordinate());\n\t\t\tif (r)\n\t\t\t{\tvar name = self.getFeatureName(feat);\n\t\t\t\tvar c = self.indexTitle(feat);\n\t\t\t\tif (c != title)\n\t\t\t\t{\tvar li_title = document.createElement(\"li\");\n\t\t\t\t\tli_title.classList.add('ol-title');\n\t\t\t\t\tli_title.textContent = c;\n\t\t\t\t\tul.appendChild(li_title);\n\t\t\t\t}\n\t\t\t\ttitle = c;\n\t\t\t\tvar li_ref_name = document.createElement(\"li\");\n\t\t\t\tvar span_name = document.createElement(\"span\");\n\t\t\t\t\t\tspan_name.classList.add(\"ol-name\");\n\t\t\t\t\t\tspan_name.textContent = name;\n\t\t\t\tli_ref_name.appendChild(span_name);\n\t\t\t\tvar span_ref = document.createElement(\"span\");\n\t\t\t\t\t\tspan_ref.classList.add(\"ol-ref\");\n\t\t\t\t\t\tspan_ref.textContent = r;\n\t\t\t\tli_ref_name.appendChild(span_ref);\n\t\t\t\tvar feature = feat;\n\t\t\t\tli_ref_name.addEventListener(\"click\", function()\n\t\t\t\t\t\t\t{\tself.dispatchEvent({ type:\"select\", feature: feature });\n\t\t\t\t\t\t\t})\n\t\t\t\tul.appendChild(li_ref_name);\n\t\t\t}\n\t\t})(f);\n\t}\n};\n/** Get reference for a coord\n*\t@param {ol.coordinate} coords\n*\t@return {string} the reference\n*/\nol.control.GridReference.prototype.getReference = function (coords)\n{\tif (!this.getMap()) return;\n\tvar extent = this.get('extent');\n\tvar size = this.get('size');\n\tvar dx = Math.floor ( (coords[0] - extent[0]) / (extent[2]- extent[0]) * size[0] );\n\tif (dx<0 || dx>=size[0]) return \"\";\n\tvar dy = Math.floor ( (extent[3] - coords[1]) / (extent[3]- extent[1]) * size[1] );\n\tif (dy<0 || dy>=size[1]) return \"\";\n\treturn String.fromCharCode(65+dx)+dy;\n};\n/**\n * Remove the control from its current map and attach it to the new map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.control.GridReference.prototype.setMap = function (map)\n{\tvar oldmap = this.getMap();\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.control.Control.prototype.setMap.call(this, map);\n\tif (oldmap) oldmap.renderSync();\n\t// Get change (new layer added or removed)\n\tif (map)\n\t{\tthis._listener = map.on('postcompose', this.drawGrid_.bind(this));\n\t\tif (this.source_) this.setIndex(this.source_.getFeatures());\n\t}\n};\n/** Set style\n* @param {ol.style.Style} style\n*/\nol.control.GridReference.prototype.setStyle = function (style)\n{\tthis.style = style;\n};\n/** Get style\n* @return {ol.style.Style} style\n*/\nol.control.GridReference.prototype.getStyle = function ()\n{\treturn this.style;\n};\n/** Draw the grid\n* @param {ol.event} e postcompose event\n* @private\n*/\nol.control.GridReference.prototype.drawGrid_ = function (e)\n{\tif (this.get('maxResolution')<e.frameState.viewState.resolution) return;\n\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tvar ratio = e.frameState.pixelRatio;\n\tvar w = canvas.width/ratio;\n\tvar h = canvas.height/ratio;\n\tvar extent = this.get('extent');\n\tvar size = this.get('size');\n\tvar map = this.getMap();\n\tvar ex = ol.extent.boundingExtent([map.getPixelFromCoordinate([extent[0],extent[1]]), map.getPixelFromCoordinate([extent[2],extent[3]])]);\n\tvar p0 = [ex[0],ex[1]];\n\tvar p1 = [ex[2],ex[3]];\n\tvar dx = (p1[0]-p0[0])/size[0];\n\tvar dy = (p1[1]-p0[1])/size[1];\n\tctx.save();\n\t\tvar margin = this.get('margin');\n\t\tctx.scale(ratio,ratio);\n\t\tctx.strokeStyle = this.style.getStroke().getColor();\n\t\tctx.lineWidth = this.style.getStroke().getWidth();\n\t\t// Draw grid\n\t\tctx.beginPath();\n\t\tvar i;\n\t\tfor (i=0; i<=size[0]; i++)\n\t\t{\tctx.moveTo(p0[0]+i*dx, p0[1]);\n\t\t\tctx.lineTo(p0[0]+i*dx, p1[1]);\n\t\t}\n\t\tfor (i=0; i<=size[1]; i++)\n\t\t{\tctx.moveTo(p0[0], p0[1]+i*dy);\n\t\t\tctx.lineTo(p1[0], p0[1]+i*dy);\n\t\t}\n\t\tctx.stroke();\n\t\t// Draw text\n\t\tctx.font = this.style.getText().getFont();\n\t\tctx.fillStyle = this.style.getText().getFill().getColor();\n\t\tctx.strokeStyle = this.style.getText().getStroke().getColor();\n\t\tvar lw = ctx.lineWidth = this.style.getText().getStroke().getWidth();\n\t\tvar spacing = margin +lw;\n\t\tctx.textAlign = 'center';\n\t\tvar letter, x, y;\n\t\tfor (i=0; i<size[0]; i++)\n\t\t{\tletter = String.fromCharCode(65+i);\n\t\t\tx = p0[0]+i*dx+dx/2;\n\t\t\ty = p0[1]-spacing;\n\t\t\tif (y<0)\n\t\t\t{\ty = spacing;\n\t\t\t\tctx.textBaseline = 'hanging';\n\t\t\t}\n\t\t\telse ctx.textBaseline = 'alphabetic';\n\t\t\tctx.strokeText(letter, x, y);\n\t\t\tctx.fillText(letter, x, y);\n\t\t\ty = p1[1]+spacing;\n\t\t\tif (y>h)\n\t\t\t{\ty = h-spacing;\n\t\t\t\tctx.textBaseline = 'alphabetic';\n\t\t\t}\n\t\t\telse ctx.textBaseline = 'hanging';\n\t\t\tctx.strokeText(letter, x, y);\n\t\t\tctx.fillText(letter, x, y);\n\t\t}\n\t\tctx.textBaseline = 'middle';\n\t\tfor (i=0; i<size[0]; i++)\n\t\t{\ty = p0[1]+i*dy+dy/2;\n\t\t\tctx.textAlign = 'right';\n\t\t\tx = p0[0] - spacing;\n\t\t\tif (x<0)\n\t\t\t{\tx = spacing;\n\t\t\t\tctx.textAlign = 'left';\n\t\t\t}\n\t\t\telse ctx.textAlign = 'right';\n\t\t\tctx.strokeText(i, x, y);\n\t\t\tctx.fillText(i, x, y);\n\t\t\tx = p1[0] + spacing;\n\t\t\tif (x>w)\n\t\t\t{\tx = w-spacing;\n\t\t\t\tctx.textAlign = 'right';\n\t\t\t}\n\t\t\telse ctx.textAlign = 'left';\n\t\t\tctx.strokeText(i, x, y);\n\t\t\tctx.fillText(i, x, y);\n\t\t}\n\tctx.restore();\n};\n\n/** Image line control\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires select\n * @fires collapse\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {ol.source.Vector} options.source a vector source that contains the images\n *\t@param {function} options.getImage a function that gets a feature and return the image url, default return the img propertie\n *\t@param {function} options.getTitle a function that gets a feature and return the title, default return an empty string\n *\t@param {boolean} options.collapsed the line is collapse, default false\n *\t@param {boolean} options.collapsible the line is collapsible, default false\n *\t@param {number} options.maxFeatures the maximum image element in the line, default 100\n *\t@param {boolean} options.hover select image on hover, default false\n *\t@param {string|boolean} options.linkColor link color or false if no link, default false\n */\nol.control.Imageline = function(options) {\n  var element = ol.ext.element.create('DIV', {\n    className: (options.className || '') + ' ol-imageline'\n      + (options.target ? '': ' ol-unselectable ol-control')\n      + (options.collapsed && options.collapsible ? 'ol-collapsed' : '')\n      + (ol.has.TOUCH ? ' ol-touch' : '')\n  });\n  if (!options.target && options.collapsible) {\n    ol.ext.element.create('BUTTON', {\n      type: 'button',\n      click: function() {\n        this.toggle();\n      }.bind(this),\n      parent: element\n    });\n  }\n  // Source \n  this._source = options.source;\n  // Initialize\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  // Scroll imageline\n  this._setScrolling();\n  this._scrolldiv.addEventListener(\"scroll\", function() {\n    if (this.getMap()) this.getMap().render();\n  }.bind(this));\n  // Parameters\n  if (typeof(options.getImage)==='function') this._getImage =  options.getImage;\n  if (typeof(options.getTitle)==='function') this._getTitle =  options.getTitle;\n  this.set('maxFeatures', options.maxFeatures || 100);\n  this.set('linkColor', options.linkColor || false);\n  this.set('hover', options.hover || false);\n  this.set('useExtent', options.useExtent || false);\n  this.refresh();\n};\nol.inherits(ol.control.Imageline, ol.control.Control);\n/**\n * Remove the control from its current map and attach it to the new map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.control.Imageline.prototype.setMap = function (map) {\n\tif (this._listener) {\n    this._listener.forEach(function(l) {\n      ol.Observable.unByKey(l);\n    }.bind(this));\n  }\n\tthis._listener = null;\n\tol.control.Control.prototype.setMap.call(this, map);\n\tif (map) {\t\n    this._listener = [\n      map.on('postcompose', this._drawLink.bind(this)),\n      map.on('moveend', function() { \n        if (this.get('useExtent')) this.refresh();\n      }.bind(this))\n    ]\n\t}\n};\n/** Set useExtent param and refresh the line\n * @param {boolean} b\n */\nol.control.Imageline.prototype.useExtent = function(b) {\n  this.set('useExtent', b);\n  this.refresh();\n};\n/** Is the line collapsed\n * @return {boolean}\n */\nol.control.Imageline.prototype.isCollapsed = function() {\n  return this.element.classList.contains('ol-collapsed');\n};\n/** Collapse the line\n * @param {boolean} b\n */\nol.control.Imageline.prototype.collapse = function(b) {\n  if (b) this.element.classList.add('ol-collapsed');\n  else this.element.classList.remove('ol-collapsed');\n  if (this.getMap()) {\n    setTimeout ( function() {\n      this.getMap().render();\n    }.bind(this), this.isCollapsed() ? 0 : 250);\n  }\n  this.dispatchEvent({ type: 'collapse', collapsed: this.isCollapsed() });\n};\n/** Collapse the line\n */\nol.control.Imageline.prototype.toggle = function() {\n  this.element.classList.toggle('ol-collapsed');\n  if (this.getMap()) {\n    setTimeout ( function() {\n      this.getMap().render();\n    }.bind(this), this.isCollapsed() ? 0 : 250);\n  }\n  this.dispatchEvent({ type: 'collapse', collapsed: this.isCollapsed() });\n};\n/** Default function to get an image of a feature\n * @param {ol.Feature} f\n * @private\n */\nol.control.Imageline.prototype._getImage = function(f) {\n  return f.get('img');\n};\n/** Default function to get an image title\n * @param {ol.Feature} f\n * @private\n */\nol.control.Imageline.prototype._getTitle = function(/* f */) {\n  return '';\n};\n/**\n * Get features\n * @return {Array<ol.Feature>}\n */\nol.control.Imageline.prototype.getFeatures = function() {\n  var map = this.getMap();\n  if (!this.get('useExtent') || !map) {\n    return this._source.getFeatures();\n  } else {\n    var extent = map.getView().calculateExtent(map.getSize());\n    return this._source.getFeaturesInExtent(extent);\n  }\n};\n/** Set element scrolling with a acceleration effect on desktop\n * (on mobile it uses the scroll of the browser)\n * @private\n */\nol.control.Imageline.prototype._setScrolling = function() {\n  var elt = this._scrolldiv = ol.ext.element.create('DIV', {\n    parent: this.element\n  });\n  ol.ext.element.scrollDiv(elt, {\n    // Prevent selection when moving\n    onmove: function(b) {\n      this._moving=b; \n    }.bind(this)\n  });\n};\n/**\n * Refresh the imageline with new data\n */\nol.control.Imageline.prototype.refresh = function() {\n  this._scrolldiv.innerHTML = '';\n  var features = this.getFeatures();\n  var current = this._select ? this._select.feature : null;\n  if (this._select) this._select.elt = null;\n  this._iline = [];\n  if (this.getMap()) this.getMap().render();\n  // Add a new image\n  var addImage = function(f) {\n    if (this._getImage(f)) {\n      var img = ol.ext.element.create('DIV', {\n        className: 'ol-image',\n        parent: this._scrolldiv\n      });\n      ol.ext.element.create('IMG', {\n        src: this._getImage(f),\n        parent: img\n      }).addEventListener('load', function(){\n        this.classList.add('ol-loaded');\n      });\n      ol.ext.element.create('SPAN', {\n        html: this._getTitle(f),\n        parent: img\n      });\n      // Current image\n      var sel = { elt: img, feature: f };\n      // On click > dispatch event\n      img.addEventListener('click', function(){\n        if (!this._moving) {\n          this.dispatchEvent({type: 'select', feature: f });\n          this._scrolldiv.scrollLeft = img.offsetLeft \n            + ol.ext.element.getStyle(img, 'width')/2\n            - ol.ext.element.getStyle(this.element, 'width')/2;\n            if (this._select) this._select.elt.classList.remove('select');\n            this._select = sel;\n            this._select.elt.classList.add('select');\n          }\n      }.bind(this));\n      // Show link\n      img.addEventListener('mouseover', function(e) {\n        if (this.get('hover')) {\n          if (this._select) this._select.elt.classList.remove('select');\n          this._select = sel;\n          this._select.elt.classList.add('select');\n          this.getMap().render();\n          e.stopPropagation();\n        }\n      }.bind(this));\n      // Remove link\n      img.addEventListener('mouseout', function(e) {\n        if (this.get('hover')) {\n          if (this._select) this._select.elt.classList.remove('select');\n          this._select = false;\n          this.getMap().render();\n          e.stopPropagation();\n        }\n      }.bind(this));\n      // Prevent image dragging\n      img.ondragstart = function(){ return false; };\n      // Add image\n      this._iline.push(sel);\n      if (current===f) {\n        this._select = sel;\n        sel.elt.classList.add('select');\n      }\n    }\n  }.bind(this);\n  // Add images \n  var nb = this.get('maxFeatures');\n  for (var i=0, f; f=features[i]; i++) {\n    if (nb--<0) break;\n    addImage(f);\n  }\n  // Add the selected one\n  if (this._select && this._select.feature && !this._select.elt) {\n    addImage(this._select.feature);\n  }\n};\n/** Center image line on a feature\n * @param {ol.feature} feature\n * @param {boolean} scroll scroll the line to center on the image, default true\n * @api\n */\nol.control.Imageline.prototype.select = function(feature, scroll) {\n  this._select = false;\n  // Find the image\n  this._iline.forEach(function (f) {\n    if (f.feature === feature) {\n      f.elt.classList.add('select');\n      this._select = f;\n      if (scroll!==false) {\n        this._scrolldiv.scrollLeft = f.elt.offsetLeft \n          + ol.ext.element.getStyle(f.elt, 'width')/2\n          - ol.ext.element.getStyle(this.element, 'width')/2;\n      }\n    } else {\n      f.elt.classList.remove('select');\n    }\n  }.bind(this));\n};\n/** Draw link on the map\n * @private\n */\nol.control.Imageline.prototype._drawLink = function(e) {\n  if (!this.get('linkColor') | this.isCollapsed()) return;\n  var map = this.getMap();\n  if (map && this._select && this._select.elt) {\n    var ctx = e.context;\n    var ratio = e.frameState.pixelRatio;\n    var pt = [ \n      this._select.elt.offsetLeft \n      - this._scrolldiv.scrollLeft\n      + ol.ext.element.getStyle(this._select.elt, 'width')/2, \n      parseFloat(ol.ext.element.getStyle(this.element, 'top')) || this.getMap().getSize()[1]\n    ];\n    var geom = this._select.feature.getGeometry().getFirstCoordinate();\n    geom = this.getMap().getPixelFromCoordinate(geom);\n    ctx.save();\n    ctx.fillStyle = this.get('linkColor');\n    ctx.beginPath();\n      if (geom[0]>pt[0]) {\n        ctx.moveTo((pt[0]-5)*ratio, pt[1]*ratio);\n        ctx.lineTo((pt[0]+5)*ratio, (pt[1]+5)*ratio);\n      } else {\n        ctx.moveTo((pt[0]-5)*ratio, (pt[1]+5)*ratio);\n        ctx.lineTo((pt[0]+5)*ratio, pt[1]*ratio);\n      }\n      ctx.lineTo(geom[0]*ratio, geom[1]*ratio);\n    ctx.fill();\n    ctx.restore();\n  }\n};\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Geoportail isochrone Control.\n * @see https://geoservices.ign.fr/documentation/geoservices/isochrones.html\n * @constructor\n * @extends {ol.control.Control}\n * @fires isochrone\n * @fires error\n * @param {Object=} options\n *\t@param {string} options.className control class name\n *\t@param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *\t@param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *\t@param {string | undefined} options.inputLabel label for the input, default none\n *\t@param {string | undefined} options.noCollapse prevent collapsing on input blur, default false\n *\t@param {number | undefined} options.typing a delay on each typing to start searching (ms) use -1 to prevent autocompletion, default 300.\n *\t@param {integer | undefined} options.minLength minimum length to start searching, default 1\n *\t@param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *\t@param {integer | undefined} options.maxHistory maximum number of items to display in history. Set -1 if you don't want history, default maxItems\n *\t@param {function} options.getTitle a function that takes a feature and return the name to display in the index.\n *\t@param {function} options.autocomplete a function that take a search string and callback function to send an array\n *\n *  @param {string} options.exclusions Exclusion list separate with a comma 'Toll,Tunnel,Bridge'\n */\nol.control.IsochroneGeoportail = function(options) {\n  var self = this;\n\tif (!options) options = {};\n\tif (options.typing == undefined) options.typing = 300;\n\tvar classNames = (options.className ? options.className : '')+ ' ol-isochrone ol-routing';\n\tif (!options.target) classNames += ' ol-unselectable ol-control';\n\tvar element = ol.ext.element.create('DIV', { className: classNames })\n\tif (!options.target) {\n    var bt = ol.ext.element.create('BUTTON', { parent: element })\n    bt.addEventListener('click', function(){\n      element.classList.toggle('ol-collapsed');\n    });\n  }\n  // Inherits\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  this.set('iter', 1);\n  var content = ol.ext.element.create('DIV', { className: 'content', parent: element } )\n  // Search control\n  this._addSearchCtrl(content, options);\n  // Method buttons\n  ol.ext.element.create('BUTTON', { className: 'ol-button ol-method-time selected', title:'isochrone', parent: content })\n    .addEventListener('click', function(){\n      this.setMethod('time');\n    }.bind(this));\n  ol.ext.element.create('I', { className: 'ol-button ol-method-distance', title:'isodistance', parent: content })\n    .addEventListener('click', function(){\n      this.setMethod('distance');\n    }.bind(this));\n  // Mode buttons\n  ol.ext.element.create('I', { className: 'ol-button ol-car selected', title:'by car', parent: content })\n    .addEventListener('click', function(){\n      this.setMode('car');\n    }.bind(this));\n  ol.ext.element.create('I', { className: 'ol-button ol-pedestrian', title:'by foot', parent: content })\n    .addEventListener('click', function(){\n      this.setMode('pedestrian');\n    }.bind(this));\n  // Direction buttons\n  ol.ext.element.create('I', { className: 'ol-button ol-direction-direct selected', title:'direct', parent: content })\n    .addEventListener('click', function(){\n      this.setDirection('direct');\n    }.bind(this));\n  ol.ext.element.create('I', { className: 'ol-button ol-direction-reverse', title:'reverse', parent: content })\n    .addEventListener('click', function(){\n      this.setDirection('reverse');\n    }.bind(this));\n  // Input \n  var div = ol.ext.element.create('DIV', { className: 'ol-time', parent: content })\n  ol.ext.element.create('DIV', { html:'isochrone:', parent: div });\n  ol.ext.element.create('INPUT', { type: 'number', parent: div, min: 0 })\n    .addEventListener('change', function(){\n      self.set('hour', Number(this.value));\n    });\n  ol.ext.element.create('TEXT', { parent: div, html: 'h' });\n  ol.ext.element.create('INPUT', { type: 'number', parent: div, min: 0 })\n    .addEventListener('change', function(){\n      self.set('minute', Number(this.value));\n    });\n  ol.ext.element.create('TEXT', { parent: div, html: 'mn' });\n  div = ol.ext.element.create('DIV', { className: 'ol-distance', parent: content });\n  ol.ext.element.create('DIV', { html:'isodistance:', parent: div });\n  ol.ext.element.create('INPUT', { type: 'number', step: 'any', parent: div, min: 0 })\n    .addEventListener('change', function(){\n      self.set('distance', Number(this.value));\n    });\n  ol.ext.element.create('TEXT', { parent: div, html: 'km' });\n  div = ol.ext.element.create('DIV', { className: 'ol-iter', parent: content })\n  ol.ext.element.create('DIV', { html:'Iteration:', parent: div });\n  ol.ext.element.create('INPUT', { type: 'number', parent: div, value: 1, min: 1 })\n    .addEventListener('change', function(){\n      self.set('iter', Number(this.value));\n    });\n  // OK button\n  ol.ext.element.create('I', { className:'ol-ok', html:'ok', parent: content })\n    .addEventListener('click', function() {\n      var val = 0;\n      switch (this.get('method')) {\n        case 'distance':  {\n          val = this.get('distance')*1000;\n          break;\n        }\n        default: {\n          val = (this.get('hour')||0)*3600 + (this.get('minute')||0)*60;\n          break;\n        }\n      }\n      if (val && this.get('coordinate')) {\n        this.search(this.get('coordinate'), val);\n      }\n    }.bind(this));\n  this.set('url', 'https://wxs.ign.fr/'+options.apiKey+'/isochrone/isochrone.json');\n  this._ajax = new ol.ext.Ajax({ \n    dataType: 'JSON',\n    auth: options.auth\n  });\n  this._ajax.on('success', this._success.bind(this));\n  this._ajax.on('error', this._error.bind(this));\n  // searching\n  this._ajax.on('loadstart', function() {\n    this.element.classList.add('ol-searching');\n  }.bind(this));\n  this._ajax.on('loadend', function() {\n    this.element.classList.remove('ol-searching');\n  }.bind(this));\n  this.setMethod(options.method);\n};\nol.inherits(ol.control.IsochroneGeoportail, ol.control.Control);\n/**\n * Set the map instance the control is associated with\n * and add its controls associated to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol.control.IsochroneGeoportail.prototype.setMap = function (map) {\n\tol.control.Control.prototype.setMap.call(this, map);\n\tthis._search.setMap(map);\n};\n/** Add a new search input\n * @private\n */\nol.control.IsochroneGeoportail.prototype._addSearchCtrl = function (element, options) {\n\tvar div = ol.ext.element.create(\"DIV\", { parent: element });\n  var search = this._search = new ol.control.SearchGeoportail({\n    className: 'IGNF ol-collapsed',\n\t\tapiKey: options.apiKey,\n\t\ttarget: div\n\t});\n\tsearch.on('select', function(e){\n    search.setInput(e.search.fulltext);\n    this.set('coordinate', e.coordinate);\n  }.bind(this));\n  search.on('change:input', function(){\n    this.set('coordinate', false);\n  }.bind(this));\n};\n/** Set the travel method\n * @param [string] method The method (time or distance)\n */\nol.control.IsochroneGeoportail.prototype.setMethod = function(method) {7\n  method = (/distance/.test(method) ? 'distance' : 'time');\n  this.element.querySelector(\".ol-method-time\").classList.remove(\"selected\");\n  this.element.querySelector(\".ol-method-distance\").classList.remove(\"selected\");\n  this.element.querySelector(\".ol-method-\"+method).classList.add(\"selected\");\n  this.element.querySelector(\"div.ol-time\").classList.remove(\"selected\");\n  this.element.querySelector(\"div.ol-distance\").classList.remove(\"selected\");\n  this.element.querySelector(\"div.ol-\"+method).classList.add(\"selected\");\n  this.set('method', method);\n};\n/** Set mode\n * @param {string} mode The mode: 'car' or 'pedestrian', default 'car'\n */\nol.control.IsochroneGeoportail.prototype.setMode = function (mode) {\n  this.set('mode', mode);\n  this.element.querySelector(\".ol-car\").classList.remove(\"selected\");\n  this.element.querySelector(\".ol-pedestrian\").classList.remove(\"selected\");\n  this.element.querySelector(\".ol-\"+mode).classList.add(\"selected\");\n};\n/** Set direction\n * @param {string} direction The direction: 'direct' or 'reverse', default direct\n */\nol.control.IsochroneGeoportail.prototype.setDirection = function (direction) {\n  this.set('direction', direction);\n  this.element.querySelector(\".ol-direction-direct\").classList.remove(\"selected\");\n  this.element.querySelector(\".ol-direction-reverse\").classList.remove(\"selected\");\n  this.element.querySelector(\".ol-direction-\"+direction).classList.add(\"selected\");\n};\n/** Calculate an isochrone\n * @param {ol.coordinate} coord\n * @param {number|string} option A number as time (in second) or distance (in meter), depend on method propertie\n * or a string with a unit (s, mn, h for time or km, m)\n */\nol.control.IsochroneGeoportail.prototype.search = function(coord, option, iter) {\n  var proj = this.getMap() ? this.getMap().getView().getProjection() : 'EPSG:3857';\n  var method = /distance/.test(this.get('method')) ? 'distance' : 'time';\n  if (typeof(option)==='string') {\n    var unit = option.replace(/([0-9|.]*)([a-z]*)$/,'$2');\n    method = 'time';\n    option = parseFloat(option);\n    // convert unit\n    switch (unit) {\n      case 'mn': {\n        option = option*60;\n        break;\n      }\n      case 'h': {\n        option = option*3600;\n        break;\n      }\n      case 'm': {\n        method = 'distance';\n        break;\n      }\n      case 'km': {\n        method = 'distance';\n        option = option*1000;\n        break;\n      }\n    }\n  }\n  var dt = Math.round(option * (this.get('iter')-(iter||0)) / this.get('iter'));\n  if (typeof option === 'number') {\n    // Send data\n    var data = {\n      'gp-access-lib': '2.1.0',\n      location: ol.proj.toLonLat(coord, proj),\n      graphName: (this.get('mode')==='pedestrian' ?  'Pieton' : 'Voiture'),\n      exclusions: this.get('exclusions') || undefined,\n      method: method,\n      time: method==='time' ? dt : undefined,\n      distance: method==='distance' ? dt : undefined,\n      reverse: (this.get('direction') === 'reverse'),\n      smoothing: this.get('smoothing') || true,\n      holes: this.get('holes') || false\n    };\n    this._ajax.send(this.get('url'), data, { \n      coord: coord, \n      option: option,\n      iteration: (iter||0)+1 \n    });\n  }\n};\n/** Trigger result\n * @private\n */\nol.control.IsochroneGeoportail.prototype._success = function(e) {\n  var proj = this.getMap() ? this.getMap().getView().getProjection() : 'EPSG:3857';\n  // Convert to features\n  var format = new ol.format.WKT();\n  var evt = e.response;\n\tevt.feature = format.readFeature(evt.wktGeometry, {\n    dataProjection: 'EPSG:4326',\n    featureProjection: proj\n  });\n  delete evt.wktGeometry;\n  evt.type = 'isochrone';\n  evt.iteration = e.options.iteration-1;\n  this.dispatchEvent (evt);\n  if (e.options.iteration < this.get('iter')) {\n    this.search(e.options.coord, e.options.option, e.options.iteration);\n  }\n};\n/** Trigger error\n * @private\n */\nol.control.IsochroneGeoportail.prototype._error = function() {\n  this.dispatchEvent ({ type:'error' });\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * OpenLayers Layer Switcher Control.\n *\n * @constructor\n * @extends {ol.control.LayerSwitcher}\n * @param {Object=} options Control options.\n */\nol.control.LayerPopup = function(options) {\n  options = options || {};\n\toptions.switcherClass=\"ol-layerswitcher-popup\";\n\tif (options.mouseover!==false) options.mouseover=true;\n\tol.control.LayerSwitcher.call(this, options);\n};\nol.inherits(ol.control.LayerPopup, ol.control.LayerSwitcher);\n/** Disable overflow\n*/\nol.control.LayerPopup.prototype.overflow = function(){};\n/** Render a list of layer\n * @param {elt} element to render\n * @layers {Array{ol.layer}} list of layer to show\n * @api stable\n */\nol.control.LayerPopup.prototype.drawList = function(ul, layers) {\t\n  var self=this;\n\tvar setVisibility = function(e) {\n    e.preventDefault(); \n\t\tvar l = self._getLayerForLI(this);\n\t\tself.switchLayerVisibility(l,layers);\n\t\tif (e.type==\"touchstart\") self.element.classList.add(\"ol-collapsed\");\n\t};\n\tlayers.forEach(function(layer) {\n    if (self.displayInLayerSwitcher(layer)) {\n      var d = ol.ext.element.create('LI', {\n        html: layer.get(\"title\") || layer.get(\"name\"),\n        on: { 'click touchstart': setVisibility },\n        parent: ul\n      });\n      self._setLayerForLI(d, layer);\n\t\t\tif (self.testLayerVisibility(layer)) d.classList.add(\"ol-layer-hidden\");\n\t\t\tif (layer.getVisible()) d.classList.add(\"select\");\n\t\t}\n\t});\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc OpenLayers Layer Switcher Control.\n * @require layer.getPreview\n *\n * @constructor\n * @extends {ol.control.LayerSwitcher}\n * @param {Object=} options Control options.\n */\nol.control.LayerSwitcherImage = function(options) {\n  options = options || {};\n\toptions.switcherClass = \"ol-layerswitcher-image\";\n\tif (options.mouseover!==false) options.mouseover=true;\n\tol.control.LayerSwitcher.call(this, options);\n};\nol.inherits(ol.control.LayerSwitcherImage, ol.control.LayerSwitcher);\n/** Render a list of layer\n * @param {elt} element to render\n * @layers {Array{ol.layer}} list of layer to show\n * @api stable\n */\nol.control.LayerSwitcherImage.prototype.drawList = function(ul, layers) {\n  var self = this;\n\tvar setVisibility = function(e) {\n    e.preventDefault(); \n\t\tvar l = self._getLayerForLI(this);\n\t\tself.switchLayerVisibility(l,layers);\n\t\tif (e.type==\"touchstart\") self.element.classList.add(\"ol-collapsed\");\n\t};\n\tol.ext.element.setStyle(ul, { height: 'auto' });\n\tlayers.forEach(function(layer) {\n    if (self.displayInLayerSwitcher(layer)) {\n      var preview = layer.getPreview ? layer.getPreview() : [\"none\"];\n      var d = ol.ext.element.create('LI', {\n        className: 'ol-imgcontainer' + (layer.getVisible() ? ' select':''),\n        on: { 'touchstart click': setVisibility },\n        parent: ul\n      });\n      self._setLayerForLI(d, layer);\n      preview.forEach(function(img){\n        ol.ext.element.create('IMG', {\n          src: img,\n          parent: d\n        })\n      });\n\t\t\tol.ext.element.create('p', {\n        html: layer.get(\"title\") || layer.get(\"name\"),\n        parent: d\n      });\n\t\t\tif (self.testLayerVisibility(layer)) d.classList.add('ol-layer-hidden');\n\t\t}\n\t});\n};\n/** Disable overflow\n*/\nol.control.LayerSwitcherImage.prototype.overflow = function(){};\n\n/** Create a legend for styles\n * @constructor\n * @fires select\n * @param {*} options\n *  @param {String} options.className class of the control\n *  @param {String} options.title Legend title\n *  @param {ol.size | undefined} options.size Size of the symboles in the legend, default [40, 25]\n *  @param {int | undefined} options.margin Size of the symbole's margin, default 10\n *  @param {boolean | undefined} options.collapsed Specify if attributions should be collapsed at startup. Default is true.\n *  @param {boolean | undefined} options.collapsible Specify if attributions can be collapsed, default true.\n *  @param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param { ol.style.Style | Array<ol.style.Style> | ol.StyleFunction | undefined\t} options.style a style or a style function to use with features\n * @extends {ol.control.Control}\n */\nol.control.Legend = function(options) {\n  options = options || {};\n  var element = document.createElement('div');\n  if (options.target) {\n    element.className = options.className || \"ol-legend\";\n  } else {\n    element.className = (options.className || \"ol-legend\")\n      +\" ol-unselectable ol-control ol-collapsed\"\n      +(options.collapsible===false ? ' ol-uncollapsible': '');\n    // Show on click\n    var button = document.createElement('button');\n    button.setAttribute('type', 'button');\n    button.addEventListener('click', function() {\n      element.classList.toggle('ol-collapsed');\n    });\n    element.appendChild(button);\n    // Hide on click\n    button = document.createElement('button');\n    button.setAttribute('type', 'button');\n    button.className = 'ol-closebox';\n    button.addEventListener('click', function() {\n      element.classList.toggle('ol-collapsed');\n    });\n    element.appendChild(button);\n  }\n  // The legend\n  this._imgElement = document.createElement('div');\n  this._imgElement.className = 'ol-legendImg';\n  element.appendChild(this._imgElement);\n  this._tableElement = document.createElement('ul');\n  element.appendChild(this._tableElement);\n\tol.control.Control.call(this, {\n    element: element,\n\t\ttarget: options.target\n\t});\n  this._rows = [];\n  this.set('size', options.size || [40, 25]);\n  this.set('margin', options.margin===0 ? 0 : options.margin || 10);\n  this.set('title', options.title || '');\n  // Set the style\n  this._style = options.style;\n  if (options.collapsed===false) this.show();\n  this.refresh();\n};\nol.inherits(ol.control.Legend, ol.control.Control);\n/** Set the style\n * @param { ol.style.Style | Array<ol.style.Style> | ol.StyleFunction | undefined\t} style a style or a style function to use with features\n */\nol.control.Legend.prototype.setStyle = function(style) {\n  this._style = style;\n  this.refresh();\n};\n/** Add a new row to the legend\n *  * You can provide in options:\n * - a feature width a style \n * - or a feature that will use the legend style function\n * - or properties ans a geometry type that will use the legend style function\n * - or a style and a geometry type\n * @param {*} options a list of parameters \n *  @param {ol.Feature} options.feature a feature to draw\n *  @param {ol.style.Style} options.style the style to use if no feature is provided\n *  @param {*} options.properties properties to use with a style function\n *  @param {string} options.typeGeom type geom to draw with the style or the properties\n */\nol.control.Legend.prototype.addRow = function(row) {\n  this._rows.push(row||{});\n  this.refresh();\n};\n/** Add a new row to the legend\n * @param {*} options a list of parameters \n *  @param {} options.\n */\nol.control.Legend.prototype.removeRow = function(index) {\n  this._rows.splice(index,1);\n  this.refresh();\n};\n/** Get a legend row\n * @param {int} index\n * @return {*}\n */\nol.control.Legend.prototype.getRow = function(index) {\n  return this._rows[index];\n};\n/** Get a legend row\n * @return {int}\n */\nol.control.Legend.prototype.getLength = function() {\n  return this._rows.length;\n};\n/** Refresh the legend\n */\nol.control.Legend.prototype.refresh = function() {\n  var self = this;\n  var table = this._tableElement\n  table.innerHTML = '';\n  var width = this.get('size')[0] + 2*this.get('margin');\n  var height = this.get('size')[1] + 2*this.get('margin');\n  // Add a new row\n  function addRow(str, title, r, i){\n    var row = document.createElement('li');\n    row.style.height = height + 'px';\n    row.addEventListener('click', function() {\n      self.dispatchEvent({ type:'select', title: str, row: r, index: i });\n    });\n    var col = document.createElement('div');\n    row.appendChild(col);\n    col.style.height = height + 'px';\n    col = document.createElement('div');\n    if (title) {\n      row.className = 'ol-title';\n    } else {\n      col.style.paddingLeft = width + 'px';\n    }\n    col.innerHTML = str || '';\n    row.appendChild(col);\n    table.appendChild(row);\n  }\n  if (this.get('title')) {\n    addRow(this.get('title'), true, {}, -1);\n  }\n  var canvas = document.createElement('canvas');\n  canvas.width = 5*width;\n  canvas.height = (this._rows.length+1) * height * ol.has.DEVICE_PIXEL_RATIO;\n  this._imgElement.innerHTML = '';\n  this._imgElement.append(canvas);\n  this._imgElement.style.height = (this._rows.length+1)*height + 'px';\n  for (var i=0, r; r = this._rows[i]; i++) {\n    addRow(r.title, false, r, i);\n    canvas = this.getStyleImage(r, canvas, i+(this.get('title')?1:0));\n  }\n};\n/** Show control\n */\nol.control.Legend.prototype.show = function() {\n  this.element.classList.remove('ol-collapsed');\n};\n/** Hide control\n */\nol.control.Legend.prototype.hide = function() {\n  this.element.classList.add('ol-collapsed');\n};\n/** Toggle control\n */\nol.control.Legend.prototype.toggle = function() {\n  this.element.classList.toggle('ol-collapsed');\n};\n/** Get the image for a style \n * You can provide in options:\n * - a feature width a style \n * - or a feature that will use the legend style function\n * - or properties and a geometry type that will use the legend style function\n * - or a style and a geometry type\n * @param {*} options\n *  @param {ol.Feature} options.feature a feature to draw\n *  @param {ol.style.Style} options.style the style to use if no feature is provided\n *  @param {*} options.properties properties to use with a style function\n *  @param {string} options.typeGeom type geom to draw with the style or the properties\n * @param {Canvas|undefined} canvas a canvas to draw in\n * @param {int|undefined} row row number to draw in canvas\n * @return {CanvasElement}\n */\nol.control.Legend.prototype.getStyleImage = function(options, theCanvas, row) {\n  options = options || {};\n  var size = this.get('size');\n  var width = size[0] + 2*this.get('margin');\n  var height = size[1] + 2*this.get('margin');\n  var canvas = theCanvas;\n  var ratio = ol.has.DEVICE_PIXEL_RATIO;\n  if (!canvas) {\n    canvas = document.createElement('canvas');\n    canvas.width = width * ratio;\n    canvas.height = height * ratio;\n  }\n  var ctx = canvas.getContext('2d');\n  ctx.save();\n  var vectorContext = ol.render.toContext(ctx);\n  var typeGeom = options.typeGeom;\n  var style;\n  var feature = options.feature;\n  if (!feature && options.properties && typeGeom) {\n    if (/Point/.test(typeGeom)) feature = new ol.Feature(new ol.geom.Point([0,0]));\n    else if (/LineString/.test(typeGeom)) feature = new ol.Feature(new ol.geom.LineString([0,0]));\n    else feature = new ol.Feature(new ol.geom.Polygon([[0,0]]));\n    feature.setProperties(options.properties);\n  }\n  if (feature) {\n    style = feature.getStyle();\n    if (!style) {\n      style = typeof(this._style) === 'function' ? this._style(feature) : this._style || [];\n    }\n    typeGeom = feature.getGeometry().getType();\n  } else {\n    style = options.style;\n  }\n  if (!(style instanceof Array)) style = [style];\n  var cx = width/2;\n  var cy = height/2;\n  var sx = size[0]/2;\n  var sy = size[1]/2;\n  var i, s;\n  // Get point offset\n  if (typeGeom === 'Point') {\n    var extent = null;\n    for (i=0; s= style[i]; i++) {\n      var img = s.getImage();\n      if (img && img.getAnchor) {\n        var anchor = img.getAnchor();\n        var si = img.getSize();\n        var dx = anchor[0] - si[0];\n        var dy = anchor[1] - si[1];\n        if (!extent) {\n          extent = [dx, dy, dx+si[0], dy+si[1]];\n        } else {\n          ol.extent.extend(extent, [dx, dy, dx+si[0], dy+si[1]]);\n        }\n      }\n    }\n    if (extent) {\n      cx = cx + (extent[2] + extent[0])/2;\n      cy = cy + (extent[3] + extent[1])/2;\n    }\n  }\n  // Draw image\n  cy += (theCanvas ? row*height : 0);\n  for (i=0; s= style[i]; i++) {\n    vectorContext.setStyle(s);\n    switch (typeGeom) {\n      case ol.geom.Point:\n      case 'Point':\n        vectorContext.drawGeometry(new ol.geom.Point([cx, cy]));\n        break;\n      case ol.geom.LineString:\n      case 'LineString':\n        ctx.save();\n          ctx.rect(this.get('margin') * ratio, 0, size[0] *  ratio, canvas.height);\n          ctx.clip();\n          vectorContext.drawGeometry(new ol.geom.LineString([[cx-sx, cy], [cx+sx, cy]]));\n        ctx.restore();\n        break;\n      case ol.geom.Polygon:\n      case 'Polygon':\n        vectorContext.drawGeometry(new ol.geom.Polygon([[[cx-sx, cy-sy], [cx+sx, cy-sy], [cx+sx, cy+sy], [cx-sx, cy+sy], [cx-sx, cy-sy]]]));\n        break;\n    }\n  }\n  ctx.restore();\n  return canvas;\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n//\n/** A control to jump from one zone to another.\n *\n * @constructor\n * @fires select\n * @extends {ol.control.Control}\n * @param {Object=} options Control options.\n *\t@param {string} options.className class name\n *\t@param {ol.layer.Layer} options.layer layer to display in the control\n *\t@param {ol.ProjectionLike} options.projection projection of the control, Default is EPSG:3857 (Spherical Mercator).\n *  @param {Array<any>} options.zone an array of zone: { name, extent (in EPSG:4326) }\n *  @param {bolean} options.centerOnClick center on click when click on zones, default true\n */\nol.control.MapZone = function(options) {\n  if (!options) options={};\n  var element = document.createElement(\"div\");\n  if (options.target) {\n    element = ol.ext.element.create('DIV', {\n      className: options.className || \"ol-mapzone\"\n    });\n  } else {\n    element = ol.ext.element.create('DIV', {\n      className: (options.className || \"ol-mapzone\") +' ol-unselectable ol-control ol-collapsed'\n    });\n    var bt = ol.ext.element.create('BUTTON', {\n      type: 'button',\n      on: {\n        'click': function() {\n          element.classList.toggle(\"ol-collapsed\");\n          maps.forEach(function (m) {\n            m.updateSize();\n          });\n        }.bind(this)\n      },\n      parent: element\n    });\n    ol.ext.element.create('I', {\n      parent: bt\n    });\n  }\n  // Parent control\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  // Create maps\n  var maps = [];\n  options.zones.forEach(function(z) {\n    var view = new ol.View({ zoom: 6, center: [0,0], projection: options.projection });\n    var extent = ol.proj.transformExtent(z.extent, 'EPSG:4326', view.getProjection());\n    console.log(extent, z.extent)\n    var div = ol.ext.element.create('DIV', {\n      className: 'ol-mapzonezone',\n      parent: element,\n      click : function() {\n        this.dispatchEvent({\n          type: 'select',\n          coordinate: ol.extent.getCenter(extent),\n          extent: extent\n        });\n        if (options.centerOnClick !== false) {\n          this.getMap().getView().fit(extent);\n        }\n        this.setVisible(false);\n      }.bind(this)\n    });\n    var layer = new options.layer.constructor({\n      source: options.layer.getSource()\n    });\n    var map = new ol.Map({\n      target: div,\n      view: view,\n      controls: [],\n      interactions:[],\n      layers: [layer]\n    });\n    maps.push(map);\n    view.fit(extent);\n    // Nmae\n    ol.ext.element.create('P', {\n      html: z.title,\n      parent: div\n    });\n  }.bind(this));\n  // Refresh the maps\n  setTimeout(function() {\n    maps.forEach(function (m) {\n      m.updateSize();\n    });\n  });\n};\nol.ext.inherits(ol.control.MapZone, ol.control.Control);\n/** Set the control visibility\n* @param {boolean} b\n*/\nol.control.MapZone.prototype.setVisible = function (b) {\n  if (b) this.element.classList.remove('ol-collapsed');\n  else this.element.classList.add('ol-collapsed');\n};\n/** Pre-defined zones */\nol.control.MapZone.zones = {};\n/** French overseas departments  */\nol.control.MapZone.zones.DOM = [{\n  \"title\": \"Guadeloupe\",\n  \"extent\": [ -61.898594315312444, 15.75623038647845, -60.957887532935324, 16.575317670979473 ]\n},{\n  \"title\": \"Guyane\",\n  \"extent\": [ -54.72525931072715, 2.1603763430019, -51.528236062921344, 5.7984307809552575 ]\n},{\n  \"title\": \"Martinique\",\n  \"extent\": [ -61.257556528564756, 14.387506317407514, -60.76934912110432, 14.895067461729951 ]\n},{\n  \"title\": \"Mayotte\",\n  \"extent\": [ 44.959844536967815, -13.01674138212816, 45.35328866510648, -12.65521942207829 ]\n},{\n  \"title\": \"La runion\",\n  \"extent\": [ 55.17059012967656, -21.407680069231688, 55.88195702001797, -20.85560221637526 ]\n}];\n/** French overseas territories */\nol.control.MapZone.zones.TOM = [{\n  \"title\": \"Polynsie Franaise\",\n  \"extent\": [ 206.23664226630862, -22.189040615809787, 221.85920743981987, -10.835039595040698 ]\n},{\n  \"title\": \"Nouvelle Caldonie\",\n  \"extent\": [ 163.76420580160925, -22.581641092751838, 167.66984709498706, -19.816411635668445 ]\n},{\n  \"title\": \"St-Pierre et Miquelon\",\n  \"extent\": [ -56.453698765748676, 46.74449858188555, -56.0980198121544, 47.14669874229787 ]\n},{\n  \"title\": \"Wallis et Futuna\",\n  \"extent\": [ 181.7588623143665, -14.7341169873267, 183.95612353301715, -13.134720799175085 ]\n},{\n  \"title\": \"St-Martin St-Barthlemy\",\n  \"extent\": [ -63.1726389501678, 17.806097291313506, -62.7606535945649, 18.13267688837938 ]\n}];\n/** French overseas departments and territories */\nol.control.MapZone.zones.DOMTOM = [{\n  title: 'Mtropole',\n  extent: [ -5.318421740712579, 41.16082274292913, 9.73284186155716, 51.21957336557702 ]\n}].concat(ol.control.MapZone.zones.DOM,ol.control.MapZone.zones.TOM);\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Control overlay for OL3\n * The overlay control is a control that display an overlay over the map\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fire change:visible\n * @param {Object=} options Control options.\n *  @param {string} className class of the control\n *  @param {boolean} hideOnClick hide the control on click, default false\n *  @param {boolean} closeBox add a closeBox to the control, default false\n */\nol.control.Notification = function(options) {\n  options = options || {};\n\tvar element = document.createElement(\"DIV\");\n  this.contentElement = document.createElement(\"DIV\");\n  element.appendChild(this.contentElement);\n  var classNames = (options.className||\"\")+ \" ol-notification\";\n\tif (!options.target) {\n    classNames += \" ol-unselectable ol-control ol-collapsed\";\n  }\n\telement.setAttribute('class', classNames);\n\tol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n};\nol.inherits(ol.control.Notification, ol.control.Control);\n/**\n * Display a notification on the map\n * @param {string|node|undefined} what the notification to show, default get the last one\n * @param {number} [duration=3000] duration in ms, if -1 never hide\n */\nol.control.Notification.prototype.show = function(what, duration) {\n  var self = this;\n  var elt = this.element;\n  if (what) {\n    if (what instanceof Node) {\n      this.contentElement.innerHTML = '';\n      this.contentElement.appendChild(what);\n    } else {\n      this.contentElement.innerHTML = what;\n    }\n  }\n  if (this._listener) {\n    clearTimeout(this._listener);\n    this._listener = null;\n  }\n  elt.classList.add('ol-collapsed');\n  this._listener = setTimeout(function() {\n    elt.classList.remove('ol-collapsed');\n    if (!duration || duration >= 0) {\n      self._listener = setTimeout(function() {\n        elt.classList.add('ol-collapsed');\n        self._listener = null;\n      }, duration || 3000);\n    } else {\n      self._listener = null;\n    }\n  }, 100);\n};\n/**\n * Remove a notification on the map\n */\nol.control.Notification.prototype.hide = function() {\n  if (this._listener) {\n    clearTimeout(this._listener);\n    this._listener = null;\n  }\n  this.element.classList.add('ol-collapsed');\n};\n/**\n * Toggle a notification on the map\n * @param {number} [duration=3000] duration in ms\n */\nol.control.Notification.prototype.toggle = function(duration) {\n  if (this.element.classList.contains('ol-collapsed')) {\n    this.show(null, duration);\n  } else {\n    this.hide();\n  }\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Control overlay for OL3\n * The overlay control is a control that display an overlay over the map\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fire change:visible\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {String|Element} options.content\n *\t@param {bool} options.hideOnClick hide the control on click, default false\n *\t@param {bool} options.closeBox add a closeBox to the control, default false\n */\nol.control.Overlay = function(options)\n{\tif (!options) options={};\n/*\n\tvar element = document.createElement(\"div\");\n\telement.classList.add('ol-unselectable', 'ol-overlay');\n\t//if (options.className) element.classList.add(options.className);\n*/\n\tvar element = ol.ext.element.create('DIV', {\n\t\tclassName: 'ol-unselectable ol-overlay '+(options.className||''),\n\t\thtml: options.content\n\t});\n\tol.control.Control.call(this,\n\t{\telement: element,\n\t\ttarget: options.target\n\t});\n\tvar self = this;\n\tif (options.hideOnClick) element.addEventListener(\"click\", function(){self.hide();});\n\tthis.set(\"closeBox\", options.closeBox);\n\tthis._timeout = false;\n\tthis.setContent (options.content);\n};\nol.inherits(ol.control.Overlay, ol.control.Control);\n/** Set the content of the overlay\n* @param {string|Element} html the html to display in the control\n*/\nol.control.Overlay.prototype.setContent = function (html)\n{\tvar self = this;\n\tif (html)\n\t{\tvar elt = this.element;\n\t\tif (html instanceof Element) elt.appendChild(html)\n\t\telse if (html!==undefined) elt.innerHTML = html;\n\t\tif (this.get(\"closeBox\"))\n\t\t{\tvar cb = document.createElement(\"div\");\n\t\t\t\t\tcb.classList.add(\"ol-closebox\");\n\t\t\t\t\tcb.addEventListener(\"click\", function(){self.hide();});\n\t\t\telt.insertBefore(cb, elt.firstChild);\n\t\t}\n\t}\n};\n/** Set the control visibility\n* @param {string|Element} html the html to display in the control\n* @param {ol.coordinate} coord coordinate of the top left corner of the control to start from\n*/\nol.control.Overlay.prototype.show = function (html, coord)\n{\tvar self = this;\n\tvar elt = this.element;\n\telt.style.display = 'block';\n\tif (coord) {\n\t\tthis.center_ = this.getMap().getPixelFromCoordinate(coord);\n\t\telt.style.top = this.center_[1]+'px';\n\t\telt.style.left = this.center_[0]+'px';\n\t} else {\n\t\t//TODO: Do fix from  hkollmann pull request\n\t\tthis.center_ = false;\n\t\telt.style.top = \"\";\n\t\telt.style.left = \"\";\n\t}\n\tif (html) this.setContent(html);\n\tif (this._timeout) clearTimeout(this._timeout);\n\tthis._timeout = setTimeout(function()\n\t\t{\telt.classList.add(\"ol-visible\")\n\t\t\telt.style.top = \"\";\n\t\t\telt.style.left = \"\";\n\t\t\tself.dispatchEvent({ type:'change:visible', visible:true, element: self.element });\n\t\t}, 10);\n\tself.dispatchEvent({ type:'change:visible', visible:false, element: self.element });\n};\n/** Set the control visibility hidden\n*/\nol.control.Overlay.prototype.hide = function ()\n{\tvar elt = this.element;\n\tthis.element.classList.remove(\"ol-visible\");\n\tif (this.center_)\n\t{\telt.style.top = this.center_[1]+'px';\n\t\telt.style.left = this.center_[0]+'px';\n\t\tthis.center_ = false;\n\t}\n\tif (this._timeout) clearTimeout(this._timeout);\n\tthis._timeout = setTimeout(function(){ elt.style.display = 'none'; }, 500);\n\tthis.dispatchEvent({ type:'change:visible', visible:false, element: this.element });\n};\n/** Toggle control visibility\n*/\nol.control.Overlay.prototype.toggle = function ()\n{\t\n\t/*\n\tif (this.getVisible()) this.element.style.display = 'none';\n\telse this.element.style.display = 'block';\n\tthis.element.classList.toggle('ol-visible');\n\t*/\n\tif (this.getVisible()) this.hide();\n\telse this.show();\n}\n/** Get the control visibility\n* @return {boolean} b\n*/\nol.control.Overlay.prototype.getVisible = function ()\n{\treturn ol.ext.element.getStyle(this.element, 'display') !== 'none';\n};\n/** Change class name\n* @param {String} className a class name or a list of class names separated by a space\n*/\nol.control.Overlay.prototype.setClass = function (className)\n{\tvar vis = this.element.classList.contains(\"ol-visible\");\n\tthis.element.className = \"\";\n\tvar classes = ['ol-unselectable', 'ol-overlay'];\n\tif (vis) classes.push('ol-visible');\n\tclasses = classes.concat(className.split(' '));\n\tthis.element.classList.add.apply(this.element.classList, classes);\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * OpenLayers 3 Layer Overview Control.\n * The overview can rotate with map. \n * Zoom levels are configurable.\n * Click on the overview will center the map.\n * Change width/height of the overview trough css.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options Control options.\n *  @param {ol.ProjectionLike} options.projection The projection. Default is EPSG:3857 (Spherical Mercator).\n *  @param {Number} options.minZoom default 0\n *  @param {Number} options.maxZoom default 18\n *  @param {boolean} options.rotation enable rotation, default false\n *  @param {top|bottom-left|right} options.align position\n *  @param {Array<ol.layer>} options.layers list of layers\n *  @param {ol.style.Style | Array.<ol.style.Style> | undefined} options.style style to draw the map extent on the overveiw\n *  @param {bool|elastic} options.panAnimation use animation to center map on click, default true\n */\nol.control.Overview = function(options)\n{\toptions = options || {};\n  var self = this;\n  // API\n  this.minZoom = options.minZoom || 0;\n  this.maxZoom = options.maxZoom || 18;\n  this.rotation = options.rotation;\n  var element;\n  if (options.target) {\n    element = document.createElement(\"div\");\n    this.panel_ = options.target;\n  } else {\n    element = document.createElement(\"div\");\n    element.classList.add('ol-overview', 'ol-unselectable', 'ol-control', 'ol-collapsed');\n    if (/top/.test(options.align)) element.classList.add('ol-control-top');\n    if (/right/.test(options.align)) element.classList.add('ol-control-right');\n    var button = document.createElement(\"button\");\n        button.setAttribute('type','button');\n        button.addEventListener(\"touchstart\", function(e){ self.toggleMap(); e.preventDefault(); });\n        button.addEventListener(\"click\", function(){self.toggleMap()});\n        element.appendChild(button);\n    this.panel_ = document.createElement(\"div\");\n    this.panel_.classList.add(\"panel\");\n    element.appendChild(this.panel_);\n  }\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  // Create a overview map\n  this.ovmap_ = new ol.Map({\n    controls: new ol.Collection(),\n    interactions: new ol.Collection(),\n    target: this.panel_,\n    view: new ol.View ({\n      zoom: 2,\n      center: [0,0],\n      projection: options.projection\n    }),\n    layers: options.layers\n  });\n  this.oview_ = this.ovmap_.getView();\n  // Cache extent\n  this.extentLayer = new ol.layer.Vector({\n    name: 'Cache extent',\n    source: new ol.source.Vector(),\n    style: options.style || [new ol.style.Style({\n      image: new ol.style.Circle({\n        fill: new ol.style.Fill({\n          color: 'rgba(255,0,0, 1)'\n        }),\n        stroke: new ol.style.Stroke({\n          width: 7,\n            color: 'rgba(255,0,0, 0.8)'\n          }),\n          radius: 5\n        }),\n        stroke: new ol.style.Stroke({\n          width: 5,\n          color: \"rgba(255,0,0,0.8)\"\n        })\n      }\n    )]\n  })\n  this.ovmap_.addLayer(this.extentLayer);\n  /** Elastic bounce\n  *\t@param {Int} bounce number of bounce\n  *\t@param {Number} amplitude amplitude of the bounce [0,1] \n  *\t@return {Number}\n  * /\n  var bounceFn = function (bounce, amplitude){\n    var a = (2*bounce+1) * Math.PI/2;\n    var b = amplitude>0 ? -1/amplitude : -100;\n    var c = - Math.cos(a) * Math.pow(2, b);\n    return function(t) {\n      t = 1-Math.cos(t*Math.PI/2);\n      return 1 + Math.abs( Math.cos(a*t) ) * Math.pow(2, b*t) + c*t;\n    }\n  }\n  /** Elastic bounce\n  *\t@param {Int} bounce number of bounce\n  *\t@param {Number} amplitude amplitude of the bounce [0,1] \n  *\t@return {Number}\n  */\n  var elasticFn = function (bounce, amplitude) {\n    var a = 3*bounce * Math.PI/2;\n    var b = amplitude>0 ? -1/amplitude : -100;\n    var c = Math.cos(a) * Math.pow(2, b);\n    return function(t){\n      t = 1-Math.cos(t*Math.PI/2);\n      return 1 - Math.cos(a*t) * Math.pow(2, b*t) + c*t;\n    }\n  }\n  // Click on the preview center the map\n  this.ovmap_.addInteraction (new ol.interaction.Pointer({\n    handleDownEvent: function(evt) {\n      if (options.panAnimation !==false) {\n        if (options.panAnimation==\"elastic\" || options.elasticPan) {\n          self.getMap().getView().animate({\n            center: evt.coordinate,\n            easing: elasticFn(2,0.3),\n            duration: 1000\n          });\n        } else {\n          self.getMap().getView().animate({\n            center: evt.coordinate,\n            duration: 300\n          });\n        }\n      }\n      else self.getMap().getView().setCenter(evt.coordinate);\n      return false;\n    }\n  }));\n};\nol.inherits(ol.control.Overview, ol.control.Control);\n/** Get overview map\n*\t@return {ol.Map}\n*/\nol.control.Overview.prototype.getOverviewMap = function(){\n  return this.ovmap_;\n};\n/** Toggle overview map\n*/\nol.control.Overview.prototype.toggleMap = function(){\n  this.element.classList.toggle(\"ol-collapsed\");\n  this.ovmap_.updateSize();\n  this.setView();\n};\n/** Set overview map position\n*\t@param {top|bottom-left|right}\n*/\nol.control.Overview.prototype.setPosition = function(align){\n  if (/top/.test(align)) this.element.classList.add(\"ol-control-top\");\n  else this.element.classList.remove(\"ol-control-top\");\n  if (/right/.test(align)) this.element.classList.add(\"ol-control-right\");\n  else this.element.classList.remove(\"ol-control-right\");\n};\n/**\n * Set the map instance the control associated with.\n * @param {ol.Map} map The map instance.\n */\nol.control.Overview.prototype.setMap = function(map) {\n  if (this._listener) ol.Observable.unByKey(this._listener);\n  this._listener = null;\n  ol.control.Control.prototype.setMap.call(this, map);\n  if (map) {\n    this._listener = map.getView().on('propertychange', this.setView.bind(this));\n    this.setView();\n  }\n};\n/** Calculate the extent of the map and draw it on the overview\n*/\nol.control.Overview.prototype.calcExtent_ = function(extent){\n  var map = this.getMap();\n  if (!map) return;\n  var source = this.extentLayer.getSource();\n  source.clear();\n  var f = new ol.Feature();\n  var size = map.getSize();\n  var resolution = map.getView().getResolution();\n  var rotation = map.getView().getRotation();\n  var center = map.getView().getCenter();\n  if (!resolution) return;\n  var dx = resolution * size[0] / 2;\n  var dy = resolution * size[1] / 2;\n  var res2 = this.oview_.getResolution();\n  if (dx/res2>5 || dy/res2>5) {\n    var cos = Math.cos(rotation);\n    var sin = Math.sin(rotation);\n    var i, x, y;\n    extent=[[-dx,-dy],[-dx,dy],[dx,dy],[dx,-dy]];\n    for (i = 0; i < 4; ++i) {\n      x = extent[i][0];\n      y = extent[i][1];\n      extent[i][0] = center[0] + x * cos - y * sin;\n      extent[i][1] = center[1] + x * sin + y * cos;\n    }\n    f.setGeometry (new ol.geom.Polygon( [ extent ]));\n  } else {\n    f.setGeometry (new ol.geom.Point( center ));\n  }\n  source.addFeature(f);\n};\n/**\n*\t@private\n*/\nol.control.Overview.prototype.setView = function(e){\n  if (!e) {\n    // refresh all\n    this.setView({key:'rotation'});\n    this.setView({key:'resolution'});\n    this.setView({key:'center'});\n    return;\n  }\n  // Set the view params\n  switch (e.key){\n    case 'rotation': {\n      if (this.rotation) this.oview_.setRotation(this.getMap().getView().getRotation());\n      else if (this.oview_.getRotation()) this.oview_.setRotation(0);\n      break;\n    }\n    case 'center': {\n      var mapExtent = this.getMap().getView().calculateExtent(this.getMap().getSize());\n      var extent = this.oview_.calculateExtent(this.ovmap_.getSize());\n      if (mapExtent[0]<extent[0] || mapExtent[1]<extent[1] \n      || mapExtent[2]>extent[2] || mapExtent[3]>extent[3]){\n        this.oview_.setCenter(this.getMap().getView().getCenter()); \n      }\n      break;\n    }\t\n    case 'resolution': {\n      //var z = Math.round(this.getMap().getView().getZoom()/2)*2-4;\n      var z = Math.round(this.oview_.getZoomForResolution(this.getMap().getView().getResolution())/2)*2-4;\n      z = Math.min ( this.maxZoom, Math.max(this.minZoom, z) );\n      this.oview_.setZoom(z);\n      break;\n    }\n    default: break;\n  }\n  this.calcExtent_();\n};\n\n/*\tCopyright (c) 2015-2018 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Permalink Control.    \n * \n *\tAdd a `permalink`property to layers to be handled by the control (and added in the url). \n *  The layer's permalink property is used to name the layer in the url.\n *\tThe control must be added after all layer are inserted in the map to take them into acount.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} options\n *\t@param {bool} options.urlReplace replace url or not, default true\n *\t@param {integer} options.fixed number of digit in coords, default 6\n *\t@param {bool} options.anchor use \"#\" instead of \"?\" in href\n *\t@param {function} options.onclick a function called when control is clicked\n */\nol.control.Permalink = function(opt_options) {\n  var options = opt_options || {};\n\tvar self = this;\n\tvar button = document.createElement('button');\n\tthis.replaceState_ = (options.urlReplace!==false);\n\tthis.fixed_ = options.fixed || 6;\n\tthis.hash_ = options.anchor ? \"#\" : \"?\";\n\tfunction linkto() {\n    if (typeof(options.onclick) == 'function') options.onclick(self.getLink());\n\t\telse self.setUrlReplace(!self.replaceState_);\n\t}\n  button.addEventListener('click', linkto, false);\n  button.addEventListener('touchstart', linkto, false);\n\tvar element = document.createElement('div');\n  element.className = (options.className || \"ol-permalink\") + \" ol-unselectable ol-control\";\n  element.appendChild(button);\n\tol.control.Control.call(this, {\n    element: element,\n\t\ttarget: options.target\n\t});\n\tthis.on ('change', this.viewChange_.bind(this));\n\t// Save search params\n\tthis.search_ = {};\n\tvar hash = document.location.hash || document.location.search;\n\tif (hash) {\n    hash = hash.replace(/(^#|^\\?)/,\"\").split(\"&\");\n\t\tfor (var i=0; i<hash.length;  i++) {\n      var t = hash[i].split(\"=\");\n\t\t\tswitch(t[0]) {\n        case 'lon':\n\t\t\t\tcase 'lat':\n\t\t\t\tcase 'z':\n\t\t\t\tcase 'r':\n\t\t\t\tcase 'l': break;\n\t\t\t\tdefault: this.search_[t[0]] = t[1];\n\t\t\t}\n\t\t}\n\t}\n\t// Decode permalink\n\tthis.setPosition();\n};\nol.inherits(ol.control.Permalink, ol.control.Control);\n/**\n * Set the map instance the control associated with.\n * @param {ol.Map} map The map instance.\n */\nol.control.Permalink.prototype.setMap = function(map) {\n\tif (this._listener) {\n\t\tol.Observable.unByKey(this._listener.change);\n\t\tol.Observable.unByKey(this._listener.moveend);\n\t}\n\tthis._listener = null;\n\tol.control.Control.prototype.setMap.call(this, map);\n\t// Get change \n\tif (map) \n\t{\tthis._listener = {\n\t\t\tchange: map.getLayerGroup().on('change', this.layerChange_.bind(this)),\n\t\t\tmoveend: map.on('moveend', this.viewChange_.bind(this))\n\t\t};\n\t\tthis.setPosition();\n\t}\n};\n/** Get layer given a permalink name (permalink propertie in the layer)\n*\t@param {string} the permalink to search for\n*\t@param {Array<ol.layer>|undefined} an array of layer to search in\n*\t@return {ol.layer|false}\n*/\nol.control.Permalink.prototype.getLayerByLink =  function (id, layers) {\n  if (!layers && this.getMap()) layers = this.getMap().getLayers().getArray();\n\tfor (var i=0; i<layers.length; i++) {\n    if (layers[i].get('permalink') == id) return layers[i];\n\t\t// Layer Group\n\t\tif (layers[i].getLayers) {\n      var li = this.getLayerByLink ( id, layers[i].getLayers().getArray() );\n\t\t\tif (li) return li;\n\t\t}\n\t}\n\treturn false;\n};\n/** Set map position according to the current link \n*/\nol.control.Permalink.prototype.setPosition = function() {\n  var map = this.getMap();\n\tif (!map) return;\n\tvar hash = document.location.hash || document.location.search;\n\tif (!hash) return;\n\tvar i, t, param = {};\n\thash = hash.replace(/(^#|^\\?)/,\"\").split(\"&\");\n\tfor (i=0; i<hash.length;  i++) {\n    t = hash[i].split(\"=\");\n\t\tparam[t[0]] = t[1];\n\t}\n\tvar c = ol.proj.transform([Number(param.lon),Number(param.lat)], 'EPSG:4326', map.getView().getProjection());\n\tif (c[0] && c[1]) map.getView().setCenter(c);\n\tif (param.z) map.getView().setZoom(Number(param.z));\n\tif (param.r) map.getView().setRotation(Number(param.r));\n\t// Reset layers visibility\n\tfunction resetLayers(layers) {\n    if (!layers) layers = map.getLayers().getArray();\n\t\tfor (var i=0; i<layers.length; i++){\n      if (layers[i].get('permalink')) {\n        layers[i].setVisible(false);\n\t\t\t\t// console.log(\"hide \"+layers[i].get('permalink'));\n\t\t\t}\n\t\t\tif (layers[i].getLayers) {\n        resetLayers (layers[i].getLayers().getArray());\n\t\t\t}\n\t\t}\n\t}\n\tif (param.l) {\n\t\tresetLayers();\n\t\tvar l = param.l.split(\"|\");\n    for (i=0; i<l.length; i++) {\n      t = l[i].split(\":\");\n\t\t\tvar li = this.getLayerByLink(t[0]);\n\t\t\tvar op = Number(t[1]);\n\t\t\tif (li) {\n        li.setOpacity(op);\n\t\t\t\tli.setVisible(true);\n\t\t\t}\n\t\t}\n\t}\n};\n/**\n * Get the parameters added to the url. The object can be changed to add new values.\n * @return {Object} a key value object added to the url as &key=value\n * @api stable\n */\nol.control.Permalink.prototype.getUrlParams = function() {\n  return this.search_;\n};\n/**\n * Set a parameter to the url.\n * @param {string} key the key parameter\n * @param {string|undefined} value the parameter's value, if undefined or empty string remove the parameter\n * @api stable\n */\nol.control.Permalink.prototype.setUrlParam = function(key, value) {\n  if (key) {\n    if (value===undefined || value==='') delete (this.search_[encodeURIComponent(key)])\n    else this.search_[encodeURIComponent(key)] = encodeURIComponent(value);\n  }\n  this.viewChange_();\n};\n/**\n * Get a parameter url.\n * @param {string} key the key parameter\n * @return {string} the parameter's value or empty string if not set\n * @api stable\n */\nol.control.Permalink.prototype.getUrlParam = function(key) {\n  return decodeURIComponent (this.search_[encodeURIComponent(key)] || '');\n};\n/**\n * Has a parameter url.\n * @param {string} key the key parameter\n * @return {boolean} \n * @api stable\n */\nol.control.Permalink.prototype.hasUrlParam = function(key) {\n  return this.search_.hasOwnProperty(encodeURIComponent(key));\n};\n/**\n * Get the permalink\n * @return {permalink}\n */\nol.control.Permalink.prototype.getLink = function() {\n  var map = this.getMap();\n\tvar c = ol.proj.transform(map.getView().getCenter(), map.getView().getProjection(), 'EPSG:4326');\n\tvar z = map.getView().getZoom();\n\tvar r = map.getView().getRotation();\n\tvar l = this.layerStr_;\n\t// Change anchor\n\tvar anchor = \"lon=\"+c[0].toFixed(this.fixed_)+\"&lat=\"+c[1].toFixed(this.fixed_)+\"&z=\"+z+(r?\"&r=\"+(Math.round(r*10000)/10000):\"\")+(l?\"&l=\"+l:\"\");\n\tfor (var i in this.search_) anchor += \"&\"+i+\"=\"+this.search_[i];\n\t//return document.location.origin+document.location.pathname+this.hash_+anchor;\n\treturn document.location.protocol+\"//\"+document.location.host+document.location.pathname+this.hash_+anchor;\n};\n/**\n * Enable / disable url replacement (replaceSate)\n *\t@param {bool}\n */\nol.control.Permalink.prototype.setUrlReplace = function(replace) {\n  try {\n\t\tthis.replaceState_ = replace;\n\t\tif (!replace) \n\t\t{\tvar s = \"\";\n\t\t\tfor (var i in this.search_)\n\t\t\t{\ts += (s==\"\"?\"?\":\"&\") + i+\"=\"+this.search_[i];\n\t\t\t}\n\t\t\twindow.history.replaceState (null,null, document.location.origin+document.location.pathname+s);\n\t\t}\n\t\telse window.history.replaceState (null,null, this.getLink());\n\t} catch(e) {/* ok */}\n}\n/**\n * On view change refresh link\n * @param {ol.event} The map instance.\n * @private\n */\nol.control.Permalink.prototype.viewChange_ = function() {\n  try {\n\t\tif (this.replaceState_) window.history.replaceState (null,null, this.getLink());\n\t} catch(e) {/* ok */}\n}\n/**\n * Layer change refresh link\n * @private\n */\nol.control.Permalink.prototype.layerChange_ = function() {\n  // Get layers\n\tvar l = \"\";\n  function getLayers(layers) {\n\t\tfor (var i=0; i<layers.length; i++) {\n\t\t\tif (layers[i].getVisible() && layers[i].get(\"permalink\")) {\n        if (l) l += \"|\";\n\t\t\t\tl += layers[i].get(\"permalink\")+\":\"+layers[i].get(\"opacity\");\n\t\t\t}\n\t\t\t// Layer Group\n\t\t\tif (layers[i].getLayers) getLayers(layers[i].getLayers().getArray());\n\t\t}\n\t}\n\tgetLayers(this.getMap().getLayers().getArray());\n\tthis.layerStr_ = l;\n\tthis.viewChange_();\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\n/**\n * @classdesc OpenLayers 3 Profil Control.\n *\tDraw a profil of a feature (with a 3D geometry)\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires  over, out, show\n * @param {Object=} _ol_control_ opt_options.\n *\n */\nol.control.Profil = function(opt_options)\n{\tvar options = opt_options || {};\n\tthis.info = options.info || ol.control.Profil.prototype.info;\n\tvar self = this;\n\tvar element;\n\tif (options.target)\n\t{\telement = document.createElement(\"div\");\n\t\telement.classList.add(options.className || \"ol-profil\");\n\t}\n\telse\n\t{\telement = document.createElement(\"div\");\n\t\telement.className = ((options.className || 'ol-profil') +' ol-unselectable ol-control ol-collapsed').trim();\n\t\tthis.button = document.createElement(\"button\");\n\t\tthis.button.setAttribute('type','button');\n\t\tvar click_touchstart_function = function(e)\n\t\t{\tself.toggle();\n\t\t\te.preventDefault();\n\t\t};\n\t\tthis.button.addEventListener(\"click\", click_touchstart_function);\n\t\tthis.button.addEventListener(\"touchstart\", click_touchstart_function);\n\t\telement.appendChild(this.button);\n\t}\n\tvar div_inner = document.createElement(\"div\");\n\t\t\tdiv_inner.classList.add(\"ol-inner\");\n\t\t\telement.appendChild(div_inner);\n\tvar div = document.createElement(\"div\");\n\t\t\tdiv.style.position = \"relative\";\n\t\t\tdiv_inner.appendChild(div);\n\tvar ratio = this.ratio = 2;\n\tthis.canvas_ = document.createElement('canvas');\n\tthis.canvas_.width = (options.width || 300)*ratio;\n\tthis.canvas_.height = (options.height || 150)*ratio;\n\tvar styles = {\n\t\t\"msTransform\":\"scale(0.5,0.5)\", \"msTransformOrigin\":\"0 0\",\n\t\t\"webkitTransform\":\"scale(0.5,0.5)\", \"webkitTransformOrigin\":\"0 0\",\n\t\t\"mozTransform\":\"scale(0.5,0.5)\", \"mozTransformOrigin\":\"0 0\",\n\t\t\"transform\":\"scale(0.5,0.5)\", \"transformOrigin\":\"0 0\"\n\t};\n\tObject.keys(styles).forEach(function(style) {\n\t\tif (style in self.canvas_.style) {\n\t\t\tself.canvas_.style[style] = styles[style];\n\t\t}\n\t});\n\tvar div_to_canvas = document.createElement(\"div\");\n\tdiv.appendChild(div_to_canvas);\n\tdiv_to_canvas.style.width = this.canvas_.width/ratio + \"px\";\n\tdiv_to_canvas.style.height = this.canvas_.height/ratio + \"px\";\n\tdiv_to_canvas.appendChild(this.canvas_);\n\tdiv_to_canvas.addEventListener(\"click\", function(e){ self.onMove(e); });\n\tdiv_to_canvas.addEventListener(\"mousemove\", function(e){ self.onMove(e); });\n\tol.control.Control.call(this,\n\t{\telement: element,\n\t\ttarget: options.target\n\t});\n\t// Offset in px\n\tthis.margin_ = { top:10*ratio, left:40*ratio, bottom:30*ratio, right:10*ratio };\n\tif (!this.info.ytitle) this.margin_.left -= 20*ratio;\n\tif (!this.info.xtitle) this.margin_.bottom -= 20*ratio;\n\t// Cursor\n\tthis.bar_ = document.createElement(\"div\");\n\tthis.bar_.classList.add(\"ol-profilbar\");\n\tthis.bar_.style.top = (this.margin_.top/ratio)+\"px\";\n\tthis.bar_.style.height = (this.canvas_.height-this.margin_.top-this.margin_.bottom)/ratio+\"px\";\n\tdiv.appendChild(this.bar_);\n\tthis.cursor_ = document.createElement(\"div\");\n\tthis.cursor_.classList.add(\"ol-profilcursor\");\n\tdiv.appendChild(this.cursor_);\n\tthis.popup_ = document.createElement(\"div\");\n\tthis.popup_.classList.add(\"ol-profilpopup\");\n\tthis.cursor_.appendChild(this.popup_);\n\t// Track information\n\tvar t = document.createElement(\"table\");\n\t\t\tt.cellPadding = '0';\n\t\t\tt.cellSpacing = '0';\n\t\t\tt.style.clientWidth = this.canvas_.width/ratio + \"px\";\n\t\tdiv.appendChild(t);\n\tvar firstTr = document.createElement(\"tr\");\n\t\t\tfirstTr.classList.add(\"track-info\");\n\t\t\tt.appendChild(firstTr);\n\tvar div_zmin = document.createElement(\"td\");\n\tdiv_zmin.innerHTML = (this.info.zmin||\"Zmin\")+': <span class=\"zmin\">';\n\tfirstTr.appendChild(div_zmin);\n\tvar div_zmax = document.createElement(\"td\");\n\tdiv_zmax.innerHTML = (this.info.zmax||\"Zmax\")+': <span class=\"zmax\">';\n\tfirstTr.appendChild(div_zmax);\n\tvar div_distance = document.createElement(\"td\");\n\tdiv_distance.innerHTML = (this.info.distance||\"Distance\")+': <span class=\"dist\">';\n\tfirstTr.appendChild(div_distance);\n\tvar div_time = document.createElement(\"td\");\n\tdiv_time.innerHTML = (this.info.time||\"Time\")+': <span class=\"time\">';\n\tfirstTr.appendChild(div_time);\n\tvar secondTr = document.createElement(\"tr\");\n\t\t\tsecondTr.classList.add(\"point-info\")\n\t\t\tt.appendChild(secondTr);\n\tvar div_altitude = document.createElement(\"td\");\n\tdiv_altitude.innerHTML = (this.info.altitude||\"Altitude\")+': <span class=\"z\">';\n\tsecondTr.appendChild(div_altitude);\n\tvar div_distance2 = document.createElement(\"td\");\n\tdiv_distance2.innerHTML = (this.info.distance||\"Distance\")+': <span class=\"dist\">';\n\tsecondTr.appendChild(div_distance2);\n\tvar div_time2 = document.createElement(\"td\");\n\tdiv_time2.innerHTML = (this.info.time||\"Time\")+': <span class=\"time\">';\n\tsecondTr.appendChild(div_time2);\n\t// Array of data\n\tthis.tab_ = [];\n\t// Show feature\n\tif (options.feature)\n\t{\tthis.setGeometry (options.feature);\n\t}\n};\nol.inherits(ol.control.Profil, ol.control.Control);\n/** Custom infos list\n* @api stable\n*/\nol.control.Profil.prototype.info =\n{\t\"zmin\": \"Zmin\",\n\t\"zmax\": \"Zmax\",\n\t\"ytitle\": \"Altitude (m)\",\n\t\"xtitle\": \"Distance (km)\",\n\t\"time\": \"Time\",\n\t\"altitude\": \"Altitude\",\n\t\"distance\": \"Distance\"\n};\n/** Show popup info\n* @param {string} info to display as a popup\n* @api stable\n*/\nol.control.Profil.prototype.popup = function(info)\n{\tthis.popup_.innerHTML = info;\n}\n/** Mouse move over canvas\n*/\nol.control.Profil.prototype.onMove = function(e)\n{\tif (!this.tab_.length) return;\n\tvar box_canvas = this.canvas_.getBoundingClientRect();\n\tvar pos = {\n    top: box_canvas.top + window.pageYOffset - document.documentElement.clientTop,\n    left: box_canvas.left + window.pageXOffset - document.documentElement.clientLeft\n  };\n\tvar dx = e.pageX -pos.left;\n\tvar dy = e.pageY -pos.top;\n\tvar ratio = this.ratio;\n\tif (dx>this.margin_.left/ratio && dx<(this.canvas_.width-this.margin_.right)/ratio\n\t\t&& dy>this.margin_.top/ratio && dy<(this.canvas_.height-this.margin_.bottom)/ratio)\n\t{\tthis.bar_.style.left = dx+\"px\";\n\t\tthis.bar_.style.display = \"block\";\n\t\tvar d = (dx*ratio-this.margin_.left)/this.scale_[0];\n\t\tvar p0 = this.tab_[0];\n\t\tfor (var i=1, p; p=this.tab_[i]; i++)\n\t\t{\tif (p[0]>=d)\n\t\t\t{\tif (d < (p[0]+p0[0])/2) p = p0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (p) {\n\t\t\tthis.cursor_.style.left = dx+\"px\";\n\t\t\tthis.cursor_.style.top = (this.canvas_.height-this.margin_.bottom+p[1]*this.scale_[1]+this.dy_)/ratio+\"px\";\n\t\t\tthis.cursor_.style.display = \"block\";\n\t\t}\n\t\telse {\n\t\t\tthis.cursor_.style.display = \"none\";\n\t\t}\n\t\tthis.bar_.parentElement.classList.add(\"over\");\n\t\tthis.element.querySelector(\".point-info .z\").textContent = p[1]+\"m\";\n\t\tthis.element.querySelector(\".point-info .dist\").textContent = (p[0]/1000).toFixed(1)+\"km\";\n\t\tthis.element.querySelector(\".point-info .time\").textContent = p[2];\n\t\tif (dx>this.canvas_.width/ratio/2) this.popup_.classList.add('ol-left');\n\t\telse this.popup_.classList.remove('ol-left');\n\t\tthis.dispatchEvent({ type:'over', click:e.type==\"click\", coord: p[3], time: p[2], distance: p[0] });\n\t}\n\telse\n\t{\tif (this.bar_.parentElement.classList.contains(\"over\"))\n\t\t{\tthis.bar_.style.display = 'none';\n\t\t\tthis.cursor_.style.display = 'none';\n\t\t\tthis.bar_.parentElement.classList.remove(\"over\");\n\t\t\tthis.dispatchEvent({ type:'out' });\n\t\t}\n\t}\n}\n/** Show panel\n* @api stable\n*/\nol.control.Profil.prototype.show = function()\n{\tthis.element.classList.remove(\"ol-collapsed\");\n\tthis.dispatchEvent({ type:'show', show: true });\n}\n/** Hide panel\n* @api stable\n*/\nol.control.Profil.prototype.hide = function()\n{\tthis.element.classList.add(\"ol-collapsed\");\n\tthis.dispatchEvent({ type:'show', show: false });\n}\n/** Toggle panel\n* @api stable\n*/\nol.control.Profil.prototype.toggle = function()\n{\tthis.element.classList.toggle(\"ol-collapsed\");\n\tvar b = this.element.classList.contains(\"ol-collapsed\");\n\tthis.dispatchEvent({ type:'show', show: !b });\n}\n/** Is panel visible\n*/\nol.control.Profil.prototype.isShown = function()\n{\treturn (!this.element.classList.contains(\"ol-collapsed\"));\n}\n/**\n * Set the geometry to draw the profil.\n * @param {ol.Feature|ol.geom} f the feature.\n * @param {Object=} options\n *\t\t- projection {ol.ProjectionLike} feature projection, default projection of the map\n *\t\t- zunit {m|km} default m\n *\t\t- unit {m|km} default km\n *\t\t- zmin {Number|undefined} default 0\n *\t\t- zmax {Number|undefined} default max Z of the feature\n *\t\t- graduation {Number|undefined} z graduation default 100\n *\t\t- amplitude {integer|undefined} amplitude of the altitude, default zmax-zmin\n * @api stable\n */\nol.control.Profil.prototype.setGeometry = function(g, options)\n{\tif (!options) options = {};\n\tif (g instanceof ol.Feature) g = g.getGeometry();\n\tvar canvas = this.canvas_;\n\tvar ctx = canvas.getContext('2d');\n\tvar w = canvas.width;\n\tvar h = canvas.height;\n\tctx.setTransform(1, 0, 0, 1, 0, 0);\n\tctx.clearRect(0,0, w, h);\n\t// No Z\n\tif (!/Z/.test(g.getLayout())) return;\n\t// No time\n\tif(/M/.test(g.getLayout())) this.element.querySelector(\".time\").parentElement.style.display = 'block';\n\telse this.element.querySelector(\".time\").parentElement.style.display = 'none';\n\t// Coords\n\tvar c = g.getCoordinates();\n\tswitch (g.getType())\n\t{\tcase \"LineString\": break;\n\t\tcase \"MultiLineString\": c = c[0]; break;\n\t\tdefault: return;\n\t}\n\t// Distance beetween 2 coords\n\tvar proj = options.projection || this.getMap().getView().getProjection();\n\tfunction dist2d(p1,p2)\n\t{\treturn ol.sphere.getDistance(\n\t\t\tol.proj.transform(p1, proj, 'EPSG:4326'),\n\t\t\tol.proj.transform(p2, proj, 'EPSG:4326'));\n\t}\n\tfunction getTime(t0, t1)\n\t{\tif (!t0 || !t1) return \"-\"\n\t\tvar dt = (t1-t0) / 60; // mn\n\t\tvar ti = Math.trunc(dt/60);\n\t\tvar mn = Math.trunc(dt-ti*60);\n\t\treturn ti+\"h\"+(mn<10?\"0\":\"\")+mn+\"mn\";\n\t}\n\t// Margin\n\tctx.setTransform(1, 0, 0, 1, this.margin_.left, h-this.margin_.bottom);\n\tvar ratio = this.ratio;\n\tw -= this.margin_.right + this.margin_.left;\n\th -= this.margin_.top + this.margin_.bottom;\n\t// Draw axes\n\tctx.strokeStyle = \"#000\";\n\tctx.lineWidth = 0.5*ratio;\n\tctx.beginPath();\n\tctx.moveTo(0,0); ctx.lineTo(0,-h);\n\tctx.moveTo(0,0); ctx.lineTo(w, 0);\n\tctx.stroke();\n\t//\n\tvar zmin=Infinity, zmax=-Infinity;\n\tvar i, p, d, z, ti, t = this.tab_ = [];\n\tfor (i=0, p; p=c[i]; i++)\n\t{\tz = p[2];\n\t\tif (z<zmin) zmin=z;\n\t\tif (z>zmax) zmax=z;\n\t\tif (i==0) d = 0;\n\t\telse d += dist2d(c[i-1], p);\n\t\tti = getTime(c[0][3],p[3]);\n\t\tt.push ([d, z, ti, p]);\n\t}\n\t// Info\n\tthis.element.querySelector(\".track-info .zmin\").textContent = zmin.toFixed(2)+\"m\";\n\tthis.element.querySelector(\".track-info .zmax\").textContent = zmax.toFixed(2)+\"m\";\n\tif (d>1000)\n\t{\tthis.element.querySelector(\".track-info .dist\").textContent = (d/1000).toFixed(1)+\"km\";\n\t}\n\telse\n\t{\tthis.element.querySelector(\".track-info .dist\").textContent= (d).toFixed(1)+\"m\";\n\t}\n\tthis.element.querySelector(\".track-info .time\").textContent = ti;\n\t// Set graduation\n\tvar grad = options.graduation || 100;\n\twhile (true)\n\t{\tzmax = Math.ceil(zmax/grad)*grad;\n\t\tzmin = Math.floor(zmin/grad)*grad;\n\t\tvar nbgrad = (zmax-zmin)/grad;\n\t\tif (h/nbgrad < 15*ratio)\n\t\t{\tgrad *= 2;\n\t\t}\n\t\telse break;\n\t}\n\t// Set amplitude\n\tif (typeof(options.zmin)=='number' && zmin > options.zmin) zmin = options.zmin;\n\tif (typeof(options.zmax)=='number' && zmax < options.zmax) zmax = options.zmax;\n\tvar amplitude = options.amplitude;\n\tif (amplitude)\n\t{\tzmax = Math.max (zmin + amplitude, zmax);\n\t}\n\t// Scales lines\n\tvar scx = w/d;\n\tvar scy = -h/(zmax-zmin);\n\tvar dy = this.dy_ = -zmin*scy;\n\tthis.scale_ = [scx,scy];\n\t// Draw\n\tctx.font = (10*ratio)+\"px arial\";\n\tctx.textAlign = \"right\";\n\tctx.textBaseline = \"middle\";\n\tctx.fillStyle=\"#000\";\n\t// Scale Z\n\tctx.beginPath();\n\tfor (i=zmin; i<=zmax; i+=grad)\n\t{\tif (options.zunit!=\"km\") ctx.fillText(i, -4*ratio, i*scy+dy);\n\t\telse ctx.fillText((i/1000).toFixed(1), -4*ratio, i*scy+dy);\n\t\tctx.moveTo (-2*ratio, i*scy+dy);\n\t\tif (i!=0) ctx.lineTo (d*scx, i*scy+dy);\n\t\telse ctx.lineTo (0, i*scy+dy);\n\t}\n\t// Scale X\n\tctx.textAlign = \"center\";\n\tctx.textBaseline = \"top\";\n\tctx.setLineDash([ratio,3*ratio]);\n\tvar unit = options.unit ||\"km\";\n\tvar step;\n\tif (d>1000)\n\t{\tstep = Math.round(d/1000)*100;\n\t\tif (step > 1000) step = Math.ceil(step/1000)*1000;\n\t}\n\telse\n\t{\tunit = \"m\";\n\t\tif (d>100) step = Math.round(d/100)*10;\n\t\telse if (d>10) step = Math.round(d/10);\n\t\telse if (d>1) step = Math.round(d)/10;\n\t\telse step = d;\n\t}\n\tfor (i=0; i<=d; i+=step)\n\t{\tvar txt = (unit==\"m\") ? i : (i/1000);\n\t\t//if (i+step>d) txt += \" \"+ (options.zunits || \"km\");\n\t\tctx.fillText(Math.round(txt*10)/10, i*scx, 4*ratio);\n\t\tctx.moveTo (i*scx, 2*ratio); ctx.lineTo (i*scx, 0);\n\t}\n\tctx.font = (12*ratio)+\"px arial\";\n\tctx.fillText(this.info.xtitle.replace(\"(km)\",\"(\"+unit+\")\"), w/2, 18*ratio);\n\tctx.save();\n\tctx.rotate(-Math.PI/2);\n\tctx.fillText(this.info.ytitle, h/2, -this.margin_.left);\n\tctx.restore();\n\tctx.stroke();\n\t// \n\tctx.strokeStyle = \"#369\";\n\tctx.lineWidth = 1;\n\tctx.setLineDash([]);\n\tctx.beginPath();\n\tfor (i=0; p=t[i]; i++)\n\t{\tif (i==0) ctx.moveTo(p[0]*scx,p[1]*scy+dy);\n\t\telse ctx.lineTo(p[0]*scx,p[1]*scy+dy);\n\t}\n\tctx.stroke();\n};\n/** Get profil image\n* @param {string|undefined} type image format or 'canvas' to get the canvas image, default image/png.\n* @param {Number|undefined} encoderOptions between 0 and 1 indicating image quality image/jpeg or image/webp, default 0.92.\n* @return {string} requested data uri\n* @api stable\n*/\nol.control.Profil.prototype.getImage = function(type, encoderOptions)\n{\tif (type===\"canvas\") return this.canvas_;\n\treturn this.canvas_.toDataURL(type, encoderOptions);\n}\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Geoportail routing Control.\n * @constructor\n * @extends {ol.control.Control}\n * @fires select\n * @fires change:input\n * @param {Object=} options\n *\t@param {string} options.className control class name\n *\t@param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *\t@param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *\t@param {string | undefined} options.inputLabel label for the input, default none\n *\t@param {string | undefined} options.noCollapse prevent collapsing on input blur, default false\n *\t@param {number | undefined} options.typing a delay on each typing to start searching (ms) use -1 to prevent autocompletion, default 300.\n *\t@param {integer | undefined} options.minLength minimum length to start searching, default 1\n *\t@param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *\t@param {integer | undefined} options.maxHistory maximum number of items to display in history. Set -1 if you don't want history, default maxItems\n *\t@param {function} options.getTitle a function that takes a feature and return the name to display in the index.\n *\t@param {function} options.autocomplete a function that take a search string and callback function to send an array\n */\nol.control.RoutingGeoportail = function(options) {\n  var self = this;\n  if (!options) options = {};\n  if (options.typing == undefined) options.typing = 300;\n  // Class name for history\n  this._classname = options.className || 'search';\n  var element = document.createElement(\"DIV\");\n  var classNames = (options.className||\"\")+ \" ol-routing\";\n  if (!options.target) {\n    classNames += \" ol-unselectable ol-control\";\n  }\n  element.setAttribute('class', classNames);\n\tif (!options.target) {\n    var bt = ol.ext.element.create('BUTTON', { parent: element })\n    bt.addEventListener('click', function(){\n      element.classList.toggle('ol-collapsed');\n    });\n  }\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  this.set('url', 'https://wxs.ign.fr/'+options.apiKey+'/itineraire/rest/route.json');\n  this._search = [];\n  var content = ol.ext.element.create('DIV', { className: 'content', parent: element } )\n  var listElt = document.createElement(\"DIV\");\n  this.addSearch(content, options);\n  this.addSearch(content, options);\n  content.appendChild(listElt);\n  ol.ext.element.create('I', { className: 'ol-car', title: options.carlabel||'by car', parent: content })\n    .addEventListener(\"click\", function() {\n      self.setMode('car');\n    });\n  ol.ext.element.create('I', { className: 'ol-pedestrian', title: options.pedlabel||'pedestrian', parent: content })\n    .addEventListener(\"click\", function() {\n      self.setMode('pedestrian');\n    });\n  ol.ext.element.create('I', { className: 'ol-ok', title: options.runlabel||'search', html:'OK', parent: content })\n    .addEventListener(\"click\", function() {\n      self.calculate();\n    });\n  this.resultElement = document.createElement(\"DIV\");\n  this.resultElement.setAttribute('class', 'ol-result');\n  element.appendChild(this.resultElement);\n  this.setMode(options.mode || 'car');\n};\nol.inherits(ol.control.RoutingGeoportail, ol.control.Control);\nol.control.RoutingGeoportail.prototype.setMode = function (mode) {\n  this.set('mode', mode);\n  this.element.querySelector(\".ol-car\").classList.remove(\"selected\");\n  this.element.querySelector(\".ol-pedestrian\").classList.remove(\"selected\");\n  this.element.querySelector(\".ol-\"+mode).classList.add(\"selected\");\n  this.calculate();\n};\nol.control.RoutingGeoportail.prototype.addButton = function (className, title, info) {\n  var bt = document.createElement(\"I\");\n  bt.setAttribute(\"class\", className);\n  bt.setAttribute(\"type\", \"button\");\n  bt.setAttribute(\"title\", title);\n  bt.innerHTML = info||'';\n  this.element.appendChild(bt);\n  return bt;\n};\n/** Add a new search input\n * @private\n */\nol.control.RoutingGeoportail.prototype.addSearch = function (element, options) {\n  var self = this;\n  var div = ol.ext.element.create(\"DIV\", { parent:element });\n  ol.ext.element.create ('BUTTON', { title: options.startlabel||\"search\", parent: div})\n    .addEventListener('click', function() {\n      self.resultElement.innerHTML = '';\n    });\n  var search = new ol.control.SearchGeoportail({\n    className: 'IGNF ol-collapsed',\n    apiKey: options.apiKey,\n    target: div\n  });\n  this._search.push(search);\n  search.on('select', function(e){\n    search.setInput(e.search.fulltext);\n    search.set('selection', e.search);\n  });\n  search.element.querySelector('input').addEventListener('change', function(){\n    search.set('selection', null);\n    self.resultElement.innerHTML = '';\n  });\n};\n/**\n * Set the map instance the control is associated with\n * and add its controls associated to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol.control.RoutingGeoportail.prototype.setMap = function (map) {\n  ol.control.Control.prototype.setMap.call(this, map);\n  for (var i=0; i<this._search.length; i++) {\n    var c = this._search[i];\n    c.setMap(map);\n  }\n};\n/** Get request data\n * @private\n */\nol.control.RoutingGeoportail.prototype.requestData = function (start, end) {\n  return {\n    'gp-access-lib': '1.1.0',\n    origin: start.x+','+start.y,\n    destination: end.x+','+end.y,\n    method: 'time', // 'distance'\n    graphName: this.get('mode')==='pedestrian' ? 'Pieton' : 'Voiture',\n    waypoints:'',\n    format: 'STANDARDEXT'\n  };\n};\n/** Show routing as a list\n * @private\n */\nol.control.RoutingGeoportail.prototype.listRouting = function (routing) {\n  var time = routing.duration/60;\n  this.resultElement.innerHTML = '';\n  var t = '';\n  if (time<60) {\n    t += time.toFixed(0)+' min';\n  } else {\n    t+= (time/60).toFixed(0)+' h '+(time%60).toFixed(0)+' min';\n  }\n  var dist = routing.distance;\n  if (dist<1000) {\n    t += ' ('+dist.toFixed(0)+' m)';\n  } else {\n    t += ' ('+(dist/1000).toFixed(2)+' km)';\n  }\n  var iElement = document.createElement('i');\n  iElement.textContent = t;\n  this.resultElement.appendChild(iElement)\n  var ul = document.createElement('ul');\n  this.resultElement.appendChild(ul);\n  var info = {\n    'none': 'Prendre sur ',\n    'R': 'Tourner  droite sur ',\n    'FR': 'Tourner lgrement  droite sur ',\n    'L': 'Tourner  gauche sur ',\n    'FL': 'Tourner lgrement  gauche sur ',\n    'F': 'Continuer tout droit sur ',\n  }\n  for (var i=0, f; f=routing.features[i]; i++) {\n    var d = f.get('distance');\n    d = (d<1000) ? d.toFixed(0)+' m' : (d/1000).toFixed(2)+' km';\n    t = f.get('durationT')/60;\n    console.log(f.get('duration'),t)\n    t = (f.get('duration')<40) ? '' : (t<60) ? t.toFixed(0)+' min' : (t/60).toFixed(0)+' h '+(t%60).toFixed(0)+' min';\n    var li = document.createElement('li');\n        li.classList.add(f.get('instruction'));\n        li.innerHTML = (info[f.get('instruction')||'none']||'#')\n      + ' ' + f.get('name')\n      + '<i>' + d + (t ? ' - ' + t : '') +'</i>'\n    ul.appendChild(li);\n  }\n};\n/** Handle routing response\n * @private\n */\nol.control.RoutingGeoportail.prototype.handleResponse = function (data, start, end) {\n  var routing = { type:'routing' };\n/*\n  var format = new ol.format.WKT();\n  routing.features = [ format.readFeature(data.geometryWkt, {\n    dataProjection: 'EPSG:4326',\n    featureProjection: this.getMap().getView().getProjection()\n  }) ];\n*/\n  routing.features = [];\n  var distance = 0;\n  var duration = 0;\n  var f, route = [];\n  for (var i=0, l; l=data.legs[i]; i++) {\n    for (var j=0, s; s=l.steps[j]; j++) {\n      var geom = [];\n      for (var k=0, p; p=s.points[k]; k++){\n        p = p.split(',');\n        geom.push([parseFloat(p[0]),parseFloat(p[1])]);\n        if (i===0 || k!==0) route.push(geom[k]);\n      }\n      geom = new ol.geom.LineString(geom);\n      var options = {\n        geometry: geom.transform('EPSG:4326',this.getMap().getView().getProjection()),\n        name: s.name,\n        instruction: s.navInstruction,\n        distance: parseFloat(s.distanceMeters),\n        duration: parseFloat(s.durationSeconds)\n      }\n      //console.log(duration, options.duration, s)\n      distance += options.distance;\n      duration += options.duration;\n      options.distanceT = distance;\n      options.durationT = duration;\n      f = new ol.Feature(options);\n      routing.features.push(f);\n    }\n  }\n  routing.distance = parseFloat(data.distanceMeters);\n  routing.duration = parseFloat(data.durationSeconds);\n  // Full route\n  route = new ol.geom.LineString(route);\n  routing.feature = new ol.Feature ({\n    geometry: route.transform('EPSG:4326',this.getMap().getView().getProjection()),\n    start: this._search[0].getTitle(start),\n    end: this._search[0].getTitle(end), \n    distance: routing.distance,\n    duration: routing.duration\n  });\n  // console.log(data, routing);\n  this.dispatchEvent(routing);\n  this.path = routing;\n  return routing;\n};\n/** Calculate route\n * \n */\nol.control.RoutingGeoportail.prototype.calculate = function () {\n  this.resultElement.innerHTML = '';\n  for (var i=0; i<this._search.length; i++) {\n    if (!this._search[i].get('selection')) return;\n  }\n  var start = this._search[0].get('selection');\n  var end = this._search[1].get('selection');\n  var data = this.requestData(start,end);\n  var url = encodeURI(this.get('url'));\n  var parameters = '';\n  for (var index in data) {\n    parameters += (parameters) ? '&' : '?';\n    if (data.hasOwnProperty(index)) parameters += index + '=' + data[index];\n  }\n  var self = this;\n  this.ajax(url + parameters, \n    function (resp) {\n      if (resp.status >= 200 && resp.status < 400) {\n        self.listRouting(self.handleResponse (JSON.parse(resp.response), start, end));\n      } else {\n        console.log(url + parameters, arguments);\n      }\n    }, function(){\n      console.log(url + parameters, arguments);\n    });\n};\t\n/** Send an ajax request (GET)\n * @param {string} url\n * @param {function} onsuccess callback\n * @param {function} onerror callback\n */\nol.control.RoutingGeoportail.prototype.ajax = function (url, onsuccess, onerror){\n  var self = this;\n  // Abort previous request\n  if (this._request) {\n    this._request.abort();\n  }\n  // New request\n  var ajax = this._request = new XMLHttpRequest();\n  ajax.open('GET', url, true);\n  if (this._auth) {\n    ajax.setRequestHeader(\"Authorization\", \"Basic \" + this._auth);\n  }\n  this.element.classList.add('ol-searching');\n  // Load complete\n  ajax.onload = function() {\n    self._request = null;\n    self.element.classList.remove('ol-searching');\n    onsuccess.call(self, this);\n  };\n  // Oops, TODO do something ?\n  ajax.onerror = function() {\n    self._request = null;\n    self.element.classList.remove('ol-searching');\n    if (onerror) onerror.call(self);\n  };\n  // GO!\n  ajax.send();\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Scale Control.\n * A control to display the scale of the center on the map\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires select\n * @fires change:input\n * @param {Object=} options\n *  @param {string} options.className control class name\n *  @param {string} options.ppi screen ppi, default 96\n * \t@param {string} options.editable make the control editable, default true\n */\nol.control.Scale = function(options) {\n  if (!options) options = {};\n  if (options.typing == undefined) options.typing = 300;\n  var element = document.createElement(\"DIV\");\n  var classNames = (options.className||\"\")+ \" ol-scale\";\n  if (!options.target) {\n  classNames += \" ol-unselectable ol-control\";\n  }\n  this._input = document.createElement(\"INPUT\");\n  this._input.value = '-';\n  element.setAttribute('class', classNames);\n  if (options.editable===false) this._input.readOnly = true;\n  element.appendChild(this._input);\n  ol.control.Control.call(this, {\n  element: element,\n  target: options.target\n  });\n  this._input.addEventListener(\"change\", this.setScale.bind(this));\n  this.set('ppi', options.ppi || 96)\n};\nol.inherits(ol.control.Scale, ol.control.Control);\n/**\n * Remove the control from its current map and attach it to the new map.\n * Subclasses may set up event handlers to get notified about changes to\n * the map here.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.control.Scale.prototype.setMap = function (map) {\n  if (this._listener) ol.Observable.unByKey(this._listener);\n  this._listener = null;\n  ol.control.Control.prototype.setMap.call(this, map);\n  // Get change (new layer added or removed)\n  if (map) {\n    this._listener = map.on('moveend', this._showScale.bind(this));\n  }\n};\n/** Display the scale\n */\nol.control.Scale.prototype._showScale = function () {\n  var map = this.getMap();\n  if (map) {\n    var view = map.getView();\n    var proj = view.getProjection();\n    var center = view.getCenter();\n    var px = map.getPixelFromCoordinate(center);\n    px[1] += 1;\n    var coord = map.getCoordinateFromPixel(px);\n    var d = ol.sphere.getDistance(\n      ol.proj.transform(center, proj, 'EPSG:4326'),\n      ol.proj.transform(coord, proj, 'EPSG:4326'));\n    d *= this.get('ppi')/.0254\n    this._input.value = this.formatScale(d);\n  }\n};\n/** Format the scale 1/d\n * @param {Number} d\n * @return {string} formated string\n */\nol.control.Scale.prototype.formatScale = function (d) {\n  if (d>100) d = Math.round(d/100) * 100;\n  else d = Math.round(d);\n  return '1 / '+ d.toLocaleString();\n};\n/** Set the current scale (will change the scale of the map)\n * @param {Number} value the scale factor\n */\nol.control.Scale.prototype.setScale = function (value) {\n  var map = this.getMap();\n  if (map && value) {\n    if (value.target) value = value.target.value;\n    var fac = value;\n    if (typeof(value)==='string') {\n      fac = value.split('/')[1];\n      if (!fac) fac = value;\n      fac = fac.replace(/[^\\d]/g,'');\n      fac = parseInt(fac);\n    }\n    // Calculate new resolution\n    var view = map.getView();\n    var proj = view.getProjection();\n    var center = view.getCenter();\n    var px = map.getPixelFromCoordinate(center);\n    px[1] += 1;\n    var coord = map.getCoordinateFromPixel(px);\n    var d = ol.sphere.getDistance(\n      ol.proj.transform(center, proj, 'EPSG:4326'),\n      ol.proj.transform(coord, proj, 'EPSG:4326'));\n    d *= this.get('ppi')/.0254\n    view.setResolution(view.getResolution()*fac/d);\n  }\n  this._showScale();\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search places using the French National Base Address (BAN) API.\n *\n * @constructor\n * @extends {ol.control.Search}\n * @fires select\n * @param {Object=} Control options.\n *\t@param {string} options.className control class name\n *\t@param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *\t@param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *\t@param {number | undefined} options.typing a delay on each typing to start searching (ms), default 500.\n *\t@param {integer | undefined} options.minLength minimum length to start searching, default 3\n *\t@param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *\n *\t@param {string|undefined} options.url Url to BAN api, default \"https://api-adresse.data.gouv.fr/search/\"\n *\t@param {boolean} options.position Search, with priority to geo position, default false\n *\t@param {function} options.getTitle a function that takes a feature and return the text to display in the menu, default return label attribute\n * @see {@link https://adresse.data.gouv.fr/api/}\n */\nol.control.SearchBAN = function(options)\n{\toptions = options || {};\n    options.typing = options.typing || 500;\n    options.url = options.url || \"https://api-adresse.data.gouv.fr/search/\";\n    options.className = options.className || 'BAN';\n    ol.control.SearchPhoton.call(this, options);\n    this.set(\"copy\",\"<a href='https://adresse.data.gouv.fr/' target='new'>&copy; BAN-data.gouv.fr</a>\");\n};\nol.inherits(ol.control.SearchBAN, ol.control.SearchPhoton);\n/** Returns the text to be displayed in the menu\n *\t@param {ol.Feature} f the feature\n *\t@return {string} the text to be displayed in the index\n *\t@api\n */\nol.control.SearchBAN.prototype.getTitle = function (f) {\n    var p = f.properties;\n    return (p.label);\n};\n/** A ligne has been clicked in the menu > dispatch event\n *\t@param {any} f the feature, as passed in the autocomplete\n *\t@api\n */\nol.control.SearchBAN.prototype.select = function (f){\n    var c = f.geometry.coordinates;\n    // Add coordinate to the event\n    try {\n        c = ol.proj.transform (f.geometry.coordinates, 'EPSG:4326', this.getMap().getView().getProjection());\n    } catch(e) { /* ok */ }\n    this.dispatchEvent({ type:\"select\", search:f, coordinate: c });\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search on DFCI grid.\n *\n * @constructor\n * @extends {ol.control.Search}\n * @fires select\n * @param {Object=} Control options. \n *\t@param {string} options.className control class name\n *\t@param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *\t@param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *\t@param {number | undefined} options.typing a delay on each typing to start searching (ms), default 300.\n *\t@param {integer | undefined} options.minLength minimum length to start searching, default 1\n *\t@param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *\n *\t@param {string | undefined} options.property a property to display in the index, default 'name'.\n *\t@param {function} options.getTitle a function that takes a feature and return the name to display in the index, default return the property \n *\t@param {function | undefined} options.getSearchString a function that take a feature and return a text to be used as search string, default geTitle() is used as search string\n */\nol.control.SearchDFCI = function(options) {\n  if (!options) options = {};\n  options.className = options.className || 'dfci';\n  options.placeholder = options.placeholder || 'Code DFCI';\n  ol.control.Search.call(this, options);\n};\nol.inherits(ol.control.SearchDFCI, ol.control.Search);\n/** Autocomplete function\n* @param {string} s search string\n* @return {Array<any>|false} an array of search solutions or false if the array is send with the cback argument (asnchronous)\n* @api\n*/\nol.control.SearchDFCI.prototype.autocomplete = function (s) {\n  s = s.toUpperCase();\n  s = s.replace(/[^0-9,^A-H,^K-N]/g,'');\n  if (s.length<2) {\n    this.setInput(s);\n    return [];\n  }\n  var i;\n  var proj = this.getMap().getView().getProjection();\n  var result = [];\n  var c = ol.coordinate.fromDFCI(s, proj);\n  var level = Math.floor(s.length/2)-1;\n  var dfci = ol.coordinate.toDFCI(c, level, proj);\n  dfci = dfci.replace(/[^0-9,^A-H,^K-N]/g,'');\n  // Valid DFCI ?\n  if (!/NaN/.test(dfci) && dfci) {\n    console.log('ok', dfci)\n    this.setInput(dfci + s.substring(dfci.length, s.length));\n    result.push({ coordinate: ol.coordinate.fromDFCI(dfci, proj), name: dfci });\n    if (s.length===5) {\n      c = ol.coordinate.fromDFCI(s+0, proj);\n      dfci = (ol.coordinate.toDFCI(c, level+1, proj)).substring(0,5);\n      for (i=0; i<10; i++) {\n        result.push({ coordinate: ol.coordinate.fromDFCI(dfci+i, proj), name: dfci+i });\n      }\n    }\n    if (level === 2) {\n      for (i=0; i<6; i++) {\n        result.push({ coordinate: ol.coordinate.fromDFCI(dfci+'.'+i, proj), name: dfci+'.'+i });\n      }\n    }\n  }\n  return result;\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search features.\n *\n * @constructor\n * @extends {ol.control.Search}\n * @fires select\n * @param {Object=} Control options. \n *\t@param {string} options.className control class name\n *\t@param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *\t@param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *\t@param {number | undefined} options.typing a delay on each typing to start searching (ms), default 300.\n *\t@param {integer | undefined} options.minLength minimum length to start searching, default 1\n *\t@param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *\n *\t@param {string | undefined} options.property a property to display in the index, default 'name'.\n *\t@param {function} options.getTitle a function that takes a feature and return the name to display in the index, default return the property \n *\t@param {function | undefined} options.getSearchString a function that take a feature and return a text to be used as search string, default geTitle() is used as search string\n */\nol.control.SearchFeature = function(options) {\n  if (!options) options = {};\n  options.className = options.className || 'feature';\n  ol.control.Search.call(this, options);\n  if (typeof(options.getSearchString)==\"function\") this.getSearchString = options.getSearchString;\n  this.set('property', options.property || 'name');\n  this.source_ = options.source;\n};\nol.inherits(ol.control.SearchFeature, ol.control.Search);\n/** No history avaliable on features\n */\nol.control.SearchFeature.prototype.restoreHistory = function () {\n  this.set('history', []);\n};\n/** No history avaliable on features\n */\nol.control.SearchFeature.prototype.saveHistory = function () {\n  localStorage.removeItem(\"ol@search-\"+this._classname);\n}\n/** Returns the text to be displayed in the menu\n*\t@param {ol.Feature} f the feature\n*\t@return {string} the text to be displayed in the index\n*\t@api\n*/\nol.control.SearchFeature.prototype.getTitle = function (f) {\n  return f.get(this.get('property')||'name');\n};\n/** Return the string to search in\n*\t@param {ol.Feature} f the feature\n*\t@return {string} the text to be used as search string\n*\t@api\n*/\nol.control.SearchFeature.prototype.getSearchString = function (f) {\n  return this.getTitle(f);\n};\n/** Get the source\n*\t@return {ol.source.Vector}\n*\t@api\n*/\nol.control.SearchFeature.prototype.getSource = function () {\n  return this.source_;\n}\n/** Get the source\n*\t@param {ol.source.Vector} source\n*\t@api\n*/\nol.control.SearchFeature.prototype.setSource = function (source) {\n  this.source_ =  source;\n};\n/** Autocomplete function\n* @param {string} s search string\n* @param {int} max max \n* @param {function} cback a callback function that takes an array to display in the autocomplete field (for asynchronous search)\n* @return {Array<any>|false} an array of search solutions or false if the array is send with the cback argument (asnchronous)\n* @api\n*/\nol.control.SearchFeature.prototype.autocomplete = function (s) {\n  var result = [];\n  if (this.source_) {\n    // regexp\n    s = s.replace(/^\\*/,'');\n    var rex = new RegExp(s, 'i');\n    // The source\n    var features = this.source_.getFeatures();\n    var max = this.get('maxItems')\n    for (var i=0, f; f=features[i]; i++) {\n      var att = this.getSearchString(f);\n      if (att !== undefined && rex.test(att)) {\n        result.push(f);\n        if ((--max)<=0) break;\n      }\n    }\n  }\n  return result;\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search on GPS coordinate.\n *\n * @constructor\n * @extends {ol.control.Search}\n * @fires select\n * @param {Object=} Control options. \n *  @param {string} options.className control class name\n *  @param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *  @param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *  @param {number | undefined} options.typing a delay on each typing to start searching (ms), default 300.\n *  @param {integer | undefined} options.minLength minimum length to start searching, default 1\n *  @param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n */\nol.control.SearchGPS = function(options) {\n  if (!options) options = {};\n  options.className = (options.className || '') + ' ol-searchgps';\n  options.placeholder = options.placeholder || 'lon,lat';\n  ol.control.Search.call(this, options);\n  // Geolocation\n  this.geolocation = new ol.Geolocation({\n    projection: \"EPSG:4326\",\n    trackingOptions: {\n      maximumAge: 10000,\n      enableHighAccuracy: true,\n      timeout: 600000\n    }\n  });\n  ol.ext.element.create ('BUTTON', {\n    className: 'ol-geoloc',\n    title: 'Locate with GPS',\n    parent: this.element,\n    click: function(){\n      this.geolocation.setTracking(true);\n    }.bind(this)\n  })\n  // DMS switcher\n  var dms = ol.ext.element.create('LABEL', {\n    className: 'ol-switch',\n    parent: this.element\n  });\n  ol.ext.element.create('TEXT', {\n    html: 'decimal',\n    parent: dms\n  });\n  ol.ext.element.create('INPUT', {\n    type: 'checkbox',\n    parent: dms,\n    on: {\n      'change': function(e) {\n        if (e.target.checked) this.element.classList.add('ol-dms');\n        else this.element.classList.remove('ol-dms');\n      }.bind(this)\n    }\n  });\n  ol.ext.element.create ('SPAN', {\n    parent: dms\n  });\n  ol.ext.element.create('TEXT', {\n    html: 'DMS',\n    parent: dms\n  });\n  this._createForm();\n  // Move list to the end\n  var ul = this.element.querySelector(\"ul.autocomplete\");\n  this.element.appendChild(ul);\n};\nol.inherits(ol.control.SearchGPS, ol.control.Search);\n/** Create input form\n * @private\n */\nol.control.SearchGPS.prototype._createForm = function () {\n  // Value has change\n  var onchange = function(e) {\n    if (e.target.classList.contains('ol-dms')) {\n      lon.value = (lond.value<0 ? -1:1) * Number(lond.value) + Number(lonm.value)/60 + Number(lons.value)/3600;\n      lon.value = (lond.value<0 ? -1:1) * Math.round(lon.value*10000000)/10000000;\n      lat.value = (latd.value<0 ? -1:1) * Number(latd.value) + Number(latm.value)/60 + Number(lats.value)/3600;\n      lat.value = (latd.value<0 ? -1:1) * Math.round(lat.value*10000000)/10000000;\n    }\n    if (lon.value||lat.value) {\n      this._input.value = lon.value+','+lat.value;\n    } else {\n      this._input.value = '';\n    }\n    if (!e.target.classList.contains('ol-dms')) {\n      var s = ol.coordinate.toStringHDMS([Number(lon.value), Number(lat.value)]);\n      var c = s.replace(/(N|S|E|W)/g,'').split('');\n      c[1] = c[1].trim().split(' ');\n      lond.value = (/W/.test(s) ? -1 : 1) * parseInt(c[1][0]);\n      lonm.value = parseInt(c[1][1]);\n      lons.value = parseInt(c[1][2]);\n      c[0] = c[0].trim().split(' ');\n      latd.value = (/W/.test(s) ? -1 : 1) * parseInt(c[0][0]);\n      latm.value = parseInt(c[0][1]);\n      lats.value = parseInt(c[0][2]);\n    }\n    this._input.dispatchEvent(new Event('search'));\n  }.bind(this);\n  function createInput(className, unit) {\n    var input = ol.ext.element.create('INPUT', {\n      className: className,\n      type:'number',\n      step:'any',\n      lang: 'en',\n      parent: div,\n      on: {\n        'change keyup': onchange\n      }\n    });\n    if (unit) {\n      ol.ext.element.create('SPAN', {\n        className: 'ol-dms',\n        html: unit,\n        parent: div,\n      });\n    }\n    return input;\n  }\n  // Longitude\n  var div = ol.ext.element.create('DIV', {\n    className: 'ol-longitude',\n    parent: this.element\n  });\n  ol.ext.element.create('LABEL', {\n    html: 'Longitude',\n    parent: div\n  });\n  var lon = createInput('ol-decimal');\n  var lond = createInput('ol-dms','');\n  var lonm = createInput('ol-dms','\\'');\n  var lons = createInput('ol-dms','\"');\n  // Latitude\n  div = ol.ext.element.create('DIV', {\n    className: 'ol-latitude',\n    parent: this.element\n  })\n  ol.ext.element.create('LABEL', {\n    html: 'Latitude',\n    parent: div\n  });\n  var lat = createInput('ol-decimal');\n  var latd = createInput('ol-dms','');\n  var latm = createInput('ol-dms','\\'');\n  var lats = createInput('ol-dms','\"');\n  // Focus\n  this.button.addEventListener(\"click\", function() {\n    lon.focus();\n  });\n  // Change value on click\n  this.on('select', function(e){\n    lon.value = e.search.gps[0];\n    lat.value = e.search.gps[1];\n  }.bind(this));\n  // Change value on geolocation\n  this.geolocation.on('change', function(){\n    this.geolocation.setTracking(false);\n    var coord = this.geolocation.getPosition();\n    lon.value = coord[0];\n    lat.value = coord[1];\n    lon.dispatchEvent(new Event('keyup'));\n  }.bind(this));\n};\n/** Autocomplete function\n* @param {string} s search string\n* @return {Array<any>|false} an array of search solutions\n* @api\n*/\nol.control.SearchGPS.prototype.autocomplete = function (s) {\n  var result = [];\n  var c = s.split(',');\n  c[0] = Number(c[0]);\n  c[1] = Number(c[1]);\n  // Name\n  s = ol.coordinate.toStringHDMS(c)\n  if (s) s= s.replace(/(||) /g,'$1');\n  // \n  var coord = ol.proj.transform ([c[0], c[1]], 'EPSG:4326', this.getMap().getView().getProjection());\n  result.push({ gps: c, coordinate: coord, name: s });\n  return result;\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search places using the French National Base Address (BAN) API.\n *\n * @constructor\n * @extends {ol.control.SearchJSON}\n * @fires select\n * @param {any} options extend ol.control.SearchJSON options\n *\t@param {string} options.className control class name\n *\t@param {boolean | undefined} options.apiKey the service api key.\n *\t@param {string | undefined} options.authentication: basic authentication for the service API as btoa(\"login:pwd\")\n *\t@param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *\t@param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *\t@param {number | undefined} options.typing a delay on each typing to start searching (ms), default 500.\n *\t@param {integer | undefined} options.minLength minimum length to start searching, default 3\n *\t@param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *\n *\t@param {Number} options.pageSize item per page for parcelle list paging, use -1 for no paging, default 5\n * @see {@link https://geoservices.ign.fr/documentation/geoservices/geocodage.html}\n */\nol.control.SearchGeoportailParcelle = function(options) {\n\tvar self = this;\n\toptions.type = \"Commune\";\n\toptions.className = options.className ? options.className+\" IGNF-parcelle\" : \"IGNF-parcelle\";\n\toptions.inputLabel = \"Commune\";\n\toptions.noCollapse = true;\n\toptions.placeholder = options.placeholder || \"Choisissez une commune...\";\n\tol.control.SearchGeoportail.call(this, options);\n\tthis.set('copy', null);\n\tvar element = this.element;\n\t// Add parcel form\n\tvar div = document.createElement(\"DIV\");\n\telement.appendChild(div);\n\tvar label = document.createElement(\"LABEL\");\n\tlabel.innerText = 'Prfixe'\n\tdiv.appendChild(label);\n\tlabel = document.createElement(\"LABEL\");\n\tlabel.innerText = 'Section'\n\tdiv.appendChild(label);\n\tlabel = document.createElement(\"LABEL\");\n\tlabel.innerText = 'Numro'\n\tdiv.appendChild(label);\n\tdiv.appendChild(document.createElement(\"BR\"));\n\t// Input\n\tthis._inputParcelle = {\n\t\tprefix: document.createElement(\"INPUT\"),\n\t\tsection: document.createElement(\"INPUT\"),\n\t\tnumero: document.createElement(\"INPUT\")\n  };\n  this._inputParcelle.prefix.setAttribute('maxlength',3);\n  this._inputParcelle.section.setAttribute('maxlength',2);\n\tthis._inputParcelle.numero.setAttribute('maxlength',4);\n  // Delay search\n  var tout;\n\tvar doSearch = function() {\n    if (tout) clearTimeout(tout);\n    tout = setTimeout(function() {\n        self.autocompleteParcelle();\n    }, options.typing || 0);\n\t}\n\t// Add inputs\n\tfor (var i in this._inputParcelle) {\n\t\tdiv.appendChild(this._inputParcelle[i]);\n\t\tthis._inputParcelle[i].addEventListener(\"keyup\", doSearch);\n\t}\n\tthis.activateParcelle(false);\n  // Autocomplete list\n\tvar ul = document.createElement('UL');\n\tul.classList.add('autocomplete-parcelle');\n\telement.appendChild(ul);\n\tul = document.createElement('UL');\n\tul.classList.add('autocomplete-page');\n\telement.appendChild(ul);\n\t// Show/hide list on fcus/blur\t\n\tthis._input.addEventListener('blur', function() {\n\t\tsetTimeout(function(){ element.classList.add('ol-collapsed-list') }, 200);\n\t});\n\tthis._input.addEventListener('focus', function() {\n    element.classList.remove('ol-collapsed-list');\n    self._listParcelle([]);\n    if (self._commune) {\n      self._commune = null;\n      self._input.value = '';\n      self.drawList_();\n\t\t}\n\t\tself.activateParcelle(false);\n\t});\n\tthis.on('select', this.selectCommune.bind(this));\n\tthis.set('pageSize', options.pageSize || 5);\n};\nol.inherits(ol.control.SearchGeoportailParcelle, ol.control.SearchGeoportail);\n/** Select a commune => start searching parcelle  \n * @param {any} e \n * @private\n */\nol.control.SearchGeoportailParcelle.prototype.selectCommune = function(e) {\n\tthis._commune = e.search.insee;\n\tthis._input.value = e.search.insee + ' - ' + e.search.fulltext;\n\tthis.activateParcelle(true);\n  this._inputParcelle.numero.focus();\n  this.autocompleteParcelle();\n};\n/** Activate parcelle inputs\n * @param {bolean} b\n */\nol.control.SearchGeoportailParcelle.prototype.activateParcelle = function(b) {\n\tfor (var i in this._inputParcelle) {\n\t\tthis._inputParcelle[i].readOnly = !b;\n\t}\n\tif (b) {\n\t\tthis._inputParcelle.section.parentElement.classList.add('ol-active');\n\t} else {\n\t\tthis._inputParcelle.section.parentElement.classList.remove('ol-active');\t\t\n\t}\n};\n/** Send search request for the parcelle  \n * @private\n */\nol.control.SearchGeoportailParcelle.prototype.autocompleteParcelle = function() {\n  var self = this;\n\t// Add 0 to fit the format\n\tfunction complete (s, n, c)\n\t{\tif (!s) return s;\n\t\tc = c || \"0\";\n\t\twhile (s.length < n) s = c+s;\n\t\treturn s.replace(/\\*/g,'_');\n\t}\n\t// The selected commune\n\tvar commune = this._commune;\n\tvar prefix = complete (this._inputParcelle.prefix.value, 3);\n\tif (prefix === '000') {\n\t\tprefix = '___';\n\t}\n\t// Get parcelle number\n\tvar section = complete (this._inputParcelle.section.value, 2);\n\tvar numero = complete (this._inputParcelle.numero.value, 4, \"0\");\n\tvar search = commune + (prefix||'___') + (section||\"__\") + (numero ?  numero : section ? \"____\":\"0001\");\n\t// Request\n\tvar request = '<?xml version=\"1.0\" encoding=\"UTF-8\"?>'\n\t+'<XLS xmlns:xls=\"http://www.opengis.net/xls\" xmlns:gml=\"http://www.opengis.net/gml\" xmlns=\"http://www.opengis.net/xls\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" version=\"1.2\" xsi:schemaLocation=\"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.2/olsAll.xsd\">'\n\t\t+'<RequestHeader/>'\n\t\t+'<Request requestID=\"1\" version=\"1.2\" methodName=\"LocationUtilityService\">'\n\t\t\t+'<GeocodeRequest returnFreeForm=\"false\">'\n\t\t\t\t+'<Address countryCode=\"CadastralParcel\">'\n\t\t\t\t+'<freeFormAddress>'+search+'+</freeFormAddress>'\n\t\t\t\t+'</Address>'\n\t\t\t+'</GeocodeRequest>'\n\t\t+'</Request>'\n  +'</XLS>'\n\tvar url = this.get('url').replace('ols/apis/completion','geoportail/ols?xls=')+encodeURIComponent(request);\n\t// Geocode\n\tthis.ajax(url, function(resp) {\n\t\t// XML to JSON\n    var parser = new DOMParser();\n    var xmlDoc = parser.parseFromString(resp.response,\"text/xml\");\n    var parcelles = xmlDoc.getElementsByTagName('GeocodedAddress');\n    var jsonResp = []\n    for (var i=0, parc; parc= parcelles[i]; i++) {\n\t\t\tvar node = parc.getElementsByTagName('gml:pos')[0] || parc.getElementsByTagName('pos')[0];\n      var p = node.childNodes[0].nodeValue.split(' ');\n      var att = parc.getElementsByTagName('Place');\n      var json = { \n        lon: Number(p[1]), \n        lat: Number(p[0])\n      };\n      for (var k=0, a; a=att[k]; k++) {\n        json[a.attributes.type.value] = a.childNodes[0].nodeValue;\n      }\n      jsonResp.push(json);\n    }\n    self._listParcelle(jsonResp);\n\t}, function() {\n\t\tconsole.log('oops')\n\t});\n};\n/**\n * Draw the autocomplete list\n * @param {*} resp \n * @private\n */\nol.control.SearchGeoportailParcelle.prototype._listParcelle = function(resp) {\n  var self = this;\n  var ul = this.element.querySelector(\"ul.autocomplete-parcelle\");\n  ul.innerHTML='';\n  var page = this.element.querySelector(\"ul.autocomplete-page\");\n  page.innerHTML='';\n\tthis._listParc = [];\n\t// Show page i\n\tfunction showPage(i) {\n\t\tvar l = ul.children;\n\t\tvar visible = \"ol-list-\"+i;\n\t\tvar k;\n\t\tfor (k=0; k<l.length; k++) {\n\t\t\tl[k].style.display = (l[k].className===visible) ? '' : 'none';\n\t\t}\n\t\tl = page.children;\n\t\tfor (k=0; k<l.length; k++) {\n\t\t\tl[k].className = (l[k].innerText==i) ? 'selected' : '';\n\t\t}\n\t\tpage.style.display = l.length>1 ? '' : 'none';\n\t}\n\t// Sort table\n\tresp.sort(function(a,b) {\n\t\tvar na = a.INSEE+a.CommuneAbsorbee+a.Section+a.Numero;\n\t\tvar nb = b.INSEE+b.CommuneAbsorbee+b.Section+b.Numero;\n\t\treturn na===nb ? 0 : na<nb ? -1 : 1;\n\t});\n\t// Show list\n\tvar n = this.get('pageSize');\n  for (var i=0, r; r = resp[i]; i++) {\n    var li = document.createElement(\"LI\");\n    li.setAttribute(\"data-search\", i);\n\t\tif (n>0) li.classList.add(\"ol-list-\"+Math.floor(i/n));\n    this._listParc.push(r);\n    li.addEventListener(\"click\", function(e) {\n      self._handleParcelle(self._listParc[e.currentTarget.getAttribute(\"data-search\")]);\n    });\n    li.innerHTML = r.INSEE+r.CommuneAbsorbee+r.Section+r.Numero;\n\t\tul.appendChild(li);\n\t\t//\n\t\tif (n>0 && !(i%n)) {\n\t\t\tli = document.createElement(\"LI\");\n\t\t\tli.innerText = Math.floor(i/n);\n\t\t\tli.addEventListener(\"click\", function(e) {\n\t\t\t\tshowPage(e.currentTarget.innerText);\n\t\t\t});\n\t\t\tpage.appendChild(li);\n\t\t}\n\t}\n\tif (n>0) showPage(0);\n};\n/**\n * Handle parcelle section\n * @param {*} parc \n * @private\n */\nol.control.SearchGeoportailParcelle.prototype._handleParcelle = function(parc) {\n  this.dispatchEvent({ \n    type:\"parcelle\", \n    search: parc, \n    coordinate: ol.proj.fromLonLat([parc.lon, parc.lat], this.getMap().getView().getProjection())\n  });\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Search places using the French National Base Address (BAN) API.\n *\n * @constructor\n * @extends {ol.control.Search}\n * @fires select\n * @param {Object=} Control options.\n *\t@param {string} options.className control class name\n *\t@param {boolean | undefined} options.polygon To get output geometry of results (in geojson format), default false.\n *\t@param {viewbox | undefined} options.viewbox The preferred area to find search results. Any two corner points of the box are accepted in any order as long as they span a real box, default none.\n *\t@param {Element | string | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *\t@param {string | undefined} options.label Text label to use for the search button, default \"search\"\n *\t@param {string | undefined} options.placeholder placeholder, default \"Search...\"\n *\t@param {number | undefined} options.typing a delay on each typing to start searching (ms), default 500.\n *\t@param {integer | undefined} options.minLength minimum length to start searching, default 3\n *\t@param {integer | undefined} options.maxItems maximum number of items to display in the autocomplete list, default 10\n *\n *\t@param {string|undefined} options.url Url to Nominatim api, default \"https://nominatim.openstreetmap.org/search\"\n * @see {@link https://wiki.openstreetmap.org/wiki/Nominatim}\n */\nol.control.SearchNominatim = function(options)\n{\toptions = options || {};\n    options.className = options.className || 'nominatim';\n    options.typing = options.typing || 500;\n    options.url = options.url || 'https://nominatim.openstreetmap.org/search';\n    ol.control.SearchJSON.call(this, options);\n    this.set('copy','<a href=\"http://www.openstreetmap.org/copyright\" target=\"new\">&copy; OpenStreetMap contributors</a>');\n    this.set('polygon', options.polygon);\n    this.set('viewbox', options.viewbox);\n};\nol.inherits(ol.control.SearchNominatim, ol.control.SearchJSON);\n/** Returns the text to be displayed in the menu\n *\t@param {ol.Feature} f the feature\n *\t@return {string} the text to be displayed in the index\n *\t@api\n */\nol.control.SearchNominatim.prototype.getTitle = function (f) {\n    var title = f.display_name+\"<i>\"+f.class+\" - \"+f.type+\"</i>\";\n    if (f.icon) title = \"<img src='\"+f.icon+\"' />\" + title;\n    return (title);\n};\n/** \n * @param {string} s the search string\n * @return {Object} request data (as key:value)\n * @api\n */\nol.control.SearchNominatim.prototype.requestData = function (s) {\n\tvar data = { \n        format: \"json\", \n        addressdetails: 1, \n        q: s, \n        polygon_geojson: this.get('polygon') ? 1:0,\n        limit: this.get('maxItems')\n    };\n    if (this.get('viewbox')) data.viewbox = this.get('viewbox');\n    return data;\n};\n/** A ligne has been clicked in the menu > dispatch event\n *\t@param {any} f the feature, as passed in the autocomplete\n *\t@api\n */\nol.control.SearchNominatim.prototype.select = function (f){\n    var c = [Number(f.lon), Number(f.lat)];\n    // Add coordinate to the event\n    try {\n        c = ol.proj.transform (c, 'EPSG:4326', this.getMap().getView().getProjection());\n    } catch(e) { /* ok */}\n    this.dispatchEvent({ type:\"select\", search:f, coordinate: c });\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Select Control.\n * A control to select features by attributes\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires select\n * @param {Object=} options\n *  @param {string} options.className control class name\n *  @param {Element | undefined} options.target Specify a target if you want the control to be rendered outside of the map's viewport.\n *  @param {ol/source/Vector | Array<ol/source/Vector>} options.source the source to search in\n *  @param {string} [options.selectLabel=select] select button label\n *  @param {string} [options.addLabel=add] add button label\n *  @param {string} [options.caseLabel=case sensitive] case checkbox label\n *  @param {string} [options.allLabel=match all] match all checkbox label\n *  @param {string} [options.attrPlaceHolder=attribute]\n *  @param {string} [options.valuePlaceHolder=value]\n */\nol.control.Select = function(options) {\n  var self = this;\n  if (!options) options = {};\n  var element;\n  if (options.target) {\n    element = document.createElement(\"div\");\n    element.className = options.className || \"ol-select\";\n  } else {\n    element = document.createElement(\"div\");\n    element.className = ((options.className || 'ol-select') +' ol-unselectable ol-control ol-collapsed').trim();\n    var button = document.createElement(\"button\")\n        button.setAttribute('type','button');\n        var click_touchstart_function = function(e) {\n          element.classList.toggle('ol-collapsed');\n          e.preventDefault();\n        }\n        button.addEventListener(\"click\", click_touchstart_function);\n        button.addEventListener(\"touchstart\", click_touchstart_function);\n    element.appendChild(button);\n  }\n  // Containre\n  var div = document.createElement(\"div\");\n      element.appendChild(div);\n  // List of selection\n  this._ul = document.createElement('ul');\n      div.appendChild(this._ul);\n  // All conditions\n  this._all = document.createElement('input');\n    this._all.setAttribute('type', 'checkbox')\n    this._all.value = 'all';\n    this._all.checked = true;\n  var label_match_all = document.createElement('label');\n    label_match_all.textContent = options.allLabel || 'match all'\n    div.appendChild(label_match_all);\n  label_match_all.insertBefore(this._all, label_match_all.firstChild);\n  div.appendChild(label_match_all);\n  // Use case\n  this._useCase = document.createElement('input');\n  this._useCase.setAttribute('type', 'checkbox');\n  var label_case_sensitive = document.createElement('label');\n  label_case_sensitive.textContent = options.caseLabel || 'case sensitive';\n  div.appendChild(label_case_sensitive);\n  label_case_sensitive.insertBefore(this._useCase, label_case_sensitive.firstChild);\n  div.appendChild(label_case_sensitive);\n  // Select button\n  var select_button = document.createElement('button');\n      select_button.setAttribute('type','button');\n      select_button.classList.add('ol-submit')\n      select_button.textContent = options.selectLabel || 'Select';\n      select_button.addEventListener(\"click\", function() {\n        self.doSelect();\n      });\n    div.appendChild(select_button);\n  // Add button\n  var create_button = document.createElement('button');\n    create_button.classList.add('ol-append');\n    create_button.textContent = options.addLabel\t|| 'add rule';\n    create_button.addEventListener(\"click\", function(){\n      self.addCondition();\n    });\n    div.appendChild(create_button);\n  this._conditions = [];\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  this.set('source', (options.source instanceof Array) ? options.source : [options.source]);\n  this.set('attrPlaceHolder', options.attrPlaceHolder || 'attribute');\n  this.set('valuePlaceHolder', options.valuePlaceHolder || 'value');\n  this.addCondition();\n};\nol.inherits(ol.control.Select, ol.control.Control);\n/** Add a new condition\n * @param {*} options\n * \t@param {string} options.attr attribute name\n * \t@param {string} options.op\toperator\n * \t@param {string} options.val attribute value\n */\nol.control.Select.prototype.addCondition = function (options) {\n  options = options || {};\n  this._conditions.push({\n    attr: options.attr || '',\n    op: options.op || '=',\n    val: options.val || ''\n  });\n  this._drawlist();\n};\n/** Get the condition list\n */\nol.control.Select.prototype.getConditions = function () {\n  return {\n    usecase: this._useCase.checked,\n    all: this._all.checked,\n    conditions: this._conditions\n  }\n};\n/** Set the condition list\n */\nol.control.Select.prototype.setConditions = function (cond) {\n  this._useCase.checked = cond.usecase;\n  this._all.checked = cond.all;\n  this._conditions = cond.conditions;\n  this._drawlist();\n};\n/** Get the conditions as string\n */\nol.control.Select.prototype.getConditionsString = function (cond) {\n  var st = '';\n  for (var i=0,c; c=cond.conditions[i]; i++) {\n    if (c.attr) {\n      st += (st ? (cond.all ? ' AND ' : ' OR ') : '')\n        + c.attr\n        + ol.control.Select.operationsList[c.op]\n        + c.val;\n    }\n  }\n  return st\n};\n/** List of operations / for translation\n * @api\n */\nol.control.Select.operationsList = {\n  '=': '=',\n  '!=': '',\n  '<': '<',\n  '<=': '',\n  '>=': '',\n  '>': '>',\n  'contain': '', // \n  '!contain': '',\t// \n  'regexp': ''\n};\n/** Draw the liste\n * @private\n */\nol.control.Select.prototype._drawlist = function () {\n  this._ul.innerHTML = '';\n  for (var i=0; i < this._conditions.length; i++) {\n    this._ul.appendChild(this._getLiCondition(i));\n  }\n};\n/** Get a line\n * @return {*}\n * @private\n */\nol.control.Select.prototype._autocomplete = function (val, ul) {\n  ul.classList.remove('ol-hidden');\n  ul.innerHTML = '';\n  var attributes = {};\n  var sources = this.get('source');\n  for (var i=0, s; s=sources[i]; i++) {\n    var features = s.getFeatures();\n    for (var j=0, f; f=features[j]; j++) {\n      Object.assign(attributes, f.getProperties());\n      if (j>100) break;\n    }\n  }\n  var rex = new RegExp(val, 'i');\n  for (var a in attributes) {\n    if (a==='geometry') continue;\n    if (rex.test(a)) {\n      var li = document.createElement('li');\n    li.textContent = a;\n    li.addEventListener(\"click\", function() {\n          ul.previousElementSibling.value = this.textContent;\n      var event = document.createEvent('HTMLEvents');\n      event.initEvent('change', true, false);\n      ul.previousElementSibling.dispatchEvent(event);\n          ul.classList.add('ol-hidden');\n        });\n        ul.appendChild(li);\n    }\n  }\n};\n/** Get a line\n * @return {*}\n * @private\n */\nol.control.Select.prototype._getLiCondition = function (i) {\n  var self = this;\n  var li = document.createElement('li');\n  // Attribut\n  var autocomplete = document.createElement('div');\n      autocomplete.classList.add('ol-autocomplete');\n      autocomplete.addEventListener(\"mouseleave\", function() {\n        this.querySelector('ul'). classList.add('ol-hidden');\n      });\n      li.appendChild(autocomplete);\n  var input_attr = document.createElement('input');\n      input_attr.classList.add('ol-attr');\n      input_attr.setAttribute('type', 'text');\n      input_attr.setAttribute('placeholder', this.get('attrPlaceHolder'));\n      input_attr.addEventListener('keyup', function () {\n        self._autocomplete( this.value, this.nextElementSibling );\n      })\n      input_attr.addEventListener('click', function(){\n        self._autocomplete( this.value, this.nextElementSibling );\n        this.nextElementSibling.classList.remove('ol-hidden')\n      })\n      input_attr.addEventListener('change', function() {\n        self._conditions[i].attr = this.value;\n      })\n      input_attr.value = self._conditions[i].attr;\n      autocomplete.appendChild(input_attr);\n  // Autocomplete list\n  var ul_autocomplete = document.createElement('ul');\n      ul_autocomplete.classList.add('ol-hidden')\n      autocomplete.appendChild(ul_autocomplete);\n  // Operation\n  var select = document.createElement('select');\n  li.appendChild(select);\n  for (var k in ol.control.Select.operationsList) {\n    var option = document.createElement('option');\n        option.value = k;\n        option.textContent = ol.control.Select.operationsList[k];\n        select.appendChild(option);\n  }\n  select.value = self._conditions[i].op;\n  select.addEventListener('change', function() {\n    self._conditions[i].op = this.value;\n  });\n  // Value\n  var input_value = document.createElement('input');\n  input_value.setAttribute('type', 'text');\n      input_value.setAttribute('placeholder', this.get('valuePlaceHolder'));\n    input_value.addEventListener('change', function() {\n      self._conditions[i].val = this.value;\n    })\n    input_value.value = self._conditions[i].val;\n    li.appendChild(input_value);\n  if (this._conditions.length > 1) {\n    var div_delete = document.createElement('div');\n    div_delete.classList.add('ol-delete');\n      div_delete.addEventListener(\"click\", function(){ self.removeCondition(i); })\n      li.appendChild(div_delete);\n  }\n  //\n  return li;\n};\n/** Remove the ith condition\n * @param {int} i condition index\n */\nol.control.Select.prototype.removeCondition = function (i) {\n  this._conditions.splice(i,1);\n  this._drawlist();\n};\n/** Escape string for regexp\n * @param {string} search\n * @return {string}\n */\nol.control.Select.prototype._escape = function (s) {\n  return s.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&'); // $& means the whole matched string\n}\n/**\n *\n * @param {*} f\n * @private\n */\nol.control.Select.prototype._checkCondition = function (f, c, usecase) {\n  if (!c.attr) return true;\n  var val = f.get(c.attr);\n  var rex;\n  switch (c.op) {\n    case '=':\n      rex = new RegExp('^'+this._escape(c.val)+'$', usecase ? '' : 'i');\n      return rex.test(val);\n    case '!=':\n      rex = new RegExp('^'+this._escape(c.val)+'$', usecase ? '' : 'i');\n      return !rex.test(val);\n    case '<':\n      return val < c.val;\n    case '<=':\n      return val <= c.val;\n    case '>':\n      return val > c.val;\n      case '>=':\n      return val >= c.val;\n    case 'contain':\n      rex = new RegExp(this._escape(c.val), usecase ? '' : 'i');\n      return rex.test(val);\n    case '!contain':\n      rex = new RegExp(this._escape(c.val), usecase ? '' : 'i');\n      return !rex.test(val);\n    case 'regexp':\n      rex = new RegExp(c.val, usecase ? '' : 'i');\n      return rex.test(val);\n    default:\n      return false;\n  }\n}\n/** Select features by attributes\n * @param {*} options\n *  @param {Array<ol/source/Vector|undefined} options.sources source to apply rules, default the select sources\n *  @param {bool} options.useCase case sensitive, default checkbox state\n *  @param {bool} options.matchAll match all conditions, , default checkbox state\n *  @param {Array<conditions>} options.conditions array of conditions\n * @fires select\n */\nol.control.Select.prototype.doSelect = function (options) {\n  options = options || {};\n  var sources = options.sources || this.get('source');\n  var features = [];\n  var usecase = options.useCase || this._useCase.checked;\n  var all = options.matchAll || this._all.checked;\n  var conditions = options.conditions || this._conditions\n  for (var i=0,s; s=sources[i]; i++) {\n    var sfeatures = s.getFeatures();\n    for (var j=0,f; f=sfeatures[j]; j++) {\n      var isok = all;\n      for (var k=0, c; c=conditions[k]; k++) {\n        if (c.attr) {\n          if (all) {\n            isok = isok && this._checkCondition(f,c,usecase);\n          }\n          else {\n            isok = isok || this._checkCondition(f,c,usecase);\n          }\n        }\n      }\n      if (isok) {\n        features.push(f);\n      }\n    }\n  }\n  this.dispatchEvent({ type:\"select\", features: features });\n  return features;\n};\n\n/** A control with scroll-driven navigation to create narrative maps\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires \n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {Element | string | undefined} options.html The storymap content\n *\t@param {Element | string | undefined} options.target The target element to place the story. If no html is provided the content of the target will be used.\n */\nol.control.Storymap = function(options) {\n  // Remove or get target content \n  if (options.target) {\n    if (!options.html) {\n      options.html = options.target.innerHTML;\n    } else if (options.html instanceof Element) {\n      options.html = options.html.innerHTML;\n    }\n    options.target.innerHTML = '';\n  }\n  var element = ol.ext.element.create('DIV', {\n    className: (options.className || '') + ' ol-storymap'\n      + (options.target ? '': ' ol-unselectable ol-control')\n      + (ol.has.TOUCH ? ' ol-touch' : ''),\n    html: options.html\n  });\n  // Initialize\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  // Make a scroll div\n  ol.ext.element.scrollDiv (this.element, {\n    vertical: true,\n    mousewheel: true\n  });\n  // Scroll to the next chapter\n  var sc = this.element.querySelectorAll('.ol-scroll-next');\n  sc.forEach(function(s) {\n    s.addEventListener('click', function(){ \n      var chapter = this.element.querySelectorAll('.chapter');\n      var scrollto = s.offsetTop;\n      for (var i=0, c; c=chapter[i]; i++) {\n        if (c.offsetTop > scrollto) {\n          scrollto = c.offsetTop;\n          break;\n        }\n      }\n      this.element.scrollTop = scrollto;\n    }.bind(this));\n  }.bind(this));\n  // Scroll top \n  sc = this.element.querySelectorAll('.ol-scroll-top');\n  sc.forEach(function(i) {\n    i.addEventListener('click', function(){ \n      this.element.scrollTop = 0;\n    }.bind(this));\n  }.bind(this));\n  // Handle scrolling\n  var currentDiv = this.element.querySelectorAll('.chapter')[0];\n  setTimeout (function (){\n    this.dispatchEvent({ type: 'scrollto', start: true, element: currentDiv, name: currentDiv.getAttribute('name') });\n  }.bind(this));\n  // Trigger change event on scroll\n  this.element.addEventListener(\"scroll\", function() {\n    var current, chapter = this.element.querySelectorAll('.chapter');\n    var height = ol.ext.element.getStyle(this.element, 'height');\n    if (!this.element.scrollTop) {\n      current = chapter[0];\n    } else {\n      for (var i=0, s; s=chapter[i]; i++) {\n        var p = s.offsetTop - this.element.scrollTop;\n        if (p > height/3) break;\n        current = s;\n      }\n    }\n    if (current && current!==currentDiv) {\n      currentDiv = current;\n      this.dispatchEvent({ type: 'scrollto', element: currentDiv, name: currentDiv.getAttribute('name') });\n    }\n  }.bind(this));\n};\nol.inherits(ol.control.Storymap, ol.control.Control);\n/** Scroll to a chapter\n * @param {string} name Name of the chapter to scroll to\n */\nol.control.Storymap.prototype.setChapter = function (name) {\n  var chapter = this.element.querySelectorAll('.chapter');\n  for (var i=0, s; s=chapter[i]; i++) {\n    if (s.getAttribute('name')===name) {\n      this.element.scrollTop = s.offsetTop;\n    }\n  }\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc OpenLayers 3 swipe Control.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @param {Object=} Control opt_options.\n *\t- layers {ol.layer} layer to swipe\n *\t- rightLayer {ol.layer} layer to swipe on right side\n *\t- className {string} control class name\n *\t- position {number} position propertie of the swipe [0,1], default 0.5\n *\t- orientation {vertical|horizontal} orientation propertie, default vertical\n */\nol.control.Swipe = function(opt_options) {\n\tvar options = opt_options || {};\n\tvar button = document.createElement('button');\n\tvar element = document.createElement('div');\n\t\t\telement.className = (options.className || \"ol-swipe\") + \" ol-unselectable ol-control\";\n\t\t\telement.appendChild(button);\n\telement.addEventListener(\"mousedown\", this.move.bind(this));\n\telement.addEventListener(\"touchstart\", this.move.bind(this));\n\tol.control.Control.call(this,\n\t{\telement: element\n\t});\n\t// An array of listener on layer postcompose\n\tthis._listener = [];\n\tthis.layers = [];\n\tif (options.layers) this.addLayer(options.layers, false);\n\tif (options.rightLayers) this.addLayer(options.rightLayers, true);\n\tthis.on('propertychange', function() \n\t{\tif (this.getMap()) this.getMap().renderSync();\n\t\tif (this.get('orientation') === \"horizontal\")\n\t\t{\tthis.element.style.top = this.get('position')*100+\"%\";\n\t\t\tthis.element.style.left = \"\";\n\t\t}\n\t\telse\n\t\t{\tif (this.get('orientation') !== \"vertical\") this.set('orientation', \"vertical\");\n\t\t\tthis.element.style.left = this.get('position')*100+\"%\";\n\t\t\tthis.element.style.top = \"\";\n\t\t}\n\t\tthis.element.classList.remove(\"horizontal\", \"vertical\");\n\t\tthis.element.classList.add(this.get('orientation'));\n\t}.bind(this));\n\tthis.set('position', options.position || 0.5);\n\tthis.set('orientation', options.orientation || 'vertical');\n};\nol.inherits(ol.control.Swipe, ol.control.Control);\n/**\n * Set the map instance the control associated with.\n * @param {_ol_Map_} map The map instance.\n */\nol.control.Swipe.prototype.setMap = function(map) {\n\tvar i;\n\tfor (i=0; i<this._listener.length; i++) {\n\t\tol.Observable.unByKey(this._listener[i]);\n\t}\n\tthis._listener = [];\n\tif (this.getMap()) {\n\t\tthis.getMap().renderSync();\n\t}\n\tol.control.Control.prototype.setMap.call(this, map);\n\tif (map)\n\t{\tthis._listener = [];\n\t\tfor (i=0; i<this.layers.length; i++)\n\t\t{\tvar l = this.layers[i];\n\t\t\tif (l.right) this._listener.push (l.layer.on('precompose', this.precomposeRight.bind(this)));\n\t\t\telse this._listener.push (l.layer.on('precompose', this.precomposeLeft.bind(this)));\n\t\t\tthis._listener.push(l.layer.on('postcompose', this.postcompose.bind(this)));\n\t\t}\n\t\tmap.renderSync();\n\t}\n};\n/** @private\n*/\nol.control.Swipe.prototype.isLayer_ = function(layer)\n{\tfor (var k=0; k<this.layers.length; k++)\n\t{\tif (this.layers[k].layer === layer) return k;\n\t}\n\treturn -1;\n};\n/** Add a layer to clip\n *\t@param {ol.layer|Array<ol.layer>} layer to clip\n*\t@param {bool} add layer in the right part of the map, default left.\n*/\nol.control.Swipe.prototype.addLayer = function(layers, right)\n{\tif (!(layers instanceof Array)) layers = [layers];\n\tfor (var i=0; i<layers.length; i++) {\n\t\tvar l = layers[i];\n\t\tif (this.isLayer_(l)<0)\n\t\t{\tthis.layers.push({ layer:l, right:right });\n\t\t\tif (this.getMap())\n\t\t\t{\tif (right) this._listener.push (l.on('precompose', this.precomposeRight.bind(this)));\n\t\t\t\telse this._listener.push (l.on('precompose', this.precomposeLeft.bind(this)));\n\t\t\t\tthis._listener.push(l.on('postcompose', this.postcompose.bind(this)));\n\t\t\t\tthis.getMap().renderSync();\n\t\t\t}\n\t\t}\n\t}\n};\n/** Remove a layer to clip\n *\t@param {ol.layer|Array<ol.layer>} layer to clip\n */\nol.control.Swipe.prototype.removeLayer = function(layers)\n{\tif (!(layers instanceof Array)) layers = [layers];\n\tfor (var i=0; i<layers.length; i++)\n\t{\tvar k = this.isLayer_(layers[i]);\n\t\tif (k >=0 && this.getMap())\n\t\t{\tif (this.layers[k].right) layers[i].un('precompose', this.precomposeRight, this);\n\t\t\telse layers[i].un('precompose', this.precomposeLeft, this);\n\t\t\tlayers[i].un('postcompose', this.postcompose, this);\n\t\t\tthis.layers.splice(k,1);\n\t\t\tthis.getMap().renderSync();\n\t\t}\n\t}\n};\n/** @private\n*/\nol.control.Swipe.prototype.move = function(e) {\n\tvar self = this;\n\tvar l;\n\tswitch (e.type)\n\t{\tcase 'touchcancel':\n\t\tcase 'touchend':\n\t\tcase 'mouseup':\n\t\t{\tself.isMoving = false;\n\t\t\t[\"mouseup\", \"mousemove\", \"touchend\", \"touchcancel\", \"touchmove\"]\n\t\t\t\t.forEach(function(eventName) {\n\t\t\t\t\tdocument.removeEventListener(eventName, self.move);\n\t\t\t\t});\n\t\t\tbreak;\n\t\t}\n\t\tcase 'mousedown':\n\t\tcase 'touchstart': {\n\t\t\tself.isMoving = true;\n\t\t\t[\"mouseup\", \"mousemove\", \"touchend\", \"touchcancel\", \"touchmove\"]\n\t\t\t\t.forEach(function(eventName) {\n\t\t\t\t\tdocument.addEventListener(eventName, self.move.bind(self));\n\t\t\t\t});\n\t\t}\n\t\t// fallthrough\n\t\tcase 'mousemove':\n\t\tcase 'touchmove':\n\t\t{\tif (self.isMoving)\n\t\t\t{\tif (self.get('orientation') === \"vertical\")\n\t\t\t\t{\tvar pageX = e.pageX\n\t\t\t\t\t\t|| (e.originalEvent.touches && e.originalEvent.touches.length && e.originalEvent.touches[0].pageX)\n\t\t\t\t\t\t|| (e.originalEvent.changedTouches && e.originalEvent.changedTouches.length && e.originalEvent.changedTouches[0].pageX);\n\t\t\t\t\tif (!pageX) break;\n\t\t\t\t\tpageX -= self.getMap().getTargetElement().getBoundingClientRect().left +\n\t\t\t\t\t\twindow.pageXOffset - document.documentElement.clientLeft;\n\t\t\t\t\tl = self.getMap().getSize()[0];\n\t\t\t\t\tl = Math.min(Math.max(0, 1-(l-pageX)/l), 1);\n\t\t\t\t\tself.set('position', l);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\tvar pageY = e.pageY\n\t\t\t\t\t\t|| (e.originalEvent.touches && e.originalEvent.touches.length && e.originalEvent.touches[0].pageY)\n\t\t\t\t\t\t|| (e.originalEvent.changedTouches && e.originalEvent.changedTouches.length && e.originalEvent.changedTouches[0].pageY);\n\t\t\t\t\tif (!pageY) break;\n\t\t\t\t\tpageY -= self.getMap().getTargetElement().getBoundingClientRect().top +\n\t\t\t\t\t\twindow.pageYOffset - document.documentElement.clientTop;\n\t\t\t\t\tl = self.getMap().getSize()[1];\n\t\t\t\t\tl = Math.min(Math.max(0, 1-(l-pageY)/l), 1);\n\t\t\t\t\tself.set('position', l);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tdefault: break;\n\t}\n};\n/** @private\n*/\nol.control.Swipe.prototype.precomposeLeft = function(e)\n{\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tctx.save();\n\tctx.beginPath();\n\tif (this.get('orientation') === \"vertical\") ctx.rect (0,0, canvas.width*this.get('position'), canvas.height);\n\telse ctx.rect (0,0, canvas.width, canvas.height*this.get('position'));\n\tctx.clip();\n};\n/** @private\n*/\nol.control.Swipe.prototype.precomposeRight = function(e)\n{\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tctx.save();\n\tctx.beginPath();\n\tif (this.get('orientation') === \"vertical\") ctx.rect (canvas.width*this.get('position'), 0, canvas.width, canvas.height);\n\telse ctx.rect (0,canvas.height*this.get('position'), canvas.width, canvas.height);\n\tctx.clip();\n};\n/** @private\n*/\nol.control.Swipe.prototype.postcompose = function(e)\n{\te.context.restore();\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** ol.control.Target draw a target at the center of the map.\n * @constructor\n * @param {Object} options\n *  - style {ol.style.Style|Array<ol.style.Style>} ol.style.Stroke: draw a cross on the map, ol.style.Image: draw the image on the map\n *  - composite {string} composite operation : difference|multiply|xor|screen|overlay|darken|lighter|lighten|...\n */\nol.control.Target = function(options)\n{\toptions = options || {};\n\tthis.style = options.style ||\n\t\t[\tnew ol.style.Style({ image: new ol.style.RegularShape ({ points: 4, radius: 11, radius1: 0, radius2: 0, snapToPixel:true, stroke: new ol.style.Stroke({ color: \"#fff\", width:3 }) }) }),\n\t\t\tnew ol.style.Style({ image: new ol.style.RegularShape ({ points: 4, radius: 11, radius1: 0, radius2: 0, snapToPixel:true, stroke: new ol.style.Stroke({ color: \"#000\", width:1 }) }) })\n\t\t];\n\tif (!(this.style instanceof Array)) this.style = [this.style];\n\tthis.composite = options.composite || '';\n\tvar div = document.createElement('div');\n\tdiv.className = \"ol-target ol-unselectable ol-control\";\n\tol.control.Control.call(this,\n\t{\telement: div,\n\t\ttarget: options.target\n\t});\n\tthis.setVisible(options.visible!==false);\n};\nol.inherits(ol.control.Target, ol.control.Control);\n/**\n * Remove the control from its current map and attach it to the new map.\n * Subclasses may set up event handlers to get notified about changes to\n * the map here.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.control.Target.prototype.setMap = function (map)\n{\tif (this.getMap()) \n\t{\tif (this.getVisible()) this.getMap().renderSync();\n\t}\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.control.Control.prototype.setMap.call(this, map);\n\tif (map) \n\t{\tthis._listener = map.on('postcompose', this.drawTarget_.bind(this));\n\t}\n};\n/** Set the control visibility\n* @paraam {boolean} b \n*/\nol.control.Target.prototype.setVisible = function (b)\n{\tthis.set(\"visible\",b);\n\tif (this.getMap()) this.getMap().renderSync();\n};\n/** Get the control visibility\n* @return {boolean} b \n*/\nol.control.Target.prototype.getVisible = function ()\n{\treturn this.get(\"visible\");\n};\n/** Draw the target\n* @private\n*/\nol.control.Target.prototype.drawTarget_ = function (e)\n{\tif (!this.getMap() || !this.getVisible()) return;\n\tvar ctx = e.context;\n\tvar ratio = e.frameState.pixelRatio;\n\tctx.save();\n\t\tctx.scale(ratio,ratio);\n\t\tvar cx = ctx.canvas.width/(2*ratio);\n\t\tvar cy = ctx.canvas.height/(2*ratio);\n\t\tvar geom = new ol.geom.Point (this.getMap().getCoordinateFromPixel([cx,cy]));\n\t\tif (this.composite) ctx.globalCompositeOperation = this.composite;\n\t\tfor (var i=0; i<this.style.length; i++)\n\t\t{\tvar style = this.style[i];\n\t\t\tif (style instanceof ol.style.Style)\n\t\t\t{\tvar sc=0;\n\t\t\t\t// OL < v4.3 : setImageStyle don't check retina\n\t\t\t\tvar imgs = ol.Map.prototype.getFeaturesAtPixel ? false : style.getImage();\n\t\t\t\tif (imgs) \n\t\t\t\t{\tsc = imgs.getScale(); \n\t\t\t\t\timgs.setScale(ratio*sc);\n\t\t\t\t}\n\t\t\t\te.vectorContext.setStyle(style);\n\t\t\t\te.vectorContext.drawGeometry(geom);\n\t\t\t\tif (imgs) imgs.setScale(sc);\n\t\t\t}\n\t\t}\n\t/*\n\t\tfor (var i=0; i<this.style.length; i++)\n\t\t{\tvar style = this.style[i];\n\t\t\tif (style.stroke instanceof ol.style.Stroke)\n\t\t\t{\tctx.lineWidth = style.stroke.getWidth();\n\t\t\t\tctx.strokeStyle = ol.color.asString(style.stroke.getColor());\n\t\t\t\tvar m = style.radius || 10;\n\t\t\t\tvar dx = cx + ctx.lineWidth/2;\n\t\t\t\tvar dy = cy + ctx.lineWidth/2;\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.moveTo (dx-m, dy);\n\t\t\t\tctx.lineTo (dx+m, dy);\n\t\t\t\tctx.moveTo (dx, dy-m);\n\t\t\t\tctx.lineTo( dx, dy+m);\n\t\t\t\tctx.stroke();\n\t\t\t}\n\t\t\telse if (style instanceof ol.style.Image)\n\t\t\t{\tvar img = style.getImage();\n\t\t\t\tctx.drawImage(img, cx-img.width/2, cy-img.height/2);\n\t\t\t}\n\t\t\telse if (style instanceof ol.style.Text)\n\t\t\t{\tctx.font = style.getFont();\n\t\t\t\tctx.textBaseline = \"middle\";\n\t\t\t\tctx.textAlign = \"center\";\n\t\t\t\tvar fill = style.getFill();\n\t\t\t\tif (fill)\n\t\t\t\t{\tctx.fillStyle = ol.color.asString(fill.getColor());\n\t\t\t\t\tctx.fillText(style.getText(), cx, cy);\n\t\t\t\t}\n\t\t\t\tvar stroke = style.getStroke();\n\t\t\t\tif (stroke) \n\t\t\t\t{\tctx.lineWidth = stroke.getWidth();\n\t\t\t\t\tctx.strokeStyle = ol.color.asString(stroke.getColor());\n\t\t\t\t\tctx.strokeText(style.getText(), cx, cy);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t*/\n\tctx.restore();\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A simple push button control drawn as text\n * @constructor\n * @extends {ol.control.Button}\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {String} options.title title of the control\n *\t@param {String} options.html html to insert in the control\n *\t@param {function} options.handleClick callback when control is clicked (or use change:active event)\n */\nol.control.TextButton = function(options)\n{\toptions = options || {};\n    options.className = (options.className||\"\") + \" ol-text-button\";\n    ol.control.Button.call(this, options);\n};\nol.inherits(ol.control.TextButton, ol.control.Button);\n\n/*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\n/** Timeline control\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires select\n * @fires scroll\n * @fires collapse\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {Array<ol.Feature>} options.features Features to show in the timeline\n *\t@param {ol.SourceImageOptions.vector} options.source class of the control\n *\t@param {Number} options.interval time interval length in ms or a text with a format d, h, mn, s (31 days = '31d'), default none\n *\t@param {String} options.maxWidth width of the time line in px, default 2000px\n *\t@param {String} options.minDate minimum date \n *\t@param {String} options.maxDate maximum date \n *\t@param {Number} options.minZoom Minimum zoom for the line, default .2\n *\t@param {Number} options.maxZoom Maximum zoom for the line, default 4\n *\t@param {boolean} options.zoomButton Are zoom buttons avaliable, default false\n *\t@param {function} options.getHTML a function that takes a feature and returns the html to display\n *\t@param {function} options.getFeatureDate a function that takes a feature and returns its date, default the date propertie\n *\t@param {function} options.endFeatureDate a function that takes a feature and returns its end date, default no end date\n *\t@param {String} options.graduation day|month to show month or day graduation, default show only years\n *\t@param {String} options.scrollTimeout Time in milliseconds to get a scroll event, default 15ms\n */\nol.control.Timeline = function(options) {\n  var element = ol.ext.element.create('DIV', {\n    className: (options.className || '') + ' ol-timeline'\n      + (options.target ? '': ' ol-unselectable ol-control')\n      + (options.zoomButton ? ' ol-hasbutton':'')\n      + (ol.has.TOUCH ? ' ol-touch' : '')\n  });\n  // Initialize\n  ol.control.Control.call(this, {\n    element: element,\n    target: options.target\n  });\n  // Scroll div\n  this._scrollDiv = ol.ext.element.create('DIV', {\n    className: 'ol-scroll',\n    parent: this.element\n  });\n  // Add a button bar\n  this._buttons = ol.ext.element.create('DIV', {\n    className: 'ol-buttons',\n    parent: this.element\n  });\n  // Zoom buttons\n  if (options.zoomButton) {\n    // Zoom in\n    this.addButton({\n      className: 'ol-zoom-in',\n      handleClick: function(){\n        var zoom = this.get('zoom');\n        if (zoom>=1) {\n          zoom++;\n        } else {\n          zoom = Math.min(1, zoom + 0.1);\n        }\n        zoom = Math.round(zoom*100)/100;\n        this.refresh(zoom);\n      }.bind(this)\n    });\n    // Zoom out\n    this.addButton({\n      className: 'ol-zoom-out',\n      handleClick: function(){\n        var zoom = this.get('zoom');\n        if (zoom>1) {\n          zoom--;\n        } else {\n          zoom -= 0.1;\n        }\n        zoom = Math.round(zoom*100)/100;\n        this.refresh(zoom);\n      }.bind(this)\n    });\n  }\n  // Draw center date\n  this._intervalDiv = ol.ext.element.create('DIV', {\n    className: 'ol-center-date',\n    parent: this.element\n  });\n  // Remove selection\n  this.element.addEventListener('mouseover', function(){\n    if (this._select) this._select.elt.classList.remove('ol-select');\n  }.bind(this));\n  // Trigger scroll event\n  var scrollListener = null;\n  this._scrollDiv.addEventListener('scroll', function() {\n    if (scrollListener) {\n      clearTimeout(scrollListener);\n      scrollListener = null;\n    }\n    scrollListener = setTimeout(function() {\n      this.dispatchEvent({ \n        type: 'scroll', \n        date: this.getDate(), \n        dateStart: this.getDate('start'), \n        dateEnd: this.getDate('end')\n      });\n    }.bind(this), options.scrollTimeout || 15);\n  }.bind(this));\n  // Magic to give \"live\" scroll events on touch devices\n  this._scrollDiv.addEventListener('gesturechange', function() {});\n  // Scroll timeline\n  ol.ext.element.scrollDiv(this._scrollDiv, {\n    onmove: function(b) {\n      // Prevent selection on moving\n      this._moving = b; \n    }.bind(this)\n  });\n  this._tline = [];\n  // Parameters\n  this.set('maxWidth', options.maxWidth || 2000);\n  this.set('minDate', options.minDate || Infinity);\n  this.set('maxDate', options.maxDate || -Infinity);\n  this.set('graduation', options.graduation);\n  this.set('minZoom', options.minZoom || .2);\n  this.set('maxZoom', options.maxZoom || 4);\n  this.setInterval(options.interval);\n  if (options.getHTML) this._getHTML =  options.getHTML;\n  if (options.getFeatureDate) this._getFeatureDate =  options.getFeatureDate;\n  if (options.endFeatureDate) this._endFeatureDate =  options.endFeatureDate;\n  // Feature source \n  this.setFeatures(options.features || options.source, options.zoom);\n};\nol.inherits(ol.control.Timeline, ol.control.Control);\n/**\n * Set the map instance the control is associated with\n * and add interaction attached to it to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol.control.Timeline.prototype.setMap = function(map) {\n  ol.control.Control.prototype.setMap.call(this, map);\n  this.refresh(this.get('zoom')||1, true);\n};\n/** Add a button on the timeline\n * @param {*} button\n *  @param {string} button.className\n *  @param {title} button.className\n *  @param {Element|string} button.html Content of the element\n *  @param {function} button.click a function called when the button is clicked\n */\nol.control.Timeline.prototype.addButton = function(button) {\n  this.element.classList.add('ol-hasbutton');\n  ol.ext.element.create('BUTTON', {\n    className: button.className || undefined,\n    title: button.title,\n    html : button.html,\n    click: button.handleClick,\n    parent: this._buttons\n  })\n};\n/** Set an interval\n * @param {number|string} length the interval length in ms or a farmatted text ie. end with y, 1d, h, mn, s (31 days = '31d'), default none\n */\nol.control.Timeline.prototype.setInterval = function(length) {\n  if (typeof(length)==='string') {\n    if (/s$/.test(length)) {\n      length = parseFloat(length) * 1000;\n    } else if (/mn$/.test(length)) {\n      length = parseFloat(length) * 1000 * 60;\n    } else if (/h$/.test(length)) {\n      length = parseFloat(length) * 1000 * 3600;\n    } else if (/d$/.test(length)) {\n      length = parseFloat(length) * 1000 * 3600 * 24;\n    } else if (/y$/.test(length)) {\n      length = parseFloat(length) * 1000 * 3600 * 24 * 365;\n    } else {\n      length = 0;\n    }\n  }\n  this.set('interval', length || 0);\n  if (length) this.element.classList.add('ol-interval');\n  else this.element.classList.remove('ol-interval');\n  this.refresh(this.get('zoom'));\n}\n/** Default html to show in the line\n * @param {ol.Feature} feature\n * @return {DOMElement|string}\n * @private\n */\nol.control.Timeline.prototype._getHTML = function(feature) {\n  return feature.get('name') || '';\n};\n/** Default function to get the date of a feature, returns the date attribute\n * @param {ol.Feature} feature\n * @return {Data|string}\n * @private\n */\nol.control.Timeline.prototype._getFeatureDate = function(feature) {\n  return (feature && feature.get) ? feature.get('date') : null;\n};\n/** Default function to get the end date of a feature, return undefined\n * @param {ol.Feature} feature\n * @return {Data|string}\n * @private\n */\nol.control.Timeline.prototype._endFeatureDate = function(/* feature */) {\n  return undefined;\n};\n/** Is the line collapsed\n * @return {boolean}\n */\nol.control.Timeline.prototype.isCollapsed = function() {\n  return this.element.classList.contains('ol-collapsed');\n};\n/** Collapse the line\n * @param {boolean} b\n */\nol.control.Timeline.prototype.collapse = function(b) {\n  if (b) this.element.classList.add('ol-collapsed');\n  else this.element.classList.remove('ol-collapsed');\n  this.dispatchEvent({ type: 'collapse', collapsed: this.isCollapsed() });\n};\n/** Collapse the line\n */\nol.control.Timeline.prototype.toggle = function() {\n  this.element.classList.toggle('ol-collapsed');\n  this.dispatchEvent({ type: 'collapse', collapsed: this.isCollapsed() });\n};\n/** Set the features to display in the timeline\n * @param {Array<ol.Features>|ol.source.Vector} features An array of features or a vector source\n * @param {number} zoom zoom to draw the line default 1\n */\nol.control.Timeline.prototype.setFeatures = function(features, zoom) {\n  this._features = this._source = null;\n  if (features instanceof ol.source.Vector) this._source = features;\n  else if (features instanceof Array) this._features = features;\n  else this._features = [];\n  this.refresh(zoom);\n};\n/**\n * Get features\n * @return {Array<ol.Feature>}\n */\nol.control.Timeline.prototype.getFeatures = function() {\n  return this._features || this._source.getFeatures();\n}\n/**\n * Refresh the timeline with new data\n * @param {Number} zoom Zoom factor from 0.25 to 10, default 1\n */\nol.control.Timeline.prototype.refresh = function(zoom, first) {\n  if (!this.getMap()) return;\n  if (!zoom) zoom = this.get('zoom');\n  zoom = Math.min(this.get('maxZoom'), Math.max(this.get('minZoom'), zoom || 1));\n  this.set('zoom', zoom);\n  this._scrollDiv.innerHTML = '';\n  var features = this.getFeatures();\n  var d, d2;\n  // Get features sorted by date\n  var tline = this._tline = [];\n  features.forEach(function(f) {\n    if (d = this._getFeatureDate(f)) {\n      if (!(d instanceof Date)) {\n        d = new Date(d)\n      }\n      if (this._endFeatureDate) {\n        d2 = this._endFeatureDate(f);\n        if (!(d2 instanceof Date)) {\n          d2 = new Date(d2)\n        }\n      }\n      if (!isNaN(d)) {\n        tline.push({\n          date: d,\n          end: isNaN(d2) ? null : d2,\n          feature: f\n        });\n      }\n    }\n  }.bind(this));\n  tline.sort(function(a,b) { \n    return (a.date < b.date ? -1 : (a.date===b.date ? 0: 1))\n  });\n  // Draw\n  var div = ol.ext.element.create('DIV', {\n    parent: this._scrollDiv\n  });\n  // Calculate width\n  var min = this._minDate = Math.min(this.get('minDate'), tline.length ? tline[0].date : Infinity);\n  var max = this._maxDate = Math.max(this.get('maxDate'), tline.length ? tline[tline.length-1].date : -Infinity);\n  if (!isFinite(min)) this._minDate = min = new Date();\n  if (!isFinite(max)) this._maxDate = max = new Date();\n  var delta = (max-min);\n  var maxWidth = this.get('maxWidth');\n  var scale = this._scale = (delta > maxWidth ? maxWidth/delta : 1) * zoom;\n  // Leave 10px on right\n  min = this._minDate = this._minDate - 10/scale;\n  delta = (max-min) * scale;\n  ol.ext.element.setStyle(div, {\n    width: delta,\n    maxWidth: 'unset'\n  });\n  // Draw time's bar\n  this._drawTime(div, min, max, scale);\n  // Set interval\n  if (this.get('interval')) {\n    ol.ext.element.setStyle (this._intervalDiv, { width: this.get('interval') * scale });\n  } else {\n    ol.ext.element.setStyle (this._intervalDiv, { width: '' });\n  }\n  // Draw features\n  var line = [];\n  var lineHeight = ol.ext.element.getStyle(this._scrollDiv, 'lineHeight');\n  // Wrapper\n  var fdiv = ol.ext.element.create('DIV', {\n      className: 'ol-features',\n      parent: div\n  });\n  // Add features on the line\n  tline.forEach(function(f) {\n    var d = f.date;\n    var t = f.elt = ol.ext.element.create('DIV', {\n      className: 'ol-feature',\n      style: {\n        left: Math.round((d-min)*scale),\n      },\n      html: this._getHTML(f.feature),\n      parent: fdiv\n    });\n    // Prevent image dragging\n    var img = t.querySelectorAll('img');\n    for (var i=0; i<img.length; i++) {\n      img[i].ondragstart = function(){ return false; };\n    }\n    // Calculate image width\n    if (f.end) {\n      ol.ext.element.setStyle(t, { \n        minWidth: (f.end-d) * scale, \n        width: (f.end-d) * scale, \n        maxWidth: 'unset'\n      });\n    }\n    var left = ol.ext.element.getStyle(t, 'left');\n    // Select on click\n    t.addEventListener('click', function(){\n      if (!this._moving) {\n        this.dispatchEvent({type: 'select', feature: f.feature });\n      }\n    }.bind(this));\n    // Find first free Y position\n    var pos, l;\n    for (pos=0; l=line[pos]; pos++) {\n      if (left > l) {\n        break;\n      }\n    }\n    line[pos] = left + ol.ext.element.getStyle(t, 'width');\n    ol.ext.element.setStyle(t, { top: pos*lineHeight });\n  }.bind(this));\n  this._nbline = line.length;\n  if (first) this.setDate(this._minDate, { anim: false, position: 'start' });\n  // Dispatch scroll event\n  this.dispatchEvent({ \n    type: 'scroll', \n    date: this.getDate(), \n    dateStart: this.getDate('start'), \n    dateEnd: this.getDate('end')\n  });\n};\n/**\n * Draw dates on line\n * @private\n */\nol.control.Timeline.prototype._drawTime = function(div, min, max, scale) {\n  // Times div\n  var tdiv = ol.ext.element.create('DIV', {\n    className: 'ol-times',\n    parent: div\n  });\n  var d, dt, month, dmonth;\n  var dx = ol.ext.element.getStyle(tdiv, 'left');\n  var heigth = ol.ext.element.getStyle(tdiv, 'height');\n  // Year\n  var year = (new Date(this._minDate)).getFullYear();\n  dt = (new Date(String(year)) - new Date(String(year-1))) * scale;\n  var dyear = Math.round(2*heigth/dt)+1;\n  while(true) {\n    d = new Date(String(year));\n    if (d > this._maxDate) break;\n    ol.ext.element.create('DIV', {\n      className: 'ol-time ol-year',\n      style: {\n        left: Math.round((d-this._minDate)*scale) - dx\n      },\n      html: year,\n      parent: tdiv\n    });\n    year += dyear;\n  }\n  // Month\n  if (/day|month/.test(this.get('graduation'))) {\n    dt = (new Date(String(year)) - new Date(String(year-1))) * scale;\n    dmonth = Math.max(1, Math.round(12 / Math.round(dt/heigth/2)));\n    if (dmonth < 12) {\n      year = (new Date(this._minDate)).getFullYear();\n      month = dmonth+1;\n      while(true) {\n        d = new Date(year+'/'+month+'/01');\n        if (d > this._maxDate) break;\n        ol.ext.element.create('DIV', {\n          className: 'ol-time ol-month',\n          style: {\n            left: Math.round((d-this._minDate)*scale) - dx\n          },\n          html: d.toLocaleDateString(undefined, { month: 'short'}),\n          parent: tdiv\n        });\n        month += dmonth;\n        if (month > 12) {\n          year++;\n          month = dmonth+1;\n        }\n      }\n    }\n  }\n  // Day\n  if (this.get('graduation')==='day') {\n    dt = (new Date(year+'/02/01') - new Date(year+'/01/01')) * scale;\n    var dday = Math.max(1, Math.round(31 / Math.round(dt/heigth/2)));\n    if (dday < 31) {\n      year = (new Date(this._minDate)).getFullYear();\n      month = 1;\n      var day = dday;\n      while(true) {\n        d = new Date(year+'/'+month+'/'+day);\n        if (isNaN(d)) {\n          month++;\n          if (month>12) {\n            month = 1;\n            year++;\n          }\n          day=dday;\n        } else {\n          if (d > this._maxDate) break;\n          ol.ext.element.create('DIV', {\n            className: 'ol-time ol-day',\n            style: {\n              left: Math.round((d-this._minDate)*scale) - dx\n            },\n            html: day,\n            parent: tdiv\n          });\n          day += dday;\n          if (day+dday/2>31) day=32;\n        }\n      }\n    }\n  }\n};\n/** Center timeline on a date\n * @param {Date|String|ol.feature} feature a date or a feature with a date\n * @param {Object} options\n *  @param {boolean} options.anim animate scroll\n *  @param {string} options.position start, end or middle, default middle\n */\nol.control.Timeline.prototype.setDate = function(feature, options) {\n  var date;\n  options = options || {};\n  // It's a date\n  if (feature instanceof Date) {\n    date = feature;\n  } else {\n    // Get date from Feature\n    if (this.getFeatures().indexOf(feature) >= 0) {\n      date = this._getFeatureDate(feature);\n    }\n    if (date && !(date instanceof Date)) {\n      date = new Date(date);\n    }\n    if (!date || isNaN(date)) {\n      date = new Date(String(feature));\n    }\n  }\n  if (!isNaN(date)) {\n    if (options.anim === false) this._scrollDiv.classList.add('ol-move');\n    var scrollLeft = (date-this._minDate)*this._scale;\n    if (options.position==='start') {\n      scrollLeft += ol.ext.element.outerWidth(this._scrollDiv)/2 - ol.ext.element.getStyle(this._scrollDiv, 'marginLeft')/2;\n    } else if (options.position==='end') {\n      scrollLeft -= ol.ext.element.outerWidth(this._scrollDiv)/2 - ol.ext.element.getStyle(this._scrollDiv, 'marginLeft')/2;\n    }\n    this._scrollDiv.scrollLeft = scrollLeft;\n    if (options.anim === false) this._scrollDiv.classList.remove('ol-move');\n    if (feature) {\n      for (var i=0, f; f = this._tline[i]; i++) {\n        if (f.feature === feature) {\n          f.elt.classList.add('ol-select');\n          this._select = f;\n        } else {\n          f.elt.classList.remove('ol-select');\n        }\n      }\n    }\n  }\n};\n/** Get the date of the center\n * @param {string} position start, end or middle, default middle\n * @return {Date}\n */\nol.control.Timeline.prototype.getDate = function(position) {\n  var pos;\n  switch (position) {\n    case 'start': {\n      if (this.get('interval')) {\n        pos = - ol.ext.element.getStyle(this._intervalDiv, 'width')/2 + ol.ext.element.getStyle(this._scrollDiv, 'marginLeft')/2;\n      } else {\n        pos = - ol.ext.element.outerWidth(this._scrollDiv)/2 + ol.ext.element.getStyle(this._scrollDiv, 'marginLeft')/2;\n      }\n      break;\n    }\n    case 'end': {\n      if (this.get('interval')) {\n        pos = ol.ext.element.getStyle(this._intervalDiv, 'width')/2 - ol.ext.element.getStyle(this._scrollDiv, 'marginLeft')/2;\n      } else {\n        pos = ol.ext.element.outerWidth(this._scrollDiv)/2 - ol.ext.element.getStyle(this._scrollDiv, 'marginLeft')/2;\n      }\n      break;\n    }\n    default: {\n      pos = 0;\n      break;\n    }\n  }\n  var d = (this._scrollDiv.scrollLeft + pos)/this._scale + this._minDate;\n  return new Date(d);\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A simple toggle control\n * The control can be created with an interaction to control its activation.\n *\n * @constructor\n * @extends {ol.control.Control}\n * @fires change:active, change:disable\n * @param {Object=} options Control options.\n *\t@param {String} options.className class of the control\n *\t@param {String} options.title title of the control\n *\t@param {String} options.html html to insert in the control\n *\t@param {ol.interaction} options.interaction interaction associated with the control\n *\t@param {bool} options.active the control is created active, default false\n *\t@param {bool} options.disable the control is created disabled, default false\n *\t@param {ol.control.Bar} options.bar a subbar associated with the control (drawn when active if control is nested in a ol.control.Bar)\n *\t@param {bool} options.autoActive the control will activate when shown in an ol.control.Bar, default false\n *\t@param {function} options.onToggle callback when control is clicked (or use change:active event)\n */\nol.control.Toggle = function(options)\n{\toptions = options || {};\n\tvar self = this;\n\tthis.interaction_ = options.interaction;\n\tif (this.interaction_)\n\t{\tthis.interaction_.on(\"change:active\", function(e)\n\t\t{\tself.setActive(!e.oldValue);\n\t\t});\n\t}\n\tif (options.toggleFn) options.onToggle = options.toggleFn; // compat old version\n\toptions.handleClick = function()\n\t\t{\tself.toggle();\n\t\t\tif (options.onToggle) options.onToggle.call(self, self.getActive());\n\t\t};\n\toptions.className = (options.className||\"\") + \" ol-toggle\";\n\tol.control.Button.call(this, options);\n\tthis.set(\"title\", options.title);\n\tthis.set (\"autoActivate\", options.autoActivate);\n\tif (options.bar)\n\t{\tthis.subbar_ = options.bar;\n\t\tthis.subbar_.setTarget(this.element);\n\t\tthis.subbar_.element.classList.add(\"ol-option-bar\");\n\t}\n\tthis.setActive (options.active);\n\tthis.setDisable (options.disable);\n};\nol.inherits(ol.control.Toggle, ol.control.Button);\n/**\n * Set the map instance the control is associated with\n * and add interaction attached to it to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol.control.Toggle.prototype.setMap = function(map)\n{\tif (!map && this.getMap())\n\t{\tif (this.interaction_)\n\t\t{\tthis.getMap().removeInteraction (this.interaction_);\n\t\t}\n\t\tif (this.subbar_) this.getMap().removeControl (this.subbar_);\n\t}\n\tol.control.Control.prototype.setMap.call(this, map);\n\tif (map)\n\t{\tif (this.interaction_) map.addInteraction (this.interaction_);\n\t\tif (this.subbar_) map.addControl (this.subbar_);\n\t}\n};\n/** Get the subbar associated with a control\n* @return {ol.control.Bar}\n*/\nol.control.Toggle.prototype.getSubBar = function ()\n{\treturn this.subbar_;\n};\n/**\n * Test if the control is disabled.\n * @return {bool}.\n * @api stable\n */\nol.control.Toggle.prototype.getDisable = function()\n{\tvar button = this.element.querySelector(\"button\");\n\treturn button && button.disabled;\n};\n/** Disable the control. If disable, the control will be deactivated too.\n* @param {bool} b disable (or enable) the control, default false (enable)\n*/\nol.control.Toggle.prototype.setDisable = function(b)\n{\tif (this.getDisable()==b) return;\n\tthis.element.querySelector(\"button\").disabled = b;\n\tif (b && this.getActive()) this.setActive(false);\n\tthis.dispatchEvent({ type:'change:disable', key:'disable', oldValue:!b, disable:b });\n};\n/**\n * Test if the control is active.\n * @return {bool}.\n * @api stable\n */\nol.control.Toggle.prototype.getActive = function()\n{\treturn this.element.classList.contains(\"ol-active\");\n};\n/** Toggle control state active/deactive\n*/\nol.control.Toggle.prototype.toggle = function()\n{\tif (this.getActive()) this.setActive(false);\n\telse this.setActive(true);\n};\n/** Change control state\n* @param {bool} b activate or deactivate the control, default false\n*/\nol.control.Toggle.prototype.setActive = function(b)\n{\tif (this.getActive()==b) return;\n\tif (b) this.element.classList.add(\"ol-active\");\n\telse this.element.classList.remove(\"ol-active\");\n\tif (this.interaction_) this.interaction_.setActive (b);\n\tif (this.subbar_) this.subbar_.setActive(b);\n\tthis.dispatchEvent({ type:'change:active', key:'active', oldValue:!b, active:b });\n};\n/** Set the control interaction\n* @param {_ol_interaction_} i interaction to associate with the control\n*/\nol.control.Toggle.prototype.setInteraction = function(i)\n{\tthis.interaction_ = i;\n};\n/** Get the control interaction\n* @return {_ol_interaction_} interaction associated with the control\n*/\nol.control.Toggle.prototype.getInteraction = function()\n{\treturn this.interaction_;\n};\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Feature animation base class\n * Use the {@link _ol_Map_#animateFeature} or {@link _ol_layer_Vector_#animateFeature} to animate a feature\n * on postcompose in a map or a layer\n* @constructor\n* @fires animationstart|animationend\n* @param {ol.featureAnimationOptions} options\n*\t@param {Number} options.duration duration of the animation in ms, default 1000\n*\t@param {bool} options.revers revers the animation direction\n*\t@param {Number} options.repeat number of time to repeat the animation, default 0\n*\t@param {oo.style.Style} options.hiddenStyle a style to display the feature when playing the animation\n*\t\tto be used to make the feature selectable when playing animation \n*\t\t(@see {@link ../examples/map.featureanimation.select.html}), default the feature \n*\t\twill be hidden when playing (and niot selectable)\n*\t@param {ol.easing.Function} options.fade an easing function used to fade in the feature, default none\n*\t@param {ol.easing.Function} options.easing an easing function for the animation, default ol.easing.linear\n*/\nol.featureAnimation = function(options)\n{\toptions = options || {};\n\tthis.duration_ = typeof (options.duration)=='number' ? (options.duration>=0 ? options.duration : 0) : 1000;\n\tthis.fade_ = typeof(options.fade) == 'function' ? options.fade : null;\n\tthis.repeat_ = Number(options.repeat);\n\tvar easing = typeof(options.easing) =='function' ? options.easing : ol.easing.linear;\n\tif (options.revers) this.easing_ = function(t) { return (1 - easing(t)); };\n\telse this.easing_ = easing;\n\tthis.hiddenStyle = options.hiddenStyle;\n\tol.Object.call(this);\n};\nol.inherits(ol.featureAnimation, ol.Object);\n/** Draw a geometry \n* @param {olx.animateFeatureEvent} e\n* @param {ol.geom} geom geometry for shadow\n* @param {ol.geom} shadow geometry for shadow (ie. style with zIndex = -1)\n* @private\n*/\nol.featureAnimation.prototype.drawGeom_ = function (e, geom, shadow)\n{\tif (this.fade_) \n\t{\te.context.globalAlpha = this.fade_(1-e.elapsed);\n\t}\n\tvar style = e.style;\n\tfor (var i=0; i<style.length; i++)\n\t{\tvar sc=0;\n\t\t// OL < v4.3 : setImageStyle doesn't check retina\n\t\tvar imgs = ol.Map.prototype.getFeaturesAtPixel ? false : style[i].getImage();\n\t\tif (imgs) \n\t\t{\tsc = imgs.getScale(); \n\t\t\timgs.setScale(e.frameState.pixelRatio*sc);\n\t\t}\n\t\t// Prevent crach if the style is not ready (image not loaded)\n\t\ttry{\n\t\t\te.vectorContext.setStyle(style[i]);\n\t\t\tif (style[i].getZIndex()<0) e.vectorContext.drawGeometry(shadow||geom);\n\t\t\telse e.vectorContext.drawGeometry(geom);\n\t\t} catch(e) { /* ok */ }\n\t\tif (imgs) imgs.setScale(sc);\n\t}\n};\n/** Function to perform manipulations onpostcompose. \n * This function is called with an ol.featureAnimationEvent argument.\n * The function will be overridden by the child implementation.    \n * Return true to keep this function for the next frame, false to remove it.\n * @param {ol.featureAnimationEvent} e\n * @return {bool} true to continue animation.\n * @api \n */\nol.featureAnimation.prototype.animate = function (/* e */)\n{\treturn false;\n};\n/** An animation controler object an object to control animation with start, stop and isPlaying function.    \n * To be used with {@link olx.Map#animateFeature} or {@link ol.layer.Vector#animateFeature}\n * @typedef {Object} ol.animationControler\n * @property {function} start - start animation.\n * @property {function} stop - stop animation option arguments can be passed in animationend event.\n * @property {function} isPlaying - return true if animation is playing.\n */\n/** Animate feature on a map\n * @function \n * @fires animationstart, animationend\n * @param {ol.Feature} feature Feature to animate\n * @param {ol.featureAnimation|Array<ol.featureAnimation>} fanim the animation to play\n * @return {olx.animationControler} an object to control animation with start, stop and isPlaying function\n */\nol.Map.prototype.animateFeature =\n/** Animate feature on a vector layer \n * @fires animationstart, animationend\n * @param {ol.Feature} feature Feature to animate\n * @param {ol.featureAnimation|Array<ol.featureAnimation>} fanim the animation to play\n * @return {olx.animationControler} an object to control animation with start, stop and isPlaying function\n*/\nol.layer.Vector.prototype.animateFeature = function(feature, fanim)\n{\tvar self = this;\n\tvar listenerKey;\n\t// Save style\n\tvar style = feature.getStyle();\n\tvar flashStyle = style || (this.getStyleFunction ? this.getStyleFunction()(feature) : null);\n\tif (!flashStyle) flashStyle=[];\n\tif (!(flashStyle instanceof Array)) flashStyle = [flashStyle];\n\t// Hide feature while animating\n\tfeature.setStyle(fanim.hiddenStyle || []);\n\t// Structure pass for animating\n\tvar event = \n\t\t{\t// Frame context\n\t\t\tvectorContext: null,\n\t\t\tframeState: null,\n\t\t\tstart: 0,\n\t\t\ttime: 0,\n\t\t\telapsed: 0,\n\t\t\textent: false,\n\t\t\t// Feature information\n\t\t\tfeature: feature,\n\t\t\tgeom: feature.getGeometry(),\n\t\t\ttypeGeom: feature.getGeometry().getType(),\n\t\t\tbbox: feature.getGeometry().getExtent(),\n\t\t\tcoord: ol.extent.getCenter(feature.getGeometry().getExtent()),\n\t\t\tstyle: flashStyle\n\t\t};\n\tif (!(fanim instanceof Array)) fanim = [fanim];\n\t// Remove null animations\n\tfor (var i=fanim.length-1; i>=0; i--)\n\t{\tif (fanim[i].duration_===0) fanim.splice(i,1);\n\t}\n\tvar nb=0, step = 0;\n\tfunction animate(e) \n\t{\tevent.vectorContext = e.vectorContext;\n\t\tevent.frameState = e.frameState;\n\t\tif (!event.extent) \n\t\t{\tevent.extent = e.frameState.extent;\n\t\t\tevent.start = e.frameState.time;\n\t\t\tevent.context = e.context;\n\t\t}\n\t\tevent.time = e.frameState.time - event.start;\n\t\tevent.elapsed = event.time / fanim[step].duration_;\n\t\tif (event.elapsed > 1) event.elapsed = 1;\n\t\t// Stop animation?\n\t\tif (!fanim[step].animate(event))\n\t\t{\tnb++;\n\t\t\t// Repeat animation\n\t\t\tif (nb < fanim[step].repeat_)\n\t\t\t{\tevent.extent = false;\n\t\t\t}\n\t\t\t// newt step\n\t\t\telse if (step < fanim.length-1)\n\t\t\t{\tfanim[step].dispatchEvent({ type:'animationend', feature: feature });\n\t\t\t\tstep++;\n\t\t\t\tnb=0;\n\t\t\t\tevent.extent = false;\n\t\t\t}\n\t\t\t// the end\n\t\t\telse \n\t\t\t{\tstop();\n\t\t\t}\n\t\t}\n\t\t// tell OL3 to continue postcompose animation\n\t\te.frameState.animate = true;\n\t}\n\t// Stop animation\n\tfunction stop(options)\n\t{\tol.Observable.unByKey(listenerKey);\n\t\tlistenerKey = null;\n\t\tfeature.setStyle(style);\n\t\t// Send event\n\t\tvar event = { type:'animationend', feature: feature };\n\t\tif (options) \n\t\t{\tfor (var i in options) if (options.hasOwnProperty(i))\n\t\t\t{ \tevent[i] = options[i]; \n\t\t\t}\n\t\t}\n\t\tfanim[step].dispatchEvent(event);\n\t\tself.dispatchEvent(event);\n\t}\n\t// Launch animation\n\tfunction start(options)\n\t{\tif (fanim.length && !listenerKey)\n\t\t{\tlistenerKey = self.on('postcompose', animate.bind(self));\n\t\t\t// map or layer?\n\t\t\tif (self.renderSync) self.renderSync();\n\t\t\telse self.changed();\n\t\t\t// Send event\n\t\t\tvar event = { type:'animationstart', feature: feature };\n\t\t\tif (options) \n\t\t\t{\tfor (var i in options) if (options.hasOwnProperty(i))\n\t\t\t\t{ \tevent[i] = options[i]; \n\t\t\t\t}\n\t\t\t}\n\t\t\tfanim[step].dispatchEvent(event);\n\t\t\tself.dispatchEvent(event);\n\t\t}\n\t}\n\tstart();\n\t// Return animation controler\n\treturn {\n\t\tstart: start,\n\t\tstop: stop,\n\t\tisPlaying: function() { return (!!listenerKey); }\n\t};\n};\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Bounce animation: \n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationBounceOptions} options\n *\t@param {Integer} options.bounce number of bounce, default 3\n *\t@param {Integer} options.amplitude bounce amplitude,default 40\n *\t@param {ol.easing} options.easing easing used for decaying amplitude, use function(){return 0} for no decay, default ol.easing.linear\n *\t@param {Integer} options.duration duration in ms, default 1000\n */\nol.featureAnimation.Bounce = function(options)\n{\toptions = options || {};\n\tol.featureAnimation.call(this, options);\n\tthis.amplitude_ = options.amplitude || 40;\n\tthis.bounce_ = -Math.PI*(options.bounce || 3);\n}\nol.inherits(ol.featureAnimation.Bounce, ol.featureAnimation);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Bounce.prototype.animate = function (e)\n{\t// Animate\n\tvar flashGeom = e.geom.clone();\n\t/*\n\tvar t = this.easing_(e.elapsed)\n\tt = Math.abs(Math.sin(this.bounce_*t)) * this.amplitude_ * (1-t) * e.frameState.viewState.resolution;\n\t*/\n\tvar t = Math.abs(Math.sin(this.bounce_*e.elapsed)) * this.amplitude_ * (1-this.easing_(e.elapsed)) * e.frameState.viewState.resolution;\n\tflashGeom.translate(0, t);\n\tthis.drawGeom_(e, flashGeom, e.geom);\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Drop animation: drop a feature on the map\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationDropOptions} options\n *  @param {Number} options.speed speed of the feature if 0 the duration parameter will be used instead, default 0\n *  @param {Number} options.side top or bottom, default top\n */\nol.featureAnimation.Drop = function(options)\n{\toptions = options || {};\n\tthis.speed_ = options.speed || 0;\n\tol.featureAnimation.call(this, options);\n\tthis.side_ = options.side || 'top';\n}\nol.inherits(ol.featureAnimation.Drop, ol.featureAnimation);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Drop.prototype.animate = function (e)\n{\t// First time > calculate duration / speed\n\tif (!e.time) \n\t{\tvar angle = e.frameState.viewState.rotation;\n\t\tvar s = e.frameState.size[1] * e.frameState.viewState.resolution;\n\t\tif (this.side_!='top') s *= -1;\n\t\tthis.dx = -Math.sin(angle)*s;\n\t\tthis.dy = Math.cos(angle)*s;\n\t\tif (this.speed_) \n\t\t{\tthis.duration_ = s/this.speed_/e.frameState.viewState.resolution;\n\t\t}\n\t}\n\t// Animate\n\tvar flashGeom = e.geom.clone();\n\tflashGeom.translate(\n\t\tthis.dx*(1-this.easing_(e.elapsed)),  \n\t\tthis.dy*(1-this.easing_(e.elapsed))\n\t);\n\tthis.drawGeom_(e, flashGeom, e.geom);\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Fade animation: feature fade in\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationOptions} options\n */\nol.featureAnimation.Fade = function(options)\n{\toptions = options || {};\n\tthis.speed_ = options.speed || 0;\n\tol.featureAnimation.call(this, options);\n}\nol.inherits(ol.featureAnimation.Fade, ol.featureAnimation);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Fade.prototype.animate = function (e)\n{\te.context.globalAlpha = this.easing_(e.elapsed);\n\tthis.drawGeom_(e, e.geom);\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Do nothing for a given duration\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationShowOptions} options\n * \n */\nol.featureAnimation.None = function(options)\n{\tol.featureAnimation.call(this, options);\n};\nol.inherits(ol.featureAnimation.None, ol.featureAnimation);\n/** Animate: do nothing during the laps time\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.None.prototype.animate = function (e)\n{\t\n\treturn (e.time <= this.duration_);\n};\n\n/*\n  Copyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL license (http://www.cecill.info/).\n*/\n/** Do nothing \n * @constructor\n * @extends {ol.featureAnimation}\n */\nol.featureAnimation.Null = function() {\n  ol.featureAnimation.call(this, { duration:0 });\n};\nol.inherits(ol.featureAnimation.Null, ol.featureAnimation);\n\n/*\n\tCopyright (c) 2016-2018 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Path animation: feature follow a path\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationPathOptions} options extend ol.featureAnimation options\n *  @param {Number} options.speed speed of the feature, if 0 the duration parameter will be used instead, default 0\n *  @param {Number|boolean} options.rotate rotate the symbol when following the path, true or the initial rotation, default false\n *  @param {ol.geom.LineString|ol.Feature} options.path the path to follow\n */\nol.featureAnimation.Path = function(options)\n{\toptions = options || {};\n\tol.featureAnimation.call(this, options);\n\tthis.speed_ = options.speed || 0;\n\tthis.path_ = options.path;\n\tswitch (options.rotate) {\n\t\tcase true: \n\t\tcase 0:\n\t\t\tthis.rotate_ = 0;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthis.rotate_ = options.rotate || false;\n\t\t\tbreak;\n\t}\n\tif (this.path_ && this.path_.getGeometry) this.path_ = this.path_.getGeometry();\n\tif (this.path_ && this.path_.getLineString) this.path_ = this.path_.getLineString();\n\tif (this.path_.getLength)\n\t{\tthis.dist_ = this.path_.getLength()\n\t\tif (this.path_ && this.path_.getCoordinates) this.path_ = this.path_.getCoordinates();\n\t}\n\telse this.dist_ = 0;\n\tif (this.speed_>0) this.duration_ = this.dist_/this.speed_;\n}\nol.inherits(ol.featureAnimation.Path, ol.featureAnimation);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Path.prototype.animate = function (e)\n{\t// First time \n\tif (!e.time) \n\t{\tif (!this.dist_) return false;\n\t}\n\tvar dmax = this.dist_*this.easing_(e.elapsed);\n\tvar p0, p, s, dx,dy, dl, d = 0;\n\tp = this.path_[0];\n\t// Linear interpol\n\tfor (var i = 1; i<this.path_.length; i++)\n\t{\tp0 = p;\n\t\tp = this.path_[i];\n\t\tdx = p[0]-p0[0];\n\t\tdy = p[1]-p0[1];\n\t\tdl = Math.sqrt(dx*dx+dy*dy);\n\t\tif (dl && d+dl>=dmax) \n\t\t{\ts = (dmax-d)/dl;\n\t\t\tp = [ p0[0] + (p[0]-p0[0])*s, p0[1] + (p[1]-p0[1])*s];\n\t\t\tbreak;\n\t\t}\n\t\td += dl;\n\t}\n\t// Rotate symbols\n\tif (this.rotate_!==false) {\n\t\tvar angle = this.rotate_ - Math.atan2(p0[1] - p[1], p0[0] - p[0]);\n\t\tfor (var k=0; s=e.style[k]; k++) {\n\t\t\tif (s.getImage()) {\n\t\t\t\ts.getImage().setRotation(angle)\n\t\t\t}\n\t\t}\n\t}\n\te.geom.setCoordinates(p);\n\t// Animate\n\tthis.drawGeom_(e, e.geom);\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Shakee animation: \n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationShakeOptions} options\n *\t@param {Integer} options.bounce number o bounds, default 6\n *\t@param {Integer} options.amplitude amplitude of the animation, default 40\n *\t@param {bool} options.horizontal shake horizontally default false (vertical)\n */\nol.featureAnimation.Shake = function(options)\n{\toptions = options || {};\n\tol.featureAnimation.call(this, options);\n//\tthis.easing_ = options.easing_ || function(t){return (0.5+t)*t -0.5*t ;};\n\tthis.amplitude_ = options.amplitude || 40;\n\tthis.bounce_ = -Math.PI*(options.bounce || 6);\n\tthis.horizontal_ = options.horizontal;\n}\nol.inherits(ol.featureAnimation.Shake, ol.featureAnimation);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Shake.prototype.animate = function (e)\n{\t// Animate\n\tvar flashGeom = e.geom.clone();\n\tvar shadow = e.geom.clone();\n\tvar t = this.easing_(e.elapsed)\n\tt = Math.sin(this.bounce_*t) * this.amplitude_ * (1-t) * e.frameState.viewState.resolution;\n\tif (this.horizontal_) \n\t{\tflashGeom.translate(t, 0);\n\t\tshadow.translate(t, 0);\n\t}\n\telse flashGeom.translate(0, t);\n\tthis.drawGeom_(e, flashGeom, shadow);\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Show an object for a given duration\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationOptions} options\n */\nol.featureAnimation.Show = function(options)\n{\tol.featureAnimation.call(this, options);\n}\nol.inherits(ol.featureAnimation.Show, ol.featureAnimation);\n/** Animate: just show the object during the laps time\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Show.prototype.animate = function (e)\n{\t\n\tthis.drawGeom_(e, e.geom);\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Slice animation: feature enter from left\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationSlideOptions} options\n *  @param {Number} options.speed speed of the animation, if 0 the duration parameter will be used instead, default 0\n */\nol.featureAnimation.Slide = function(options)\n{\toptions = options || {};\n\tthis.speed_ = options.speed || 0;\n\tol.featureAnimation.call(this, options);\n\tthis.side_ = options.side || 'left';\n}\nol.inherits(ol.featureAnimation.Slide, ol.featureAnimation);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Slide.prototype.animate = function (e)\n{\t// First time > calculate duration / speed\n\tif (!e.time) \n\t{\tif (this.side_=='left') this.dx = (e.extent[0]-e.bbox[2])\n\t\telse this.dx = (e.extent[2]-e.bbox[0])\n\t\tif (this.speed_) this.duration_ = Math.abs(this.dx)/this.speed_/e.frameState.viewState.resolution;\n\t}\n\t// Animate\n\tvar flashGeom = e.geom.clone();\n\tflashGeom.translate(this.dx*(1-this.easing_(e.elapsed)), 0);\n\tthis.drawGeom_(e, flashGeom);\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Teleport a feature at a given place\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationOptions} options\n */\nol.featureAnimation.Teleport = function(options)\n{\tol.featureAnimation.call(this, options);\n}\nol.inherits(ol.featureAnimation.Teleport, ol.featureAnimation);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Teleport.prototype.animate = function (e)\n{\tvar sc = this.easing_(e.elapsed);\n\tif (sc)\n\t{\te.context.save()\n\t\t\tvar ratio = e.frameState.pixelRatio;\n\t\t\te.context.globalAlpha = sc;\n\t\t\te.context.scale(sc,1/sc);\n\t\t\tvar m = e.frameState.coordinateToPixelTransform;\n\t\t\tvar dx = (1/sc-1) * ratio * (m[0]*e.coord[0] + m[1]*e.coord[1] +m[4]);\n\t\t\tvar dy = (sc-1) * ratio * (m[2]*e.coord[0] + m[3]*e.coord[1] +m[5]);\n\t\t\te.context.translate(dx,dy);\n\t\t\tthis.drawGeom_(e, e.geom);\n\t\te.context.restore()\n\t}\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Slice animation: feature enter from left\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationThrowOptions} options\n *  @param {left|right} options.side side of the animation, default left\n */\nol.featureAnimation.Throw = function(options)\n{\toptions = options || {};\n\tol.featureAnimation.call(this, options);\n\tthis.speed_ = options.speed || 0;\n\tthis.side_ = options.side || 'left';\n}\nol.inherits(ol.featureAnimation.Throw, ol.featureAnimation);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Throw.prototype.animate = function (e)\n{\t// First time > calculate duration / speed\n\tif (!e.time && this.speed_) \n\t{\tvar dx, dy;\n\t\tif (this.side_=='left')\n\t\t{\tdx = this.dx = e.extent[0]-e.bbox[2];\n\t\t\tdy = this.dy = e.extent[3]-e.bbox[1];\n\t\t}\n\t\telse\n\t\t{\tdx = this.dx = e.extent[2]-e.bbox[0];\n\t\t\tdy = this.dy = e.extent[3]-e.bbox[1];\n\t\t}\n\t\tthis.duration_ = Math.sqrt(dx*dx+dy*dy)/this.speed_/e.frameState.viewState.resolution;\n\t}\n\t// Animate\n\tvar flashGeom = e.geom.clone();\n\tvar shadow = e.geom.clone();\n\tflashGeom.translate(this.dx*(1-this.easing_(e.elapsed)), \n\t\tthis.dy*Math.cos(Math.PI/2*this.easing_(e.elapsed)));\n\tshadow.translate(this.dx*(1-this.easing_(e.elapsed)), 0);\n\tthis.drawGeom_(e, flashGeom, shadow);\n\treturn (e.time <= this.duration_);\n}\n\n/*\n\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL license (http://www.cecill.info/).\n*/\n/** Zoom animation: feature zoom in (for points)\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationZoomOptions} options\n *  @param {bool} options.zoomOut to zoom out\n */\nol.featureAnimation.Zoom = function(options)\n{\toptions = options || {};\n\tol.featureAnimation.call(this, options);\n\tthis.set('zoomout', options.zoomOut);\n}\nol.inherits(ol.featureAnimation.Zoom, ol.featureAnimation);\n/** Zoom animation: feature zoom out (for points)\n * @constructor\n * @extends {ol.featureAnimation}\n * @param {ol.featureAnimationZoomOptions} options\n */\nol.featureAnimation.ZoomOut = function(options)\n{\toptions = options || {};\n\toptions.zoomOut = true;\n\tol.featureAnimation.Zoom.call(this, options);\n}\nol.inherits(ol.featureAnimation.ZoomOut, ol.featureAnimation.Zoom);\n/** Animate\n* @param {ol.featureAnimationEvent} e\n*/\nol.featureAnimation.Zoom.prototype.animate = function (e)\n{\tvar fac = this.easing_(e.elapsed);\n\tif (fac)\n\t{\tif (this.get('zoomout')) fac  = 1/fac;\n\t\tvar style = e.style;\n\t\tvar i, imgs, sc=[]\n\t\tfor (i=0; i<style.length; i++)\n\t\t{\timgs = style[i].getImage();\n\t\t\tif (imgs) \n\t\t\t{\tsc[i] = imgs.getScale(); \n\t\t\t\timgs.setScale(sc[i]*fac);\n\t\t\t}\n\t\t}\n\t\te.context.save()\n\t\t\tvar ratio = e.frameState.pixelRatio;\n\t\t\tvar m = e.frameState.coordinateToPixelTransform;\n\t\t\tvar dx = (1/fac-1)* ratio * (m[0]*e.coord[0] + m[1]*e.coord[1] +m[4]);\n\t\t\tvar dy = (1/fac-1)* ratio * (m[2]*e.coord[0] + m[3]*e.coord[1] +m[5]);\n\t\t\te.context.scale(fac,fac);\n\t\t\te.context.translate(dx,dy);\n\t\t\tthis.drawGeom_(e, e.geom);\n\t\te.context.restore()\n\t\tfor (i=0; i<style.length; i++)\n\t\t{\timgs = style[i].getImage();\n\t\t\tif (imgs) imgs.setScale(sc[i]);\n\t\t}\n\t}\n/*\n\tvar sc = this.easing_(e.elapsed);\n\tif (sc)\n\t{\te.context.save()\n\t\tconsole.log(e)\n\t\t\tvar ratio = e.frameState.pixelRatio;\n\t\t\tvar m = e.frameState.coordinateToPixelTransform;\n\t\t\tvar dx = (1/(sc)-1)* ratio * (m[0]*e.coord[0] + m[1]*e.coord[1] +m[4]);\n\t\t\tvar dy = (1/(sc)-1)*ratio * (m[2]*e.coord[0] + m[3]*e.coord[1] +m[5]);\n\t\t\te.context.scale(sc,sc);\n\t\t\te.context.translate(dx,dy);\n\t\t\tthis.drawGeom_(e, e.geom);\n\t\te.context.restore()\n\t}\n*/\n\treturn (e.time <= this.duration_);\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/* Namespace */\nol.filter = {};\n/**\n * @classdesc \n * Abstract base class; normally only used for creating subclasses and not instantiated in apps.    \n * Used to create filters    \n * Use {@link _ol_Map_#addFilter}, {@link _ol_Map_#removeFilter} or {@link _ol_Map_#getFilters} to handle filters on a map.\n * Use {@link ol.layer.Base#addFilter}, {@link ol.layer.Base#removeFilter} or {@link ol.layer.Base#getFilters}\n * to handle filters on layers.\n *\n * @constructor\n * @extends {ol.Object}\n * @param {Object} options Extend {@link _ol_control_Control_} options.\n *  @param {boolean} [options.active]\n */\nol.filter.Base = function(options) {\n  ol.Object.call(this);\n  // Array of postcompose listener\n  this._listener = [];\n  if (options && options.active===false) this.set('active', false);\n  else this.set('active', true);\n};\nol.inherits(ol.filter.Base, ol.Object);\n/** Activate / deactivate filter\n*\t@param {boolean} b\n*/\nol.filter.Base.prototype.setActive = function (b) {\n  this.set('active', b===true);\n};\n/** Get filter active\n*\t@return {boolean}\n*/\nol.filter.Base.prototype.getActive = function () {\n  return this.get('active');\n};\n(function(){\n/** Internal function\n* @this {ol.filter} this the filter\n* @private\n*/\nfunction precompose_(e) {\n  if (this.get('active')) this.precompose(e);\n}\n/** Internal function\n* @this {ol.filter} this the filter\n* @private\n*/\nfunction postcompose_(e) {\n  if (this.get('active')) this.postcompose(e);\n}\n/** Force filter redraw / Internal function\n* @this {ol.Map|ol.layer.Layer} this: the map or layer the filter is added to\n* @private\n*/\nfunction filterRedraw_() {\n  if (this.renderSync) this.renderSync();\n  else this.changed(); \n}\n/** Add a filter to an ol object\n* @this {ol.Map|ol.layer.Layer} this: the map or layer the filter is added to\n* @private\n*/\nfunction addFilter_(filter) {\n  if (!this.filters_) this.filters_ = [];\n  this.filters_.push(filter);\n  if (filter.precompose) filter._listener.push ( { listener: this.on('precompose', precompose_.bind(filter)), target: this });\n  if (filter.postcompose) filter._listener.push ( { listener: this.on('postcompose', postcompose_.bind(filter)), target: this });\n  filter._listener.push ( { listener: filter.on('propertychange', filterRedraw_.bind(this)), target: this });\n  filterRedraw_.call (this);\n}\n/** Remove a filter to an ol object\n* @this {ol.Map|ol.layer.Layer} this: the map or layer the filter is added to\n* @private\n*/\nfunction removeFilter_(filter) {\n  var i\n  if (!this.filters_) this.filters_ = [];\n  for (i=this.filters_.length-1; i>=0; i--) {\n    if (this.filters_[i]===filter) this.filters_.splice(i,1);\n  }\n  for (i=filter._listener.length-1; i>=0; i--) {\n    // Remove listener on this object\n    if (filter._listener[i].target === this) {\n      ol.Observable.unByKey(filter._listener[i].listener);\n      filter._listener.splice(i,1);\n    }\n  }\n  filterRedraw_.call (this);\n}\n/** Add a filter to an ol.Map\n*\t@param {ol.filter}\n*/\nol.Map.prototype.addFilter = function (filter) {\n  addFilter_.call (this, filter);\n};\n/** Remove a filter to an ol.Map\n*\t@param {ol.filter}\n*/\nol.Map.prototype.removeFilter = function (filter) {\n  removeFilter_.call (this, filter);\n};\n/** Get filters associated with an ol.Map\n*\t@return {Array<ol.filter>}\n*/\nol.Map.prototype.getFilters = function () {\n  return this.filters_;\n};\n/** Add a filter to an ol.Layer\n*\t@param {ol.filter}\n*/\nol.layer.Base.prototype.addFilter = function (filter) {\n  addFilter_.call (this, filter);\n};\n/** Remove a filter to an ol.Layer\n*\t@param {ol.filter}\n*/\nol.layer.Base.prototype.removeFilter = function (filter) {\n  removeFilter_.call (this, filter);\n};\n/** Get filters associated with an ol.Map\n*\t@return {Array<ol.filter>}\n*/\nol.layer.Base.prototype.getFilters = function () {\n  return this.filters_;\n};\n})();\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Mask drawing using an ol.Feature\n * @constructor\n * @requires ol.filter\n * @extends {ol.filter.Base}\n * @param {Object} [options]\n *  @param {ol.Feature} [options.feature] feature to mask with\n *  @param {ol.style.Fill} [options.fill] style to fill with\n *  @param {boolean} [options.inner] mask inner, default false\n */\nol.filter.Mask = function(options)\n{\toptions = options || {};\n\tol.filter.Base.call(this, options);\n\tif (options.feature)\n\t{\tswitch (options.feature.getGeometry().getType())\n\t\t{\tcase \"Polygon\":\n\t\t\tcase \"MultiPolygon\":\n\t\t\t\tthis.feature_ = options.feature;\n\t\t\t\tbreak;\n\t\t\tdefault: break;\n\t\t}\n\t}\n\tthis.set(\"inner\", options.inner);\n\tthis.fillColor_ = options.fill ? ol.color.asString(options.fill.getColor()) || \"rgba(0,0,0,0.2)\" : \"rgba(0,0,0,0.2)\";\n}\nol.inherits(ol.filter.Mask, ol.filter.Base);\n/** Draw the feature into canvas */\nol.filter.Mask.prototype.drawFeaturePath_ = function(e, out)\n{\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tvar ratio = e.frameState.pixelRatio;\n\t// Transform\n\tvar m = e.frameState.coordinateToPixelTransform;\n\tvar tr = function(pt)\n\t{\treturn [\n\t\t\t(pt[0]*m[0]+pt[1]*m[1]+m[4])*ratio,\n\t\t\t(pt[0]*m[2]+pt[1]*m[3]+m[5])*ratio\n\t\t];\n\t}\n\t// Old ol version\n\tif (!m)\n\t{\tm = e.frameState.coordinateToPixelMatrix;\n\t\ttr = function(pt)\n\t\t{\treturn [\n\t\t\t\t(pt[0]*m[0]+pt[1]*m[1]+m[12])*ratio,\n\t\t\t\t(pt[0]*m[4]+pt[1]*m[5]+m[13])*ratio\n\t\t\t];\n\t\t}\n\t}\n\t// Geometry\n\tvar ll = this.feature_.getGeometry().getCoordinates();\n\tif (this.feature_.getGeometry().getType()==\"Polygon\") ll = [ll];\n\tctx.beginPath();\n        if (out)\n\t\t{\tctx.moveTo (0,0);\n\t\t\tctx.lineTo (canvas.width, 0);\n\t\t\tctx.lineTo (canvas.width, canvas.height);\n\t\t\tctx.lineTo (0, canvas.height);\n\t\t\tctx.lineTo (0, 0);\n\t\t}\n\t\tfor (var l=0; l<ll.length; l++)\n\t\t{\tvar c = ll[l];\n\t\t\tfor (var i=0; i<c.length; i++) \n\t\t\t{\tvar pt = tr(c[i][0]);\n\t\t\t\tctx.moveTo (pt[0], pt[1]);\n\t\t\t\tfor (var j=1; j<c[i].length; j++) \n\t\t\t\t{\tpt = tr(c[i][j]);\n\t\t\t\t\tctx.lineTo (pt[0], pt[1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n}\nol.filter.Mask.prototype.postcompose = function(e)\n{\tif (!this.feature_) return;\n\tvar ctx = e.context;\n\tctx.save();\n\t\tthis.drawFeaturePath_(e, !this.get(\"inner\"));\n\t\tctx.fillStyle = this.fillColor_;\n\t\tctx.fill(\"evenodd\");\n\tctx.restore();\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Clip layer or map\n*  @constructor\n* @requires ol.filter\n* @extends {ol.filter.Base}\n* @param {Object} [options]\n*  @param {Array<ol.Coordinate>} [options.coords]\n*  @param {ol.Extent} [options.extent]\n*  @param {string} [options.units] coords units percent (%) or pixel (px)\n*  @param {boolean} [options.keepAspectRatio] keep aspect ratio\n*  @param {string} [options.color] backgroundcolor\n*/\nol.filter.Clip = function(options)\n{\toptions = options || {};\n\tol.filter.Base.call(this, options);\n\tthis.set(\"coords\", options.coords);\n\tthis.set(\"units\", options.units);\n\tthis.set(\"keepAspectRatio\", options.keepAspectRatio);\n\tthis.set(\"extent\", options.extent || [0,0,1,1]);\n\tthis.set(\"color\", options.color);\n\tif (!options.extent && options.units!=\"%\" && options.coords)\n\t{\tvar xmin = Infinity;\n\t\tvar ymin = Infinity;\n\t\tvar xmax = -Infinity;\n\t\tvar ymax = -Infinity;\n\t\tfor (var i=0, p; p=options.coords[i]; i++)\n\t\t{\tif (xmin > p[0]) xmin = p[0];\n\t\t\tif (xmax < p[0]) xmax = p[0];\n\t\t\tif (ymin > p[1]) ymin = p[1];\n\t\t\tif (ymax < p[1]) ymax = p[1];\n\t\t}\n\t\toptions.extent = [xmin,ymin,xmax,ymax];\n\t}\n}\nol.inherits(ol.filter.Clip, ol.filter.Base);\nol.filter.Clip.prototype.clipPath_ = function(e)\n{\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tvar coords = this.get(\"coords\");\n\tif (!coords) return;\n\tvar ex = this.get('extent');\n\tvar scx = 1, scy = 1;\n\tif (this.get(\"units\")==\"%\") \n\t{\tscx = canvas.width/(ex[2]-ex[0]);\n\t\tscy = canvas.height/(ex[3]-ex[1]);\n\t}\n\tif (this.get(\"keepAspectRatio\")) \n\t{\tscx = scy = Math.min (scx, scy);\n\t}\n\tvar pos = this.get('position');\n\tvar dx=0, dy=0;\n\tif (/left/.test(pos)) \n\t{\tdx = -ex[0]*scx;\n\t}\n\telse if (/center/.test(pos)) \n\t{\tdx = canvas.width/2 - (ex[2]-ex[0])*scx/2;\n\t}\n\telse if (/right/.test(pos)) \n\t{\tdx = canvas.width - (ex[2]-ex[0])*scx;\n\t}\n\tvar fx = function(x) { return x*scx + dx };\n\tif (/top/.test(pos)) \n\t{\tdy = -ex[1]*scy;\n\t}\n\telse if (/middle/.test(pos)) \n\t{\tdy = canvas.height/2 - (ex[3]-ex[1])*scy/2;\n\t}\n\telse if (/bottom/.test(pos)) \n\t{\tdy = canvas.height - (ex[3]-ex[1])*scy;\n\t}\n\tvar fy = function(y) { return y*scy + dy; };\n\tctx.moveTo ( fx(coords[0][0]), fy(coords[0][1]) );\n\tfor (var i=1, p; p=coords[i]; i++) \n\t{\tctx.lineTo ( fx(p[0]), fy(p[1]) );\n\t}\n\tctx.lineTo ( fx(coords[0][0]), fy(coords[0][1]) );\n};\nol.filter.Clip.prototype.precompose = function(e)\n{\tif (!this.get(\"color\"))\n\t{\te.context.save();\n\t\te.context.beginPath();\n\t\tthis.clipPath_(e);\n\t\te.context.clip();\n\t}\n}\nol.filter.Clip.prototype.postcompose = function(e)\n{\tif (this.get(\"color\"))\n\t{\tvar ctx = e.context;\n\t\tvar canvas = e.context.canvas;\n\t\tctx.save();\n\t\tctx.beginPath();\n\t\tctx.moveTo(0,0);\n\t\tctx.lineTo(0,canvas.height);\n\t\tctx.lineTo(canvas.width, canvas.height);\n\t\tctx.lineTo(canvas.width, canvas.height);\n\t\tctx.lineTo(canvas.width, 0);\n\t\tctx.lineTo(0, 0);\n\t\tthis.clipPath_(e);\n\t\tctx.fillStyle = this.get(\"color\");\n\t\tctx.fill(\"evenodd\");\n\t}\n\te.context.restore();\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** @typedef {Object} FilterColorizeOptions\n *  @property {ol.Color} color style to fill with\n *  @property {string} operation 'enhance' or a CanvasRenderingContext2D.globalCompositeOperation\n *  @property {number} value a [0-1] value to modify the effect value\n *  @property {boolean} inner mask inner, default false\n */\n/** Colorize map or layer\n * @constructor\n * @requires ol.filter\n * @extends {ol.filter.Base}\n * @author Thomas Tilak https://github.com/thhomas\n * @author Jean-Marc Viglino https://github.com/viglino\n * @param {FilterColorizeOptions} options\n */\nol.filter.Colorize = function(options)\n{\tol.filter.Base.call(this, options);\n\tthis.setFilter(options);\n}\nol.inherits(ol.filter.Colorize, ol.filter.Base);\n/** Set options to the filter\n * @param {FilterColorizeOptions} [options]\n */\nol.filter.Colorize.prototype.setFilter = function(options)\n{\toptions = options || {};\n\tswitch (options)\n\t{\tcase \"grayscale\": options = { operation:'hue', red:0, green:0, blue:0, value:1 }; break;\n\t\tcase \"invert\": options = { operation:'difference', red:255, green:255, blue:255, value:1 }; break;\n\t\tcase \"sepia\": options = { operation:'color', red:153, green:102, blue:51, value:0.6 }; break;\n\t\tdefault: break;\n\t}\n\tvar color = options.color ? ol.color.asArray(options.color) : [ options.red, options.green, options.blue, options.value];\n\tthis.set('color', ol.color.asString(color))\n\tthis.set ('value', color[3]||1);\n\tvar v;\n\tswitch (options.operation)\n\t{\tcase 'color':\n\t\tcase 'hue':\n\t\tcase 'difference':\n\t\tcase 'color-dodge':\n\t\tcase 'enhance':\n\t\t\tthis.set ('operation', options.operation);\n\t\t\tbreak;\n\t\tcase 'saturation':\n\t\t\tv = 255*(options.value || 0);\n\t\t\tthis.set('color', ol.color.asString([0,0,v,v||1]));\n\t\t\tthis.set ('operation', options.operation);\n\t\t\tbreak;\n\t\tcase 'luminosity':\n\t\t\tv = 255*(options.value || 0);\n\t\t\tthis.set('color', ol.color.asString([v,v,v,255]));\n\t\t\t//this.set ('operation', 'luminosity')\n\t\t\tthis.set ('operation', 'hard-light');\n\t\t\tbreak;\n\t\tcase 'contrast':\n\t\t\tv = 255*(options.value || 0);\n\t\t\tthis.set('color', ol.color.asString([v,v,v,255]));\n\t\t\tthis.set('operation', 'soft-light');\n\t\t\tbreak;\n\t\tdefault: \n\t\t\tthis.set ('operation', 'color');\n\t\t\tbreak;\n\t}\n}\n/** Set the filter value\n *  @param {ol.Color} options.color style to fill with\n */\nol.filter.Colorize.prototype.setValue = function(v)\n{\tthis.set ('value', v);\n\tvar c = ol.color.asArray(this.get(\"color\"));\n\tc[3] = v;\n\tthis.set(\"color\", ol.color.asString(c));\n}\n/** Set the color value\n *  @param {number} options.value a [0-1] value to modify the effect value\n */\nol.filter.Colorize.prototype.setColor = function(c)\n{\tc = ol.color.asArray(c);\n\tif (c)\n\t{\tc[3] = this.get(\"value\");\n\t\tthis.set(\"color\", ol.color.asString(c));\n\t}\n}\n/** @private \n */\nol.filter.Colorize.prototype.precompose = function(/* e */) {\n}\n/** @private \n */\nol.filter.Colorize.prototype.postcompose = function(e) {\n\t// Set back color hue\n\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tctx.save();\n\t\tif (this.get('operation')=='enhance')\n\t\t{\tvar v = this.get('value');\n\t\t\tif (v)\n\t\t\t{\tvar w = canvas.width;\n\t\t\t\tvar h = canvas.height;\n\t\t\t\tctx.globalCompositeOperation = 'color-burn'\n\t\t\t\tctx.globalAlpha = v;\n\t\t\t\tctx.drawImage (canvas, 0, 0, w, h);\n\t\t\t\tctx.drawImage (canvas, 0, 0, w, h);\n\t\t\t\tctx.drawImage (canvas, 0, 0, w, h);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\tctx.globalCompositeOperation = this.get('operation');\n\t\t\tctx.fillStyle = this.get('color');\n\t\t\tctx.fillRect(0,0,canvas.width,canvas.height);  \n\t\t}\n\tctx.restore();\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Colorize map or layer\n* @constructor\n* @requires ol.filter\n* @extends {ol.filter.Base}\n* @param {Object} options\n*   @param {string} options.operation composite operation\n*/\nol.filter.Composite = function(options)\n{\tol.filter.Base.call(this, options);\n\tthis.set(\"operation\", options.operation || \"source-over\");\n}\nol.inherits(ol.filter.Composite, ol.filter.Base);\n/** Change the current operation\n*\t@param {string} operation composite function\n*/\nol.filter.Composite.prototype.setOperation = function(operation)\n{\tthis.set('operation', operation || \"source-over\");\n}\nol.filter.Composite.prototype.precompose = function(e)\n{\tvar ctx = e.context;\n\tctx.save();\n\tctx.globalCompositeOperation = this.get('operation');\n}\nol.filter.Composite.prototype.postcompose = function(e)\n{\te.context.restore();\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Crop drawing using an ol.Feature\n* @constructor\n* @requires ol.filter\n* @requires ol.filter.Mask\n* @extends {ol.filter.Mask}\n* @param {Object} [options]\n*  @param {ol.Feature} [options.feature] feature to crop with\n*  @param {boolean} [options.inner=false] mask inner, default false\n*/\nol.filter.Crop = function(options)\n{\toptions = options || {};\n\tol.filter.Mask.call(this, options);\n}\nol.inherits(ol.filter.Crop, ol.filter.Mask);\nol.filter.Crop.prototype.precompose = function(e)\n{\tif (!this.feature_) return;\n\tvar ctx = e.context;\n\tctx.save();\n\tthis.drawFeaturePath_(e, this.get(\"inner\"));\n\tctx.clip(\"evenodd\");\n}\nol.filter.Crop.prototype.postcompose = function(e)\n{\tif (this.feature_) e.context.restore();\n}\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Fold filer map\n* @constructor\n* @requires ol.filter\n* @extends {ol.filter.Base}\n* @param {Object} [options]\n*  @param {[number, number]} [options.fold] number of fold (horizontal and vertical)\n*  @param {number} [options.margin] margin in px, default 8\n*  @param {number} [options.padding] padding in px, default 8\n*  @param {number|number[]} [options.fsize] fold size in px, default 8,10\n*/\nol.filter.Fold = function(options)\n{\toptions = options || {};\n\tol.filter.Base.call(this, options);\n\tthis.set(\"fold\", options.fold || [8,4]);\n\tthis.set(\"margin\", options.margin || 8);\n\tthis.set(\"padding\", options.padding || 8);\n\tif (typeof options.fsize == \"number\") options.fsize = [options.fsize,options.fsize];\n\tthis.set(\"fsize\", options.fsize || [8,10]);\n}\nol.inherits(ol.filter.Fold, ol.filter.Base);\nol.filter.Fold.prototype.drawLine_ = function(ctx, d, m)\n{\tvar canvas = ctx.canvas;\n\tvar fold = this.get(\"fold\");\n\tvar w = canvas.width;\n\tvar h = canvas.height;\n\tvar x, y, i;\n\tctx.beginPath();\n\tctx.moveTo ( m, m );\n\tfor (i=1; i<=fold[0]; i++)\n\t{\tx = i*w/fold[0] - (i==fold[0] ? m : 0);\n\t\ty =  d[1]*(i%2) +m;\n\t\tctx.lineTo ( x, y );\n\t}\n\tfor (i=1; i<=fold[1]; i++)\n\t{\tx = w - d[0]*(i%2) - m;\n\t\ty = i*h/fold[1] - (i==fold[1] ? d[0]*(fold[0]%2) + m : 0);\n\t\tctx.lineTo ( x, y );\n\t}\n\tfor (i=fold[0]; i>0; i--)\n\t{\tx = i*w/fold[0] - (i==fold[0] ? d[0]*(fold[1]%2) + m : 0);\n\t\ty = h - d[1]*(i%2) -m;\n\t\tctx.lineTo ( x, y );\n\t}\n\tfor (i=fold[1]; i>0; i--)\n\t{\tx = d[0]*(i%2) + m;\n\t\ty = i*h/fold[1] - (i==fold[1] ? m : 0);\n\t\tctx.lineTo ( x, y );\n\t}\n\tctx.closePath();\n}\nol.filter.Fold.prototype.precompose = function(e)\n{\tvar ctx = e.context;\n\tctx.save();\n\t\tctx.shadowColor = \"rgba(0,0,0,0.3)\";\n\t\tctx.shadowBlur = 8;\n\t\tctx.shadowOffsetX = 2;\n\t\tctx.shadowOffsetY = 3;\n\t\tthis.drawLine_(ctx, this.get(\"fsize\"), this.get(\"margin\"));\n\t\tctx.fillStyle=\"#fff\";\n\t\tctx.fill();\n\t\tctx.strokeStyle = \"rgba(0,0,0,0.1)\";\n\t\tctx.stroke();\n\tctx.restore();\n\tctx.save();\n\tthis.drawLine_(ctx, this.get(\"fsize\"), this.get(\"margin\") + this.get(\"padding\"));\n\tctx.clip();\n}\nol.filter.Fold.prototype.postcompose = function(e)\n{\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tctx.restore();\n\tctx.save();\n\t\tthis.drawLine_(ctx, this.get(\"fsize\"), this.get(\"margin\"));\n\t\tctx.clip();\n\t\tvar fold = this.get(\"fold\");\n\t\tvar w = canvas.width/fold[0];\n\t\tvar h = canvas.height/fold[1];\n\t\tvar grd = ctx.createRadialGradient(5*w/8,5*w/8,w/4,w/2,w/2,w);\n\t\tgrd.addColorStop(0,\"transparent\");\n\t\tgrd.addColorStop(1,\"rgba(0,0,0,0.2)\");\n\t\tctx.fillStyle = grd;\n\t\tctx.scale (1,h/w);\n\t\tfor (var i=0; i<fold[0]; i++) for (var j=0; j<fold[1]; j++)\n\t\t{\tctx.save()\n\t\t\tctx.translate(i*w, j*w);\n\t\t\tctx.fillRect(0,0,w,w);\n\t\t\tctx.restore()\n\t\t}\n\tctx.restore();\n}\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Make a map or layer look like made of a set of Lego bricks.\n *  @constructor\n * @requires ol.filter\n * @extends {ol.filter.Base}\n * @param {Object} [options]\n *  @param {string} [options.img]\n *  @param {number} [options.brickSize] size of te brick, default 30\n *  @param {null | string | undefined} [options.crossOrigin] crossOrigin attribute for loaded images.\n */\nol.filter.Lego = function(options)\n{\tif (!options) options = {};\n\tol.filter.Base.call(this, options);\n\tvar img = new Image();\n\t// Default image\n\timg.src = this.img[options.img] || this.img.ol3;\n\timg.crossOrigin = options.crossOrigin || null;\n\t// and pattern \n\tthis.pattern = \n\t{\tcanvas: document.createElement('canvas')\n\t};\n\tthis.setBrick (options.brickSize, img);\n\tthis.internal_ = document.createElement('canvas');\n}\nol.inherits(ol.filter.Lego, ol.filter.Base);\n/** Image definition\n*/\nol.filter.Lego.prototype.img =\n{\tbrick: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAQAAAAAYLlVAAAAAnNCSVQICFXsRgQAAAAJcEhZcwAAD10AAA9dAah0GUAAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAGAElEQVRo3sWZy4tkVx3HP+fcc29Vd1dP17TdTcbJPDKPMGR0kVEZkuBCF0EE9Z8QXLhxMUsRF4oLwYWQTSCgSxUXroQhoiEuskgEUUQh+BhHOpkZO11dr3vvefxc3FPlNHNvPbrD1Dl016XoqvM539/znFbcZo3VjbFmxcMA3Mg2fSoAiQJDov7/B1o9+aEgkycv4PBSPU9eHeDEixNwOAFXPYvFia0+rcnQEeBr218cfLIwCqW1UWillEYphUKpCmCCIQAiCEhAJIggTiSISBAfggTvJZTifQghWO+89cOQexuOXN8Pwz/9ff9X/xF0uEA7AmTsjLp/2xZQCgXHlj0OEBEAeRwGkep3qN6pfibDB3DBixMnvdCXt8J3FZowNYFSjgv71RtPaehjD0alalVOqCtHU3qlAGrVAGbidCtUYLUAiV6dCUx8XV4BhUKjY0AJgUB4LE8sA7CkCRSalFYnE72WiBrLSCKCp6TALZNRDEDCwgAKQ/vyRidN9c32K1sbqlCP/C+P9kXJI597PA7HkGJRCLNUGCY767udF9e+9dz1S5ueoRzIEZa1OxcK9td+/fAHvYH0LY6MkgHFIuYwS0ifXe1+qXvn1vk99QfzCwokToUylPrre1/de/vMnf9+5MsSg2HMELegAsl86duvnP3e8y/f1r83v8Li1RO7k/9c2t/avHnt27xpyhRDguEIuxDA3OXXX93+8a0rz6ZvcKgadqUEL73wx+9sb5//WWKTGCOHsxEWM0H71e2ffmF3lPyEkZppVyVYefCw/9a5f3epSvsWh7MMsUgeaL20/dpLu4fJXZUvFCgi46/8i5RNFCCc4bA5JuZ7f/Kp7g9fuLSdvLnY8lEHxz8ItOPcaN7gPAB1tvPl7udupT9nvGSmLLlHSosWLdbJTgpgLna+eVv9hiO1ZIpFOGBEFmejBnrO/tc/0znXTf+sHMuPwD0MrSnETID6/SXPrH/junp3Xiw3atCjxJCRktKu10DHzrZ+pOvpc5cP/6T8CWtt4BATZ4tkBoCvTz8tbTb8TnHiYi/0pgCmPufMUkB1ss9vtU7Trgt9EgyGhIS0zgjRB6RukaSdfHpLPly2xTg2chQJmgRN2qiAa3DBtu5kYXgqAIFYEzTJDAVCnQIqaA+O0wyFjj8q1oY6AB/qd5nLw9JvcpqOOcFMT5dqlg/UAoy5exS2TgGg6DxhkHofqHVCGYf3ho/S904DcHZ6jpZ6lWMY1iogCDxsn8oDduP3BEI9QvSBWgU8YRDeGezsyEk1SNlD8HF51wjQoEAgHNkffXBw+XfJiZbXXCTBT2fZaAJfn4iEEt+z73bTk92jZTxPwOFxVCeGRif0tt4HCtxB+f0P7l//rTlBAN6gjcNicThcfU2NCnjf0NU43L59vf2XZf1A8wzX8JRTgLw+Ckx17SahIZGOyMri7dHalXf6DJdYfovPAgVlRLAzAXwI0gCQU5La8m6SXeH9pi+pWf5lUooIUFKSN6V0A1AE39RyeAYYEpvYNjf4OwP8XNuf50UycnKKKURjSTMALkjzzgpyEhI0LW7ygHvYRh00G7zARQL5dBYU9JtLWvQB52e0VX0MOl5anmOP+3yIjZldpteZijZXuIbBxZ1PAEbkc05GVspZtnX04hlHEDKucpUePYbklCgyNjjDLp9AERhjKSNAQc6IwSzPMQClt37OIeOQ7vQWxJPSZSf2OZMyK1h8jHsbNSgY0Z/tNRWA2HmuVXLIZsxnliw2mROAyR2Rjwmn8vyC0XynrUwQ3PzGs6QX06rDRgD9GIDEjF9pUFLSXyRsowLFIp2/44icDpZ02umq6S3ZxDwupp3hYs1cVMAu1noLBZaMNbJoAD3tl6prOodnTF5feBoBRmGweO8fyClISMlIowkkApRYyqbeZ5YJQrHc4UNieeGYArL8NeUkFcvgJKc/AU56ajxejod+/DT/W/IkQC4P3GoBwoGsFKAf9v2qAGIxej9MU8rTGdNjWtVsJv315aL3YwDYqG5MTDxAPMvTNkJS3ReY6AmtlTrhKsf/AHgAA6ezGE+FAAAAAElFTkSuQmCC\",\n\tol3: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAQAAAAAYLlVAAAAAnNCSVQICFXsRgQAAAAJcEhZcwAAD10AAA9dAah0GUAAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAHtUlEQVRo3sWZTWxcVxXHf/d9zIztcTz+pE6cOHXiyLJJadKgKE2oCBLlQwIWSCxYI0WiGxZZIYRAArFAYoEEi0hIsGBBURd0g4iK2lJAaWlaojZVKkU0H26cxB8Zz/f7uPeweHdebDLPnqlQ5l2N5/mN7tz/+Z//OffcM4rPUKCPl0eBAqqfAEAt5Ia1LwCuAg93CyCnAzgj7TstEKMluW+/x0AsWmKBmFggTu4lIpYome2Qw0kA8I2xL9T2Bp5COY6ncJRSDkopFEolANowBEAEATGIGBEkFjEiYkQbI0ZrMaFobYwxkY51pOumpSNTiau6bm7oZX1NP4Ai+ylYADkmGqUPxwSUQsG2ZbcDsBAA2QoGkeSvSZ4kr/alDcRGSyyxbJqqvG5+pHAwbRegVMz+leTBY7qcbTee8vsmQycRmnL6CkD1G4DXFl0fGegvANfpnws8+947AwqFg2MDSjAYzJY80QuAHl2gcPDJF3PiDLiimtIQC0ETEhD3klE8AJeuASg8CgeHir7vLBVOjwypQK3plyoromRNtzSamJg6QbcgvJ7C0J0YnCweG/jek/Ozw5q6bEiFiIHz+wNWBv68+rPNmlQjYnKE1Ai6cYfXA/W5Q6Uvl84f3zel3vH+SIDYoVAeofOdqa9PvbHn/PoDHYZ4eDSpE3fJgLs79YXToz858uxJ5+/en4jQ6hHr5OPZlZHhpcM/4BUv9PFw8agQdQVg1+UHnx/75fG5Gf83lFWGVUrQsmmu/HBsbN8f3Mi1MVLeGUJ3Lig8P/a7s5MN97c01I5+VUIk91err0/fLqFwgBHKOzmimzyQPzX2q1OTZfeianUVKCLNr93EZxiFIOyhnB0Tu6vf/XTp54uzY+4r3S1veYj5CEPBjqFsA3cDoEaLXy199rj/Is0eM2XILXzy5MkzSO6TAvAOFF84qf5KRfWYYhE2aJCzI5MDbxf7B58pTpf89x8qX1yWGKXKFaUBZIF1tWo/KzJPiYi3VAgYbrFEnpiYiBzBTgx0ts99YvDcvHr7YSBJka/Q4k1u3jz5eQ/EYebkXvL241NUeZN/31gkDwibhHjk8PGzTh+OrWw7X/6g/+TB8nuJrQCc4Z/KU08rb+1f/1gCSqy9NUNoP72txtXRb40dfJ+nkgMEZTw78riZLhDRndNP3vGG9GBKnRzhrppmilfhmcWoRYkxyuxv86euUaT24h4W2WN53WQmheB1ygc7MaCKuc+N5LeW6wfOXeUorwFQZIV5RlnbNqcGjBMyaAFUcfHwcHHxOznBakA6JQq34B4dkXtt+8QjvnCQa/Z/jxpFCmdbpPSJI7NyhMVzK/j2UQuFi4OLkz57FECcIcGCU8yZeirQvdxjjuvpTKGAem2EcjpjkjnUC5cvfIm/bRG3Y4e7AwOmEwPKOJotfhvlPj61dGaBEChtAdD88Yeq9et1LqWOUTj2lYzOItSmcxi2ZDXUw+k0n0bqDoXDJBsMM8rHKeIKFbxgIV9nL3cSFlPpZQBoa6AjgCYXK2YkndbckkxmWWfu2D00ozzYNinOlagwbRct/k92zNJARxFK01yur/mX2wDWGE0jfuHyNfa+Y6hQYNsmJQ45hqwwFaPpOVo6s2zDsCMDgsBq2sBR9xj8ZvX70+LJc9w+scA1Sjz49rjMy7zMywE5IY64PMcNDlkHKCbt9xhMZwhOooGODGhMzVyqTUxIm4Pll9797ixnWFZ3WORdSqz//hI+Pv7LT5dXOcNZltUa49y3qplC0Hb5uBMAbwcGDKYS/eLu6YMfrSZCUhWY+QCfGZ7iZYRbarSdYMfd0bvXazh8ii/yF2vcAVwitB1hZirWnROREFLYjN4uLQ5QTZ/WmeA2VwDUHbBks351HRxK3OaqtTTHEQwxmpjkxJApQh111kBAvBH+9O7y/KveFsfcYyNj82qywqZdxmWBAjEREbHdkrNEqNE6o6qJiVeiC4UPHuqg20PvExxGE6YAWp2jwEvabmIyqpoGuTB4ozEwd6lKvYflRzgBBIQWQrQjAG2MZABoEeJH4UU3N8f1rC/psPyz+AQWQEhIK6s09wACk+EC0NTwcCM3KrDAf6ihd6ui2ccxcrRoEaQg6lnQPYDYSLZlAS1cXBzyLHGfW0SZPDgMscgBDK10BARUs48mVgNxtl2GKh6ObVpOM8Uy94hsZpe0nakoMMdhPGJreRtAg9YuJ6NIwp18G7OJsilVyHGIQ2yySZ0WIYocQ+xhknEUhiYRoQUQ0KJBbSfleAChjvQuh4wypbQLovEpMWHrnPY2K0RoG/eR5SCgQXVn1SQAJNpNWiFlhm0+i8jZIrMNoN0j0jbhJMoPaOwu2sQFJt69oRKyadNqTGQBOFsAiM34CQchIdVuwtYyEOgu4jumQosiEX5a6aq0S9Z2T2zTThfdkS0MRN21lISAiBwD5KwDnLReStp0MZomrc4bTyaAhql131gztAhw8cnhWxeIBRASEWbVPju5wAS9/VYgdnthGwPSe5uynYqlpun9EuCTzHt0O67r5uP8teRRAC25H/cXgNmQvgKomhXdLwB2M7pu0pTyeK70mJYUm251sLfo/T8AGEoKes8eIGZ43E5wk36BBwhO2mbqgwZa9C0CAP4LFLGzNDDzmrAAAAAASUVORK5CYII=\",\n\tlego: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAD8AAAA/CAQAAAD9VthUAAAAAnNCSVQICFXsRgQAAAAJcEhZcwAADzoAAA86AZc528IAAAAZdEVYdFNvZnR3YXJlAHd3dy5pbmtzY2FwZS5vcmeb7jwaAAAHvElEQVRYw8WZWWxcVxnHf+fec2fGu+M4qbPH2EmTLk4FApqQNrgiVYyKeClIwBsvPCAQkZAQPND2gRekCoGQEItYHhBLurCksoTKA6QNJW0CBZLWCc3qEBvHy3hsz93O+XiYMxM7nhmPGxGf++Dre2fO7/v+5/u+s4zigzSxVq3osaZNAwzkuq1nPeUrAE9p99JTAKWn5WYEwErpv9TdGbECRlKMgBEjRlIgsqlAKBBaSKUokAjgkcFz+Ce6BvM9sVbKU55WKKWUh1IeoJQCFhsgIIIgIohYEWwq1ooVK9ZasdbG1hhrjUmMsYlZsJEJzYIpmLwZs/8xZ9JpaGYHOYfPyvrChrdbpAxbjFRltCqhnQ2yxBTKf0WQUgNrwYqIFStGUkkllqIU5E/2aQBbEV8pz/ZM3Or8/95UmeUB+J63RiHoAWi1ZHTvNl6pNfXe99Taeq/W1HvuYOzvKG5c4q1afIWHj4eHBwgWwWCQ1aWvBvC8VXngE5DbmO3UxrOeqEhmTFEcPiIiadwEfVttWxmd623tyu7Mfnrjru5cM0Th+Nyp2Z/MztvJNDLkSImZJ27MhNWIr8j1tn+g9at7+/ubivaSHYkmjPF1f+sj7Uc3Xc29VPjm1JSJEzJkCZkjaVT8hvzubDvQ8cz9AwPeG/rHFD3BZkoeTqLwCuqzrQf7nw9+UJhOidEEFAhX0sCJr1fyXm/uPLr5849n/u1/j3mMWtqtYEFm5v/2pXUHdhzNjgaxzunQQzNX3wDdWIT0dT3bP3Qo8wIXSVWNDpWQys2xmW/3fbn1WpAWXUrWNaARvN+/7lu7jzysf8q4siuEh5A8fX5/+8XepLyEs8zfCd7raP/K9scf1T9iQjUUzU+JynOR3TQBgpAS1a16dVtusONTH8kc42ZjcFFKEApcJyBHjizt+O8Wr3e2P7Uv+3curyT7InhJ8nFCMmTJkqWlVlnzVsj0psc69vbrV1SyKnjJgCsEZMiQoanWINcfe39v6xfv808Suu6f5EVlQA7QAcC/1DXp42GmuazOiaJbjjDFSTUNCLOEZMiQEJAjrZYB9b0PmoPe7fpNZQAkYFb1A9CphtWwGlbNkmX/R59TpzhPAAwdf37XKWac1JZJAnc1VSfp0ufSqtK3NT/Y3DJVKZ5tYbHiwfvJAjc5dO7Pw4cZOb4vc51ccvZjh7ZfubaTC8y4evgeAjQaTYCpgZfq06TXpD++Rd6hHHTdZ8JKDs8yAsAD92/gjxSfGNvYzp7Wt3nj6sS2D5NxtXAeHNwnIFpOqSe+bg+2d6ejFXzXS8WlJUSyhBiKoAqj1yFuYQLQZCvFOMLDx8evPFuOF7HV0sqzXmsuP1mJ5tbfVirYc++VITnItvyN8rhJjqIrL7qS50KCX1mWeLXFr5Z02nqiJ2+lXOasIQHJkD75C6DjtQ8dH6Eg99FHyD+LBRclaomnqgL3lo++w4utWsBVbNYtr1htYZFBZgm2299Z5rmXl4+ZtwaPjDlt9CJ0gIeqXNXFN7WKDtMLnW1y+9e6Txc5z2le25Te0BTVic89ovf3yIXE1QeP4FbJbmCla21V723evjklncued/0mZA6AcEABfH/6rXzb2IM5fJD1zLvIB02zm3ak+iK0hK8mvmBnzA/Hoy3LJoyW4XIITn5daAbaX0w3XBnIIsCBL7zDpFNvPWoRvBY+larBZ5Gb6eX20xXxf/2QDMkgmc+sl8MyJH2cf/Seka3yGFv+kR7Ok/1riwxhvruJUYffhGCxWKS0IqqReFXFN5g583qaNokC0aSf/JUaVn95ufNrJ9SwGlapMkkUXuPMAy/E24CJbQVeVWeIXDAFbEYwWCymes3XAMZW9d5gC8k3Rn++79hJjErvvcBB0P53/sBBAOa5knmdnWwlywlQZ7mHfQivOsd6yVDEkGIwxDVrfo2yY4nJ5tMTLe9rkYKSkUtcEqXk9/DKok9d5nLlfpzxyn0Tu7Gk7jLVNx8eQFw98oUi6Vz07NiZ3c/4y+bz+i1gHxliEhJnQFKn6MbVu01ISRaSX2b8vk/4q4D77GErCTGxM2EBW1P8pLr4YJkjiKORhZ91hR1qpsG9m89O9pASOXxMXF6wrCb0ACIidBJe8ZNdjHID24DsA/RhCImInAnztQqr897UeI1lDp3ToU8TO2jiat39q0cLD7GJlNBdERFhLd8dPjamtldx98K8dhNGD91cZ6zKPl6hyNJPP5rYIcsGFGprVva+Nl4GF455lVzI0UcvU0ySX7R5aKabHnrwMRSJlhiQr7fT1QCprYPnmKHgzjQtliwZNrIZHyHBkHHLSMG4KI+JK6Lna+9wFuETUzecLAUHN6QkBARofHwCFImr6Mbld+Lw0Upwhy/acKWUMswS07YI77tllHJTqsW4t4lLtcLKBwyl0JN05YQSiqS0knW+a7eGu4W3rrgmJMwRNpCkLvRsaBoqKAkzZGgi66S/HV+Sf4GQxvor4xPbYDkVIuLS2RZ6CV4wRMQkNNpXGb9go1V8BSElJXRrWIXCupM9We2hvMPPG1bbaqxf3sWhamTzhjVpHsCc/a9dQ3xo82uJL9jRNRLfTTnnBO+u/pTkLT5c8fPNd9nt5tLmRbsVynbsXR704Bbeq775v0uht3btfyZT7OA5knjdAAAAAElFTkSuQmCC\"\n};\n/** Overwrite to handle brickSize\n* @param {string} key\n* @param {any} val\n*/\nol.filter.Lego.prototype.set = function (key, val)\n{\tol.filter.Base.prototype.set.call(this, key, val);\n\tif (key==\"brickSize\" && this.pattern.canvas.width!=val)\n\t{\tthis.setBrick(val);\n\t}\n}\n/** Set the current brick\n*\t@param {number} width the pattern width, default 30\n*\t@param {'brick'|'ol3'|'lego'|undefined} img the pattern, default ol3\n*\t@param {string} crossOrigin\n*/\nol.filter.Lego.prototype.setBrick = function (width, img, crossOrigin)\n{\twidth = Number(width) || 30;\n\tif (typeof(img) === 'string')\n\t{\tvar i = new Image;\n\t\ti.src = this.img[img] || this.img.ol3;\n\t\ti.crossOrigin = crossOrigin || null;\n\t\timg = i;\n\t}\n\tif (img) this.pattern.img = img;\n\tif (!this.pattern.img.width)\n\t{\tvar self = this;\n\t\tthis.pattern.img.onload = function()\n\t\t{\tself.setBrick(width,img);\n\t\t}\n\t\treturn;\n\t}\n\tthis.pattern.canvas.width = this.pattern.canvas.height = width;\n\tthis.pattern.ctx = this.pattern.canvas.getContext(\"2d\");\n\tthis.pattern.ctx.fillStyle = this.pattern.ctx.createPattern (this.pattern.img, 'repeat');\n\tthis.set(\"brickSize\", width);\n\tthis.set(\"img\", img.src);\n};\n/** Get translated pattern\n*\t@param {number} offsetX x offset\n*\t@param {number} offsetY y offset\n*/\nol.filter.Lego.prototype.getPattern = function (offsetX, offsetY)\n{\t\n\tif (!this.pattern.ctx) return \"transparent\";\n\t//return this.pattern.ctx.fillStyle\n\tvar c = this.pattern.canvas;\n\tvar ctx = this.pattern.ctx;\n\tvar sc = c.width / this.pattern.img.width;\n\tctx.save();\n\t\tctx.clearRect(0,0,c.width,c.height);\n\t\tctx.scale(sc,sc);\n\t\toffsetX /= sc;\n\t\toffsetY /= sc;\n\t\tctx.translate(offsetX, offsetY);\n\t\tctx.beginPath();\n\t\tctx.clearRect(-2*c.width, -2*c.height, 4*c.width, 4*c.height);\n\t\tctx.rect(-offsetX, -offsetY, 2*c.width/sc, 2*c.height/sc);\n\t\tctx.fill(); \n\tctx.restore();\n\treturn ctx.createPattern(c, 'repeat');\n};\n/** Postcompose operation\n*/\nol.filter.Lego.prototype.postcompose = function(e)\n{\t// Set back color hue\n\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tvar ratio = e.frameState.pixelRatio;\n\tctx.save();\n\t\t// resize \n\t\tvar step = this.pattern.canvas.width*ratio;\n\t\tvar p = e.frameState.extent;\n\t\tvar res = e.frameState.viewState.resolution/ratio;\n\t\tvar offset = [ -Math.round((p[0]/res)%step), Math.round((p[1]/res)%step) ];\n\t\tvar ctx2 = this.internal_.getContext(\"2d\");\n\t\tvar w = this.internal_.width = canvas.width;\n\t\tvar h = this.internal_.height = canvas.height;\n\t\t// No smoothing please\n\t\tctx2.webkitImageSmoothingEnabled =\n\t\tctx2.mozImageSmoothingEnabled =\n\t\tctx2.msImageSmoothingEnabled =\n\t\tctx2.imageSmoothingEnabled = false;\n\t\tvar w2 = Math.floor((w-offset[0])/step);\n\t\tvar h2 = Math.floor((h-offset[1])/step);\n\t\tctx2.drawImage (canvas, offset[0], offset[1], w2*step, h2*step, 0, 0, w2, h2);\n\t\t//\n\t\tctx.webkitImageSmoothingEnabled =\n\t\tctx.mozImageSmoothingEnabled =\n\t\tctx.msImageSmoothingEnabled =\n\t\tctx.imageSmoothingEnabled = false;\n\t\tctx.clearRect (0, 0, w,h);\n\t\tctx.drawImage (this.internal_, 0,0, w2,h2, offset[0],offset[1], w2*step, h2*step);\n/*\n\t\tfor (var x=offset[0]; x<w; x+=step) for (var y=offset[1]; y<h; y+=step)\n\t\t{\tif (x>=0 && y<h) ctx2.drawImage (canvas, x, y, 1, 1, x, y, step, step);\n\t\t}\n\t\tctx.clearRect (0, 0, w,h);\n\t\tctx.drawImage (c, 0, 0);\n*/\n\t\t// Draw brick stud\n\t\tctx.scale(ratio,ratio);\n\t\tctx.fillStyle = this.getPattern (offset[0]/ratio, offset[1]/ratio);\n\t\tctx.rect(0,0, w, h);\n\t\tctx.fill(); \n\tctx.restore();\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** @typedef {Object} FilterTextureOptions\n *  @property {Image | undefined} img Image object for the texture\n *  @property {string} src Image source URI\n *  @property {number} scale scale to draw the image. Default 1.\n *  @property {number} [opacity]\n *  @property {boolean} rotate Whether to rotate the texture with the view (may cause animation lags on mobile or slow devices). Default is true.\n *  @property {null | string | undefined} crossOrigin The crossOrigin attribute for loaded images.\n */\n/** Add texture effects on maps or layers\n * @constructor\n * @requires ol.filter\n * @extends {ol.filter.Base}\n * @param {FilterTextureOptions} options\n */\nol.filter.Texture = function(options)\n{\tol.filter.Base.call(this, options);\n\tthis.setFilter(options);\n}\nol.inherits(ol.filter.Texture, ol.filter.Base);\n/** Set texture\n * @param {FilterTextureOptions} [options]\n */\nol.filter.Texture.prototype.setFilter = function(options)\n{\tvar img;\n\toptions = options || {};\n\tif (options.img) img = options.img;\n\telse \n\t{\timg = new Image();\n\t\tif (options.src) {\n\t\t\t// Look for a texture stored in ol.filter.Texture.Image\n\t\t\tif (ol.filter.Texture.Image && ol.filter.Texture.Image[options.src]) {\n\t\t\t\timg.src = ol.filter.Texture.Image[options.src];\n\t\t\t} \n\t\t\t// default source\n\t\t\telse {\n\t\t\t\tif (!img.src) img.src = options.src;\n\t\t\t}\n\t\t}\n\t\timg.crossOrigin = options.crossOrigin || null;\n\t}\n\tthis.set('rotateWithView', options.rotateWithView !== false);\n\tthis.set('opacity', typeof(options.opacity)=='number' ? options.opacity : 1);\n\tthis.set('ready', false);\n\tvar self = this;\n\tfunction setPattern(img)\n\t{\tself.pattern = {};\n\t\tself.pattern.scale = options.scale || 1;\n\t\tself.pattern.canvas = document.createElement('canvas');\n\t\tself.pattern.canvas.width = img.width * self.pattern.scale;\n\t\tself.pattern.canvas.height = img.height * self.pattern.scale;\n\t\tself.pattern.canvas.width = img.width;// * self.pattern.scale;\n\t\tself.pattern.canvas.height = img.height;// * self.pattern.scale;\n\t\tself.pattern.ctx = self.pattern.canvas.getContext(\"2d\");\n\t\tself.pattern.ctx.fillStyle = self.pattern.ctx.createPattern(img, 'repeat');\n\t\t// Force refresh\n\t\tself.set('ready', true);\n\t}\n\tif (img.width) \n\t{\tsetPattern(img);\n\t}\n\telse\n\t{\timg.onload = function()\n\t\t{\tsetPattern(img);\n\t\t}\n\t}\n}\n/** Get translated pattern\n *\t@param {number} offsetX x offset\n *\t@param {number} offsetY y offset\n */\nol.filter.Texture.prototype.getPattern = function (offsetX, offsetY)\n{\tvar c = this.pattern.canvas;\n\tvar ctx = this.pattern.ctx;\n\tctx.save();\n\t/*\n\t\toffsetX /= this.pattern.scale;\n\t\toffsetY /= this.pattern.scale;\n\t\tctx.scale(this.pattern.scale,this.pattern.scale);\n\t*/\n\t\tctx.translate(-offsetX, offsetY);\n\t\tctx.beginPath();\n\t\tctx.rect(offsetX, -offsetY, c.width, c.height);\n\t\tctx.fill();\n\tctx.restore();\n\treturn ctx.createPattern(c, 'repeat');\n}\n/** Draw pattern over the map on postcompose */\nol.filter.Texture.prototype.postcompose = function(e)\n{\t// not ready\n\tif (!this.pattern) return;\n\t// Set back color hue\n\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\tvar m = 1.5 * Math.max(canvas.width, canvas.height);\n\tvar mt = e.frameState.pixelToCoordinateTransform;\n\t// Old version (matrix)\n\tif (!mt)\n\t{\tmt = e.frameState.pixelToCoordinateMatrix,\n\t\tmt[2] = mt[4];\n\t\tmt[3] = mt[5];\n\t\tmt[4] = mt[12];\n\t\tmt[5] = mt[13];\n\t}\n\tvar ratio = e.frameState.pixelRatio;\n\tvar res = e.frameState.viewState.resolution;\n\tvar w = canvas.width/2, \n\t\th = canvas.height/2;\n\tctx.save();\n\t\tctx.globalCompositeOperation = \"multiply\";\n\t\t//ctx.globalCompositeOperation = \"overlay\";\n\t\t//ctx.globalCompositeOperation = \"color\";\n\t\tctx.globalAlpha = this.get('opacity');\n\t\tctx.scale(ratio*this.pattern.scale,ratio*this.pattern.scale);\n\t\tif (this.get('rotateWithView'))\n\t\t{\t// Translate pattern\n\t\t\tres *= this.pattern.scale\n\t\t\tctx.fillStyle = this.getPattern ((w*mt[0] + h*mt[1] + mt[4])/res, (w*mt[2] + h*mt[3] + mt[5])/res);\n\t\t\t// Rotate on canvas center and fill\n\t\t\tctx.translate(w/this.pattern.scale, h/this.pattern.scale);\n\t\t\tctx.rotate(e.frameState.viewState.rotation);\n\t\t\tctx.beginPath();\n\t\t\tctx.rect(-w-m, -h-m, 2*m, 2*m);\n\t\t\tctx.fill(); \n\t\t}\n\t\telse\n\t\t{\n\t\t\t/**/\n\t\t\t\tvar dx = -(w*mt[0] + h*mt[1] + mt[4])/res;\n\t\t\t\tvar dy = (w*mt[2] + h*mt[3] + mt[5])/res;\n\t\t\t\tvar cos = Math.cos(e.frameState.viewState.rotation);\n\t\t\t\tvar sin = Math.sin(e.frameState.viewState.rotation);\n\t\t\t\tvar offsetX = (dx*cos - dy*sin) / this.pattern.scale;\n\t\t\t\tvar offsetY = (dx*sin + dy*cos) / this.pattern.scale;\n\t\t\t\tctx.translate(offsetX, offsetY);\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.fillStyle = this.pattern.ctx.fillStyle;\n\t\t\t\tctx.rect(-offsetX -m , -offsetY -m, 2*m, 2*m);\n\t\t\t\tctx.fill(); \n\t\t\t/*\t//old version without centered rotation\n\t\t\t\tvar offsetX = -(e.frameState.extent[0]/res) % this.pattern.canvas.width;\n\t\t\t\tvar offsetY = (e.frameState.extent[1]/res) % this.pattern.canvas.height;\n\t\t\t\tctx.rotate(e.frameState.viewState.rotation);\n\t\t\t\tctx.translate(offsetX, offsetY);\n\t\t\t\tctx.beginPath();\n\t\t\t\tctx.fillStyle = this.pattern.ctx.fillStyle\n\t\t\t\tctx.rect(-offsetX -m , -offsetY -m, 2*m, 2*m);\n\t\t\t\tctx.fill(); \n\t\t\t*/\n\t\t}\n\tctx.restore();\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Handles coordinates on the center of the viewport.\n * It can be used as abstract base class used for creating subclasses. \n * The CenterTouch interaction modifies map browser event coordinate and pixel properties to force pointer on the viewport center to any interaction that them.\n * Only pointermove pointerup are concerned with it.\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @param {olx.interaction.InteractionOptions} options Options\n *  - targetStyle {ol.style.Style|Array<ol.style.Style>} a style to draw the target point, default cross style\n *  - composite {string} composite operation : difference|multiply|xor|screen|overlay|darken|lighter|lighten|...\n */\nol.interaction.CenterTouch = function(options)\n{\toptions = options || {};\n\t// LIst of listerner on the object\n\tthis._listener = {};\n\t// Filter event\n\tvar rex = /^pointermove$|^pointerup$/;\n\t// Default style = cross\n\tthis.targetStyle = options.targetStyle ||\n\t\t[\tnew ol.style.Style({ image: new ol.style.RegularShape ({ points: 4, radius: 11, radius1: 0, radius2: 0, snapToPixel:true, stroke: new ol.style.Stroke({ color: \"#fff\", width:3 }) }) }),\n\t\t\tnew ol.style.Style({ image: new ol.style.RegularShape ({ points: 4, radius: 11, radius1: 0, radius2: 0, snapToPixel:true, stroke: new ol.style.Stroke({ color: \"#000\", width:1 }) }) })\n\t\t];\n\tif (!(this.targetStyle instanceof Array)) this.targetStyle = [this.targetStyle];\n\tthis.composite = options.composite || '';\n\t// Interaction to defer center on top of the interaction \n\t// this is done to enable other coordinates manipulation inserted after the interaction (snapping)\n\tthis.ctouch = new ol.interaction.Interaction(\n\t\t{\thandleEvent: function(e) \n\t\t\t\t{\tif (rex.test(e.type) && this.getMap()) \n\t\t\t\t\t{\te.coordinate = this.getMap().getView().getCenter();\n\t\t\t\t\t\te.pixel = this.getMap().getSize();\n\t\t\t\t\t\te.pixel = [ e.pixel[0]/2, e.pixel[1]/2 ];\n\t\t\t\t\t}\n\t\t\t\t\treturn true; \n\t\t\t\t}\n\t\t});\n\tol.interaction.Interaction.call(this,\n\t\t{\thandleEvent: function(e) \n\t\t\t{\tif (rex.test(e.type)) this.pos_ = e.coordinate;\n\t\t\t\tif (options.handleEvent) return options.handleEvent.call (this,e);\n\t\t\t\treturn true; \n\t\t\t}\n\t\t});\n};\nol.inherits(ol.interaction.CenterTouch, ol.interaction.Interaction);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {_ol_Map_} map Map.\n * @api stable\n */\nol.interaction.CenterTouch.prototype.setMap = function(map)\n{\tif (this.getMap())\n\t{\tthis.getMap().removeInteraction(this.ctouch);\n\t}\n\tif (this._listener.drawtarget) ol.Observable.unByKey(this._listener.drawtarget);\n\tthis._listener.drawtarget = null;\n\tol.interaction.Interaction.prototype.setMap.call (this, map);\n\tif (this.getMap())\n\t{\tif (this.getActive()) this.getMap().addInteraction(this.ctouch);\n\t\tthis._listener.drawtarget = this.getMap().on('postcompose', this.drawTarget_.bind(this));\n\t}\n};\n/**\n * Activate or deactivate the interaction.\n * @param {boolean} active Active.\n * @observable\n * @api\n */\nol.interaction.CenterTouch.prototype.setActive = function(b)\n{\tol.interaction.Interaction.prototype.setActive.call (this, b);\n\tthis.pos_ = null;\n\tif (this.getMap())\n\t{\tif (this.getActive()) \n\t\t{\tthis.getMap().addInteraction(this.ctouch);\n\t\t}\n\t\telse this.getMap().removeInteraction(this.ctouch);\n\t}\n};\n/** Get the position of the target\n * @return {ol.coordinate}\n */\nol.interaction.CenterTouch.prototype.getPosition = function ()\n{\tif (!this.pos_) \n\t{\tvar px =this.getMap().getSize();\n\t\tpx = [ px[0]/2, px[1]/2 ];\n\t\tthis.pos_ = this.getMap().getCoordinateFromPixel(px);\n\t}\n\treturn this.pos_; \n};\n/** Draw the target\n* @private\n*/\nol.interaction.CenterTouch.prototype.drawTarget_ = function (e)\n{\tif (!this.getMap() || !this.getActive()) return;\n\tvar ctx = e.context;\n\tvar ratio = e.frameState.pixelRatio;\n\tctx.save();\n\t\tvar cx = ctx.canvas.width/(2*ratio);\n\t\tvar cy = ctx.canvas.height/(2*ratio);\n\t\tvar geom = new ol.geom.Point (this.getMap().getCoordinateFromPixel([cx,cy]));\n\t\tif (this.composite) ctx.globalCompositeOperation = this.composite;\n\t\tfor (var i=0; i<this.targetStyle.length; i++)\n\t\t{\tvar style = this.targetStyle[i];\n\t\t\tif (style instanceof ol.style.Style)\n\t\t\t{\tvar sc=0;\n\t\t\t\t// OL < v4.3 : setImageStyle doesn't check retina\n\t\t\t\tvar imgs = ol.Map.prototype.getFeaturesAtPixel ? false : style.getImage();\n\t\t\t\tif (imgs) \n\t\t\t\t{\tsc = imgs.getScale(); \n\t\t\t\t\timgs.setScale(ratio*sc);\n\t\t\t\t}\n\t\t\t\te.vectorContext.setStyle(style);\n\t\t\t\te.vectorContext.drawGeometry(geom);\n\t\t\t\tif (imgs) imgs.setScale(sc);\n\t\t\t}\n\t\t}\n\tctx.restore();\n};\n\n/** Clip interaction to clip layers in a circle\n * @constructor\n * @extends {ol.interaction.Pointer}\n *\t@param {ol.interaction.Clip.options} options flashlight  param\n *\t\t- radius {number} radius of the clip, default 100\n *\t\t- layers {ol.layer|Array<ol.layer>} layers to clip\n */\nol.interaction.Clip = function(options) {\n\tthis.layers_ = [];\n\tol.interaction.Pointer.call(this,\n\t{\thandleDownEvent: this.setPosition,\n\t\thandleMoveEvent: this.setPosition\n\t});\n\t// Default options\n\toptions = options || {};\n\tthis.pos = false;\n\tthis.radius = (options.radius||100);\n\tif (options.layers) this.addLayer(options.layers);\n};\nol.inherits(ol.interaction.Clip, ol.interaction.Pointer);\n/** Set the map > start postcompose\n*/\nol.interaction.Clip.prototype.setMap = function(map) {\n\tvar i;\n\tif (this.getMap()) {\n\t\tfor (i=0; i<this.layers_.length; i++) {\n\t\t\tif (this.layers_[i].precompose) ol.Observable.unByKey(this.layers_[i].precompose);\n\t\t\tif (this.layers_[i].postcompose) ol.Observable.unByKey(this.layers_[i].postcompose);\n\t\t\tthis.layers_[i].precompose = this.layers_[i].postcompose = null;\n\t\t}\n\t\tthis.getMap().renderSync();\n\t}\n\tol.interaction.Pointer.prototype.setMap.call(this, map);\n\tif (map) {\n\t\tfor (i=0; i<this.layers_.length; i++) {\n\t\t\tthis.layers_[i].precompose = this.layers_[i].layer.on('precompose', this.precompose_.bind(this));\n\t\t\tthis.layers_[i].postcompose = this.layers_[i].layer.on('postcompose', this.postcompose_.bind(this));\n\t\t}\n\t\tmap.renderSync();\n\t}\n}\n/** Set clip radius\n *\t@param {integer} radius\n */\nol.interaction.Clip.prototype.setRadius = function(radius)\n{\tthis.radius = radius;\n\tif (this.getMap()) this.getMap().renderSync();\n}\n/** Add a layer to clip\n *\t@param {ol.layer|Array<ol.layer>} layer to clip\n */\nol.interaction.Clip.prototype.addLayer = function(layers)\n{\tif (!(layers instanceof Array)) layers = [layers];\n\tfor (var i=0; i<layers.length; i++) {\n\t\tvar l = { layer: layers[i] }\n\t\tif (this.getMap()) {\n\t\t\tl.precompose = layers[i].on('precompose', this.precompose_.bind(this));\n\t\t\tl.postcompose = layers[i].on('postcompose', this.postcompose_.bind(this));\n\t\t\tthis.getMap().renderSync();\n\t\t}\n\t\tthis.layers_.push(l);\n\t}\n}\n/** Remove a layer to clip\n *\t@param {ol.layer|Array<ol.layer>} layer to clip\n */\nol.interaction.Clip.prototype.removeLayer = function(layers)\n{\tif (!(layers instanceof Array)) layers = [layers];\n\tfor (var i=0; i<layers.length; i++)\n\t{\tvar k;\n\t\tfor (k=0; k<this.layers_.length; k++)\n\t\t{\tif (this.layers_[k].layer===layers[i]) \n\t\t\t{\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (k!=this.layers_.length && this.getMap())\n\t\t{\tif (this.layers_[k].precompose) ol.Observable.unByKey(this.layers_[k].precompose);\n\t\t\tif (this.layers_[k].postcompose) ol.Observable.unByKey(this.layers_[k].postcompose);\n\t\t\tthis.layers_.splice(k,1);\n\t\t\tthis.getMap().renderSync();\n\t\t}\n\t}\n}\n/** Set position of the clip\n*\t@param {ol.Pixel|ol.MapBrowserEvent}\n*/\nol.interaction.Clip.prototype.setPosition = function(e)\n{\tif (e.pixel) this.pos = e.pixel;\n\telse \n\t{\tif (e && e instanceof Array) this.pos = e;\n\t\telse e = [-10000000,-10000000];\n\t}\n\tif (this.getMap()) this.getMap().renderSync();\n}\n/* @private\n*/\nol.interaction.Clip.prototype.precompose_ = function(e)\n{\tvar ctx = e.context;\n\tvar ratio = e.frameState.pixelRatio;\n\tctx.save();\n\tctx.beginPath();\n\tctx.arc (this.pos[0]*ratio, this.pos[1]*ratio, this.radius*ratio, 0, 2*Math.PI);\n\tctx.clip();\n}\n/* @private\n*/\nol.interaction.Clip.prototype.postcompose_ = function(e)\n{\te.context.restore();\n};\n/**\n * Activate or deactivate the interaction.\n * @param {boolean} active Active.\n * @observable\n * @api\n */\nol.interaction.Clip.prototype.setActive = function(b) {\n\tvar i;\n\tol.interaction.Pointer.prototype.setActive.call (this, b);\n\tif(b) {\n\t\tfor(i=0; i<this.layers_.length; i++) {\n\t\t\tthis.layers_[i].precompose = this.layers_[i].layer.on('precompose', this.precompose_.bind(this));\n\t\t\tthis.layers_[i].postcompose = this.layers_[i].layer.on('postcompose', this.postcompose_.bind(this));\n\t\t}\n\t} else {\n\t\tfor(i=0; i<this.layers_.length; i++) {\n\t\t\tif (this.layers_[i].precompose) ol.Observable.unByKey(this.layers_[i].precompose);\n\t\t\tif (this.layers_[i].postcompose) ol.Observable.unByKey(this.layers_[i].postcompose);\n\t\t\tthis.layers_[i].precompose = this.layers_[i].postcompose = null;\n\t\t}\n\t}\n\tif (this.getMap()) this.getMap().renderSync();\n}\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A Select interaction to delete features on click.\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires deletestart\n * @fires deleteend\n * @param {*} options ol.interaction.Select options\n */\nol.interaction.Delete = function(options) {\n  ol.interaction.Select.call(this, options);\n  this.on('select', function(e) {\n    this.getFeatures().clear();\n    this.delete(e.selected);\n  }.bind(this));\n};\nol.inherits(ol.interaction.Delete, ol.interaction.Select);\n/** Get vector source of the map\n * @return {Array<ol.source.Vector}\n */\nol.interaction.Delete.prototype._getSources = function(layers) {\n  if (!this.getMap()) return [];\n  if (!layers) layers = this.getMap().getLayers();\n  var sources = [];\n  layers.forEach(function (l) {\n    // LayerGroup\n    if (l.getLayers) {\n      sources = sources.concat(this._getSources(l.getLayers()));\n    } else {\n      if (l.getSource && l.getSource() instanceof ol.source.Vector) {\n        sources.push(l.getSource());\n      }\n    }\n  }.bind(this));\n  return sources;\n};\n/** Delete features: remove the features from the map (from all layers in the map)\n * @param {ol.Collection<ol.Feature>|Array<ol.Feature>} features The features to delete\n * @api\n */\nol.interaction.Delete.prototype.delete = function(features) {\n  if (features && (features.length || features.getLength())) {\n    this.dispatchEvent({ type: 'deletestart', features: features });\n    var delFeatures = [];\n    // Get the sources concerned\n    this._getSources().forEach(function (source) {\n      try {\n        // Try to delete features in the source\n        features.forEach(function(f) {\n          source.removeFeature(f);\n          delFeatures.push(f);\n        });\n      } catch(e) { /* ok */ }\n    })\n    this.dispatchEvent({ type: 'deleteend', features: delFeatures });\n  }\n};\n\n/** Drag an overlay on the map\n * @constructor\n * @extends {ol.interaction.Pointer}\n * @fires dragstart\n * @fires dragging\n * @fires dragend\n * @param {any} options\n *  @param {ol.Overlay|Array<ol.Overlay} options.overlays the overlays to drag\n */\nol.interaction.DragOverlay = function(options) {\n  if (!options) options = {};\n  // Extend pointer\n  ol.interaction.Pointer.call(this, {\n    // start draging on an overlay\n    handleDownEvent: function(evt) {\n      // Click on a button (closeBox) or on a link: don't drag!\n      if (/^(BUTTON|A)$/.test(evt.originalEvent.target.tagName)) {\n        this._dragging = false;\n        return true;\n      }\n      // Start dragging\n      if (this._dragging) {\n        this._dragging.setPosition(evt.coordinate);\n        this.dispatchEvent({ \n          type: 'dragstart',\n          overlay: this._dragging,\n          coordinate: evt.coordinate\n        });\n        return true;\n      }\n      return false;\n    },\n    // Drag\n    handleDragEvent: function(evt) {\n      if (this._dragging) {\n        this._dragging.setPosition(evt.coordinate);\n        this.dispatchEvent({ \n          type: 'dragging',\n          overlay: this._dragging,\n          coordinate: evt.coordinate\n        });\n      }\n    },\n    // Stop dragging\n    handleUpEvent: function(evt) {\n      if (this._dragging) {\n        this.dispatchEvent({ \n          type: 'dragend',\n          overlay: this._dragging,\n          coordinate: evt.coordinate\n        });\n      }\n      return (this._dragging = false);\n    }\n  });\n  // List of overlays / listeners\n  this._overlays = [];\n  if (!(options.overlays instanceof Array)) options.overlays = [options.overlays];\n  options.overlays.forEach(this.addOverlay.bind(this));\n};\nol.inherits(ol.interaction.DragOverlay, ol.interaction.Pointer);\n/** Add an overlay to the interacton\n * @param {ol.Overlay} ov\n */\nol.interaction.DragOverlay.prototype.addOverlay = function (ov) {\n  for (var i=0, o; o=this._overlays[i]; i++) {\n    if (o===ov) return;\n  }\n  // Stop event overlay\n  if (ov.element.parentElement && ov.element.parentElement.classList.contains('ol-overlaycontainer-stopevent')) {\n    console.warn('[DragOverlay.addOverlay] overlay must be created with stopEvent set to false!');\n    return;\n  }\n  // Add listener on overlay of the same map\n  var handler = function() {\n    if (this.getMap()===ov.getMap()) this._dragging = ov;\n  }.bind(this);\n  this._overlays.push({\n    overlay: ov,\n    listener: handler\n  });\n  ov.element.addEventListener('pointerdown', handler);\n};\n/** Remove an overlay from the interacton\n * @param {ol.Overlay} ov\n */\nol.interaction.DragOverlay.prototype.removeOverlay = function (ov) {\n  for (var i=0, o; o=this._overlays[i]; i++) {\n    if (o.overlay===ov) {\n      var l = this._overlays.splice(i,1)[0];\n      ov.element.removeEventListener('pointerdown', l.listener);\n      break;\n    }\n  }\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction to draw holes in a polygon.\n * It fires a drawstart, drawend event when drawing the hole\n * and a modifystart, modifyend event before and after inserting the hole in the feature geometry.\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires drawstart\n * @fires drawend\n * @fires modifystart\n * @fires modifyend\n * @param {olx.interaction.DrawHoleOptions} options extend olx.interaction.DrawOptions\n * \t@param {Array<ol.layer.Vector> | function | undefined} options.layers A list of layers from which polygons should be selected. Alternatively, a filter function can be provided. default: all visible layers\n * \t@param { ol.style.Style | Array<ol.style.Style> | StyleFunction | undefined }\tStyle for the selected features, default: default edit style\n */\nol.interaction.DrawHole = function(options)\n{\tif (!options) options = {};\n\tvar self = this;\n\t// Select interaction for the current feature\n\tthis._select = new ol.interaction.Select({ style: options.style });\n\tthis._select.setActive(false);\n\t// Geometry function that test points inside the current\n\tvar geometryFn, geomFn = options.geometryFunction;\n\tif (geomFn)\n\t{\tgeometryFn = function(c,g) \n\t\t{ \tg = self._geometryFn (c, g);\n\t\t\treturn geomFn (c,g);\n\t\t}\n\t}\n\telse\n\t{\tgeometryFn = function(c,g) { return self._geometryFn (c, g); }\n\t}\n\t// Create draw interaction\n\toptions.type = \"Polygon\";\n\toptions.geometryFunction = geometryFn;\n\tol.interaction.Draw.call(this, options);\n\t// Layer filter function\n\tif (options.layers) \n\t{\tif (typeof (options.layers) === 'function') this.layers_ = options.layers;\n\t\telse if (options.layers.indexOf) \n\t\t{\tthis.layers_ = function(l) \n\t\t\t{ return (options.layers.indexOf(l) >= 0); \n\t\t\t};\n\t\t}\n\t}\n\t// Start drawing if inside a feature\n\tthis.on('drawstart', this._startDrawing.bind(this));\n\t// End drawing add the hole to the current Polygon\n\tthis.on('drawend', this._finishDrawing.bind(this));\n};\nol.inherits(ol.interaction.DrawHole, ol.interaction.Draw);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.DrawHole.prototype.setMap = function(map)\n{\tif (this.getMap()) this.getMap().removeInteraction(this._select);\n\tif (map) map.addInteraction(this._select);\n\tol.interaction.Draw.prototype.setMap.call (this, map);\n};\n/**\n * Activate/deactivate the interaction\n * @param {boolean}\n * @api stable\n */\nol.interaction.DrawHole.prototype.setActive = function(b)\n{\tthis._select.getFeatures().clear();\n\tol.interaction.Draw.prototype.setActive.call (this, b);\n};\n/**\n * Remove last point of the feature currently being drawn \n * (test if points to remove before).\n */\nol.interaction.DrawHole.prototype.removeLastPoint = function()\n{\tif (this._feature && this._feature.getGeometry().getCoordinates()[0].length>2) \n\t{\tol.interaction.Draw.prototype.removeLastPoint.call(this);\n\t}\n};\n/** \n * Get the current polygon to hole\n * @return {ol.Feature}\n */\nol.interaction.DrawHole.prototype.getPolygon = function()\n{\treturn this._polygon;\n\t// return this._select.getFeatures().item(0).getGeometry();\n};\n/**\n * Get current feature to add a hole and start drawing\n * @param {ol.interaction.Draw.Event} e\n * @private\n */\nol.interaction.DrawHole.prototype._startDrawing = function(e)\n{\tvar map = this.getMap();\n\tvar layersFilter = this.layers_;\n\tthis._feature = e.feature;\n\tvar coord = e.feature.getGeometry().getCoordinates()[0][0];\n\t// Check object under the pointer\n\tvar features = map.getFeaturesAtPixel(\n\t\tmap.getPixelFromCoordinate(coord),\n\t\t{ \tlayerFilter: layersFilter\n\t\t}\n\t);\n\tthis._current = null;\n\tif (features) {\n\t\tfor (var k=0; k<features.length; k++) {\n\t\t\tvar poly = features[k].getGeometry();\n\t\t\tif (poly.getType() === \"Polygon\"\n\t\t\t\t&& poly.intersectsCoordinate(coord)) {\n\t\t\t\tthis._polygonIndex = false;\n\t\t\t\tthis._polygon = poly;\n\t\t\t\tthis._current = features[k];\n\t\t\t}\n\t\t\telse if (poly.getType() === \"MultiPolygon\"\n\t\t\t\t&& poly.intersectsCoordinate(coord)) {\n\t\t\t\tfor (var i=0, p; p=poly.getPolygon(i); i++) {\n\t\t\t\t\tif (p.intersectsCoordinate(coord)) {\n\t\t\t\t\t\tthis._polygonIndex = i;\n\t\t\t\t\t\tthis._polygon = p;\n\t\t\t\t\t\tthis._current = features[k];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this._current) break;\n\t\t}\n\t}\n\tthis._select.getFeatures().clear();\n\tif (!this._current)\n\t{\tthis.setActive(false);\n\t\tthis.setActive(true);\n\t}\n\telse\n\t{\tthis._select.getFeatures().push(this._current);\n\t}\n};\n/**\n * Stop drawing and add the sketch feature to the target feature. \n * @param {ol.interaction.Draw.Event} e\n * @private\n */\nol.interaction.DrawHole.prototype._finishDrawing = function(e)\n{\t// The feature is the hole\n\te.hole = e.feature;\n\t// Get the current feature\n\te.feature = this._select.getFeatures().item(0);\n\tthis.dispatchEvent({ type: 'modifystart', features: [ this._current ] });\n\t// Create the hole\n\tvar c = e.hole.getGeometry().getCoordinates()[0];\n\tif (c.length > 3) {\n\t\tif (this._polygonIndex!==false) {\n\t\t\tvar geom = e.feature.getGeometry();\n\t\t\tvar newGeom = new ol.geom.MultiPolygon([]);\n\t\t\tfor (var i=0, pi; pi=geom.getPolygon(i); i++) {\n\t\t\t\tif (i===this._polygonIndex) {\n\t\t\t\t\tpi.appendLinearRing(new ol.geom.LinearRing(c));\n\t\t\t\t\tnewGeom.appendPolygon(pi);\n\t\t\t\t}\n\t\t\t\telse newGeom.appendPolygon(pi);\n\t\t\t}\n\t\t\te.feature.setGeometry(newGeom);\n\t\t} else {\n\t\t\tthis.getPolygon().appendLinearRing(new ol.geom.LinearRing(c));\n\t\t}\n\t}\n\tthis.dispatchEvent({ type: 'modifyend', features: [ this._current ] });\n\t// reset\n\tthis._feature = null;\n\tthis._select.getFeatures().clear();\n};\n/**\n * Function that is called when a geometry's coordinates are updated.\n * @param {Array<ol.coordinate>} coordinates\n * @param {ol.geom.Polygon} geometry\n * @return {ol.geom.Polygon}\n * @private\n */\nol.interaction.DrawHole.prototype._geometryFn = function(coordinates, geometry)\n{\tvar coord = coordinates[0].pop();\n\tif (!this.getPolygon() || this.getPolygon().intersectsCoordinate(coord))\n\t{\tthis.lastOKCoord = [coord[0],coord[1]];\n\t}\n\tcoordinates[0].push([this.lastOKCoord[0],this.lastOKCoord[1]]);\n\tif (geometry) \n\t{\tgeometry.setCoordinates([coordinates[0].concat([coordinates[0][0]])]);\n\t} \n\telse \n\t{\tgeometry = new ol.geom.Polygon(coordinates);\n\t}\n\treturn geometry;\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction rotate\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires drawstart, drawing, drawend, drawcancel\n * @param {olx.interaction.TransformOptions} options\n *  @param {Array<ol.Layer>} source Destination source for the drawn features\n *  @param {ol.Collection<ol.Feature>} features Destination collection for the drawn features \n *  @param {ol.style.Style | Array.<ol.style.Style> | ol.style.StyleFunction | undefined} style style for the sketch\n *  @param {integer} sides number of sides, default 0 = circle\n *  @param { ol.events.ConditionType | undefined } squareCondition A function that takes an ol.MapBrowserEvent and returns a boolean to draw square features.\n *  @param { ol.events.ConditionType | undefined } centerCondition A function that takes an ol.MapBrowserEvent and returns a boolean to draw centered features.\n *  @param { bool } canRotate Allow rotation when centered + square, default: true\n *  @param { number } clickTolerance click tolerance on touch devices, default: 6\n *  @param { number } maxCircleCoordinates Maximum number of point on a circle, default: 100\n */\nol.interaction.DrawRegular = function(options) {\n  if (!options) options={};\n  this.squaredClickTolerance_ = options.clickTolerance ? options.clickTolerance * options.clickTolerance : 36;\n  this.maxCircleCoordinates_ = options.maxCircleCoordinates || 100;\n  // Collection of feature to transform \n  this.features_ = options.features;\n  // List of layers to transform \n  this.source_ = options.source;\n  // Square condition\n  this.squareFn_ = options.squareCondition;\n  // Centered condition\n  this.centeredFn_ = options.centerCondition;\n  // Allow rotation when centered + square\n  this.canRotate_ = (options.canRotate !== false);\n  // Specify custom geometry name\n  this.geometryName_ = options.geometryName\n  // Number of sides (default=0: circle)\n  this.setSides(options.sides);\n  // Style\n  var white = [255, 255, 255, 1];\n  var blue = [0, 153, 255, 1];\n  var width = 3;\n  var defaultStyle = [\n    new ol.style.Style({\n      stroke: new ol.style.Stroke({ color: white, width: width + 2 })\n    }),\n    new ol.style.Style({\n      image: new ol.style.Circle({\n        radius: width * 2,\n        fill: new ol.style.Fill({ color: blue }),\n        stroke: new ol.style.Stroke({ color: white, width: width / 2 })\n      }),\n      stroke: new ol.style.Stroke({ color: blue, width: width }),\n      fill: new ol.style.Fill({\n        color: [255, 255, 255, 0.5]\n      })\n    })\n  ];\n  // Create a new overlay layer for the sketch\n  this.sketch_ = new ol.Collection();\n  this.overlayLayer_ = new ol.layer.Vector({\n    source: new ol.source.Vector({\n      features: this.sketch_,\n      useSpatialIndex: false\n    }),\n    name:'DrawRegular overlay',\n    displayInLayerSwitcher: false,\n    style: options.style || defaultStyle\n  });\n  ol.interaction.Interaction.call(this, {\t\n      /*\n      handleDownEvent: this.handleDownEvent_,\n      handleMoveEvent: this.handleMoveEvent_,\n      handleUpEvent: this.handleUpEvent_,\n      */\n      handleEvent: this.handleEvent_\n    });\n};\nol.inherits(ol.interaction.DrawRegular, ol.interaction.Interaction);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.DrawRegular.prototype.setMap = function(map) {\n  if (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\n  ol.interaction.Interaction.prototype.setMap.call (this, map);\n  this.overlayLayer_.setMap(map);\n};\n/**\n * Activate/deactivate the interaction\n * @param {boolean}\n * @api stable\n */\nol.interaction.DrawRegular.prototype.setActive = function(b) {\n  this.reset();\n  ol.interaction.Interaction.prototype.setActive.call (this, b);\n}\n/**\n * Reset the interaction\n * @api stable\n */\nol.interaction.DrawRegular.prototype.reset = function() {\n  this.overlayLayer_.getSource().clear();\n  this.started_ = false;\n}\n/**\n * Set the number of sides.\n * @param {int} number of sides.\n * @api stable\n */\nol.interaction.DrawRegular.prototype.setSides = function (nb) {\n  nb = parseInt(nb);\n  this.sides_ = nb>2 ? nb : 0;\n}\n/**\n * Allow rotation when centered + square\n * @param {bool} \n * @api stable\n */\nol.interaction.DrawRegular.prototype.canRotate = function (b) {\n  if (b===true || b===false) this.canRotate_ = b;\n  return this.canRotate_;\n}\n/**\n * Get the number of sides.\n * @return {int} number of sides.\n * @api stable\n */\nol.interaction.DrawRegular.prototype.getSides = function () {\n  return this.sides_;\n}\n/** Default start angle array for each sides\n*/\nol.interaction.DrawRegular.prototype.startAngle = {\n  'default':Math.PI/2,\n  3: -Math.PI/2,\n  4: Math.PI/4\n};\n/** Get geom of the current drawing\n* @return {ol.geom.Polygon | ol.geom.Point}\n*/\nol.interaction.DrawRegular.prototype.getGeom_ = function () {\n  this.overlayLayer_.getSource().clear();\n  if (!this.center_) return false;\n  var g;\n  if (this.coord_) {\n    var center = this.center_;\n    var coord = this.coord_;\n    // Specific case: circle\n    var d, dmax, r, circle, centerPx;\n    if (!this.sides_ && this.square_ && !this.centered_) {\n      center = [(coord[0] + center[0])/2, (coord[1] + center[1])/2];\n      d = [coord[0] - center[0], coord[1] - center[1]];\n      r = Math.sqrt(d[0]*d[0]+d[1]*d[1]);\n      circle = new ol.geom.Circle(center, r, 'XY');\n      // Optimize points on the circle\n      centerPx = this.getMap().getPixelFromCoordinate(center);\n      dmax = Math.max (100, Math.abs(centerPx[0]-this.coordPx_[0]), Math.abs(centerPx[1]-this.coordPx_[1]));\n      dmax = Math.min ( this.maxCircleCoordinates_, Math.round(dmax / 3 ));\n      return ol.geom.Polygon.fromCircle (circle, dmax, 0);\n    } else {\n      var hasrotation = this.canRotate_ && this.centered_ && this.square_;\n      d = [coord[0] - center[0], coord[1] - center[1]];\n      if (this.square_ && !hasrotation) {\n        //var d = [coord[0] - center[0], coord[1] - center[1]];\n        var dm = Math.max (Math.abs(d[0]), Math.abs(d[1])); \n        coord = [ \n          center[0] + (d[0]>0 ? dm:-dm),\n          center[1] + (d[1]>0 ? dm:-dm)\n        ];\n      }\n      r = Math.sqrt(d[0]*d[0]+d[1]*d[1]);\n      if (r>0) {\n        circle = new ol.geom.Circle(center, r, 'XY');\n        var a;\n        if (hasrotation) a = Math.atan2(d[1], d[0]);\n        else a = this.startAngle[this.sides_] || this.startAngle['default'];\n        if (this.sides_) {\n          g = ol.geom.Polygon.fromCircle (circle, this.sides_, a);\n        } else {\n          // Optimize points on the circle\n          centerPx = this.getMap().getPixelFromCoordinate(this.center_);\n          dmax = Math.max (100, Math.abs(centerPx[0]-this.coordPx_[0]), Math.abs(centerPx[1]-this.coordPx_[1]));\n          dmax = Math.min ( this.maxCircleCoordinates_, Math.round(dmax / (this.centered_ ? 3:5) ));\n          g = ol.geom.Polygon.fromCircle (circle, dmax, 0);\n        }\n        if (hasrotation) return g;\n        // Scale polygon to fit extent\n        var ext = g.getExtent();\n        if (!this.centered_) center = this.center_;\n        else center = [ 2*this.center_[0]-this.coord_[0], 2*this.center_[1]-this.coord_[1] ];\n        var scx = (center[0] - coord[0]) / (ext[0] - ext[2]);\n        var scy = (center[1] - coord[1]) / (ext[1] - ext[3]);\n        if (this.square_) {\n          var sc = Math.min(Math.abs(scx),Math.abs(scy));\n          scx = Math.sign(scx)*sc;\n          scy = Math.sign(scy)*sc;\n        }\n        var t = [ center[0] - ext[0]*scx, center[1] - ext[1]*scy ];\n        g.applyTransform(function(g1, g2, dim) {\n          for (var i=0; i<g1.length; i+=dim) {\n            g2[i] = g1[i]*scx + t[0];\n            g2[i+1] = g1[i+1]*scy + t[1];\n          }\n          return g2;\n        });\n        return g;\n      }\n    }\n  }\n  // No geom => return a point\n  return new ol.geom.Point(this.center_);\n};\n/** Draw sketch\n* @return {ol.Feature} The feature being drawn.\n*/\nol.interaction.DrawRegular.prototype.drawSketch_ = function(evt) {\n  this.overlayLayer_.getSource().clear();\n  if (evt) {\n    this.square_ = this.squareFn_ ? this.squareFn_(evt) : evt.originalEvent.shiftKey;\n    this.centered_ = this.centeredFn_ ? this.centeredFn_(evt) : evt.originalEvent.metaKey || evt.originalEvent.ctrlKey;\n    var g = this.getGeom_();\n    if (g) {\n      var f = this.feature_;\n      if (this.geometryName_) f.setGeometryName(this.geometryName_)\n      //f.setGeometry (g);\n      if (g.getType()==='Polygon') f.getGeometry().setCoordinates(g.getCoordinates());\n      this.overlayLayer_.getSource().addFeature(f);\n      if (this.coord_ \n        && this.square_ \n        && ((this.canRotate_ && this.centered_ && this.coord_) || (!this.sides_ && !this.centered_))) {\n        this.overlayLayer_.getSource().addFeature(new ol.Feature(new ol.geom.LineString([this.center_,this.coord_])));\n      }\n      return f;\n    }\n  }\n};\n/** Draw sketch (Point)\n*/\nol.interaction.DrawRegular.prototype.drawPoint_ = function(pt, noclear) {\n  if (!noclear) this.overlayLayer_.getSource().clear();\n  this.overlayLayer_.getSource().addFeature(new ol.Feature(new ol.geom.Point(pt)));\n};\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n */\nol.interaction.DrawRegular.prototype.handleEvent_ = function(evt) {\n  var dx, dy;\n  // Event date time\n  this._eventTime = new Date();\n  switch (evt.type) {\n    case \"pointerdown\": {\n      this.downPx_ = evt.pixel;\n      this.start_(evt);\n      // Test long touch\n      var dt = 500;\n      this._longTouch = false;\n      setTimeout(function() {\n        this._longTouch = (new Date() - this._eventTime > .9*dt);\n        if (this._longTouch) this.handleMoveEvent_(evt);\n      }.bind(this), dt);\n      break;\n    }\n    case \"pointerup\": {\n      // Started and fisrt move\n      if (this.started_ && this.coord_) {\n        dx = this.downPx_[0] - evt.pixel[0];\n        dy = this.downPx_[1] - evt.pixel[1];\n        if (dx*dx + dy*dy <= this.squaredClickTolerance_) {\n          // The pointer has moved\n          if ( this.lastEvent == \"pointermove\" || this.lastEvent == \"keydown\" ) {\n            this.end_(evt);\n          }\n          // On touch device there is no move event : terminate = click on the same point\n          else {\n            dx = this.upPx_[0] - evt.pixel[0];\n            dy = this.upPx_[1] - evt.pixel[1];\n            if ( dx*dx + dy*dy <= this.squaredClickTolerance_) {\n              this.end_(evt);\n            } else  {\n              this.handleMoveEvent_(evt);\n              this.drawPoint_(evt.coordinate,true);\n            }\n          }\n        }\n      }\n      this.upPx_ = evt.pixel;\t\n      break;\n    }\n    case \"pointerdrag\": {\n      if (this.started_) {\n        var centerPx = this.getMap().getPixelFromCoordinate(this.center_);\n        dx = centerPx[0] - evt.pixel[0];\n        dy = centerPx[1] - evt.pixel[1];\n        if (dx*dx + dy*dy <= this.squaredClickTolerance_) {\n          this.reset();\n        }\n      }\n      return !this._longTouch;\n      // break;\n    }\n    case \"pointermove\": {\n      if (this.started_) {\n        dx = this.downPx_[0] - evt.pixel[0];\n        dy = this.downPx_[1] - evt.pixel[1];\n        if (dx*dx + dy*dy > this.squaredClickTolerance_) {\n          this.handleMoveEvent_(evt);\n          this.lastEvent = evt.type;\n        }\n      }\n      break;\n    }\n    default: {\n      this.lastEvent = evt.type;\n      // Prevent zoom in on dblclick\n      if (this.started_ && evt.type==='dblclick') {\n        //evt.stopPropagation();\n        return false;\n      }\n      break;\n    }\n  }\n  return true;\n}\n/** Stop drawing.\n */\nol.interaction.DrawRegular.prototype.finishDrawing = function() {\n  if (this.started_ && this.coord_) {\n    this.end_({ pixel: this.upPx_, coordinate: this.coord_});\n  }\n};\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n */\nol.interaction.DrawRegular.prototype.handleMoveEvent_ = function(evt) {\n  if (this.started_) {\n    this.coord_ = evt.coordinate;\n    this.coordPx_ = evt.pixel;\n    var f = this.drawSketch_(evt);\n    this.dispatchEvent({ \n      type:'drawing', \n      feature: f, \n      pixel: evt.pixel, \n      startCoordinate: this.center_,\n      coordinate: evt.coordinate, \n      square: this.square_, \n      centered: this.centered_ \n    });\n  } else  {\n    this.drawPoint_(evt.coordinate);\n  }\n};\n/** Start an new draw\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `false` to stop the drag sequence.\n */\nol.interaction.DrawRegular.prototype.start_ = function(evt) {\n  if (!this.started_) {\n    this.started_ = true;\n    this.center_ = evt.coordinate;\n    this.coord_ = null;\n    var geom = new ol.geom.Polygon([[evt.coordinate,evt.coordinate,evt.coordinate]]);\n    var f = this.feature_ = new ol.Feature(geom);\n    this.drawSketch_(evt);\n    this.dispatchEvent({ type:'drawstart', feature: f, pixel: evt.pixel, coordinate: evt.coordinate });\n  } else {\n    this.coord_ = evt.coordinate;\n  }\n};\n/** End drawing\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `false` to stop the drag sequence.\n */\nol.interaction.DrawRegular.prototype.end_ = function(evt) {\n  this.coord_ = evt.coordinate;\n  this.started_ = false;\n  // Add new feature\n  if (this.coord_ && this.center_[0]!=this.coord_[0] && this.center_[1]!=this.coord_[1]) {\n    var f = this.feature_;\n    if (this.geometryName_) f.setGeometryName(this.geometryName_)\n    f.setGeometry(this.getGeom_());\n    if (this.source_) this.source_.addFeature(f);\n    else if (this.features_) this.features_.push(f);\n    this.dispatchEvent({ type:'drawend', feature: f, pixel: evt.pixel, coordinate: evt.coordinate, square: this.square_, centered: this.centered_ });\n  } else {\n    this.dispatchEvent({ type:'drawcancel', feature: null, pixel: evt.pixel, coordinate: evt.coordinate, square: this.square_, centered: this.centered_ });\n  }\n  this.center_ = this.coord_ = null;\n  this.drawSketch_();\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction DrawTouch :\n * @constructor\n * @extends {ol.interaction.CenterTouch}\n * @param {olx.interaction.DrawOptions} options\n *\t- source {ol.source.Vector | undefined} Destination source for the drawn features.\n *\t- type {ol.geom.GeometryType} Drawing type ('Point', 'LineString', 'Polygon') not ('MultiPoint', 'MultiLineString', 'MultiPolygon' or 'Circle'). Required.\n *\t- tap {boolean} enable on tap, default true\n *\tInherited params\n *  - targetStyle {ol.style.Style|Array<ol.style.Style>} a style to draw the target point, default cross style\n *  - composite {string} composite operation : difference|multiply|xor|screen|overlay|darken|lighter|lighten|...\n */\nol.interaction.DrawTouch = function(options) {\n\toptions = options||{};\n\toptions.handleEvent = function(e) {\n\t\tif (this.get(\"tap\")) {\n\t\t\tswitch (e.type) {\n\t\t\t\tcase \"singleclick\": {\n\t\t\t\t\tthis.addPoint();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"dblclick\": {\n\t\t\t\t\tthis.addPoint();\n\t\t\t\t\tthis.finishDrawing();\n\t\t\t\t\treturn false;\n\t\t\t\t\t//break;\n\t\t\t\t}\n\t\t\t\tdefault: break;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\tol.interaction.CenterTouch.call(this, options);\n\tthis.typeGeom_ = options.type;\n\tthis.source_ = options.source;\n\tthis.set(\"tap\", (options.tap!==false));\n\t// Style\n\tvar white = [255, 255, 255, 1];\n\tvar blue = [0, 153, 255, 1];\n\tvar width = 3;\n\tvar defaultStyle = [\n\t\tnew ol.style.Style({\n\t\t\tstroke: new ol.style.Stroke({ color: white, width: width + 2 })\n\t\t}),\n\t\tnew ol.style.Style({\n\t\t\timage: new ol.style.Circle({\n\t\t\t\tradius: width * 2,\n\t\t\t\tfill: new ol.style.Fill({ color: blue }),\n\t\t\t\tstroke: new ol.style.Stroke({ color: white, width: width / 2 })\n\t\t\t}),\n\t\t\tstroke: new ol.style.Stroke({ color: blue, width: width }),\n\t\t\tfill: new ol.style.Fill({\n\t\t\t\tcolor: [255, 255, 255, 0.5]\n\t\t\t})\n\t\t})\n\t];\n\tthis.overlay_ = new ol.layer.Vector(\n\t\t{\tsource: new ol.source.Vector({useSpatialIndex: false }),\n\t\t\tstyle: defaultStyle\n\t\t});\n\tthis.geom_ = [];\n};\nol.inherits(ol.interaction.DrawTouch, ol.interaction.CenterTouch);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.DrawTouch.prototype.setMap = function(map) {\n\tif (this._listener.drawSketch) ol.Observable.unByKey(this._listener.drawSketch);\n\tthis._listener.drawSketch = null;\n\tol.interaction.CenterTouch.prototype.setMap.call (this, map);\n\tthis.overlay_.setMap(map);\n\tif (this.getMap())\n\t{\tthis._listener.drawSketch = this.getMap().on(\"postcompose\", this.drawSketchLink_.bind(this));\n\t}\n};\n/** Start drawing and add the sketch feature to the target layer. \n* The ol.interaction.Draw.EventType.DRAWSTART event is dispatched before inserting the feature.\n*/\nol.interaction.DrawTouch.prototype.startDrawing = function()\n{\tthis.geom_ = [];\n\tthis.addPoint();\n};\n/** Get geometry type\n* @return {ol.geom.GeometryType}\n*/\nol.interaction.DrawTouch.prototype.getGeometryType = function()\n{\treturn this.typeGeom_;\n};\n/** Start drawing and add the sketch feature to the target layer. \n* The ol.interaction.Draw.EventType.DRAWEND event is dispatched before inserting the feature.\n*/\nol.interaction.DrawTouch.prototype.finishDrawing = function()\n{\tif (!this.getMap()) return;\n\tvar f;\n\tswitch (this.typeGeom_)\n\t{\tcase \"LineString\":\n\t\t\tif (this.geom_.length > 1) f = new ol.Feature(new ol.geom.LineString(this.geom_));\n\t\t\tbreak;\n\t\tcase \"Polygon\":\n\t\t\t// Close polygon\n\t\t\tif (this.geom_[this.geom_.length-1] != this.geom_[0]) \n\t\t\t{\tthis.geom_.push(this.geom_[0]);\n\t\t\t}\n\t\t\t// Valid ?\n\t\t\tif (this.geom_.length > 3) \n\t\t\t{\tf = new ol.Feature(new ol.geom.Polygon([ this.geom_ ]));\n\t\t\t}\n\t\t\tbreak;\n\t\tdefault: break;\n\t}\n\tif (f) this.source_.addFeature (f);\n\t// reset\n\tthis.geom_ = [];\n\tthis.drawSketch_();\n}\n/** Add a new Point to the drawing\n*/\nol.interaction.DrawTouch.prototype.addPoint = function()\n{\tif (!this.getMap()) return;\n\tthis.geom_.push(this.getPosition());\n\tswitch (this.typeGeom_)\n\t{\tcase \"Point\": \n\t\t\tvar f = new ol.Feature( new ol.geom.Point (this.geom_.pop()));\n\t\t\tthis.source_.addFeature(f);\n\t\t\tbreak;\n\t\tcase \"LineString\":\n\t\tcase \"Polygon\":\n\t\t\tthis.drawSketch_();\n\t\t\tbreak;\n\t\tdefault: break;\n\t}\n}\n/** Remove last point of the feature currently being drawn.\n*/\nol.interaction.DrawTouch.prototype.removeLastPoint = function()\n{\tif (!this.getMap()) return;\n\tthis.geom_.pop();\n\tthis.drawSketch_();\n}\n/** Draw sketch\n* @private\n*/\nol.interaction.DrawTouch.prototype.drawSketch_ = function()\n{\tif (!this.overlay_) return;\n\tthis.overlay_.getSource().clear();\n\tif (this.geom_.length)\n\t{\tvar f;\n\t\tif (this.typeGeom_ == \"Polygon\") \n\t\t{\tf = new ol.Feature(new ol.geom.Polygon([this.geom_]));\n\t\t\tthis.overlay_.getSource().addFeature(f);\n\t\t}\n\t\tvar geom = new ol.geom.LineString(this.geom_);\n\t\tf = new ol.Feature(geom);\n\t\tthis.overlay_.getSource().addFeature(f);\n\t\tf = new ol.Feature( new ol.geom.Point (this.geom_.slice(-1).pop()) );\n\t\tthis.overlay_.getSource().addFeature(f);\n\t}\n}\n/** Draw contruction lines on postcompose\n* @private\n*/\nol.interaction.DrawTouch.prototype.drawSketchLink_ = function(e)\n{\tif (!this.getActive() || !this.getPosition()) return;\n\tvar ctx = e.context;\n\tctx.save();\n\t\tvar p, pt = this.getMap().getPixelFromCoordinate(this.getPosition());\n\t\tvar ratio = e.frameState.pixelRatio || 1;\n\t\tctx.scale(ratio,ratio);\n\t\tctx.strokeStyle = \"rgba(0, 153, 255, 1)\";\n\t\tctx.lineWidth = 1;\n\t\tctx.beginPath();\n\t\tctx.arc (pt[0],pt[1], 5, 0, 2*Math.PI);\n\t\tctx.stroke();\n\t\tif (this.geom_.length)\n\t\t{\tp = this.getMap().getPixelFromCoordinate(this.geom_[this.geom_.length-1]);\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(p[0],p[1]);\n\t\t\tctx.lineTo(pt[0],pt[1]);\n\t\t\tif (this.typeGeom_ == \"Polygon\")\n\t\t\t{\tp = this.getMap().getPixelFromCoordinate(this.geom_[0]);\n\t\t\t\tctx.lineTo(p[0],p[1]);\n\t\t\t}\n\t\t\tctx.stroke();\n\t\t}\n\tctx.restore();\n}\n/**\n * Activate or deactivate the interaction.\n * @param {boolean} active Active.\n * @observable\n * @api\n */\nol.interaction.DrawTouch.prototype.setActive = function(b)\n{\tol.interaction.CenterTouch.prototype.setActive.call (this, b);\n\tif (!b) this.geom_ = [];\n\tthis.drawSketch_();\n}\n\n/** Extend DragAndDrop choose drop zone + fires loadstart, loadend\n * @constructor\n * @extends {ol.interaction.DragAndDrop}\n *\t@fires loadstart, loadend, addfeatures\n *\t@param {ol.dropfile.options} flashlight options param\n *\t\t- zone {string} selector for the drop zone, default document\n *\t\t- projection {ol.projection} default projection of the map\n *\t\t- formatConstructors {Array<function(new:ol.format.Feature)>|undefined} Format constructors, default [ ol.format.GPX, ol.format.GeoJSON, ol.format.IGC, ol.format.KML, ol.format.TopoJSON ]\n *\t\t- accept {Array<string>|undefined} list of eccepted format, default [\"gpx\",\"json\",\"geojson\",\"igc\",\"kml\",\"topojson\"]\n */\nol.interaction.DropFile = function(options)\n{\toptions = options||{};\n\tol.interaction.DragAndDrop.call(this, {});\n\tvar zone = options.zone || document;\n\tzone.addEventListener('dragenter', this.onstop );\n\tzone.addEventListener('dragover', this.onstop );\n\tzone.addEventListener('dragleave', this.onstop );\n\t// Options\n\tthis.formatConstructors_ = options.formatConstructors || [ ol.format.GPX, ol.format.GeoJSON, ol.format.IGC, ol.format.KML, ol.format.TopoJSON ];\n\tthis.projection_ = options.projection;\n\tthis.accept_ = options.accept || [\"gpx\",\"json\",\"geojson\",\"igc\",\"kml\",\"topojson\"];\n\tvar self = this;\n\tzone.addEventListener('drop', function(e){ return self.ondrop(e);});\n};\nol.inherits(ol.interaction.DropFile, ol.interaction.DragAndDrop);\n/** Set the map\n*/\nol.interaction.DropFile.prototype.setMap = function(map)\n{\tol.interaction.Interaction.prototype.setMap.call(this, map);\n};\n/** Do somthing when over\n*/\nol.interaction.DropFile.prototype.onstop = function(e)\n{\te.preventDefault();\n\te.stopPropagation();\n\treturn false;\n}\n/** Do something when over\n*/\nol.interaction.DropFile.prototype.ondrop = function(e)\n{\te.preventDefault();\n\tif (e.dataTransfer && e.dataTransfer.files.length)\n\t{\tvar self = this;\n\t\t// fetch FileList object\n\t\tvar files = e.dataTransfer.files; // e.originalEvent.target.files ?\n\t\t// process all File objects\n\t\tvar file;\n\t\tvar pat = /\\.([0-9a-z]+)(?=[?#])|(\\.)(?:[\\w]+)$/;\n\t\tfor (var i=0; file=files[i]; i++)\n\t\t{\tvar ex = file.name.match(pat)[0];\n\t\t\tself.dispatchEvent({ type:'loadstart', file: file, filesize: file.size, filetype: file.type, fileextension: ex, projection: projection, target: self });\n\t\t\t// Load file\n\t\t\tvar reader = new FileReader();\n\t\t\tvar projection = this.projection_ || this.getMap().getView().getProjection();\n\t\t\tvar formatConstructors = this.formatConstructors_\n\t\t\tif (!projection) return;\n\t\t\tvar tryReadFeatures = function (format, result, options)\n\t\t\t{\ttry\n\t\t\t\t{\treturn format.readFeatures(result, options);\n\t\t\t\t} catch (e) { /* ok */ }\n\t\t\t}\n\t\t\tvar theFile = file;\n\t\t\treader.onload = function(e)\n\t\t\t{\tvar result = e.target.result;\n\t\t\t\tvar features = [];\n\t\t\t\tvar i, ii;\n\t\t\t\tfor (i = 0, ii = formatConstructors.length; i < ii; ++i)\n\t\t\t\t{\tvar formatConstructor = formatConstructors[i];\n\t\t\t\t\tvar format = new formatConstructor();\n\t\t\t\t\tfeatures = tryReadFeatures(format, result, { featureProjection: projection });\n\t\t\t\t\tif (features && features.length > 0)\n\t\t\t\t\t{\tself.dispatchEvent({ type:'addfeatures', features: features, file: theFile, projection: projection, target: self });\n\t\t\t\t\t\tself.dispatchEvent({ type:'loadend', features: features, file: theFile, projection: projection, target: self });\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tself.dispatchEvent({ type:'loadend', file: theFile, target: self });\n\t\t\t};\n\t\t\treader.readAsText(file);\n\t\t}\n\t}\n    return false;\n};\n\n/** A Select interaction to fill feature's properties on click.\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires setattributestart\n * @fires setattributeend\n * @param {*} options extentol.interaction.Select options\n *  @param {boolean} options.active activate the interaction on start, default true\n *  @param {boolean} options.cursor use a paint bucket cursor, default true\n * @param {*} properties The properties as key/value\n */\nol.interaction.FillAttribute = function(options, properties) {\n  options = options || {};\n  if (!options.condition) options.condition = ol.events.condition.click;\n  ol.interaction.Select.call(this, options);\n  this.setActive(options.active!==false)\n  this._attributes = properties;\n  this.on('select', function(e) {\n    this.getFeatures().clear();\n    this.fill(e.selected, this._attributes);\n  }.bind(this));\n  if (options.cursor!==false) {\n    var canvas = document.createElement('CANVAS');\n    canvas.width = canvas.height = 32;\n    var ctx = canvas.getContext(\"2d\");\n    ctx.beginPath();\n      ctx.moveTo(9,3);\n      ctx.lineTo(2,9);\n      ctx.lineTo(10,17);\n      ctx.lineTo(17,11);\n    ctx.closePath();\n    ctx.fillStyle = \"#fff\";\n    ctx.fill();\n    ctx.stroke();\n    ctx.beginPath();\n      ctx.moveTo(6,4);\n      ctx.lineTo(0,8);\n      ctx.lineTo(0,13);\n      ctx.lineTo(3,17);\n      ctx.lineTo(3,8);\n    ctx.closePath();\n    ctx.fillStyle = \"#000\";\n    ctx.fill();\n    ctx.stroke();\n    ctx.moveTo(8,8);\n    ctx.lineTo(10,0);\n    ctx.lineTo(11,0);\n    ctx.lineTo(13,3);\n    ctx.lineTo(13,7);\n    ctx.stroke();\n    this._cursor = 'url('+canvas.toDataURL()+') 0 13, auto';\n  }\n};\nol.inherits(ol.interaction.FillAttribute, ol.interaction.Select);\n/** Activate the interaction\n * @param {boolean} active\n */\nol.interaction.FillAttribute.prototype.setActive = function(active) {\n  ol.interaction.Select.prototype.setActive.call(this, active);\n  if (this.getMap() && this._cursor) {\n    if (active) {\n      this._previousCursor = this.getMap().getTargetElement().style.cursor;\n      this.getMap().getTargetElement().style.cursor = this._cursor;\n      console.log('setCursor',this._cursor)\n    } else {\n      this.getMap().getTargetElement().style.cursor = this._previousCursor;\n      this._previousCursor = undefined;\n    }\n  }\n};\n/** Set attributes\n * @param {*} properties The properties as key/value\n */\nol.interaction.FillAttribute.prototype.setAttributes = function(properties) {\n  this._attributes = properties;\n};\n/** Set an attribute\n * @param {string} key \n * @param {*} val \n */\nol.interaction.FillAttribute.prototype.setAttribute = function(key, val) {\n  this._attributes[key] = val;\n};\n/** get attributes\n * @return {*} The properties as key/value\n */\nol.interaction.FillAttribute.prototype.getAttributes = function() {\n  return this._attributes;\n};\n/** Get an attribute\n * @param {string} key \n * @return {*} val \n */\nol.interaction.FillAttribute.prototype.getAttribute = function(key) {\n  return this._attributes[key];\n};\n/** Fill feature attributes\n * @param {Array<ol.Feature>} features The features to modify\n * @param {*} properties The properties as key/value\n */\nol.interaction.FillAttribute.prototype.fill = function(features, properties) {\n  if (features.length && properties) {\n    this.dispatchEvent({ type: 'setattributestart', features: features, properties: properties });\n    features.forEach(function(f) {\n      for (var p in properties) {\n        f.set(p, properties[p]);\n      }\n    });\n    this.dispatchEvent({ type: 'setattributeend', features: features, properties: properties });\n  }\n};\n\n/**\n * @constructor\n * @extends {ol.interaction.Pointer}\n *\t@param {ol.flashlight.options} flashlight options param\n *\t\t- color {ol.Color} light color, default transparent\n *\t\t- fill {ol.Color} fill color, default rgba(0,0,0,0.8)\n *\t\t- radius {number} radius of the flash\n */\nol.interaction.Flashlight = function(options) {\n\tol.interaction.Pointer.call(this,\n\t{\thandleDownEvent: this.setPosition,\n\t\thandleMoveEvent: this.setPosition\n\t});\n\t// Default options\n\toptions = options||{};\n\tthis.pos = false;\n\tthis.radius = (options.radius||100);\n\tthis.setColor(options);\n};\nol.inherits(ol.interaction.Flashlight, ol.interaction.Pointer);\n/** Set the map > start postcompose\n*/\nol.interaction.Flashlight.prototype.setMap = function(map) {\n\tif (this.getMap()) {\n\t\tthis.getMap().render();\n\t}\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.interaction.Pointer.prototype.setMap.call(this, map);\n\tif (map) {\n\t\tthis._listener = map.on('postcompose', this.postcompose_.bind(this));\n\t}\n}\n/** Set flashlight radius\n *\t@param {integer} radius\n */\nol.interaction.Flashlight.prototype.setRadius = function(radius)\n{\tthis.radius = radius\n\tif (this.getMap()) this.getMap().renderSync();\n}\n/** Set flashlight color\n *\t@param {ol.flashlight.options} flashlight options param\n *\t\t- color {ol.Color} light color, default transparent\n *\t\t- fill {ol.Color} fill color, default rgba(0,0,0,0.8)\n */\nol.interaction.Flashlight.prototype.setColor = function(options)\n{\t// Backcolor\n\tvar color = (options.fill ? options.fill : [0,0,0,0.8]);\n\tvar c = ol.color.asArray(color);\n\tthis.startColor = ol.color.asString(c);\n\t// Halo color\n\tif (options.color) {\n\t\tc = this.endColor = ol.color.asString(ol.color.asArray(options.color)||options.color);\n\t}\n\telse \n\t{\tc[3] = 0\n\t\tthis.endColor = ol.color.asString(c);\n\t}\n\tc[3] = 0.1;\n\tthis.midColor = ol.color.asString(c);\n\tif (this.getMap()) this.getMap().renderSync();\n}\n/** Set position of the flashlight\n*\t@param {ol.Pixel|ol.MapBrowserEvent}\n*/\nol.interaction.Flashlight.prototype.setPosition = function(e)\n{\tif (e.pixel) this.pos = e.pixel;\n\telse this.pos = e;\n\tif (this.getMap()) \n\t{\tthis.getMap().renderSync();\n\t}\n}\n/** Postcompose function\n*/\nol.interaction.Flashlight.prototype.postcompose_ = function(e)\n{\tvar ctx = e.context;\n\tvar ratio = e.frameState.pixelRatio;\n\tvar w = ctx.canvas.width;\n\tvar h = ctx.canvas.height;\n\tctx.save();\n\tctx.scale(ratio,ratio);\n\tif (!this.pos) \n\t{\tctx.fillStyle = this.startColor;\n\t\tctx.fillRect( 0,0,w,h );\n\t}\n\telse\n\t{\tvar d = Math.max(w, h);\n\t\t// reveal wherever we drag\n\t\tvar radGrd = ctx.createRadialGradient( this.pos[0], this.pos[1], w*this.radius/d, this.pos[0], this.pos[1], h*this.radius/d );\n\t\tradGrd.addColorStop(   0, this.startColor );\n\t\tradGrd.addColorStop( 0.8, this.midColor );\n\t\tradGrd.addColorStop(   1, this.endColor );\n\t\tctx.fillStyle = radGrd;\n\t\tctx.fillRect( this.pos[0] - d, this.pos[1] - d, 2*d, 2*d );\n\t}\n\tctx.restore();\n};\n\n/** Interaction to draw on the current geolocation\n *\tIt combines a draw with a ol.Geolocation\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires drawstart, drawend, drawing, tracking, follow\n * @param {any} options\n *\t@param { ol.Collection.<ol.Feature> | undefined } option.features Destination collection for the drawn features.\n *\t@param { ol.source.Vector | undefined } options.source Destination source for the drawn features.\n *\t@param {ol.geom.GeometryType} options.type Drawing type ('Point', 'LineString', 'Polygon'), default LineString.\n *\t@param {Number | undefined} options.minAccuracy minimum accuracy underneath a new point will be register (if no condition), default 20\n *\t@param {function | undefined} options.condition a function that take a ol.Geolocation object and return a boolean to indicate whether location should be handled or not, default return true if accuraty < minAccuraty\n *\t@param {Object} options.attributes a list of attributes to register as Point properties: {accuracy:true,accuracyGeometry:true,heading:true,speed:true}, default none.\n *\t@param {Number} options.tolerance tolerance to add a new point (in projection unit), use ol.geom.LineString.simplify() method, default 5\n *\t@param {Number} options.zoom zoom for tracking, default 16\n *\t@param {boolean|auto|position|visible} options.followTrack true if you want the interaction to follow the track on the map, default true\n *\t@param { ol.style.Style | Array.<ol.style.Style> | ol.StyleFunction | undefined } options.style Style for sketch features.\n */\nol.interaction.GeolocationDraw = function(options) {\n\tif (!options) options={};\n\t// Geolocation\n\tthis.geolocation = new ol.Geolocation(\n\t({\tprojection: \"EPSG:4326\",\n\t\ttrackingOptions: \n\t\t{\tmaximumAge: 10000,\n\t\t\tenableHighAccuracy: true,\n\t\t\ttimeout: 600000\n\t\t}\n\t}));\n\tthis.geolocation.on('change', this.draw_.bind(this));\n\t// Current path\n\tthis.path_ = [];\n\tthis.lastPosition_ = false;\n\t// Default style\n\tvar white = [255, 255, 255, 1];\n\tvar blue = [0, 153, 255, 1];\n\tvar width = 3;\n\tvar circle = new ol.style.Circle(\n\t\t{\tradius: width * 2,\n\t\t\tfill: new ol.style.Fill({ color: blue }),\n\t\t\tstroke: new ol.style.Stroke({ color: white, width: width / 2 })\n\t\t});\n\tvar style = \n\t[\tnew ol.style.Style(\n\t\t{\tstroke: new ol.style.Stroke({ color: white, width: width + 2 })\n\t\t}),\n\t\tnew ol.style.Style(\n\t\t{\tstroke: new ol.style.Stroke({ color: blue, width: width }),\n\t\t\tfill: new ol.style.Fill({\n\t\t\t\tcolor: [255, 255, 255, 0.5]\n\t\t\t})\n\t\t})\n\t];\n\tvar triangle = new ol.style.RegularShape(\n\t\t{\tradius: width * 3.5,\n\t\t\tpoints: 3,\n\t\t\trotation: 0,\n\t\t\tfill: new ol.style.Fill({ color: blue }),\n\t\t\tstroke: new ol.style.Stroke({ color: white, width: width / 2 })\n\t\t});\n\t// stretch the symbol\n\tvar c = triangle.getImage();\n\tvar ctx = c.getContext(\"2d\");\n\t\tvar c2 = document.createElement('canvas');\n\t\tc2.width = c2.height = c.width;\n\t\tc2.getContext(\"2d\").drawImage(c, 0,0);\n\tctx.clearRect(0,0,c.width,c.height);\n\tctx.drawImage(c2, 0,0, c.width, c.height, width, 0, c.width-2*width, c.height);\n\tvar defaultStyle = function(f)\n\t{\tif (f.get('heading')===undefined)\n\t\t{\tstyle[1].setImage(circle);\n\t\t}\n\t\telse \n\t\t{\tstyle[1].setImage(triangle);\n\t\t\ttriangle.setRotation( f.get('heading') || 0);\n\t\t}\n\t\treturn style;\n\t}\n\t// Style for the accuracy geometry\n\tthis.locStyle = \n\t\t{\terror: new ol.style.Style({ fill: new ol.style.Fill({ color: [255, 0, 0, 0.2] }) }),\n\t\t\twarn: new ol.style.Style({ fill: new ol.style.Fill({ color: [255, 192, 0, 0.2] }) }),\n\t\t\tok: new ol.style.Style({ fill: new ol.style.Fill({ color: [0, 255, 0, 0.2] }) }),\n\t\t};\n\t// Create a new overlay layer for the sketch\n\tthis.overlayLayer_ = new ol.layer.Vector(\n\t{\tsource: new ol.source.Vector(),\n\t\tname:'GeolocationDraw overlay',\n\t\tstyle: options.style || defaultStyle\n\t});\n\tthis.sketch_ = [new ol.Feature(), new ol.Feature(), new ol.Feature()];\n\tthis.overlayLayer_.getSource().addFeatures(this.sketch_);\n\tthis.features_ = options.features;\n\tthis.source_ = options.source;\n\tthis.condition_ = options.condition || function(loc) { return loc.getAccuracy() < this.get(\"minAccuracy\") };\n\t// Prevent interaction when tracking\n\tol.interaction.Interaction.call(this,\n\t{\thandleEvent: function()\n\t\t{\treturn (!this.get('followTrack') || this.get('followTrack')=='auto');//  || !geoloc.getTracking());\n\t\t}\n\t});\n\tthis.set(\"type\", options.type||\"LineString\");\n\tthis.set(\"attributes\", options.attributes||{});\n\tthis.set(\"minAccuracy\", options.minAccuracy||20);\n\tthis.set(\"tolerance\", options.tolerance||5);\n\tthis.set(\"zoom\", options.zoom);\n\tthis.setFollowTrack (options.followTrack===undefined ? true : options.followTrack);\n\tthis.setActive(false);\n};\nol.inherits(ol.interaction.GeolocationDraw, ol.interaction.Interaction);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.GeolocationDraw.prototype.setMap = function(map)\n{\tif (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\n\tol.interaction.Pointer.prototype.setMap.call (this, map);\n\tthis.overlayLayer_.setMap(map);\n\tif (map) this.geolocation.setProjection(map.getView().getProjection());\n};\n/** Activate or deactivate the interaction.\n* @param {boolean} active\n*/\nol.interaction.GeolocationDraw.prototype.setActive = function(active)\n{\tol.interaction.Interaction.prototype.setActive.call(this, active);\n\tthis.overlayLayer_.setVisible(active);\n\tif (this.getMap())\n\t{\tthis.geolocation.setTracking(active);\n\t\tthis.getMap().renderSync();\n\t}\n\tthis.pause(!active);\n\tif (active)\n\t{\t// Start drawing\n\t\tthis.reset();\n\t\tthis.dispatchEvent({ type:'drawstart', feature: this.sketch_[1]});\n\t}\n\telse\n\t{\tvar f = this.sketch_[1].clone();\n\t\tif (f.getGeometry())\n\t\t{\tif (this.features_) this.features_.push(f);\n\t\t\tif (this.source_) this.source_.addFeature(f);\n\t\t\tthis.dispatchEvent({ type:'drawend', feature: f});\n\t\t}\n\t}\n};\n/** Reset drawing\n*/\nol.interaction.GeolocationDraw.prototype.reset = function()\n{\tthis.sketch_[1].setGeometry();\n\tthis.path_ = [];\n\tthis.lastPosition_ = false;\n};\n/** Start tracking = setActive(true)\n*/\nol.interaction.GeolocationDraw.prototype.start = function()\n{\tthis.setActive(true);\n};\n/** Stop tracking = setActive(false)\n*/\nol.interaction.GeolocationDraw.prototype.stop = function()\n{\tthis.setActive(false);\n};\n/** Pause drawing\n* @param {boolean} b \n*/\nol.interaction.GeolocationDraw.prototype.pause = function(b)\n{\tthis.pause_ = b!==false;\n};\n/** Is paused\n* @return {boolean} b \n*/\nol.interaction.GeolocationDraw.prototype.isPaused = function()\n{\treturn this.pause_;\n};\n/** Enable following the track on the map\n* @param {boolean|auto|position|visible} follow, \n*\tfalse: don't follow, \n*\ttrue: follow (position+zoom), \n*\t'position': follow only position,\n*\t'auto': start following until user move the map,\n*\t'visible': center when position gets out of the visible extent\n*/\nol.interaction.GeolocationDraw.prototype.setFollowTrack = function(follow)\n{\tthis.set('followTrack', follow);\n\tvar map = this.getMap();\n\t// Center if wanted\n\tif (follow !== false && !this.lastPosition_ && map) \n\t{\tvar pos = this.path_[this.path_.length-1];\n\t\tif (pos)\n\t\t{\tmap.getView().animate({\n\t\t\t\tcenter: pos,\n\t\t\t\tzoom: (follow!=\"position\" ? this.get(\"zoom\") : undefined)\n\t\t\t})\n\t\t}\n\t}\n\tthis.lastPosition_ = false;\t\t\t\t\n\tthis.dispatchEvent({ type:'follow', following: follow!==false });\n};\n/** Add a new point to the current path\n* @private\n*/\nol.interaction.GeolocationDraw.prototype.draw_ = function() {\n\tvar map = this.getMap();\n\tif (!map) return;\n\t// Current location\n\tvar loc = this.geolocation;\n\tvar accu = loc.getAccuracy();\n\tvar pos = loc.getPosition();\n\tpos.push (Math.round((loc.getAltitude()||0)*100)/100);\n\tpos.push (Math.round((new Date()).getTime()/1000));\n\tvar p = loc.getAccuracyGeometry();\n\t// Center on point\n\t// console.log(this.get('followTrack'))\n\tswitch (this.get('followTrack'))\n\t{\t// Follow center + zoom\n\t\tcase true: {\n\t\t\t// modify zoom\n\t\t\tif (this.get('followTrack') == true) \n\t\t\t{\tmap.getView().setZoom( this.get(\"zoom\") || 16 );\n\t\t\t\tif (!ol.extent.containsExtent(map.getView().calculateExtent(map.getSize()), p.getExtent()))\n\t\t\t\t{\tmap.getView().fit(p.getExtent());\n\t\t\t\t}\n\t\t\t}\n\t\t\tmap.getView().setCenter( pos );\n\t\t\tbreak;\n\t\t}\n\t\t// Follow  position \n\t\tcase 'position': {\n\t\t\t// modify center\n\t\t\tmap.getView().setCenter( pos );\n\t\t\tbreak;\n\t\t}\n\t\t// Keep on following \n\t\tcase 'auto': {\n\t\t\tif (this.lastPosition_)\n\t\t\t{\tvar center = map.getView().getCenter();\n\t\t\t\t// console.log(center,this.lastPosition_)\n\t\t\t\tif (center[0]!=this.lastPosition_[0] || center[1]!=this.lastPosition_[1])\n\t\t\t\t{\t//this.dispatchEvent({ type:'follow', following: false });\n\t\t\t\t\tthis.setFollowTrack (false);\n\t\t\t\t}\n\t\t\t\telse \n\t\t\t\t{\tmap.getView().setCenter( pos );\t\n\t\t\t\t\tthis.lastPosition_ = pos;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse \n\t\t\t{\tmap.getView().setCenter( pos );\t\n\t\t\t\tif (this.get(\"zoom\")) map.getView().setZoom( this.get(\"zoom\") );\n\t\t\t\tthis.lastPosition_ = pos;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\t// Force to stay on the map\n\t\tcase 'visible': {\n\t\t\tif (!ol.extent.containsCoordinate(map.getView().calculateExtent(map.getSize()), pos))\n\t\t\t{\tmap.getView().setCenter (pos);\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\t// Don't follow\n\t\tdefault: break;\n\t}\n\t// Draw occuracy\n\tvar f = this.sketch_[0];\n\tf.setGeometry(p);\n\tif (accu < this.get(\"minAccuracy\")/2) f.setStyle(this.locStyle.ok);\n\telse if (accu < this.get(\"minAccuracy\")) f.setStyle(this.locStyle.warn);\n\telse f.setStyle(this.locStyle.error);\n\tvar geo;\n\tif (!this.pause_ && this.condition_.call(this, loc))\n\t{\tf = this.sketch_[1];\n\t\tthis.path_.push(pos);\n\t\tswitch (this.get(\"type\"))\n\t\t{\tcase \"Point\":\n\t\t\t\tthis.path_ = [pos];\n\t\t\t\tf.setGeometry(new ol.geom.Point(pos, 'XYZM'));\n\t\t\t\tvar attr = this.get('attributes');\n\t\t\t\tif (attr.heading) f.set(\"heading\",loc.getHeading());\n\t\t\t\tif (attr.accuracy) f.set(\"accuracy\",loc.getAccuracy());\n\t\t\t\tif (attr.altitudeAccuracy) f.set(\"altitudeAccuracy\",loc.getAltitudeAccuracy());\n\t\t\t\tif (attr.speed) f.set(\"speed\",loc.getSpeed());\n\t\t\t\tbreak;\n\t\t\tcase \"LineString\":\n\t\t\t\tif (this.path_.length>1)\n\t\t\t\t{\tgeo = new ol.geom.LineString(this.path_, 'XYZM');\n\t\t\t\t\tgeo.simplify (this.get(\"tolerance\"));\n\t\t\t\t\tf.setGeometry(geo);\n\t\t\t\t}\n\t\t\t\telse f.setGeometry();\n\t\t\t\tbreak;\n\t\t\tcase \"Polygon\":\n\t\t\t\tif (this.path_.length>2)\n\t\t\t\t{\tgeo = new ol.geom.Polygon([this.path_], 'XYZM');\n\t\t\t\t\tgeo.simplify (this.get(\"tolerance\"));\n\t\t\t\t\tf.setGeometry(geo);\n\t\t\t\t}\n\t\t\t\telse f.setGeometry();\n\t\t\t\tbreak;\n\t\t}\n\t\tthis.dispatchEvent({ type:'drawing', feature: this.sketch_[1], geolocation: loc });\n\t}\n\tthis.sketch_[2].setGeometry(new ol.geom.Point(pos));\n\tthis.sketch_[2].set(\"heading\",loc.getHeading());\n\t// Drawing\n\tthis.dispatchEvent({ type:'tracking', feature: this.sketch_[1], geolocation: loc });\n};\n\n/** Interaction hover do to something when hovering a feature\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires hover, enter, leave\n * @param {olx.interaction.HoverOptions} \n *\t@param { string | undefined } options.cursor css cursor propertie or a function that gets a feature, default: none\n *\t@param {function | undefined} optionsfeatureFilter filter a function with two arguments, the feature and the layer of the feature. Return true to select the feature \n *\t@param {function | undefined} options.layerFilter filter a function with one argument, the layer to test. Return true to test the layer\n *\t@param {number | undefined} options.hitTolerance Hit-detection tolerance in pixels.\n *\t@param { function | undefined } options.handleEvent Method called by the map to notify the interaction that a browser event was dispatched to the map. The function may return false to prevent the propagation of the event to other interactions in the map's interactions chain.\n*/\nol.interaction.Hover = function(options)\n{\tif (!options) options={};\n\tvar self = this;\n\tol.interaction.Interaction.call(this,\n\t{\thandleEvent: function(e)\n\t\t{\tif (e.type==\"pointermove\") { self.handleMove_(e); } \n\t\t\tif (options.handleEvent) return options.handleEvent(e);\n\t\t\treturn true; \n\t\t}\n\t});\n\tthis.setFeatureFilter (options.featureFilter);\n\tthis.setLayerFilter (options.layerFilter);\n\tthis.set('hitTolerance', options.hitTolerance)\n\tthis.setCursor (options.cursor);\n};\nol.inherits(ol.interaction.Hover, ol.interaction.Interaction);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.Hover.prototype.setMap = function(map)\n{\tif (this.previousCursor_!==undefined && this.getMap())\n\t{\tthis.getMap().getTargetElement().style.cursor = this.previousCursor_;\n\t\tthis.previousCursor_ = undefined;\n\t}\n\tol.interaction.Interaction.prototype.setMap.call (this, map);\n};\n/**\n * Set cursor on hover\n * @param { string } cursor css cursor propertie or a function that gets a feature, default: none\n * @api stable\n */\nol.interaction.Hover.prototype.setCursor = function(cursor)\n{\tif (!cursor && this.previousCursor_!==undefined && this.getMap())\n\t{\tthis.getMap().getTargetElement().style.cursor = this.previousCursor_;\n\t\tthis.previousCursor_ = undefined;\n\t}\n\tthis.cursor_ = cursor;\n};\n/** Feature filter to get only one feature\n* @param {function} filter a function with two arguments, the feature and the layer of the feature. Return true to select the feature \n*/\nol.interaction.Hover.prototype.setFeatureFilter = function(filter)\n{\tif (typeof (filter) == 'function') this.featureFilter_ = filter;\n\telse this.featureFilter_ = function(){ return true; };\n};\n/** Feature filter to get only one feature\n* @param {function} filter a function with one argument, the layer to test. Return true to test the layer\n*/\nol.interaction.Hover.prototype.setLayerFilter = function(filter)\n{\tif (typeof (filter) == 'function') this.layerFilter_ = filter;\n\telse this.layerFilter_ = function(){ return true; };\n};\n/** Get features whenmove\n* @param {ol.event} e \"move\" event\n*/\nol.interaction.Hover.prototype.handleMove_ = function(e)\n{\tvar map = this.getMap();\n\tif (map)\n\t{\t//var b = map.hasFeatureAtPixel(e.pixel);\n\t\tvar feature, layer;\n\t\tvar self = this;\n\t\tvar b = map.forEachFeatureAtPixel(e.pixel, \n\t\t\t\t\tfunction(f, l)\n\t\t\t\t\t{\tif (self.layerFilter_.call(null, l) \n\t\t\t\t\t\t&& self.featureFilter_.call(null,f,l))\n\t\t\t\t\t\t{\tfeature = f;\n\t\t\t\t\t\t\tlayer = l;\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse \n\t\t\t\t\t\t{\tfeature = layer = null;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t},{ hitTolerance: this.get('hitTolerance') });\n\t\tif (b) this.dispatchEvent({ type:\"hover\", feature:feature, layer:layer, coordinate:e.coordinate, pixel: e.pixel, map: e.map, dragging:e.dragging });\n\t\tif (this.feature_===feature && this.layer_===layer)\n\t\t{\t/* ok */\n\t\t}\n\t\telse\n\t\t{\tthis.feature_ = feature;\n\t\t\tthis.layer_ = layer;\n\t\t\tif (feature) this.dispatchEvent({ type:\"enter\", feature:feature, layer:layer, coordinate:e.coordinate, pixel: e.pixel, map: e.map, dragging:e.dragging });\n\t\t\telse this.dispatchEvent({ type:\"leave\", coordinate:e.coordinate, pixel: e.pixel, map: e.map, dragging:e.dragging });\n\t\t}\n\t\tif (this.cursor_) \n\t\t{\tvar style = map.getTargetElement().style;\n\t\t\tif (b) \n\t\t\t{\tif (style.cursor != this.cursor_) \n\t\t\t\t{\tthis.previousCursor_ = style.cursor;\n\t\t\t\t\tstyle.cursor = this.cursor_;\n\t\t\t\t}\n\t\t\t} \n\t\t\telse if (this.previousCursor_ !== undefined) \n\t\t\t{\tstyle.cursor = this.previousCursor_;\n\t\t\t\tthis.previousCursor_ = undefined;\n\t\t\t}\n\t\t}\n\t}\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction to handle longtouch events\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @param {olx.interaction.LongTouchOptions} \n * \t@param {function | undefined} options.handleLongTouchEvent Function handling \"longtouch\" events, it will receive a mapBrowserEvent.\n *\t@param {interger | undefined} options.delay The delay for a long touch in ms, default is 1000\n */\nol.interaction.LongTouch = function(options)\n{\tif (!options) options = {};\n\tthis.delay_ = options.delay || 1000;\n\tvar ltouch = options.handleLongTouchEvent || function(){};\n\tvar _timeout = null;\n\tol.interaction.Interaction.call(this,\n\t{\thandleEvent: function(e)\n\t\t{\tif (this.getActive())\n\t\t\t{\tswitch (e.type)\n\t\t\t\t{\tcase 'pointerdown': \n\t\t\t\t\t\tif (_timeout) clearTimeout(_timeout);\n\t\t\t\t\t\t_timeout = setTimeout (function()\n\t\t\t\t\t\t\t{\te.type = \"longtouch\";\n\t\t\t\t\t\t\t\tltouch(e) \n\t\t\t\t\t\t\t}, this.delay_);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t/* case 'pointermove': */\n\t\t\t\t\tcase 'pointerdrag':\n\t\t\t\t\tcase 'pointerup':\n\t\t\t\t\t\tif (_timeout) \n\t\t\t\t\t\t{\tclearTimeout(_timeout);\n\t\t\t\t\t\t\t_timeout = null;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault: break;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\tif (_timeout) \n\t\t\t\t{\tclearTimeout(_timeout);\n\t\t\t\t\t_timeout = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t});\n};\nol.inherits(ol.interaction.LongTouch, ol.interaction.Interaction);\n\n/* Extent the ol/interaction/Modify with a getModifyFeatures\n * Get the features modified by the interaction\n * @return {Array<ol.Feature>} the modified features\n */\nol.interaction.Modify.prototype.getModifiedFeatures = function() {\n  var featuresById = {};\n  this.dragSegments_.forEach( function(s) {\n    var feature = s[0].feature;\n    featuresById[ol.getUid(feature)] = feature;\n  });\n  var features = [];\n  for (var i in featuresById) features.push(featuresById[i]);\n  return features;\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction for modifying feature geometries. Similar to the core ol/interaction/Modify.\n * The interaction is more suitable to use to handle feature modification: only features concerned \n * by the modification are passed to the events (instead of all feature with ol/interaction/Modify)\n * - the modifystart event is fired before the feature is modified (no points still inserted)\n * - the modifyend event is fired after the modification\n * - it fires a modifying event\n * @constructor\n * @extends {ol.interaction.Pointer}\n * @fires modifystart\n * @fires modifying\n * @fires modifyend\n * @param {*} options\n *\t@param {ol.source.Vector|Array{ol.source.Vector}} options.source a list of source to modify (configured with useSpatialIndex set to true)\n *  @param {ol.Collection.<ol.Feature>} options.features collection of feature to modify\n *  @param {integer} options.pixelTolerance Pixel tolerance for considering the pointer close enough to a segment or vertex for editing. Default is 10.\n *  @param {function|undefined} options.filter a filter that takes a feature and return true if it can be modified, default always true.\n *  @param {ol.style.Style | Array<ol.style.Style> | undefined} options.style Style for the sketch features.\n *  @param {ol.EventsConditionType | undefined} options.condition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether that event will be considered to add or move a vertex to the sketch. Default is ol.events.condition.primaryAction.\n *  @param {ol.EventsConditionType | undefined} options.deleteCondition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether that event should be handled. By default, ol.events.condition.singleClick with ol.events.condition.altKeyOnly results in a vertex deletion.\n *  @param {ol.EventsConditionType | undefined} options.insertVertexCondition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether a new vertex can be added to the sketch features. Default is ol.events.condition.always\n */\nol.interaction.ModifyFeature = function(options){\n  if (!options) options = {};\n  var dragging, modifying;\n  ol.interaction.Pointer.call(this,{\n    /*\n    handleDownEvent: this.handleDownEvent,\n    handleDragEvent: this.handleDragEvent,\n    handleMoveEvent: this.handleMoveEvent,\n    handleUpEvent: this.handleUpEvent,\n    */\n    handleEvent: function(e) {\n      switch(e.type) {\n        case 'pointerdown': {\n          dragging = this.handleDownEvent(e);\n          modifying = dragging || this._deleteCondition(e);\n          return !dragging;\n        }\n        case 'pointerup': {\n          dragging = false;\n          return this.handleUpEvent(e);\n        }\n        case 'pointerdrag': {\n          if (dragging) return this.handleDragEvent(e);\n          else return true;\n        }\n        case 'pointermove': {\n          if (!dragging) return this.handleMoveEvent(e);\n          else return true;\n        }\n        case 'singleclick':\n        case 'click': {\n          // Prevent click when modifying\n          return !modifying;\n        }\n        default: return true;\n      }\n    }\n  });\n  // Snap distance (in px)\n  this.snapDistance_ = options.pixelTolerance || 10;\n  // Split tolerance between the calculated intersection and the geometry\n  this.tolerance_ = 1e-10;\n  // Cursor\n  this.cursor_ = options.cursor;\n  // List of source to split\n  this.sources_ = options.sources ? (options.sources instanceof Array) ? options.sources:[options.sources] : [];\n  if (options.features) {\n    this.sources_.push (new ol.source.Vector({ features: options.features }));\n  }\n  // Get all features candidate\n  this.filterSplit_ = options.filter || function(){ return true; };\n  this._condition = options.condition || ol.events.condition.primaryAction;\n  this._deleteCondition = options.deleteCondition || ol.events.condition.altKeyOnly;\n  this._insertVertexCondition = options.insertVertexCondition || ol.events.condition.always;\n  // Default style\n  var sketchStyle = function() {\n    return [ new ol.style.Style({\n        image: new ol.style.Circle({\n          radius: 6,\n          fill: new ol.style.Fill({ color: [0, 153, 255, 1] }),\n          stroke: new ol.style.Stroke({ color: '#FFF', width: 1.25 })\n        })\n      })\n    ];\n  }\n  // Custom style\n  if (options.style) {\n    if (typeof(options.style) === 'function') {\n      sketchStyle = options.style\n     } else {\n       sketchStyle = function() { return options.style; }\n     }\n  }\n  // Create a new overlay for the sketch\n  this.overlayLayer_ = new ol.layer.Vector({\n    source: new ol.source.Vector({\n      useSpatialIndex: false\n    }),\n    name:'Modify overlay',\n    displayInLayerSwitcher: false,\n    style: sketchStyle\n  });\n};\nol.inherits(ol.interaction.ModifyFeature, ol.interaction.Pointer);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.ModifyFeature.prototype.setMap = function(map) {\n  if (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\n  ol.interaction.Interaction.prototype.setMap.call (this, map);\n  this.overlayLayer_.setMap(map);\n};\n/**\n * Activate or deactivate the interaction + remove the sketch.\n * @param {boolean} active.\n * @api stable\n */\nol.interaction.ModifyFeature.prototype.setActive = function(active) {\n  ol.interaction.Interaction.prototype.setActive.call (this, active);\n  if (this.overlayLayer_) this.overlayLayer_.getSource().clear();\n};\n/** Get closest feature at pixel\n * @param {ol.Pixel} \n * @return {*} \n * @private\n */\nol.interaction.ModifyFeature.prototype.getClosestFeature = function(e) {\n  var f, c, d = this.snapDistance_+1;\n  for (var i=0; i<this.sources_.length; i++) {\n    var source = this.sources_[i];\n    f = source.getClosestFeatureToCoordinate(e.coordinate);\n    if (f && this.filterSplit_(f)) {\n      var ci = f.getGeometry().getClosestPoint(e.coordinate);\n      var di = ol.coordinate.dist2d(e.coordinate,ci) / e.frameState.viewState.resolution;\n      if (di < d){\n        d = di;\n        c = ci;\n      }\n      break;\n    }\n  }\n  if (d > this.snapDistance_) {\n    return false;\n  } else {\n    // Snap to node\n    var coord = this.getNearestCoord (c, f.getGeometry());\n    if (coord) {\n      coord = coord.coord;\n      var p = this.getMap().getPixelFromCoordinate(coord);\n      if (ol.coordinate.dist2d(e.pixel, p) < this.snapDistance_) {\n        c = coord;\n      }\n      //\n      return { source:source, feature:f, coord: c };\n    }\n  }\n}\n/** Get nearest coordinate in a list \n* @param {ol.coordinate} pt the point to find nearest\n* @param {ol.geom} coords list of coordinates\n* @return {*} the nearest point with a coord (projected point), dist (distance to the geom), ring (if Polygon)\n*/\nol.interaction.ModifyFeature.prototype.getNearestCoord = function(pt, geom) {\n  var i, l, p, p0, dm;\n  switch (geom.getType()) {\n    case 'Point': {\n      return { coord: geom.getCoordinates(), dist: ol.coordinate.dist2d(geom.getCoordinates(), pt) };\n    }\n    case 'MultiPoint': {\n      return this.getNearestCoord (pt, new ol.geom.LineString(geom.getCoordinates()));\n    }\n    case 'LineString':\n    case 'LinearRing': {\n      var d;\n      dm = Number.MAX_VALUE;\n      var coords = geom.getCoordinates();\n      for (i=0; i < coords.length; i++) {\n        d = ol.coordinate.dist2d (pt, coords[i]);\n        if (d < dm) {\n          dm = d;\n          p0 = coords[i];\n        }\n      }\n      return { coord: p0, dist: dm };\n    }\n    case 'MultiLineString': {\n      var lstring = geom.getLineStrings();\n      p0 = false, dm = Number.MAX_VALUE;\n      for (i=0; l=lstring[i]; i++) {\n        p = this.getNearestCoord(pt, l);\n        if (p && p.dist<dm) {\n          p0 = p;\n          dm = p.dist;\n          p0.ring = i;\n        }\n      }\n      return p0;\n    }\n    case 'Polygon': {\n      var lring = geom.getLinearRings();\n      p0 = false;\n      dm = Number.MAX_VALUE;\n      for (i=0; l=lring[i]; i++) {\n        p = this.getNearestCoord(pt, l);\n        if (p && p.dist<dm) {\n          p0 = p;\n          dm = p.dist;\n          p0.ring = i;\n        }\n      }\n      return p0;\n    }\n    case 'MultiPolygon': {\n      var poly = geom.getPolygons();\n      p0 = false;\n      dm = Number.MAX_VALUE;\n      for (i=0; l=poly[i]; i++) {\n        p = this.getNearestCoord(pt, l);\n        if (p && p.dist<dm) {\n          p0 = p;\n          dm = p.dist;\n          poly.poly = i;\n        }\n      }\n      return p0;\n    }\n    default: return false;\n  }\n};\n/** Get arcs concerned by a modification \n * @param {ol.geom} geom the geometry concerned\n * @param {ol.coordinate} coord pointed coordinates\n */\nol.interaction.ModifyFeature.prototype.getArcs = function(geom, coord) {\n  var arcs = false;\n  var coords, i, s, l;\n  switch(geom.getType()) {\n    case 'Point': {\n      arcs = { \n        geom: geom, \n        type: geom.getType(),\n        coord1: [],\n        coord2: [],\n        node: true\n      }\n      break;\n    }\n    case 'MultiPoint': {\n      coords = geom.getCoordinates();\n      for (i=0; i < coords.length; i++) {\n        if (ol.coordinate.equal(coord, coords[i])) {\n          arcs = { \n            geom: geom, \n            type: geom.getType(),\n            index: i,\n            coord1: [],\n            coord2: [],\n            node: true\n          }\n          break;\n        }\n      }\n      break;\n    }\n    case 'LinearRing': \n    case 'LineString': {\n      var p = geom.getClosestPoint(coord);\n      if (ol.coordinate.dist2d(p,coord) < 1.5*this.tolerance_) {\n        var split;\n        // Split the line in two\n        if (geom.getType() === 'LinearRing') {\n          var g = new ol.geom.LineString(geom.getCoordinates());\n          split = g.splitAt(coord, this.tolerance_);\n        } else {\n          split = geom.splitAt(coord, this.tolerance_);\n        }\n        // If more than 2\n        if (split.length>2) {\n          coords = split[1].getCoordinates();\n          for (i=2; s=split[i]; i++) {\n            var c = s.getCoordinates();\n            c.shift();\n            coords = coords.concat(c);\n          }\n          split = [ split[0], new ol.geom.LineString(coords) ];\n        }\n        // Split in two\n        if (split.length === 2) {\n          var c0 = split[0].getCoordinates();\n          var c1 = split[1].getCoordinates();\n          var nbpt = c0.length + c1.length -1;\n          c0.pop();\n          c1.shift();\n          arcs = { \n            geom: geom, \n            type: geom.getType(),\n            coord1: c0, \n            coord2: c1,\n            node: (geom.getCoordinates().length === nbpt),\n            closed: false\n          }\n        } else if (split.length === 1) {\n          s = split[0].getCoordinates();\n          var start = ol.coordinate.equal(s[0], coord);\n          var end = ol.coordinate.equal(s[s.length-1], coord);\n          // Move first point\n          if (start) {\n            s.shift();\n            if (end) s.pop();\n            arcs = { \n              geom: geom, \n              type: geom.getType(),\n              coord1: [], \n              coord2: s,\n              node: true,\n              closed: end\n            }\n          } else if (end) {\n            // Move last point\n            s.pop()\n            arcs = { \n              geom: geom, \n              type: geom.getType(),\n              coord1: s, \n              coord2: [],\n              node: true,\n              closed: false\n            }\n          }\n        }\n      }\n      break;\n    }\n    case 'MultiLineString': {\n      var lstring = geom.getLineStrings();\n      for (i=0; l=lstring[i]; i++) {\n        arcs = this.getArcs(l, coord);\n        if (arcs) {\n          arcs.geom = geom;\n          arcs.type = geom.getType();\n          arcs.lstring = i;\n          break;\n        }\n      }\n      break;\n    }\n    case 'Polygon': {\n      var lring = geom.getLinearRings();\n      for (i=0; l=lring[i]; i++) {\n        arcs = this.getArcs(l, coord);\n        if (arcs) {\n          arcs.geom = geom;\n          arcs.type = geom.getType();\n          arcs.index = i;\n          break;\n        }\n      }\n      break;\n    }\n    case 'MultiPolygon': {\n      var poly = geom.getPolygons();\n      for (i=0; l=poly[i]; i++) {\n        arcs = this.getArcs(l, coord);\n        if (arcs) {\n          arcs.geom = geom;\n          arcs.type = geom.getType();\n          arcs.poly = i;\n          break;\n        }\n      }\n      break;\n    }\n    default: {\n      console.error('ol/interaction/ModifyFeature '+geom.getType()+' not supported!');\n    }\n  }\n  return arcs;\n};\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `true` to start the drag sequence.\n */\nol.interaction.ModifyFeature.prototype.handleDownEvent = function(evt) {\n  if (!this.getActive()) return false;\n  // Something to split ?\n  var current = this.getClosestFeature(evt);\n  if (current && (this._condition(evt) || this._deleteCondition(evt))) {\n    var features = [];\n    this.arcs = [];\n    // Get features concerned\n    this.sources_.forEach(function(s) {\n      var extent = ol.extent.buffer (ol.extent.boundingExtent([current.coord]), this.tolerance_);\n      features = features.concat(features, s.getFeaturesInExtent(extent));\n    }.bind(this));\n    // Get arcs concerned\n    this._modifiedFeatures = [];\n    features.forEach(function(f) {\n      var a = this.getArcs(f.getGeometry(), current.coord);\n      if (a) {\n        if (this._insertVertexCondition(evt) || a.node) {\n          a.feature = f;\n          this._modifiedFeatures.push(f);\n          this.arcs.push(a);\n        }\n      }\n    }.bind(this));\n    if (this._modifiedFeatures.length) {\n      if (this._deleteCondition(evt)) {\n        return !this._removePoint(current, evt); \n      } else {\n        this.dispatchEvent({ \n          type:'modifystart', \n          coordinate: current.coord,\n          originalEvent: evt.originalEvent,\n          features: this._modifiedFeatures\n        });\n        this.handleDragEvent({ coordinate: current.coord })\n        return true;\n      }\n    } else {\n      return true;\n    }\n  } else {\n    return false;\n  }\n};\n/** Get modified features\n * @return {Array<ol.Feature>} list of modified features\n */\nol.interaction.ModifyFeature.prototype.getModifiedFeatures = function() {\n  return this._modifiedFeatures || [];\n};\n/** Removes the vertex currently being pointed.\n */\nol.interaction.ModifyFeature.prototype.removePoint = function() {\n  this._removePoint({},{});\n};\n/** Removes the vertex currently being pointed.\n * @private\n */\nol.interaction.ModifyFeature.prototype._removePoint = function(current, evt) {\n  if (!this.arcs) return false;\n  this.overlayLayer_.getSource().clear();\n  var found = false;\n  // Get all modifications\n  this.arcs.forEach(function(a) {\n    var coords = a.coord1.concat(a.coord2);\n    switch (a.type) {\n      case 'LineString': {\n        if (a.closed) coords.push(coords[0]);\n        if (coords.length>1) {\n          if (a.geom.getCoordinates().length != coords.length) {\n            a.coords = coords;\n            found = true;\n          }\n        }\n        break;\n      }\n      case 'MultiLineString': {\n        if (a.closed) coords.push(coords[0]);\n        if (coords.length>1) {\n          var c = a.geom.getCoordinates();\n          if (c[a.lstring].length != coords.length) {\n            c[a.lstring] = coords;\n            a.coords = c;\n            found = true;\n          }\n        }\n        break;\n      }\n      case 'Polygon': {\n        if (a.closed) coords.push(coords[0]);\n        if (coords.length>3) {\n          c = a.geom.getCoordinates();\n          if (c[a.index].length != coords.length) {\n            c[a.index] = coords;\n            a.coords = c;\n            found = true;\n          }\n        }\n        break;\n      }\n      case 'MultiPolygon': {\n        if (a.closed) coords.push(coords[0]);\n        if (coords.length>3) {\n          c = a.geom.getCoordinates();\n          if (c[a.poly][a.index].length != coords.length) {\n            c[a.poly][a.index] = coords;\n            a.coords = c;\n            found = true;\n          }\n        }\n        break;\n      }\n    }\n  }.bind(this));\n  // Almost one point is removed\n  if (found) {\n    this.dispatchEvent({ \n      type:'modifystart', \n      coordinate: current.coord,\n      originalEvent: evt.originalEvent,\n      features: this._modifiedFeatures\n    });\n    this.arcs.forEach(function(a) {\n      if (a.coords) a.geom.setCoordinates(a.coords)\n    });\n    this.dispatchEvent({ \n      type:'modifyend', \n      coordinate: current.coord,\n      originalEvent: evt.originalEvent,\n      features: this._modifiedFeatures\n    });\n  }\n  this.arcs = [];\n  return found;\n};\n/**\n * @private\n */\nol.interaction.ModifyFeature.prototype.handleUpEvent = function(e) {\n  if (!this.getActive()) return false;\n  if (!this.arcs || !this.arcs.length) return true;\n  this.overlayLayer_.getSource().clear();\n  this.dispatchEvent({ \n    type:'modifyend', \n    coordinate: e.coordinate,\n    originalEvent: e.originalEvent,\n    features: this._modifiedFeatures\n  });\n  return true;\n};\n/**\n * @private\n */\nol.interaction.ModifyFeature.prototype.handleDragEvent = function(e) {\n  if (!this.getActive()) return false;\n  if (!this.arcs) return true;\n  // Show sketch\n  this.overlayLayer_.getSource().clear();\n  var p = new ol.Feature(new ol.geom.Point(e.coordinate));\n  this.overlayLayer_.getSource().addFeature(p);\n  // Nothing to do\n  if (!this.arcs.length) return true;\n  // Move arcs\n  this.arcs.forEach(function(a) {\n    var c, coords = a.coord1.concat([e.coordinate], a.coord2);\n    if (a.closed) coords.push(e.coordinate);\n    switch (a.type) {\n      case 'Point': {\n        a.geom.setCoordinates(e.coordinate);\n        break;\n      }\n      case 'MultiPoint': {\n        c = a.geom.getCoordinates();\n        c[a.index] = e.coordinate;\n        a.geom.setCoordinates(c);\n        break;\n      }\n      case 'LineString': {\n        a.geom.setCoordinates(coords);\n        break;\n      }\n      case 'MultiLineString': {\n        c = a.geom.getCoordinates();\n        c[a.lstring] = coords;\n        a.geom.setCoordinates(c);\n        break;\n      }\n      case 'Polygon': {\n        c = a.geom.getCoordinates();\n        c[a.index] = coords;\n        a.geom.setCoordinates(c);\n        break;\n      }\n      case 'MultiPolygon': {\n        c = a.geom.getCoordinates();\n        c[a.poly][a.index] = coords;\n        a.geom.setCoordinates(c);\n        break;\n      }\n    }\n  }.bind(this));\n  this.dispatchEvent({ \n    type:'modifying', \n    coordinate: e.coordinate,\n    originalEvent: e.originalEvent,\n    features: this._modifiedFeatures\n  });\n  return true;\n};\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n * @private\n */\nol.interaction.ModifyFeature.prototype.handleMoveEvent = function(e) {\n  if (!this.getActive()) return false;\n  this.overlayLayer_.getSource().clear();\n  var current = this.getClosestFeature(e);\n  // Draw sketch\n  if (current) {\n    var p = new ol.Feature(new ol.geom.Point(current.coord));\n    this.overlayLayer_.getSource().addFeature(p);\n  }\n  // Show cursor\n  var element = e.map.getTargetElement();\n  if (this.cursor_) {\n    if (current) {\n      if (element.style.cursor != this.cursor_) {\n        this.previousCursor_ = element.style.cursor;\n        element.style.cursor = this.cursor_;\n      }\n    } else if (this.previousCursor_ !== undefined) {\n      element.style.cursor = this.previousCursor_;\n      this.previousCursor_ = undefined;\n    }\n  }\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Modify interaction with a popup to delet a point on touch device\n * @constructor\n * @fires showpopup\n * @fires hidepopup\n * @extends {ol.interaction.Modify}\n * @param {olx.interaction.ModifyOptions} options\n *  @param {String|undefined} options.title title to display, default \"remove point\"\n *  @param {Boolean|undefined} options.usePopup use a popup, default true\n */\nol.interaction.ModifyTouch = function(options) {\n  var self = this;\n  if (!options) options = {};\n  this._popup = new ol.Overlay.Popup ({\n    popupClass: options.calssName || 'modifytouch',\n    positioning: 'bottom-rigth',\n    offsetBox: 10\n  });\n  this._source = options.source;\n  this._features = options.features;\n  // popup content\n  var a = document.createElement('a');\n  a.appendChild(document.createTextNode(options.title || \"remove point\"));\n  a.onclick = function() {\n    self.removePoint();\n  };\n  this.setPopupContent(a);\n  var pixelTolerance = options.pixelTolerance || 0;\n  var searchDist = pixelTolerance +5;\n  // Check if there is a feature to select\n  options.condition = function(e) {\n\t\tvar features = this.getMap().getFeaturesAtPixel(e.pixel,{\n      hitTolerance: searchDist\n    });\n    var p0, p1, found = false;\n\t\tif (features) {\n      var search = this._features;\n      if (!search) {\n        p0 = [e.pixel[0] - searchDist, e.pixel[1] - searchDist]\n        p1 = [e.pixel[0] + searchDist, e.pixel[1] + searchDist]\n        p0 = this.getMap().getCoordinateFromPixel(p0);\n        p1 = this.getMap().getCoordinateFromPixel(p1);\n        var ext = ol.extent.boundingExtent([p0,p1]);\n        search = this._source.getFeaturesInExtent(ext);\n      } \n      if (search.getArray) search = search.getArray();\n      for (var i=0, f; f=features[i]; i++) {\n        if (search.indexOf(f) >= 0) break;\n      }\n      if (f) {\n        p0 = e.pixel;\n        p1 = f.getGeometry().getClosestPoint(e.coordinate);\n        p1 = this.getMap().getPixelFromCoordinate(p1);\n        var dx = p0[0] - p1[0];\n        var dy = p0[1] - p1[1];\n        found = (Math.sqrt(dx*dx+dy*dy) < searchDist);\n      }\n    }\n    // Show popup if any\n    this.showDeleteBt(found ? { type:'show', feature:f, coordinate: e.coordinate } : { type:'hide' });\n    // Prevent click on the popup\n    e.preventDefault();\n    e.stopPropagation();\n\t\treturn true;\n  };\n  // Hide popup on insert\n\toptions.insertVertexCondition = function() {\n\t\tthis.showDeleteBt({ type:'hide' });\n\t\treturn true;\n  }\n  ol.interaction.Modify.call(this, options);\n  this.on(['modifystart','modifyend'], function(){\n\t\tthis.showDeleteBt({ type:'hide', modifying: true });\n  });\n  // Use a popup ?\n  this.set('usePopup', options.usePopup !== false);\n};\nol.inherits(ol.interaction.ModifyTouch, ol.interaction.Modify);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.ModifyTouch.prototype.setMap = function(map) {\t\n  if (this.getMap()) {\n    this.getMap().removeOverlay(this._popup);\n  }\n\tol.interaction.Modify.prototype.setMap.call (this, map);\n  if (this.getMap()) {\n    this.getMap().addOverlay(this._popup);\n  }\n};\n/** Activate the interaction and remove popup\n * @param {Boolean} b\n */\nol.interaction.ModifyTouch.prototype.setActive = function(b) {\t\n  ol.interaction.Modify.prototype.setActive.call (this, b);\n  this.showDeleteBt({ type:'hide' });\n};\n/**\n * Remove the current point\n */\nol.interaction.ModifyTouch.prototype.removePoint = function() {\t\n  // Prevent touch + click on popup \n  if (new Date() - this._timeout < 200) return;\n  // Remove point\n  ol.interaction.Modify.prototype.removePoint.call (this);\n  this.showDeleteBt({ type:'hide' });\n}\n/**\n * Show the delete button (menu)\n * @param {Event} e\n * @api stable\n */\nol.interaction.ModifyTouch.prototype.showDeleteBt = function(e) {\n  if (this.get('usePopup') && e.type==='show') {\n    this._popup.show(e.coordinate, this._menu);\n  } else {\n    this._popup.hide();\n  }\n  e.type += 'popup';\n  this.dispatchEvent(e);\n  // Date if popup start a timeout to prevent touch + click on the popup\n  this._timeout = new Date();\n};\n/**\n * Change the popup content\n * @param {DOMElement} html \n */\nol.interaction.ModifyTouch.prototype.setPopupContent = function(html) {\n  this._menu = html;\n}\n/**\n * Get the popup content\n * @return {DOMElement}\n */\nol.interaction.ModifyTouch.prototype.getPopupContent = function() {\n  return this._menu;\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Offset interaction for offseting feature geometry\n * @constructor\n * @extends {ol.interaction.Pointer}\n * @fires offsetstart\n * @fires offsetting\n * @fires offsetend\n * @param {any} options\n *\t@param {ol.layer.Vector | Array<ol.layer.Vector>} options.layers list of feature to transform \n *\t@param {ol.Collection.<ol.Feature>} options.features collection of feature to transform\n *\t@param {ol.source.Vector | undefined} options.source source to duplicate feature when ctrl key is down\n *\t@param {boolean} options.duplicate force feature to duplicate (source must be set)\n */\nol.interaction.Offset = function(options) {\n  if (!options) options = {};\n\t// Extend pointer\n\tol.interaction.Pointer.call(this, {\n    handleDownEvent: this.handleDownEvent_,\n    handleDragEvent: this.handleDragEvent_,\n    handleMoveEvent: this.handleMoveEvent_,\n    handleUpEvent: this.handleUpEvent_\n  });\n\t// Collection of feature to transform\n\tthis.features_ = options.features;\n\t// List of layers to transform\n  this.layers_ = options.layers ? (options.layers instanceof Array) ? options.layers:[options.layers] : null;\n  // duplicate\n  this.set('duplicate', options.duplicate);\n  this.source_ = options.source;\n  // init\n  this.previousCursor_ = false;\n};\nol.inherits(ol.interaction.Offset, ol.interaction.Pointer);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.Offset.prototype.setMap = function(map) {\n\tol.interaction.Pointer.prototype.setMap.call (this, map);\n};\n/** Get Feature at pixel\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {any} a feature and the hit point\n * @private\n */\nol.interaction.Offset.prototype.getFeatureAtPixel_ = function(e) {\n  var self = this;\n\treturn this.getMap().forEachFeatureAtPixel(e.pixel,\n\t\tfunction(feature, layer) {\n      var current;\n\t\t\t// feature belong to a layer\n\t\t\tif (self.layers_) {\n        for (var i=0; i<self.layers_.length; i++) {\n          if (self.layers_[i]===layer) {\n            current = feature;\n            break;\n          }\n\t\t\t\t}\n\t\t\t}\n\t\t\t// feature in the collection\n\t\t\telse if (self.features_) {\n        self.features_.forEach (function(f) {\n          if (f===feature) {\n            current = feature \n          }\n        });\n\t\t\t}\n\t\t\t// Others\n\t\t\telse {\n        current = feature;\n      }\n      // Only poygon or linestring\n      var typeGeom = current.getGeometry().getType();\n      if (current && /Polygon|LineString/.test(typeGeom)) {\n        if (typeGeom==='Polygon' && current.getGeometry().getCoordinates().length>1) return false;\n        // test distance\n        var p = current.getGeometry().getClosestPoint(e.coordinate);\n        var dx = p[0]-e.coordinate[0];\n        var dy = p[1]-e.coordinate[1];\n        var d = Math.sqrt(dx*dx+dy*dy) / e.frameState.viewState.resolution;\n        if (d<5) {\n          return { \n            feature: current, \n            hit: p, \n            coordinates: current.getGeometry().getCoordinates(),\n            geom: current.getGeometry().clone(),\n            geomType: typeGeom\n          }\n        } else {\n          return false;\n        }\n      } else {\n        return false;\n      }\n\t\t},  { hitTolerance: 5 });\n};\n/**\n * @param {ol.MapBrowserEvent} e Map browser event.\n * @return {boolean} `true` to start the drag sequence.\n * @private\n */\nol.interaction.Offset.prototype.handleDownEvent_ = function(e) {\t\n  this.current_ = this.getFeatureAtPixel_(e);\n  if (this.source_ && (this.get('duplicate') || e.originalEvent.ctrlKey)) {\n    this.current_.feature = this.current_.feature.clone();\n    this.source_.addFeature(this.current_.feature);\n  } else {\n    // Modify the current feature\n    if (this.current_) {\n      this.dispatchEvent({ type:'modifystart', features: [ this.current_.feature ] });\n    }\n  }\n\tif (this.current_) {\n    this.dispatchEvent({ type:'offsetstart', feature: this.current_.feature, offset: 0 });\n    return true;\n  } else  {\n    return false;\n  }\n};\n/**\n * @param {ol.MapBrowserEvent} e Map browser event.\n * @private\n */\nol.interaction.Offset.prototype.handleDragEvent_ = function(e) {\n  var p = this.current_.geom.getClosestPoint(e.coordinate);\n  var d = ol.coordinate.dist2d(p, e.coordinate);\n  var seg, v1, v2, offset;\n  switch (this.current_.geomType) {\n    case  'Polygon': {\n      seg = ol.coordinate.findSegment(p, this.current_.coordinates[0]).segment;\n      if (seg) {\n        v1 = [ seg[1][0]-seg[0][0], seg[1][1]-seg[0][1] ];\n        v2 = [ e.coordinate[0]-p[0], e.coordinate[1]-p[1] ];\n        if (v1[0]*v2[1] - v1[1]*v2[0] > 0) {\n          d = -d;\n        }\n        offset = [];\n        for (var i=0; i<this.current_.coordinates.length; i++) {\n          offset.push( ol.coordinate.offsetCoords(this.current_.coordinates[i], i==0 ? d : -d) );\n        }\n        this.current_.feature.setGeometry(new ol.geom.Polygon(offset));\n      }\n      break;\n    }\n    case 'LineString': {\n      seg = ol.coordinate.findSegment(p, this.current_.coordinates).segment;\n      if (seg) {\n        v1 = [ seg[1][0]-seg[0][0], seg[1][1]-seg[0][1] ];\n        v2 = [ e.coordinate[0]-p[0], e.coordinate[1]-p[1] ];\n        if (v1[0]*v2[1] - v1[1]*v2[0] > 0) {\n          d = -d;\n        }\n        offset = ol.coordinate.offsetCoords(this.current_.coordinates, d);\n        this.current_.feature.setGeometry(new ol.geom.LineString(offset));\n      }\n      break;\n    }\n    default: {\n      break;\n    }\n  }\n  this.dispatchEvent({ type:'offsetting', feature: this.current_.feature, offset: d, segment: [p, e.coordinate], coordinate: e.coordinate });  \n};\n/**\n * @param {ol.MapBrowserEvent} e Map browser event.\n * @private\n */\nol.interaction.Offset.prototype.handleUpEvent_ = function(e) {\n  this.dispatchEvent({ type:'offsetend', feature: this.current_.feature, coordinate: e.coordinate });  \n  this.current_ = false;\n};\n/**\n * @param {ol.MapBrowserEvent} e Event.\n * @private\n */\nol.interaction.Offset.prototype.handleMoveEvent_ = function(e) {\t\n  var f = this.getFeatureAtPixel_(e);\n  if (f) {\n    if (this.previousCursor_ === false) {\n      this.previousCursor_ = e.map.getTargetElement().style.cursor;\n    }\n    e.map.getTargetElement().style.cursor = 'pointer';\n  } else {\n    e.map.getTargetElement().style.cursor = this.previousCursor_;\n    this.previousCursor_ = false;\n  }\n};\n\n/*\t\n\tWater ripple effect.\n\tOriginal code (Java) by Neil Wallis \n\t@link http://www.neilwallis.com/java/water.html\n\tOriginal code (JS) by Sergey Chikuyonok (serge.che@gmail.com)\n\t@link http://chikuyonok.ru\n\t@link http://media.chikuyonok.ru/ripple/\n\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n\t@link https://github.com/Viglino\n */\n/**\n * @constructor\n * @extends {ol.interaction.Pointer}\n *\t@param {ol.flashlight.options} flashlight options param\n *\t\t- color {ol.Color} light color, default transparent\n *\t\t- fill {ol.Color} fill color, default rgba(0,0,0,0.8)\n *\t\t- radius {number} radius of the flash\n */\nol.interaction.Ripple = function(options)\n{\n\tol.interaction.Pointer.call(this,\n\t{\thandleDownEvent: this.rainDrop,\n\t\thandleMoveEvent: this.rainDrop\n\t});\n\t// Default options\n\toptions = options||{};\n\tthis.riprad = options.radius || 3;\n\tthis.ripplemap = [];\n    this.last_map = [];\n    // Generate random ripples\n    this.interval = options.interval;\n\tthis.rains (this.interval);\n};\nol.inherits(ol.interaction.Ripple, ol.interaction.Pointer);\n/** Set the map > start postcompose\n*/\nol.interaction.Ripple.prototype.setMap = function(map)\n{\tif (this.oncompose)\n\t{\tol.Observable.unByKey(this.oncompose);\n\t\tif (this.getMap()) this.getMap().render();\n\t}\n\tol.interaction.Pointer.prototype.setMap.call(this, map);\n\tif (map)\n\t{\tthis.oncompose = map.on('postcompose', this.postcompose_.bind(this));\n\t}\n}\n/** Generate random rain drop\n*\t@param {integer} interval\n*/\nol.interaction.Ripple.prototype.rains = function(interval)\n{\tif (this.onrain) clearTimeout (this.onrain);\n\tvar self = this;\n\tvar vdelay = (typeof(interval)==\"number\" ? interval : 1000)/2;\n\tvar delay = 3*vdelay/2;\n\tvar rnd = Math.random;\n\tfunction rain() \n\t{\tif (self.width) self.rainDrop([rnd() * self.width, rnd() * self.height]);\n\t\tself.onrain = setTimeout (rain, rnd()*vdelay + delay);\n\t}\n\t// Start raining\n\tif (delay) rain();\n}\n/** Disturb water at specified point\n*\t@param {ol.Pixel|ol.MapBrowserEvent}\n*/\nol.interaction.Ripple.prototype.rainDrop = function(e)\n{\tif (!this.width) return;\n\tvar dx,dy;\n\tif (e.pixel) \n\t{\tdx = e.pixel[0]*this.ratio;\n\t\tdy = e.pixel[1]*this.ratio;\n\t}\n\telse \n\t{\tdx = e[0]*this.ratio;\n\t\tdy = e[1]*this.ratio;\n\t}\n\tdx <<= 0;\n    dy <<= 0;\n    for (var j = dy - this.riprad*this.ratio; j < dy + this.riprad*this.ratio; j++) \n\t{   for (var k = dx - this.riprad*this.ratio; k < dx + this.riprad*this.ratio; k++) \n\t\t{   this.ripplemap[this.oldind + (j * this.width) + k] += 128;\n        }\n    }\n}\n/** Postcompose function\n*/\nol.interaction.Ripple.prototype.postcompose_ = function(e)\n{\tvar ctx = e.context;\n\tvar canvas = ctx.canvas;\n\t// Initialize when canvas is ready / modified\n\tif (this.width != canvas.width || this.height != canvas.height)\n\t{\tthis.width = canvas.width;\n\t\tthis.height = canvas.height;\n\t\tthis.ratio = e.frameState.pixelRatio;\n\t\tthis.half_width = this.width >> 1;\n\t\tthis.half_height = this.height >> 1;\n\t\tthis.size = this.width * (this.height + 2) * 2;\n\t\tthis.oldind = this.width;\n\t\tthis.newind = this.width * (this.height + 3);\n\t\tfor (var i = 0; i < this.size; i++) {\n\t\t\tthis.last_map[i] = this.ripplemap[i] = 0;\n\t\t}\n\t}\n\tthis.texture = ctx.getImageData(0, 0, this.width, this.height);\n\tthis.ripple = ctx.getImageData(0, 0, this.width, this.height);\t\n\t// Run animation\n\tvar a, b, data, cur_pixel, new_pixel;\n    var t = this.oldind; this.oldind = this.newind; this.newind = t;\n    i = 0;\n    var _rd = this.ripple.data,\n        _td = this.texture.data;\n    for (var y = 0; y < this.height; y++) {\n        for (var x = 0; x < this.width; x++) {\n            var _newind = this.newind + i,\n\t\t\t\t_mapind = this.oldind + i;\n            data = (\n                this.ripplemap[_mapind - this.width] + \n                this.ripplemap[_mapind + this.width] + \n                this.ripplemap[_mapind - 1] + \n                this.ripplemap[_mapind + 1]) >> 1;\n            data -= this.ripplemap[_newind];\n            data -= data >> 5;\n            this.ripplemap[_newind] = data;\n            //where data=0 then still, where data>0 then wave\n            data = 1024 - data;\n            if (this.last_map[i] != data) \n\t\t\t{   this.last_map[i] = data;\n\t\t\t\t//offsets\n                a = (((x - this.half_width) * data / 1024) << 0) + this.half_width;\n                b = (((y - this.half_height) * data / 1024) << 0) + this.half_height;\n                //bounds check\n                if (a >= this.width) a = this.width - 1;\n                if (a < 0) a = 0;\n                if (b >= this.height) b = this.height - 1;\n                if (b < 0) b = 0;\n                new_pixel = (a + (b * this.width)) * 4;\n                cur_pixel = i * 4;\n\t\t\t\t/**/\n                _rd[cur_pixel] = _td[new_pixel];\n                _rd[cur_pixel + 1] = _td[new_pixel + 1];\n                _rd[cur_pixel + 2] = _td[new_pixel + 2];\n\t\t\t\t/*/\n\t\t\t\t// only in blue pixels \n                if (_td[new_pixel + 2]>_td[new_pixel + 1]\n\t\t\t\t\t&& _td[new_pixel + 2]>_td[new_pixel])\n\t\t\t\t{\n                _rd[cur_pixel] = _td[new_pixel];\n                _rd[cur_pixel + 1] = _td[new_pixel + 1];\n                _rd[cur_pixel + 2] = _td[new_pixel + 2];\n\t\t\t\t}\n\t\t\t\telse this.ripplemap[_newind] = 0;\n\t\t\t\t/**/\n            }\n            ++i;\n        }\n    }\n\tctx.putImageData(this.ripple, 0, 0);\n\t// tell OL3 to continue postcompose animation\n\tthis.getMap().render(); \n};\n\n/*\n\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (http://www.cecill.info/).\n\tol.interaction.SelectCluster is an interaction for selecting vector features in a cluster.\n*/\n//\n/**\n * @classdesc\n * Interaction for selecting vector features in a cluster. \n * It can be used as an ol.interaction.Select. \n * When clicking on a cluster, it springs apart to reveal the features in the cluster.\n * Revealed features are selectable and you can pick the one you meant.\n * Revealed features are themselves a cluster with an attribute features that contain the original feature.\n * \n * @constructor\n * @extends {ol.interaction.Select}\n * @param {olx.interaction.SelectOptions=} options SelectOptions.\n *  @param {ol.style} options.featureStyle used to style the revealed features as options.style is used by the Select interaction.\n * \t@param {boolean} options.selectCluster false if you don't want to get cluster selected\n * \t@param {Number} options.PointRadius to calculate distance between the features\n * \t@param {bool} options.spiral means you want the feature to be placed on a spiral (or a circle)\n * \t@param {Number} options.circleMaxObject number of object that can be place on a circle\n * \t@param {Number} options.maxObjects number of object that can be drawn, other are hidden\n * \t@param {bool} options.animation if the cluster will animate when features spread out, default is false\n * \t@param {Number} options.animationDuration animation duration in ms, default is 500ms\n * @fires ol.interaction.SelectEvent\n * @api stable\n */\nol.interaction.SelectCluster = function(options) \n{\toptions = options || {};\n\tvar fn; \n\tthis.pointRadius = options.pointRadius || 12;\n\tthis.circleMaxObjects = options.circleMaxObjects || 10;\n\tthis.maxObjects = options.maxObjects || 60;\n\tthis.spiral = (options.spiral !== false);\n\tthis.animate = options.animate;\n\tthis.animationDuration = options.animationDuration || 500;\n\tthis.selectCluster_ = (options.selectCluster !== false);\n\t// Create a new overlay layer for \n\tvar overlay = this.overlayLayer_ = new ol.layer.Vector(\n\t\t{\tsource: new ol.source.Vector({\n\t\t\t\tfeatures: new ol.Collection(),\n\t\t\t\twrapX: options.wrapX,\n\t\t\t\tuseSpatialIndex: true\n\t\t\t}),\n\t\t\tname:'Cluster overlay',\n\t\t\tupdateWhileAnimating: true,\n\t\t\tupdateWhileInteracting: true,\n\t\t\tdisplayInLayerSwitcher: false,\n\t\t\tstyle: options.featureStyle\n\t\t});\n\t// Add the overlay to selection\n\tif (options.layers)\n\t{\tif (typeof(options.layers) == \"function\")\n\t\t{\tfn = options.layers;\n\t\t\toptions.layers = function(layer)\n\t\t\t{\treturn (layer===overlay || fn(layer));\n\t\t\t};\n\t\t}\n\t\telse if (options.layers.push)\n\t\t{\toptions.layers.push(this.overlayLayer_);\n\t\t}\n\t}\n\t// Don't select links\n\tif (options.filter)\n\t{\tfn = options.filter;\n\t\toptions.filter = function(f,l)\n\t\t{\t//if (l===overlay && f.get(\"selectclusterlink\")) return false;\n\t\t\tif (!l && f.get(\"selectclusterlink\")) return false;\n\t\t\telse return fn(f,l);\n\t\t};\n\t}\n\telse options.filter = function(f,l) \n\t{\t//if (l===overlay && f.get(\"selectclusterlink\")) return false; \n\t\tif (!l && f.get(\"selectclusterlink\")) return false; \n\t\telse return true;\n\t};\n\tthis.filter_ = options.filter;\n\tol.interaction.Select.call(this, options);\n\tthis.on(\"select\", this.selectCluster.bind(this));\n};\nol.inherits(ol.interaction.SelectCluster, ol.interaction.Select);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.SelectCluster.prototype.setMap = function(map) {\n\tif (this.getMap()) {\n\t\tthis.getMap().removeLayer(this.overlayLayer_);\n\t}\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.interaction.Select.prototype.setMap.call (this, map);\n\tthis.overlayLayer_.setMap(map);\n\t// map.addLayer(this.overlayLayer_);\n\tif (map && map.getView()) {\n\t\tthis._listener = map.getView().on('change:resolution', this.clear.bind(this));\n\t}\n};\n/**\n * Clear the selection, close the cluster and remove revealed features\n * @api stable\n */\nol.interaction.SelectCluster.prototype.clear = function() \n{\tthis.getFeatures().clear();\n\tthis.overlayLayer_.getSource().clear();\n};\n/**\n * Get the layer for the revealed features\n * @api stable\n */\nol.interaction.SelectCluster.prototype.getLayer = function() \n{\treturn this.overlayLayer_;\n};\n/**\n * Select a cluster \n * @param {ol.Feature} a cluster feature ie. a feature with a 'features' attribute.\n * @api stable\n */\nol.interaction.SelectCluster.prototype.selectCluster = function (e) \n{\t// Nothing selected\n\tif (!e.selected.length)\n\t{\tthis.clear();\n\t\treturn;\n\t}\n\t// Get selection\n\tvar feature = e.selected[0];\n\t// It's one of ours\n\tif (feature.get('selectclusterfeature')) return;\n\t// Clic out of the cluster => close it\n\tvar source = this.overlayLayer_.getSource();\n\tsource.clear();\n\tvar cluster = feature.get('features');\n\t// Not a cluster (or just one feature)\n\tif (!cluster || cluster.length==1) return;\n\t// Remove cluster from selection\n\tif (!this.selectCluster_) this.getFeatures().clear();\n\tvar center = feature.getGeometry().getCoordinates();\n\t// Pixel size in map unit\n\tvar pix = this.getMap().getView().getResolution();\n\tvar r = pix * this.pointRadius * (0.5 + cluster.length / 4);\n\tvar a, i, max;\n\tvar p, cf, lk;\n\t// The features\n\tvar features = [];\n\t// Draw on a circle\n\tif (!this.spiral || cluster.length <= this.circleMaxObjects)\n\t{\tmax = Math.min(cluster.length, this.circleMaxObjects);\n\t\tfor (i=0; i<max; i++)\n\t\t{\ta = 2*Math.PI*i/max;\n\t\t\tif (max==2 || max == 4) a += Math.PI/4;\n\t\t\tp = [ center[0]+r*Math.sin(a), center[1]+r*Math.cos(a) ];\n\t\t\tcf = new ol.Feature({ 'selectclusterfeature':true, 'features':[cluster[i]], geometry: new ol.geom.Point(p) });\n\t\t\tcf.setStyle(cluster[i].getStyle());\n\t\t\tfeatures.push(cf);\n\t\t\tlk = new ol.Feature({ 'selectclusterlink':true, geometry: new ol.geom.LineString([center,p]) });\n\t\t\tfeatures.push(lk);\n\t\t}\n\t}\n\t// Draw on a spiral\n\telse\n\t{\t// Start angle\n\t\ta = 0;\n\t\tr;\n\t\tvar d = 2*this.pointRadius;\n\t\tmax = Math.min (this.maxObjects, cluster.length);\n\t\t// Feature on a spiral\n\t\tfor (i=0; i<max; i++)\n\t\t{\t// New radius => increase d in one turn\n\t\t\tr = d/2 + d*a/(2*Math.PI);\n\t\t\t// Angle\n\t\t\ta = a + (d+0.1)/r;\n\t\t\tvar dx = pix*r*Math.sin(a)\n\t\t\tvar dy = pix*r*Math.cos(a)\n\t\t\tp = [ center[0]+dx, center[1]+dy ];\n\t\t\tcf = new ol.Feature({ 'selectclusterfeature':true, 'features':[cluster[i]], geometry: new ol.geom.Point(p) });\n\t\t\tcf.setStyle(cluster[i].getStyle()); \n\t\t\tfeatures.push(cf);\n\t\t\tlk = new ol.Feature({ 'selectclusterlink':true, geometry: new ol.geom.LineString([center,p]) });\n\t\t\tfeatures.push(lk);\n\t\t}\n\t}\n\tsource.clear();\n\tif (this.animate) {\n\t\tthis.animateCluster_(center, features);\n\t} else {\n\t\tsource.addFeatures(features);\n\t}\n};\n/**\n * Animate the cluster and spread out the features\n * @param {ol.Coordinates} the center of the cluster\n */\nol.interaction.SelectCluster.prototype.animateCluster_ = function(center, features)\n{\t// Stop animation (if one is running)\n\tif (this.listenerKey_) {\n\t\tol.Observable.unByKey(this.listenerKey_);\n\t}\n\t// Features to animate\n\t// var features = this.overlayLayer_.getSource().getFeatures();\n\tif (!features.length) return;\n\tvar style = this.overlayLayer_.getStyle();\n\tvar stylefn = (typeof(style) == 'function') ? style : style.length ? function(){ return style; } : function(){ return [style]; } ;\n\tvar duration = this.animationDuration || 500;\n\tvar start = new Date().getTime();\n\t// Animate function\n\tfunction animate(event) {\n\t\tvar vectorContext = event.vectorContext;// || ol.render.getVectorContext(event);\n\t\t// Retina device\n\t\tvar ratio = event.frameState.pixelRatio;\n\t\tvar res = this.getMap().getView().getResolution();\n\t\tvar e = ol.easing.easeOut((event.frameState.time - start) / duration);\n\t\tfor (var i=0, feature; feature = features[i]; i++) if (feature.get('features'))\n\t\t{\tvar pt = feature.getGeometry().getCoordinates();\n\t\t\tpt[0] = center[0] + e * (pt[0]-center[0]);\n\t\t\tpt[1] = center[1] + e * (pt[1]-center[1]);\n\t\t\tvar geo = new ol.geom.Point(pt);\n\t\t\t// Image style\n\t\t\tvar st = stylefn(feature, res);\n\t\t\tfor (var s=0; s<st.length; s++)\n\t\t\t{\tvar sc;\n\t\t\t\t// OL < v4.3 : setImageStyle doesn't check retina\n\t\t\t\tvar imgs = ol.Map.prototype.getFeaturesAtPixel ? false : st[s].getImage();\n\t\t\t\tif (imgs)\n\t\t\t\t{\tsc = imgs.getScale();\n\t\t\t\t\timgs.setScale(ratio); \n\t\t\t\t}\n\t\t\t\t// OL3 > v3.14\n\t\t\t\tif (vectorContext.setStyle)\n\t\t\t\t{\tvectorContext.setStyle(st[s]);\n\t\t\t\t\tvectorContext.drawGeometry(geo);\n\t\t\t\t}\n\t\t\t\t// older version\n\t\t\t\telse\n\t\t\t\t{\tvectorContext.setImageStyle(imgs);\n\t\t\t\t\tvectorContext.drawPointGeometry(geo);\n\t\t\t\t}\n\t\t\t\tif (imgs) imgs.setScale(sc);\n\t\t\t}\n\t\t}\n\t\t// Stop animation and restore cluster visibility\n\t\tif (e > 1.0) {\n\t\t\tol.Observable.unByKey(this.listenerKey_);\n\t\t\tthis.overlayLayer_.getSource().addFeatures(features);\n\t\t\tthis.overlayLayer_.changed();\n\t\t\treturn;\n\t\t}\n\t\t// tell OL3 to continue postcompose animation\n\t\tevent.frameState.animate = true;\n\t}\n\t// Start a new postcompose animation\n\tthis.listenerKey_ = this.overlayLayer_.on(['postcompose','postrender'], animate.bind(this));\n\t// Start animation with a ghost feature\n\tvar feature = new ol.Feature(new ol.geom.Point(this.getMap().getView().getCenter()));\n\tfeature.setStyle(new ol.style.Style({ image: new ol.style.Circle({}) }));\n\tthis.overlayLayer_.getSource().addFeature(feature);\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction to snap to guidelines\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @param {olx.interaction.SnapGuidesOptions} \n *\t- pixelTolerance {number | undefined} distance (in px) to snap to a guideline, default 10 px\n *  - enableInitialGuides {bool | undefined} whether to draw initial guidelines based on the maps orientation, default false.\n *\t- style {ol.style.Style | Array<ol.style.Style> | undefined} Style for the sektch features.\n */\nol.interaction.SnapGuides = function(options) {\n\tif (!options) options = {};\n\t// Intersect 2 guides\n\tfunction getIntersectionPoint (d1, d2)\n\t{\tvar d1x = d1[1][0] - d1[0][0];\n\t\tvar d1y = d1[1][1] - d1[0][1];\n\t\tvar d2x = d2[1][0] - d2[0][0];\n\t\tvar d2y = d2[1][1] - d2[0][1];\n\t\tvar det = d1x * d2y - d1y * d2x;\n\t\tif (det != 0)\n\t\t{\tvar k = (d1x * d1[0][1] - d1x * d2[0][1] - d1y * d1[0][0] + d1y * d2[0][0]) / det;\n\t\t\treturn [d2[0][0] + k*d2x, d2[0][1] + k*d2y];\n\t\t}\n\t\telse return false;\n\t}\n\tfunction dist2D (p1,p2)\n\t{\tvar dx = p1[0]-p2[0];\n\t\tvar dy = p1[1]-p2[1];\n\t\treturn Math.sqrt(dx*dx+dy*dy);\n\t}\n\t// Snap distance (in px)\n\tthis.snapDistance_ = options.pixelTolerance || 10;\n\tthis.enableInitialGuides_ = options.enableInitialGuides || false;\n\t// Default style\n\tvar sketchStyle =\n\t[\tnew ol.style.Style({\n\t\t\tstroke: new ol.style.Stroke(\n\t\t\t{\tcolor: '#ffcc33',\n\t\t\t\tlineDash: [8,5],\n\t\t\t\twidth: 1.25\n\t\t\t})\n\t\t})\n\t];\n\t// Custom style\n\tif (options.style) sketchStyle = options.style instanceof Array ? options.style : [options.style];\n\t// Create a new overlay for the sketch\n\tthis.overlaySource_ = new ol.source.Vector(\n\t\t{\tfeatures: new ol.Collection(),\n\t\t\tuseSpatialIndex: false\n\t\t});\n\tthis.overlayLayer_ = new ol.layer.Vector({\n\t\t// render the snap guides as an image to improve performance on rerenders\n\t\trenderMode: 'image',\n\t\tsource: this.overlaySource_,\n\t\t\tstyle: function() {\n\t\t\t\treturn sketchStyle;\n\t\t\t},\n\t\t\tname:'Snap overlay',\n\t\t\tdisplayInLayerSwitcher: false\n\t\t});\n\t// Use snap interaction\n\tol.interaction.Interaction.call(this, {\n\t\thandleEvent: function(e) {\n\t\t\tif (this.getActive()) {\n\t\t\t\tvar features = this.overlaySource_.getFeatures();\n\t\t\t\tvar prev = null;\n\t\t\t\tvar p = null;\n\t\t\t\tvar res = e.frameState.viewState.resolution;\n\t\t\t\tfor (var i=0, f; f = features[i]; i++) {\n\t\t\t\t\tvar c = f.getGeometry().getClosestPoint(e.coordinate);\n\t\t\t\t\tif ( dist2D(c, e.coordinate) / res < this.snapDistance_) {\n\t\t\t\t\t\t// Intersection on 2 lines\n\t\t\t\t\t\tif (prev) {\n\t\t\t\t\t\t\tvar c2 = getIntersectionPoint(prev.getGeometry().getCoordinates(),  f.getGeometry().getCoordinates());\n\t\t\t\t\t\t\tif (c2) {\n\t\t\t\t\t\t\t\tif (dist2D(c2, e.coordinate) / res < this.snapDistance_) {\n\t\t\t\t\t\t\t\t\tp = c2;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tp = c;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tprev = f;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (p) e.coordinate = p;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t});\n};\nol.inherits(ol.interaction.SnapGuides, ol.interaction.Interaction);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.SnapGuides.prototype.setMap = function(map) {\n\tif (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\n\tol.interaction.Interaction.prototype.setMap.call (this, map);\n\tthis.overlayLayer_.setMap(map);\n\tif (map) this.projExtent_ = map.getView().getProjection().getExtent();\n};\n/** Activate or deactivate the interaction.\n* @param {boolean} active\n*/\nol.interaction.SnapGuides.prototype.setActive = function(active)\n{\tthis.overlayLayer_.setVisible(active);\n\tol.interaction.Interaction.prototype.setActive.call (this, active);\n}\n/** Clear previous added guidelines\n* @param {Array<ol.Feature> | undefined} features a list of feature to remove, default remove all feature\n*/\nol.interaction.SnapGuides.prototype.clearGuides = function(features)\n{\tif (!features) this.overlaySource_.clear();\n\telse\n\t{\tfor (var i=0, f; f=features[i]; i++)\n\t\t{\tthis.overlaySource_.removeFeature(f);\n\t\t}\n\t}\n}\n/** Get guidelines\n* @return {ol.Collection} guidelines features\n*/\nol.interaction.SnapGuides.prototype.getGuides = function()\n{\treturn this.overlaySource_.getFeaturesCollection();\n}\n/** Add a new guide to snap to\n* @param {Array<ol.coordinate>} v the direction vector\n* @return {ol.Feature} feature guide\n*/\nol.interaction.SnapGuides.prototype.addGuide = function(v, ortho) {\n\tif (v)\n\t{\tvar map = this.getMap();\n\t\t// Limit extent\n\t\tvar extent = map.getView().calculateExtent(map.getSize());\n\t\tvar guideLength = Math.max(\n\t\t\tthis.projExtent_[2] - this.projExtent_[0],\n\t\t\tthis.projExtent_[3] - this.projExtent_[1]\n\t\t);\n\t\textent = ol.extent.buffer(extent, guideLength * 1.5);\n\t\t//extent = ol.extent.boundingExtent(extent, this.projExtent_);\n\t\tif (extent[0]<this.projExtent_[0]) extent[0]=this.projExtent_[0];\n\t\tif (extent[1]<this.projExtent_[1]) extent[1]=this.projExtent_[1];\n\t\tif (extent[2]>this.projExtent_[2]) extent[2]=this.projExtent_[2];\n\t\tif (extent[3]>this.projExtent_[3]) extent[3]=this.projExtent_[3];\n\t\tvar dx = v[0][0] - v[1][0];\n\t\tvar dy = v[0][1] - v[1][1];\n\t\tvar d = 1 / Math.sqrt(dx*dx+dy*dy);\n\t\tvar generateLine = function(loopDir) {\n\t\t\tvar p, g = [];\n\t\t\tvar loopCond = guideLength*loopDir*2;\n\t\t\tfor (var i=0; loopDir > 0 ? i < loopCond : i > loopCond; i+=(guideLength * loopDir) / 100) {\n\t\t\t\tif (ortho) p = [ v[0][0] + dy*d*i, v[0][1] - dx*d*i];\n\t\t\t\telse p = [ v[0][0] + dx*d*i, v[0][1] + dy*d*i];\n\t\t\t\tif (ol.extent.containsCoordinate(extent, p)) g.push(p);\n\t\t\t\telse break;\n\t\t\t}\n\t\t\treturn new ol.Feature(new ol.geom.LineString([g[0], g[g.length-1]]));\n\t\t}\n\t\tvar f0 = generateLine(1);\n\t\tvar f1 = generateLine(-1);\n\t\tthis.overlaySource_.addFeature(f0);\n\t\tthis.overlaySource_.addFeature(f1);\n\t\treturn [f0, f1];\n\t}\n};\n/** Add a new orthogonal guide to snap to\n* @param {Array<ol.coordinate>} v the direction vector\n* @return {ol.Feature} feature guide\n*/\nol.interaction.SnapGuides.prototype.addOrthoGuide = function(v)\n{\treturn this.addGuide(v, true);\n};\n/** Listen to draw event to add orthogonal guidelines on the first and last point.\n* @param {_ol_interaction_Draw_} drawi a draw interaction to listen to\n* @api\n*/\nol.interaction.SnapGuides.prototype.setDrawInteraction = function(drawi) {\n\tvar self = this;\n\t// Number of points currently drawing\n\tvar nb = 0;\n\t// Current guidelines\n\tvar features = [];\n\tfunction setGuides(e) {\n\t\tvar coord = e.target.getCoordinates();\n\t\tvar s = 2;\n\t\tswitch (e.target.getType()) {\n\t\t\tcase 'Polygon':\n\t\t\t\tcoord = coord[0].slice(0, -1);\n\t\t\t\tbreak;\n\t\t\tdefault: break;\n\t\t}\n\t\tvar l = coord.length;\n\t\tif (l === s && self.enableInitialGuides_) {\n\t\t\tvar x = coord[0][0];\n\t\t\tvar y = coord[0][1];\n\t\t\tcoord = [[x, y], [x, y - 1]];\n\t\t}\n\t\tif (l != nb && (self.enableInitialGuides_ ? l >= s : l > s)) {\n\t\t\tself.clearGuides(features);\n\t\t\tvar p1 = coord[l - s], p2 = coord[l - s - 1];\n\t\t\tif (l > s && !(p1[0] === p2[0] && p1[1] === p2[1])) {\n\t\t\t\tfeatures = self.addOrthoGuide([coord[l - s], coord[l - s - 1]]);\n\t\t\t}\n\t\t\tfeatures = features.concat(self.addGuide([coord[0], coord[1]]));\n\t\t\tfeatures = features.concat(self.addOrthoGuide([coord[0], coord[1]]));\n\t\t\tnb = l;\n\t\t}\n\t}\n\t// New drawing\n\tdrawi.on (\"drawstart\", function(e) {\n\t\t// When geom is changing add a new orthogonal direction \n\t\te.feature.getGeometry().on(\"change\", setGuides);\n\t});\n\t// end drawing / deactivate => clear directions\n\tdrawi.on ([\"drawend\", \"change:active\"], function(e) {\n\t\tself.clearGuides(features);\n\t\tif (e.feature) e.feature.getGeometry().un(\"change\", setGuides);\n\t\tnb = 0;\n\t\tfeatures = [];\n\t});\n};\n/** Listen to modify event to add orthogonal guidelines relative to the currently dragged point\n* @param {_ol_interaction_Modify_} modifyi a modify interaction to listen to\n* @api\n*/\nol.interaction.SnapGuides.prototype.setModifyInteraction = function (modifyi) {\n\tfunction mod(d, n) {\n\t\treturn ((d % n) + n) % n;\n\t}\n\tvar self = this;\n\t// Current guidelines\n\tvar features = [];\n\tfunction computeGuides(e) {\n\t\tvar selectedVertex = e.target.vertexFeature_\n\t\tif (!selectedVertex) return;\n\t\tvar f = e.target.getModifiedFeatures()[0];\n\t\tvar geom = f.getGeometry();\n\t\tvar coord = geom.getCoordinates();\n\t\tswitch (geom.getType()) {\n\t\t\tcase 'Polygon':\n\t\t\t\tcoord = coord[0].slice(0, -1);\n\t\t\t\tbreak;\n\t\t\tdefault: break;\n\t\t}\n\t\tvar modifyVertex = selectedVertex.getGeometry().getCoordinates();\n\t\tvar idx = coord.findIndex(function(c) {\n\t\t\treturn c[0] === modifyVertex[0] && c[1] === modifyVertex[1]\n\t\t});\n\t\tvar l = coord.length;\n\t\tself.clearGuides(features);\n\t\tfeatures = self.addOrthoGuide([coord[mod(idx - 1, l)], coord[mod(idx - 2, l)]]);\n\t\tfeatures = features.concat(self.addGuide([coord[mod(idx - 1, l)], coord[mod(idx - 2, l)]]));\n\t\tfeatures = features.concat(self.addGuide([coord[mod(idx + 1, l)], coord[mod(idx + 2, l)]]));\n\t\tfeatures = features.concat(self.addOrthoGuide([coord[mod(idx + 1, l)], coord[mod(idx + 2, l)]]));\n\t}\n\tfunction setGuides(e) {\n\t\t// This callback is called before ol adds the vertex to the feature, so\n\t\t// defer a moment for openlayers to add the new vertex\n\t\tsetTimeout(computeGuides, 0, e);\n\t}\n\tfunction drawEnd() {\n\t\tself.clearGuides(features);\n\t\tfeatures = [];\n\t}\n\t// New drawing\n\tmodifyi.on(\"modifystart\", setGuides);\n\t// end drawing, clear directions\n\tmodifyi.on(\"modifyend\", drawEnd);\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction split interaction for splitting feature geometry\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires  beforesplit, aftersplit, pointermove\n * @param {olx.interaction.SplitOptions} \n *\t- source {ol.source.Vector|Array{ol.source.Vector}} a list of source to split (configured with useSpatialIndex set to true)\n *\t- features {ol.Collection.<ol.Feature>} collection of feature to split\n *\t- snapDistance {integer} distance (in px) to snap to an object, default 25px\n *\t- cursor {string|undefined} cursor name to display when hovering an objet\n *\t- filter {function|undefined} a filter that takes a feature and return true if it can be clipped, default always split.\n *\t- featureStyle {ol.style.Style | Array<ol.style.Style> | false | undefined} Style for the selected features, choose false if you don't want feature selection. By default the default edit style is used.\n *\t- sketchStyle {ol.style.Style | Array<ol.style.Style> | undefined} Style for the sektch features.\n *\t- tolerance {function|undefined} Distance between the calculated intersection and a vertex on the source geometry below which the existing vertex will be used for the split.  Default is 1e-10.\n */\nol.interaction.Split = function(options)\n{\tif (!options) options = {};\n\tol.interaction.Interaction.call(this,\n\t{\thandleEvent: function(e)\n\t\t{\tswitch (e.type)\n\t\t\t{\tcase \"singleclick\":\n\t\t\t\t\treturn this.handleDownEvent(e);\n\t\t\t\tcase \"pointermove\":\n\t\t\t\t\treturn this.handleMoveEvent(e);\n\t\t\t\tdefault: \n\t\t\t\t\treturn true;\n\t\t\t}\n\t\t\t//return true;\n\t\t}\n\t});\n\t// Snap distance (in px)\n\tthis.snapDistance_ = options.snapDistance || 25;\n\t// Split tolerance between the calculated intersection and the geometry\n\tthis.tolerance_ = options.tolerance || 1e-10;\n\t// Cursor\n\tthis.cursor_ = options.cursor;\n\t// List of source to split\n\tthis.sources_ = options.sources ? (options.sources instanceof Array) ? options.sources:[options.sources] : [];\n\tif (options.features)\n\t{\tthis.sources_.push (new ol.source.Vector({ features: options.features }));\n\t}\n\t// Get all features candidate\n\tthis.filterSplit_ = options.filter || function(){ return true; };\n\t// Default style\n\tvar white = [255, 255, 255, 1];\n\tvar blue = [0, 153, 255, 1];\n\tvar width = 3;\n\tvar fill = new ol.style.Fill({ color: 'rgba(255,255,255,0.4)' });\n\tvar stroke = new ol.style.Stroke({\n\t\tcolor: '#3399CC',\n\t\twidth: 1.25\n\t});\n\tvar sketchStyle =\n\t[\tnew ol.style.Style({\n\t\t\timage: new ol.style.Circle({\n\t\t\t\tfill: fill,\n\t\t\t\tstroke: stroke,\n\t\t\t\tradius: 5\n\t\t\t}),\n\t\t\tfill: fill,\n\t\t\tstroke: stroke\n\t\t})\n\t];\n\tvar featureStyle =\n\t[\tnew ol.style.Style({\n\t\t\tstroke: new ol.style.Stroke({\n\t\t\t\tcolor: white,\n\t\t\t\twidth: width + 2\n\t\t\t})\n\t\t}),\n\t\tnew ol.style.Style({\n\t\t\timage: new ol.style.Circle({\n\t\t\t\tradius: 2*width,\n\t\t\t\tfill: new ol.style.Fill({\n\t\t\t\t\tcolor: blue\n\t\t\t\t}),\n\t\t\t\tstroke: new ol.style.Stroke({\n\t\t\t\t\tcolor: white,\n\t\t\t\t\twidth: width/2\n\t\t\t\t})\n\t\t\t}),\n\t\t\tstroke: new ol.style.Stroke({\n\t\t\t\t\tcolor: blue,\n\t\t\t\t\twidth: width\n\t\t\t\t})\n\t\t}),\n\t];\n\t// Custom style\n\tif (options.sketchStyle) sketchStyle = options.sketchStyle instanceof Array ? options.sketchStyle : [options.sketchStyle];\n\tif (options.featureStyle) featureStyle = options.featureStyle instanceof Array ? options.featureStyle : [options.featureStyle];\n\t// Create a new overlay for the sketch\n\tthis.overlayLayer_ = new ol.layer.Vector(\n\t{\tsource: new ol.source.Vector({\n\t\t\tuseSpatialIndex: false\n\t\t}),\n\t\tname:'Split overlay',\n\t\tdisplayInLayerSwitcher: false,\n\t\tstyle: function(f)\n\t\t{\tif (f._sketch_) return sketchStyle;\n\t\t\telse return featureStyle;\n\t\t}\n\t});\n};\nol.inherits(ol.interaction.Split, ol.interaction.Interaction);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.Split.prototype.setMap = function(map)\n{\tif (this.getMap()) this.getMap().removeLayer(this.overlayLayer_);\n\tol.interaction.Interaction.prototype.setMap.call (this, map);\n\tthis.overlayLayer_.setMap(map);\n};\n/** Get closest feature at pixel\n * @param {ol.Pixel} \n * @return {ol.feature} \n * @private\n */\nol.interaction.Split.prototype.getClosestFeature = function(e)\n{\tvar f, c, g, d = this.snapDistance_+1;\n\tfor (var i=0; i<this.sources_.length; i++)\n\t{\tvar source = this.sources_[i];\n\t\tf = source.getClosestFeatureToCoordinate(e.coordinate);\n\t\tif (f && f.getGeometry().splitAt) \n\t\t{\tc = f.getGeometry().getClosestPoint(e.coordinate);\n\t\t\tg = new ol.geom.LineString([e.coordinate,c]);\n\t\t\td = g.getLength() / e.frameState.viewState.resolution;\n\t\t\tbreak;\n\t\t}\n\t}\n\tif (d > this.snapDistance_) return false;\n\telse \n\t{\t// Snap to node\n\t\tvar coord = this.getNearestCoord (c, f.getGeometry().getCoordinates());\n\t\tvar p = this.getMap().getPixelFromCoordinate(coord);\n\t\tif (ol.coordinate.dist2d(e.pixel, p) < this.snapDistance_)\n\t\t{\tc = coord;\n\t\t}\n\t\t//\n\t\treturn { source:source, feature:f, coord: c, link: g };\n\t}\n}\n/** Get nearest coordinate in a list \n* @param {ol.coordinate} pt the point to find nearest\n* @param {Array<ol.coordinate>} coords list of coordinates\n* @return {ol.coordinate} the nearest coordinate in the list\n*/\nol.interaction.Split.prototype.getNearestCoord = function(pt, coords)\n{\tvar d, dm=Number.MAX_VALUE, p0;\n\tfor (var i=0; i < coords.length; i++)\n\t{\td = ol.coordinate.dist2d (pt, coords[i]);\n\t\tif (d < dm)\n\t\t{\tdm = d;\n\t\t\tp0 = coords[i];\n\t\t}\n\t}\n\treturn p0;\n};\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `true` to start the drag sequence.\n */\nol.interaction.Split.prototype.handleDownEvent = function(evt)\n{\t// Something to split ?\n\tvar current = this.getClosestFeature(evt);\n\tif (current)\n\t{\tvar self = this;\n\t\tself.overlayLayer_.getSource().clear();\n\t\tvar split = current.feature.getGeometry().splitAt(current.coord, this.tolerance_);\n\t\tvar i;\n\t\tif (split.length > 1)\n\t\t{\tvar tosplit = [];\n\t\t\tfor (i=0; i<split.length; i++)\n\t\t\t{\tvar f = current.feature.clone();\n\t\t\t\tf.setGeometry(split[i]);\n\t\t\t\ttosplit.push(f);\n\t\t\t}\n\t\t\tself.dispatchEvent({ type:'beforesplit', original: current.feature, features: tosplit });\n\t\t\tcurrent.source.dispatchEvent({ type:'beforesplit', original: current.feature, features: tosplit });\n\t\t\tcurrent.source.removeFeature(current.feature);\n\t\t\tfor (i=0; i<tosplit.length; i++)\n\t\t\t{\tcurrent.source.addFeature(tosplit[i]);\n\t\t\t}\n\t\t\tself.dispatchEvent({ type:'aftersplit', original: current.feature, features: tosplit });\n\t\t\tcurrent.source.dispatchEvent({ type:'aftersplit', original: current.feature, features: tosplit });\n\t\t}\n\t}\n\treturn false;\n};\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n */\nol.interaction.Split.prototype.handleMoveEvent = function(e)\n{\tvar map = e.map;\n\tthis.overlayLayer_.getSource().clear();\n\tvar current = this.getClosestFeature(e);\n\tif (current && this.filterSplit_(current.feature)) {\n\t\tvar p, l;\n\t\t// Draw sketch\n\t\tthis.overlayLayer_.getSource().addFeature(current.feature);\n\t\tp = new ol.Feature(new ol.geom.Point(current.coord));\n\t\tp._sketch_ = true;\n\t\tthis.overlayLayer_.getSource().addFeature(p);\n\t\t//\n\t\tl = new ol.Feature(current.link);\n\t\tl._sketch_ = true;\n\t\tthis.overlayLayer_.getSource().addFeature(l);\n\t\t// move event\n\t\tthis.dispatchEvent({\n\t\t\ttype: 'pointermove',\n\t\t\tcoordinate: e.coordinate,\n\t\t\tframeState: e.frameState,\n\t\t\toriginalEvent: e.originalEvent,\n\t\t\tmap: e.map,\n\t\t\tpixel: e.pixel,\n\t\t\tfeature: current.feature,\n\t\t\tlinkGeometry: current.link\n\t\t});\n\t} else {\n\t\tthis.dispatchEvent(e);\n\t}\n\tvar element = map.getTargetElement();\n\tif (this.cursor_) \n\t{\tif (current) \n\t\t{\tif (element.style.cursor != this.cursor_) \n\t\t\t{\tthis.previousCursor_ = element.style.cursor;\n\t\t\t\telement.style.cursor = this.cursor_;\n\t\t\t}\n\t\t} \n\t\telse if (this.previousCursor_ !== undefined) \n\t\t{\telement.style.cursor = this.previousCursor_;\n\t\t\tthis.previousCursor_ = undefined;\n\t\t}\n\t}\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\n/** Interaction splitter: acts as a split feature agent while editing vector features (LineString).\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires  beforesplit, aftersplit\n * @param {olx.interaction.SplitOptions} \n *\t- source {ol.source.Vector|Array{ol.source.Vector}} The target source (or array of source) with features to be split (configured with useSpatialIndex set to true)\n *\t- triggerSource {ol.source.Vector} Any newly created or modified features from this source will be used to split features on the target source. If none is provided the target source is used instead.\n *\t- features {ol.Collection.<ol.Feature>} A collection of feature to be split (replace source target).\n *\t- triggerFeatures {ol.Collection.<ol.Feature>} Any newly created or modified features from this collection will be used to split features on the target source (replace triggerSource).\n *\t- filter {function|undefined} a filter that takes a feature and return true if the feature is eligible for splitting, default always split.\n *\t- tolerance {function|undefined} Distance between the calculated intersection and a vertex on the source geometry below which the existing vertex will be used for the split. Default is 1e-10.\n * @todo verify auto intersection on features that split.\n */\nol.interaction.Splitter = function(options)\n{\tif (!options) options = {};\n\tol.interaction.Interaction.call(this,\n\t{\thandleEvent: function(e)\n\t\t\t{\t// Hack to get only one changeFeature when draging with ol.interaction.Modify on.\n\t\t\t\tif (e.type != \"pointermove\" && e.type != \"pointerdrag\")\n\t\t\t\t{\tif (this.lastEvent_)\n\t\t\t\t\t{\tthis.splitSource(this.lastEvent_.feature);\n\t\t\t\t\t\tthis.lastEvent_ = null;\n\t\t\t\t\t}\n\t\t\t\t\tthis.moving_ = false;\n\t\t\t\t}\n\t\t\t\telse this.moving_ = true;\n\t\t\t\treturn true; \n\t\t\t},\n\t});\n\t// Features added / remove\n\tthis.added_ = [];\n\tthis.removed_ = [];\n\t// Source to split\n\tif (options.features)\n\t{\tthis.source_ = new ol.source.Vector({ features: options.features });\n\t}\n\telse \n\t{\tthis.source_ = options.source ? options.source : new ol.source.Vector({ features: new ol.Collection() });\n\t}\n\tvar trigger = this.triggerSource;\n\tif (options.triggerFeatures)\n\t{\ttrigger = new ol.source.Vector({ features: options.triggerFeatures });\n\t}\n\tif (trigger)\n\t{\ttrigger.on(\"addfeature\", this.onAddFeature.bind(this));\n\t\ttrigger.on(\"changefeature\", this.onChangeFeature.bind(this));\n\t\ttrigger.on(\"removefeature\", this.onRemoveFeature.bind(this));\n\t}\n\telse\n\t{\tthis.source_.on(\"addfeature\", this.onAddFeature.bind(this));\n\t\tthis.source_.on(\"changefeature\", this.onChangeFeature.bind(this));\n\t\tthis.source_.on(\"removefeature\", this.onRemoveFeature.bind(this));\n\t}\n\t// Split tolerance between the calculated intersection and the geometry\n\tthis.tolerance_ = options.tolerance || 1e-10;\n\t// Get all features candidate\n\tthis.filterSplit_ = options.filter || function(){ return true; };\n};\nol.inherits(ol.interaction.Splitter, ol.interaction.Interaction);\n/** Calculate intersection on 2 segs\n* @param {Array<_ol_coordinate_>} s1 first seg to intersect (2 points)\n* @param {Array<_ol_coordinate_>} s2 second seg to intersect (2 points)\n* @return { boolean | _ol_coordinate_ } intersection point or false no intersection\n*/\nol.interaction.Splitter.prototype.intersectSegs = function(s1,s2)\n{\tvar tol = this.tolerance_;\n\t// Solve\n\tvar x12 = s1[0][0] - s1[1][0];\n\tvar x34 = s2[0][0] - s2[1][0];\n\tvar y12 = s1[0][1] - s1[1][1];\n\tvar y34 = s2[0][1] - s2[1][1];\n\tvar det = x12 * y34 - y12 * x34;\n\t// No intersection\n\tif (Math.abs(det) < tol)\n\t{\treturn false;\n\t}\n\telse\n\t{\t// Outside segement\n\t\tvar r1 = ((s1[0][0] - s2[1][0])*y34 - (s1[0][1] - s2[1][1])*x34) / det;\n\t\tif (Math.abs(r1)<tol) return s1[0];\n\t\tif (Math.abs(1-r1)<tol) return s1[1];\n\t\tif (r1<0 || r1>1) return false;\n\t\tvar r2 = ((s1[0][1] - s2[1][1])*x12 - (s1[0][0] - s2[1][0])*y12) / det;\n\t\tif (Math.abs(r2)<tol) return s2[1];\n\t\tif (Math.abs(1-r2)<tol) return s2[0];\n\t\tif (r2<0 || r2>1) return false;\n\t\t// Intersection\n\t\tvar a = s1[0][0] * s1[1][1] - s1[0][1] * s1[1][0];\n\t\tvar b = s2[0][0] * s2[1][1] - s2[0][1] * s2[1][0];\n\t\tvar p = [(a * x34 - b * x12) / det, (a * y34 - b * y12) / det];\n\t\t// Test start / end\n/*\nconsole.log(\"r1: \"+r1)\nconsole.log(\"r2: \"+r2)\nconsole.log (\"s10: \"+(_ol_coordinate_.dist2d(p,s1[0])<tol)) ;\nconsole.log (\"s11: \"+(_ol_coordinate_.dist2d(p,s1[1])<tol)) ;\nconsole.log (\"s20: \"+(_ol_coordinate_.dist2d(p,s2[0])<tol)) ;\nconsole.log (\"s21: \"+(_ol_coordinate_.dist2d(p,s2[1])<tol)) ;\n*/\n\t\treturn p;\n\t}\n};\n/** Split the source using a feature\n* @param {ol.Feature} feature The feature to use to split.\n*/\nol.interaction.Splitter.prototype.splitSource = function(feature)\n{\t// Allready perform a split\n\tif (this.splitting) return;\n\tvar self = this;\n\tvar i, k, f2;\n\t// Start splitting\n\tthis.source_.dispatchEvent({ type:'beforesplit', feaure: feature, source: this.source_ });\n\tthis.splitting = true;\n\tthis.added_ = [];\n\tthis.removed_ = [];\n\tvar c = feature.getGeometry().getCoordinates();\n\tvar seg, split = [];\n\tfunction intersect (f)\n\t{\tif (f !== feature)\n\t\t{\tvar c2 = f.getGeometry().getCoordinates();\n\t\t\tfor (var j=0; j<c2.length-1; j++)\n\t\t\t{\tvar p = this.intersectSegs (seg, [c2[j],c2[j+1]]);\n\t\t\t\tif (p)\n\t\t\t\t{\tsplit.push(p);\n\t\t\t\t\tg = f.getGeometry().splitAt(p, this.tolerance_);\n\t\t\t\t\tif (g && g.length>1)\n\t\t\t\t\t{\tfound = f;\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\t// Split existing features\n\tfor (i=0; i<c.length-1; i++)\n\t{\tseg = [c[i],c[i+1]];\n\t\tvar extent = ol.extent.buffer(ol.extent.boundingExtent(seg), this.tolerance_ /*0.01*/ );\n\t\tvar g;\n\t\twhile (true)\n\t\t{\tvar found = false;\n\t\t\tthis.source_.forEachFeatureIntersectingExtent(extent, intersect.bind(this));\n\t\t\t// Split feature\n\t\t\tif (found)\n\t\t\t{\tvar f = found;\n\t\t\t\tthis.source_.removeFeature(f);\n\t\t\t\tfor (k=0; k<g.length; k++)\n\t\t\t\t{\tf2 = f.clone();\n\t\t\t\t\tf2.setGeometry(g[k]);\n\t\t\t\t\tthis.source_.addFeature(f2);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse break;\n\t\t}\n\t}\n\t// Auto intersect\n\tfor (i=0; i<c.length-2; i++)\n\t{\tfor (var j=i+1; j<c.length-1; j++)\n\t\t{\tvar p = this.intersectSegs ([c[i],c[i+1]], [c[j],c[j+1]]);\n\t\t\tif (p && p!=c[i+1])\n\t\t\t{\tsplit.push(p);\n\t\t\t}\n\t\t}\n\t}\n\t// Split original\n\tvar splitOriginal = false;\n\tif (split.length)\n\t{\tvar result = feature.getGeometry().splitAt(split, this.tolerance_);\n\t\tif (result.length>1)\n\t\t{\tfor (k=0; k<result.length; k++)\n\t\t\t{\tf2 = feature.clone();\n\t\t\t\tf2.setGeometry(result[k]);\n\t\t\t\tthis.source_.addFeature(f2);\n\t\t\t}\n\t\t\tsplitOriginal = true;\n\t\t}\n\t}\n\t// If the interaction is inserted after modify interaction, the objet is not consistant \n\t// > wait end of other interactions\n\tsetTimeout (function()\n\t{\tif (splitOriginal) self.source_.removeFeature(feature);\n\t\tself.source_.dispatchEvent({ type:'aftersplit', featureAdded: self.added_, featureRemoved: self.removed_, source: this.source_ });\n\t\t// Finish\n\t\tself.splitting = false;\n\t},0);\n};\n/** New feature source is added \n*/\nol.interaction.Splitter.prototype.onAddFeature = function(e)\n{\tthis.splitSource(e.feature);\n\tif (this.splitting) \n\t{\tthis.added_.push(e.feature);\n\t}\n\t/*\n\tif (this.splitting) return;\n\tvar self = this;\n\tsetTimeout (function() { self.splitSource(e.feature); }, 0);\n\t*/\n};\n/** Feature source is removed > count features added/removed\n*/\nol.interaction.Splitter.prototype.onRemoveFeature = function(e)\n{\tif (this.splitting) \n\t{\tvar n = this.added_.indexOf(e.feature);\n\t\tif (n==-1)\n\t\t{\tthis.removed_.push(e.feature);\n\t\t}\n\t\telse\n\t\t{\tthis.added_.splice(n,1);\n\t\t}\n\t}\n};\n/** Feature source is changing \n*/\nol.interaction.Splitter.prototype.onChangeFeature = function(e)\n{\tif (this.moving_) \n\t{\tthis.lastEvent_ = e;\n\t}\n\telse this.splitSource(e.feature);\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction synchronize\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @param {olx.interaction.SynchronizeOptions} \n *  - maps {Array<ol.Map>} An array of maps to synchronize with the map of the interaction\n */\nol.interaction.Synchronize = function(options)\n{\tif (!options) options={};\n\tvar self = this;\n\tol.interaction.Interaction.call(this,\n\t\t{\thandleEvent: function(e)\n\t\t\t\t{\tif (e.type==\"pointermove\") { self.handleMove_(e); }\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t});\n\tthis.maps = options.maps;\n};\nol.inherits(ol.interaction.Synchronize, ol.interaction.Interaction);\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.Synchronize.prototype.setMap = function(map)\n{\n\tif (this._listener) {\n\t\tol.Observable.unByKey(this._listener.center);\n\t\tol.Observable.unByKey(this._listener.rotation);\n\t\tol.Observable.unByKey(this._listener.resolution);\n\t\tthis.getMap().getTargetElement().removeEventListener('mouseout', this._listener.mouseout);\n\t}\n\tthis._listener = null;\n\tol.interaction.Interaction.prototype.setMap.call (this, map);\n\tif (map) {\n\t\tthis._listener = {};\n\t\tthis._listener.center = this.getMap().getView().on('change:center', this.syncMaps.bind(this));\n\t\tthis._listener.rotation = this.getMap().getView().on('change:rotation', this.syncMaps.bind(this));\n\t\tthis._listener.resolution = this.getMap().getView().on('change:resolution', this.syncMaps.bind(this));\n\t\tthis._listener.mouseout = this.handleMouseOut_.bind(this);\n\t\tthis.getMap().getTargetElement().addEventListener('mouseout', this._listener.mouseout);\n\t\tthis.syncMaps();\n\t}\n};\n/** Synchronize the maps\n*/\nol.interaction.Synchronize.prototype.syncMaps = function(e)\n{\tvar map = this.getMap();\n\tif (!e) e = { type:'all' };\n\tif (map)\n\t{\tfor (var i=0; i<this.maps.length; i++)\n\t\t{\tswitch (e.type)\n\t\t\t{\tcase 'change:rotation':\n\t\t\t\t\tif (this.maps[i].getView().getRotation() != map.getView().getRotation())\n\t\t\t\t\t\tthis.maps[i].getView().setRotation(map.getView().getRotation()); \n\t\t\t\t\tbreak;\n\t\t\t\tcase 'change:center':\n\t\t\t\t\tif (this.maps[i].getView().getCenter() != map.getView().getCenter())\n\t\t\t\t\t\tthis.maps[i].getView().setCenter(map.getView().getCenter()); \n\t\t\t\t\tbreak;\n\t\t\t\tcase 'change:resolution':\n\t\t\t\t\tif (this.maps[i].getView().getResolution() != map.getView().getResolution())\n\t\t\t\t\t{\t/* old version prior to 1.19.1\n\t\t\t\t\t\tthis.maps[i].beforeRender ( ol.animation.zoom(\n\t\t\t\t\t\t\t{\tduration: 250,\n\t\t\t\t\t\t\t\tresolution: this.maps[i].getView().getResolution()\n\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t*/\n\t\t\t\t\t\tthis.maps[i].getView().setResolution(map.getView().getResolution());\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis.maps[i].getView().setRotation(map.getView().getRotation());\n\t\t\t\t\tthis.maps[i].getView().setCenter(map.getView().getCenter());\n\t\t\t\t\tthis.maps[i].getView().setResolution(map.getView().getResolution());\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n};\n/** Cursor move > tells other maps to show the cursor\n* @param {ol.event} e \"move\" event\n*/\nol.interaction.Synchronize.prototype.handleMove_ = function(e)\n{\tfor (var i=0; i<this.maps.length; i++)\n\t{\tthis.maps[i].showTarget(e.coordinate);\n\t}\n\tthis.getMap().showTarget();\n};\n/** Cursor out of map > tells other maps to hide the cursor\n* @param {event} e \"mouseOut\" event\n*/\nol.interaction.Synchronize.prototype.handleMouseOut_ = function(/*e*/) {\n\tfor (var i=0; i<this.maps.length; i++) {\n\t\tthis.maps[i].targetOverlay_.setPosition(undefined);\n\t}\n};\n/** Show a target overlay at coord\n* @param {ol.coordinate} coord\n*/\nol.Map.prototype.showTarget = function(coord)\n{\tif (!this.targetOverlay_)\n\t{\tvar elt = document.createElement(\"div\");\n\t\t\t\telt.classList.add(\"ol-target\");\n\t\tthis.targetOverlay_ = new ol.Overlay({ element: elt });\n\t\tthis.targetOverlay_.setPositioning('center-center');\n\t\tthis.addOverlay(this.targetOverlay_);\n\t\telt.parentElement.classList.add(\"ol-target-overlay\");\n\t\t// hack to render targetOverlay before positioning it\n\t\tthis.targetOverlay_.setPosition([0,0]);\n\t}\n\tthis.targetOverlay_.setPosition(coord);\n};\n/** Hide the target overlay\n*/\nol.Map.prototype.hideTarget = function()\n{\n\tthis.removeOverlay(this.targetOverlay_);\n\tthis.targetOverlay_ = undefined;\n};\n\n/*\t\n\tTinker Bell effect on maps.\n\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n\t@link https://github.com/Viglino\n */\n/**\n * @constructor\n * @extends {ol.interaction.Pointer}\n *\t@param {ol.interaction.TinkerBell.options}  options flashlight param\n *\t\t- color {ol.color} color of the sparkles\n */\nol.interaction.TinkerBell = function(options)\n{\toptions = options || {};\n\tol.interaction.Pointer.call(this,\n\t{\thandleDownEvent: this.onMove,\n\t\thandleMoveEvent: this.onMove\n\t});\n\tthis.set('color', options.color ? ol.color.asString(options.color) : \"#fff\");\n\tthis.sparkle = [0,0];\n\tthis.sparkles = [];\n\tthis.lastSparkle = this.time = new Date();\n\tvar self = this;\n\tthis.out_ = function() { self.isout_=true; };\n\tthis.isout_ = true;\n};\nol.inherits(ol.interaction.TinkerBell, ol.interaction.Pointer);\n/** Set the map > start postcompose\n*/\nol.interaction.TinkerBell.prototype.setMap = function(map) {\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tif (this.getMap()) {\n\t\tmap.getViewport().removeEventListener('mouseout', this.out_, false);\n\t\tthis.getMap().render();\n\t}\n\tol.interaction.Pointer.prototype.setMap.call(this, map);\n\tif (map) {\n\t\tthis._listener = map.on('postcompose', this.postcompose_.bind(this));\n\t\tmap.getViewport().addEventListener('mouseout', this.out_, false);\n\t}\n};\nol.interaction.TinkerBell.prototype.onMove = function(e)\n{\tthis.sparkle = e.pixel;\n\tthis.isout_ = false;\n\tthis.getMap().render();\n};\n/** Postcompose function\n*/\nol.interaction.TinkerBell.prototype.postcompose_ = function(e)\n{\tvar delta = 15;\n\tvar ctx = e.context;\n\tvar dt = e.frameState.time - this.time;\n\tthis.time = e.frameState.time;\n\tif (e.frameState.time-this.lastSparkle > 30 && !this.isout_)\n\t{\tthis.lastSparkle = e.frameState.time;\n\t\tthis.sparkles.push({ p:[this.sparkle[0]+Math.random()*delta-delta/2, this.sparkle[1]+Math.random()*delta], o:1 });\n\t}\n\tctx.save();\n\t\tctx.scale(e.frameState.pixelRatio,e.frameState.pixelRatio);\n\t\tctx.fillStyle = this.get(\"color\");\n\t\tfor (var i=this.sparkles.length-1, p; p=this.sparkles[i]; i--)\n\t\t{\tif (p.o < 0.2) \n\t\t\t{\tthis.sparkles.splice(0,i+1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tctx.globalAlpha = p.o;\n\t\t\tctx.beginPath();\n\t\t\tctx.arc (p.p[0], p.p[1], 2.2, 0, 2 * Math.PI, false);\n\t\t\tctx.fill();\n\t\t\tp.o *= 0.98;\n\t\t\tp.p[0] += (Math.random()-0.5);\n\t\t\tp.p[1] += dt*(1+Math.random())/30;\n\t\t}\n\tctx.restore();\n\t// tell OL3 to continue postcompose animation\n\tif (this.sparkles.length) this.getMap().render(); \n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Interaction splitter: acts as a split feature agent while editing vector features (LineString).\n * @constructor\n * @extends {ol.interaction.Pointer}\n * @param {olx.interaction.TouchCompass} \n *\t- onDrag {function|undefined} Function handling \"drag\" events. It provides a dpixel and a traction (in projection) vector form the center of the compas\n *\t- size {Number} size of the compass in px, default 80\n *\t- alpha {Number} opacity of the compass, default 0.5\n */\nol.interaction.TouchCompass = function(options) {\n\toptions = options||{};\n\tvar opt = {};\n\t// Click on the compass\n\topt.handleDownEvent = function(e)\n\t{\tvar s = this.getCenter_();\n\t\tvar dx = e.pixel[0]-s[0];\n\t\tvar dy = e.pixel[1]-s[1];\n\t\tthis.start = e;\n\t\treturn (Math.sqrt(dx*dx+dy*dy) < this.size/2);\n\t};\n\t// Pn drag\n\topt.handleDragEvent = function(e)\n\t{\tif (!this.pos) \n\t\t{\tthis.pos = this.start;\n\t\t\tthis.getMap().renderSync();\n\t\t}\n\t\tthis.pos = e;\n\t};\n\t// Stop drag\n\topt.handleUpEvent = function()\n\t{\tthis.pos = false;\n\t\treturn true;\n\t};\n\tol.interaction.Pointer.call(this, opt);\n\tthis.ondrag_ = options.onDrag;\n\tthis.size = options.size || 80;\n\tthis.alpha = options.alpha || 0.5;\n\tif (!ol.interaction.TouchCompass.prototype.compass)\n\t{\tvar canvas = ol.interaction.TouchCompass.prototype.compass = document.createElement('canvas');\n\t\tvar ctx = canvas.getContext(\"2d\");\n\t\tvar s = canvas.width = canvas.height = this.size;\n\t\tvar w = s/10;\n\t\tvar r = s/2;\n\t\tvar r2 = 0.22*r;\n\t\tctx.translate(r,r);\n\t\tctx.fillStyle = \"#999\";\n\t\tctx.strokeStyle = \"#ccc\";\n\t\tctx.lineWidth = w;\n\t\tctx.beginPath();\n\t\tctx.arc (0,0, s*0.42, 0, 2*Math.PI);\n\t\tctx.fill();\n\t\tctx.stroke();\n\t\tctx.fillStyle = \"#99f\";\n\t\tctx.beginPath();\n\t\tctx.moveTo (0,0); \n\t\tctx.lineTo (r,0); ctx.lineTo (r2,r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (-r,0); ctx.lineTo (-r2,-r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (0,r); ctx.lineTo (-r2,r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (0,-r); ctx.lineTo (r2,-r2); ctx.moveTo (0,0);\n\t\tctx.fill();\n\t\tctx.fillStyle = \"#eee\";\n\t\tctx.beginPath();\n\t\tctx.moveTo (0,0); \n\t\tctx.lineTo (r,0); ctx.lineTo (r2,-r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (-r,0); ctx.lineTo (-r2,r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (0,r); ctx.lineTo (r2,r2); ctx.moveTo (0,0);\n\t\tctx.lineTo (0,-r); ctx.lineTo (-r2,-r2); ctx.moveTo (0,0);\n\t\tctx.fill();\n\t}\n};\nol.inherits(ol.interaction.TouchCompass, ol.interaction.Pointer);\n/** Compass Image as a JS Image object\n* @api\n*/\nol.interaction.TouchCompass.prototype.compass = null;\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {_ol_Map_} map Map.\n * @api stable\n */\nol.interaction.TouchCompass.prototype.setMap = function(map) {\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.interaction.Pointer.prototype.setMap.call (this, map);\n\tif (map) {\n\t\tthis._listener = map.on('postcompose', this.drawCompass_.bind(this));\n\t}\n};\n/**\n * Activate or deactivate the interaction.\n * @param {boolean} active Active.\n * @observable\n * @api\n */\nol.interaction.TouchCompass.prototype.setActive = function(b)\n{\tol.interaction.Pointer.prototype.setActive.call (this, b);\n\tif (this.getMap()) this.getMap().renderSync();\n}\n/**\n * Get the center of the compass\n * @param {_ol_coordinate_}\n * @private\n */\nol.interaction.TouchCompass.prototype.getCenter_ = function()\n{\tvar margin = 10;\n\tvar s = this.size;\n\tvar c = this.getMap().getSize(); \n\treturn [c[0]/2, c[1]-margin-s/2];\n}\n/**\n * Draw the compass on post compose\n * @private\n */\nol.interaction.TouchCompass.prototype.drawCompass_ = function(e)\n{\tif (!this.getActive()) return;\n\tvar ctx = e.context;\n\tvar ratio = e.frameState.pixelRatio;\n\tctx.save();\n\tctx.scale(ratio,ratio);\n\tctx.globalAlpha = this.alpha;\n\tctx.strokeStyle = \"#fff\";\n\tctx.lineWidth = 5;\n\tvar s = this.size;\n\tvar c = this.getCenter_();\n\tctx.drawImage(this.compass, 0,0,this.compass.width,this.compass.height, c[0]-s/2, c[1]-s/2, s,s);\n\tif (this.pos)\n\t{\tvar dx = this.pos.pixel[0]-this.start.pixel[0];\n\t\tvar dy = this.pos.pixel[1]-this.start.pixel[1];\n\t\tfor (var i=1; i<=4; i++)\n\t\t{\tctx.beginPath();\n\t\t\tctx.arc (c[0] +dx/4*i, c[1] +dy/4*i, s/2*(0.6+0.4*i/4), 0, 2*Math.PI);\n\t\t\tctx.stroke();\n\t\t}\n\t}\n\tctx.restore();\n\tif (this.pos)\n\t{\t// Get delta\n\t\tif (this.ondrag_) \n\t\t{\tvar r = this.getMap().getView().getResolution();\n\t\t\tvar delta = \n\t\t\t\t{\tdpixel: [ this.pos.pixel[0] - this.start.pixel[0], this.pos.pixel[1] - this.start.pixel[1] ]\n\t\t\t\t}\n\t\t\tdelta.traction = [ delta.dpixel[0]*r, -delta.dpixel[1]*r];\n\t\t\tthis.ondrag_(delta, this.pos);\n\t\t}\n\t\t// Continue animation\n\t\te.frameState.animate = true;\n\t}\n};\n\n/** Interaction rotate\n * @constructor\n * @extends {ol.interaction.Pointer}\n * @fires select | rotatestart | rotating | rotateend | translatestart | translating | translateend | scalestart | scaling | scaleend\n * @param {any} options\n *  @param {function} options.filter A function that takes a Feature and a Layer and returns true if the feature may be transformed or false otherwise. \n *  @param {Array<ol.Layer>} options.layers array of layers to transform,\n *  @param {ol.Collection<ol.Feature>} options.features collection of feature to transform,\n *\t@param {ol.EventsConditionType|undefined} options.addCondition A function that takes an ol.MapBrowserEvent and returns a boolean to indicate whether that event should be handled. default: ol.events.condition.never.\n *\t@param {number | undefined} options.hitTolerance Tolerance to select feature in pixel, default 0\n *\t@param {bool} options.translateFeature Translate when click on feature\n *\t@param {bool} options.translate Can translate the feature\n *\t@param {bool} options.stretch can stretch the feature\n *\t@param {bool} options.scale can scale the feature\n *\t@param {bool} options.rotate can rotate the feature\n *\t@param {bool} options.noFlip prevent the feature geometry to flip, default false\n *\t@param {bool} options.selection the intraction handle selection/deselection, if not use the select prototype to add features to transform, default true\n *\t@param {ol.events.ConditionType | undefined} options.keepAspectRatio A function that takes an ol.MapBrowserEvent and returns a boolean to keep aspect ratio, default ol.events.condition.shiftKeyOnly.\n *\t@param {ol.events.ConditionType | undefined} options.modifyCenter A function that takes an ol.MapBrowserEvent and returns a boolean to apply scale & strech from the center, default ol.events.condition.metaKey or ol.events.condition.ctrlKey.\n *\t@param {} options.style list of ol.style for handles\n *\n */\nol.interaction.Transform = function(options) {\n  if (!options) options = {};\n\tvar self = this;\n\t// Create a new overlay layer for the sketch\n\tthis.handles_ = new ol.Collection();\n\tthis.overlayLayer_ = new ol.layer.Vector({\n    source: new ol.source.Vector({\n      features: this.handles_,\n      useSpatialIndex: false,\n      wrapX: false // For vector editing across the -180 and 180 meridians to work properly, this should be set to false\n    }),\n    name:'Transform overlay',\n    displayInLayerSwitcher: false,\n    // Return the style according to the handle type\n    style: function (feature) {\n      return (self.style[(feature.get('handle')||'default')+(feature.get('constraint')||'')+(feature.get('option')||'')]);\n    }, \n  });\n  // Extend pointer\n  ol.interaction.Pointer.call(this, {\n    handleDownEvent: this.handleDownEvent_,\n    handleDragEvent: this.handleDragEvent_,\n    handleMoveEvent: this.handleMoveEvent_,\n    handleUpEvent: this.handleUpEvent_\n  });\n  // Collection of feature to transform\n  this.features_ = options.features;\n  // Filter or list of layers to transform \n  if (typeof(options.filter)==='function') this._filter = options.filter;\n  this.layers_ = options.layers ? (options.layers instanceof Array) ? options.layers:[options.layers] : null;\n  this.addFn_ = options.addCondition || function() { return false; };\n  /* Translate when click on feature */\n  this.set('translateFeature', (options.translateFeature!==false));\n  /* Can translate the feature */\n  this.set('translate', (options.translate!==false));\n  /* Can stretch the feature */\n  this.set('stretch', (options.stretch!==false));\n  /* Can scale the feature */\n  this.set('scale', (options.scale!==false));\n  /* Can rotate the feature */\n  this.set('rotate', (options.rotate!==false));\n  /* Keep aspect ratio */\n  this.set('keepAspectRatio', (options.keepAspectRatio || function(e){ return e.originalEvent.shiftKey }));\n  /* Modify center */\n  this.set('modifyCenter', (options.modifyCenter || function(e){ return e.originalEvent.metaKey || e.originalEvent.ctrlKey }));\n  /* Prevent flip */\n  this.set('noFlip', (options.noFlip || false));\n  /* Handle selection */\n  this.set('selection', (options.selection !== false));\n  /*  */\n  this.set('hitTolerance', (options.hitTolerance || 0));\n  this.selection_ = [];\n  // Force redraw when changed\n  this.on ('propertychange', function() {\n    this.drawSketch_();\n  });\n  // setstyle\n  this.setDefaultStyle();\n};\nol.inherits(ol.interaction.Transform, ol.interaction.Pointer);\n/** Cursors for transform\n*/\nol.interaction.Transform.prototype.Cursors = {\n  'default': 'auto',\n  'select': 'pointer',\n  'translate': 'move',\n  'rotate': 'move',\n  'rotate0': 'move',\n  'scale': 'nesw-resize',\n  'scale1': 'nwse-resize',\n  'scale2': 'nesw-resize',\n  'scale3': 'nwse-resize',\n  'scalev': 'ew-resize',\n  'scaleh1': 'ns-resize',\n  'scalev2': 'ew-resize',\n  'scaleh3': 'ns-resize'\n};\n/**\n * Remove the interaction from its current map, if any,  and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.Transform.prototype.setMap = function(map) {\n  if (this.getMap()) {\n    this.getMap().removeLayer(this.overlayLayer_);\n    if (this.previousCursor_) {\n      this.getMap().getTargetElement().style.cursor = this.previousCursor_;\n      this.previousCursor_ = undefined;\n    }\n  }\n  ol.interaction.Pointer.prototype.setMap.call (this, map);\n  this.overlayLayer_.setMap(map);\n  if (map !== null) {\n    this.isTouch = /touch/.test(map.getViewport().className);\n    this.setDefaultStyle();\n  }\n};\n/**\n * Activate/deactivate interaction\n * @param {bool}\n * @api stable\n */\nol.interaction.Transform.prototype.setActive = function(b) {\n  this.select(null);\n  this.overlayLayer_.setVisible(b);\n  ol.interaction.Pointer.prototype.setActive.call (this, b);\n};\n/** Set efault sketch style\n*/\nol.interaction.Transform.prototype.setDefaultStyle = function() {\n  // Style\n  var stroke = new ol.style.Stroke({ color: [255,0,0,1], width: 1 });\n  var strokedash = new ol.style.Stroke({ color: [255,0,0,1], width: 1, lineDash:[4,4] });\n  var fill0 = new ol.style.Fill({ color:[255,0,0,0.01] });\n  var fill = new ol.style.Fill({ color:[255,255,255,0.8] });\n  var circle = new ol.style.RegularShape({\n      fill: fill,\n      stroke: stroke,\n      radius: this.isTouch ? 12 : 6,\n      points: 15\n    });\n  circle.getAnchor()[0] = this.isTouch ? -10 : -5;\n  var bigpt = new ol.style.RegularShape({\n      fill: fill,\n      stroke: stroke,\n      radius: this.isTouch ? 16 : 8,\n      points: 4,\n      angle: Math.PI/4\n    });\n  var smallpt = new ol.style.RegularShape({\n      fill: fill,\n      stroke: stroke,\n      radius: this.isTouch ? 12 : 6,\n      points: 4,\n      angle: Math.PI/4\n    });\n  function createStyle (img, stroke, fill) {\n    return [ new ol.style.Style({image:img, stroke:stroke, fill:fill}) ];\n  }\n  /** Style for handles */\n  this.style = {\n    'default': createStyle (bigpt, strokedash, fill0),\n    'translate': createStyle (bigpt, stroke, fill),\n    'rotate': createStyle (circle, stroke, fill),\n    'rotate0': createStyle (bigpt, stroke, fill),\n    'scale': createStyle (bigpt, stroke, fill),\n    'scale1': createStyle (bigpt, stroke, fill),\n    'scale2': createStyle (bigpt, stroke, fill),\n    'scale3': createStyle (bigpt, stroke, fill),\n    'scalev': createStyle (smallpt, stroke, fill),\n    'scaleh1': createStyle (smallpt, stroke, fill),\n    'scalev2': createStyle (smallpt, stroke, fill),\n    'scaleh3': createStyle (smallpt, stroke, fill),\n  };\n  this.drawSketch_();\n}\n/**\n * Set sketch style.\n * @param {style} style Style name: 'default','translate','rotate','rotate0','scale','scale1','scale2','scale3','scalev','scaleh1','scalev2','scaleh3'\n * @param {ol.style.Style|Array<ol.style.Style>} olstyle\n * @api stable\n */\nol.interaction.Transform.prototype.setStyle = function(style, olstyle) {\n  if (!olstyle) return;\n  if (olstyle instanceof Array) this.style[style] = olstyle;\n  else this.style[style] = [ olstyle ];\n  for (var i=0; i<this.style[style].length; i++) {\n    var im = this.style[style][i].getImage();\n    if (im) {\n      if (style == 'rotate') im.getAnchor()[0] = -5;\n      if (this.isTouch) im.setScale(1.8);\n    }\n    var tx = this.style[style][i].getText();\n    if (tx) {\n      if (style == 'rotate') tx.setOffsetX(this.isTouch ? 14 : 7);\n      if (this.isTouch) tx.setScale(1.8);\n    }\n  }\n  this.drawSketch_();\n};\n/** Get Feature at pixel\n * @param {ol.Pixel}\n * @return {ol.feature}\n * @private\n */\nol.interaction.Transform.prototype.getFeatureAtPixel_ = function(pixel) {\n  var self = this;\n  return this.getMap().forEachFeatureAtPixel(pixel,\n    function(feature, layer) {\n      var found = false;\n      // Overlay ?\n      if (!layer) {\n        if (feature===self.bbox_) return false;\n        self.handles_.forEach (function(f) { if (f===feature) found=true; });\n        if (found) return { feature: feature, handle:feature.get('handle'), constraint:feature.get('constraint'), option:feature.get('option') };\n      }\n      // No seletion\n      if (!self.get('selection')) {\n        // Return the currently selected feature the user is interacting with.\n        if (self.selection_.some(function(f) { return feature === f; })) {\n          return { feature: feature };\n        }\n        return null;\n      }\n      // filter condition\n      if (self._filter) {\n        if (self._filter(feature,layer)) return { feature: feature };\n        else return null;\n      }\n      // feature belong to a layer\n      else if (self.layers_) {\n        for (var i=0; i<self.layers_.length; i++) {\n          if (self.layers_[i]===layer) return { feature: feature };\n        }\n        return null;\n      }\n      // feature in the collection\n      else if (self.features_) {\n        self.features_.forEach (function(f) { if (f===feature) found=true; });\n        if (found) return { feature: feature };\n        else return null;\n      }\n      // Others\n      else return { feature: feature };\n    },\n    { hitTolerance: this.get('hitTolerance') }\n  ) || {};\n}\n/** Draw transform sketch\n* @param {boolean} draw only the center\n*/\nol.interaction.Transform.prototype.drawSketch_ = function(center) {\n  var i, f, geom;\n  this.overlayLayer_.getSource().clear();\n  if (!this.selection_.length) return;\n  var ext = this.selection_[0].getGeometry().getExtent();\n  // Clone and extend\n  ext = ol.extent.buffer(ext, 0);\n  for (i=1, f; f = this.selection_[i]; i++) {\n    ol.extent.extend(ext, f.getGeometry().getExtent());\n  }\n  if (center===true) {\n    if (!this.ispt_) {\n      this.overlayLayer_.getSource().addFeature(new ol.Feature( { geometry: new ol.geom.Point(this.center_), handle:'rotate0' }) );\n      geom = ol.geom.Polygon.fromExtent(ext);\n      f = this.bbox_ = new ol.Feature(geom);\n      this.overlayLayer_.getSource().addFeature (f);\n    }\n  }\n  else {\n    if (this.ispt_) {\n      var p = this.getMap().getPixelFromCoordinate([ext[0], ext[1]]);\n      ext = ol.extent.boundingExtent([\n        this.getMap().getCoordinateFromPixel([p[0]-10, p[1]-10]),\n        this.getMap().getCoordinateFromPixel([p[0]+10, p[1]+10])\n      ]);\n    }\n    geom = ol.geom.Polygon.fromExtent(ext);\n    f = this.bbox_ = new ol.Feature(geom);\n    var features = [];\n    var g = geom.getCoordinates()[0];\n    if (!this.ispt_) {\n      features.push(f);\n      // Middle\n      if (this.get('stretch') && this.get('scale')) for (i=0; i<g.length-1; i++) {\n        f = new ol.Feature( { geometry: new ol.geom.Point([(g[i][0]+g[i+1][0])/2,(g[i][1]+g[i+1][1])/2]), handle:'scale', constraint:i%2?\"h\":\"v\", option:i });\n        features.push(f);\n      }\n      // Handles\n      if (this.get('scale')) for (i=0; i<g.length-1; i++) {\n        f = new ol.Feature( { geometry: new ol.geom.Point(g[i]), handle:'scale', option:i });\n        features.push(f);\n      }\n      // Center\n      if (this.get('translate') && !this.get('translateFeature')) {\n        f = new ol.Feature( { geometry: new ol.geom.Point([(g[0][0]+g[2][0])/2, (g[0][1]+g[2][1])/2]), handle:'translate' });\n        features.push(f);\n      }\n    }\n    // Rotate\n    if (this.get('rotate')) {\n      f = new ol.Feature( { geometry: new ol.geom.Point(g[3]), handle:'rotate' });\n      features.push(f);\n    }\n    // Add sketch\n    this.overlayLayer_.getSource().addFeatures(features);\n  }\n};\n/** Select a feature to transform\n* @param {ol.Feature} feature the feature to transform\n* @param {boolean} add true to add the feature to the selection, default false\n*/\nol.interaction.Transform.prototype.select = function(feature, add) {\n  if (!feature) {\n    this.selection_ = [];\n    this.drawSketch_();\n    return;\n  }\n  if (!feature.getGeometry || !feature.getGeometry()) return;\n  // Add to selection\n  if (add) this.selection_.push(feature);\n  else this.selection_ = [feature];\n  this.ispt_ = (this.selection_.length===1 ? (this.selection_[0].getGeometry().getType() == \"Point\") : false);\n  this.drawSketch_();\n  this.watchFeatures_();\n  // select event\n  this.dispatchEvent({ type:'select', feature: feature, features: this.selection_ });\n};\n/** Watch selected features\n * @private\n */\nol.interaction.Transform.prototype.watchFeatures_ = function() {\n  // Listen to feature modification\n  if (this._featureListeners) {\n    this._featureListeners.forEach(function (l) {\n      ol.Observable.unByKey(l)\n    });\n  }\n  this._featureListeners = [];\n  this.selection_.forEach(function(f) {\n    this._featureListeners.push(\n      f.on('change', function() {\n        this.drawSketch_();\n      }.bind(this))\n    );\n  }.bind(this));\n};\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `true` to start the drag sequence.\n */\nol.interaction.Transform.prototype.handleDownEvent_ = function(evt) {\n  var sel = this.getFeatureAtPixel_(evt.pixel);\n  var feature = sel.feature;\n  if (this.selection_.length\n    && this.selection_.indexOf(feature) >=0\n    && ((this.ispt_ && this.get('translate')) || this.get('translateFeature'))\n  ){\n    sel.handle = 'translate';\n  }\n  if (sel.handle) {\n    this.mode_ = sel.handle;\n    this.opt_ = sel.option;\n    this.constraint_ = sel.constraint;\n    // Save info\n    this.coordinate_ = evt.coordinate;\n    this.pixel_ = evt.pixel;\n    this.geoms_ = [];\n    var extent = ol.extent.createEmpty();\n    for (var i=0, f; f=this.selection_[i]; i++) {\n      this.geoms_.push(f.getGeometry().clone());\n      extent = ol.extent.extend(extent, f.getGeometry().getExtent());\n    }\n    this.extent_ = (ol.geom.Polygon.fromExtent(extent)).getCoordinates()[0];\n    if (this.mode_==='rotate') {\n      this.center_ = this.getCenter() || ol.extent.getCenter(extent);\n      // we are now rotating (cursor down on rotate mode), so apply the grabbing cursor\n      var element = evt.map.getTargetElement();\n      element.style.cursor = this.Cursors.rotate0;\n      this.previousCursor_ = element.style.cursor;\n    } else {\n      this.center_ = ol.extent.getCenter(extent);\n    }\n    this.angle_ = Math.atan2(this.center_[1]-evt.coordinate[1], this.center_[0]-evt.coordinate[0]);\n    this.dispatchEvent({\n      type: this.mode_+'start',\n      feature: this.selection_[0], // backward compatibility\n      features: this.selection_,\n      pixel: evt.pixel,\n      coordinate: evt.coordinate\n    });\n    return true;\n  }\n  else if (this.get('selection')) {\n    if (feature){\n      if (!this.addFn_(evt)) this.selection_ = [];\n      var index = this.selection_.indexOf(feature);\n      if (index < 0) this.selection_.push(feature);\n      else this.selection_.splice(index,1);\n    } else {\n      this.selection_ = [];\n    }\n    this.ispt_ = this.selection_.length===1 ? (this.selection_[0].getGeometry().getType() == \"Point\") : false;\n    this.drawSketch_();\n    this.watchFeatures_();\n    this.dispatchEvent({ type:'select', feature: feature, features: this.selection_, pixel: evt.pixel, coordinate: evt.coordinate });\n    return false;\n  }\n};\n/**\n * Get features to transform\n * @return {Array<ol.Feature>}\n */\nol.interaction.Transform.prototype.getFeatures = function() {\n  return this.selection_;\n};\n/**\n * Get the rotation center\n * @return {ol.coordinates|undefined}\n */\nol.interaction.Transform.prototype.getCenter = function() {\n  return this.get('center');\n};\n/**\n * Set the rotation center\n * @param {ol.coordinates|undefined} c the center point, default center on the objet\n */\nol.interaction.Transform.prototype.setCenter = function(c) {\n  return this.set('center', c);\n}\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n */\nol.interaction.Transform.prototype.handleDragEvent_ = function(evt) {\n  var i, f, geometry;\n  switch (this.mode_) {\n    case 'rotate': {\n      var a = Math.atan2(this.center_[1]-evt.coordinate[1], this.center_[0]-evt.coordinate[0]);\n      if (!this.ispt) {\n        // var geometry = this.geom_.clone();\n        // geometry.rotate(a-this.angle_, this.center_);\n        // this.feature_.setGeometry(geometry);\n        for (i=0, f; f=this.selection_[i]; i++) {\n          geometry = this.geoms_[i].clone();\n          geometry.rotate(a - this.angle_, this.center_);\n          f.setGeometry(geometry);\n        }\n      }\n      this.drawSketch_(true);\n      this.dispatchEvent({\n        type:'rotating',\n        feature: this.selection_[0],\n        features: this.selection_,\n        angle: a-this.angle_,\n        pixel: evt.pixel,\n        coordinate: evt.coordinate\n      });\n      break;\n    }\n    case 'translate': {\n      var deltaX = evt.coordinate[0] - this.coordinate_[0];\n      var deltaY = evt.coordinate[1] - this.coordinate_[1];\n      //this.feature_.getGeometry().translate(deltaX, deltaY);\n      for (i=0, f; f=this.selection_[i]; i++) {\n        f.getGeometry().translate(deltaX, deltaY);\n      }\n      this.handles_.forEach(function(f) {\n        f.getGeometry().translate(deltaX, deltaY);\n      });\n      this.coordinate_ = evt.coordinate;\n      this.dispatchEvent({\n        type:'translating',\n        feature: this.selection_[0],\n        features: this.selection_,\n        delta:[deltaX,deltaY],\n        pixel: evt.pixel,\n        coordinate: evt.coordinate\n      });\n      break;\n    }\n    case 'scale': {\n      var center = this.center_;\n      if (this.get('modifyCenter')(evt)) {\n        center = this.extent_[(Number(this.opt_)+2)%4];\n      }\n      var scx = (evt.coordinate[0] - center[0]) / (this.coordinate_[0] - center[0]);\n      var scy = (evt.coordinate[1] - center[1]) / (this.coordinate_[1] - center[1]);\n      if (this.get('noFlip')) {\n        if (scx<0) scx=-scx;\n        if (scy<0) scy=-scy;\n      }\n      if (this.constraint_) {\n        if (this.constraint_==\"h\") scx=1;\n        else scy=1;\n      } else {\n        if (this.get('keepAspectRatio')(evt)) {\n          scx = scy = Math.min(scx,scy);\n        }\n      }\n      for (i=0, f; f=this.selection_[i]; i++) {\n        geometry = this.geoms_[i].clone();\n        geometry.applyTransform(function(g1, g2, dim) {\n          if (dim<2) return g2;\n          for (i=0; i<g1.length; i+=dim) {\n            if (scx!=1) g2[i] = center[0] + (g1[i]-center[0])*scx;\n            if (scy!=1) g2[i+1] = center[1] + (g1[i+1]-center[1])*scy;\n          }\n          return g2;\n        });\n        f.setGeometry(geometry);\n      }\n      this.drawSketch_();\n      this.dispatchEvent({\n        type:'scaling',\n        feature: this.selection_[0],\n        features: this.selection_,\n        scale:[scx,scy],\n        pixel: evt.pixel,\n        coordinate: evt.coordinate\n      });\n      break;\n    }\n    default: break;\n  }\n};\n/**\n * @param {ol.MapBrowserEvent} evt Event.\n */\nol.interaction.Transform.prototype.handleMoveEvent_ = function(evt) {\n  // console.log(\"handleMoveEvent\");\n  if (!this.mode_) {\n    var sel = this.getFeatureAtPixel_(evt.pixel);\n    var element = evt.map.getTargetElement();\n    if (sel.feature)\n    {\tvar c = sel.handle ? this.Cursors[(sel.handle||'default')+(sel.constraint||'')+(sel.option||'')] : this.Cursors.select;\n      if (this.previousCursor_===undefined)\n      {\tthis.previousCursor_ = element.style.cursor;\n      }\n      element.style.cursor = c;\n    }\n    else\n    {\tif (this.previousCursor_!==undefined) element.style.cursor = this.previousCursor_;\n      this.previousCursor_ = undefined;\n    }\n  }\n};\n/**\n * @param {ol.MapBrowserEvent} evt Map browser event.\n * @return {boolean} `false` to stop the drag sequence.\n */\nol.interaction.Transform.prototype.handleUpEvent_ = function(evt) {\n  // remove rotate0 cursor on Up event, otherwise it's stuck on grab/grabbing\n  if (this.mode_ === 'rotate') {\n    var element = evt.map.getTargetElement();\n    element.style.cursor = this.Cursors.default;\n    this.previousCursor_ = undefined;\n  }\n  //dispatchEvent\n  this.dispatchEvent({\n    type:this.mode_+'end',\n    feature: this.selection_[0],\n    features: this.selection_,\n    oldgeom: this.geoms_[0],\n    oldgeoms: this.geoms_\n  });\n  this.drawSketch_();\n  this.mode_ = null;\n  return false;\n};\n\n/** Undo/redo interaction\n * @constructor\n * @extends {ol.interaction.Interaction}\n * @fires undo\n * @fires redo\n * @param {*} options\n */\nol.interaction.UndoRedo = function(options) {\n  if (!options) options = {};\n\tol.interaction.Interaction.call(this, {\t\n    handleEvent: function() { \n      return true; \n    }\n  });\n  this._undoStack = [];\n  this._redoStack = [];\n  // Block counter\n  this._block = 0;\n  // Start recording\n  this._record = true;\n  // Custom definitions\n  this._defs = {};\n};\nol.inherits(ol.interaction.UndoRedo, ol.interaction.Interaction);\n/** Add a custom undo/redo\n * @param {string} action the action key name\n * @param {function} undoFn function called when undoing\n * @param {function} redoFn function called when redoing\n * @api\n */\nol.interaction.UndoRedo.prototype.define = function(action, undoFn, redoFn) {\n  this._defs['_'+action] = { undo: undoFn, redo: redoFn };\n};\n/** Set a custom undo/redo\n * @param {string} action the action key name\n * @param {any} prop an object that will be passed in the undo/redo fucntions of the action\n * @return {boolean} true if the action is defined\n */\nol.interaction.UndoRedo.prototype.push = function(action, prop) {\n  if (this._defs['_'+action]) {\n    this._undoStack.push({type: '_'+action, prop: prop });\n    return true;\n  } else {\n    return false;\n  }\n};\n/** Activate or deactivate the interaction, ie. records or not events on the map.\n * @param {boolean} active\n * @api stable\n */\nol.interaction.UndoRedo.prototype.setActive = function(active) {\n  ol.interaction.Interaction.prototype.setActive.call (this, active);\n  this._record = active;\n};\n/**\n * Remove the interaction from its current map, if any, and attach it to a new\n * map, if any. Pass `null` to just remove the interaction from the current map.\n * @param {ol.Map} map Map.\n * @api stable\n */\nol.interaction.UndoRedo.prototype.setMap = function(map) {\n  ol.interaction.Interaction.prototype.setMap.call (this, map);\n  // Watch sources\n  this._watchSources();\n  this._watchInteractions();\n};\n/** Watch for changes in the map sources\n * @private\n */\nol.interaction.UndoRedo.prototype._watchSources = function() {\n  var map = this.getMap();\n  // Clear listeners\n  if (this._sourceListener) {\n    this._sourceListener.forEach(function(l) { ol.Observable.unByKey(l); })\n  }\n  this._sourceListener = [];\n  // Ges vector layers \n  function getVectorLayers(layers, init) {\n    if (!init) init = [];\n    layers.forEach(function(l) {\n      if (l instanceof ol.layer.Vector) {\n        init.push(l);\n      } else if (l.getLayers) {\n        getVectorLayers(l.getLayers(), init);\n      }\n    });\n    return init;\n  }\n  if (map) {\n    // Watch the vector sources in the map \n    var vectors = getVectorLayers(map.getLayers());\n    vectors.forEach((function(l) {\n      var s = l.getSource();\n      this._sourceListener.push( s.on(['addfeature', 'removefeature'], this._onAddRemove.bind(this)) );\n      this._sourceListener.push( s.on('clearstart', this.blockStart.bind(this)) );\n      this._sourceListener.push( s.on('clearend', this.blockEnd.bind(this)) );\n    }).bind(this));\n    // Watch new inserted/removed\n    this._sourceListener.push( map.getLayers().on(['add', 'remove'], this._watchSources.bind(this) ) );\n  }\n};\n/** Watch for interactions\n * @private\n */\nol.interaction.UndoRedo.prototype._watchInteractions = function() {\n  var map = this.getMap();\n  // Clear listeners\n  if (this._interactionListener) {\n    this._interactionListener.forEach(function(l) { ol.Observable.unByKey(l); })\n  }\n  this._interactionListener = [];\n  if (map) {\n    // Watch the interactions in the map \n    map.getInteractions().forEach((function(i) {\n      this._interactionListener.push(i.on(\n        ['setattributestart', 'modifystart', 'rotatestart', 'translatestart', 'scalestart', 'deletestart', 'deleteend', 'beforesplit', 'aftersplit'], \n        this._onInteraction.bind(this)\n      ));\n    }).bind(this));\n    // Watch new inserted / unwatch removed\n    this._interactionListener.push( map.getInteractions().on(\n      ['add', 'remove'], \n      this._watchInteractions.bind(this)\n    ));\n  }\n};\n/** A feature is added / removed\n */\nol.interaction.UndoRedo.prototype._onAddRemove = function(e) {\n  if (this._record) {\n    this._undoStack.push({type: e.type, source: e.target, feature: e.feature });\n    this._redoStack = [];\n  }\n};\nol.interaction.UndoRedo.prototype._onInteraction = function(e) {\n  var fn = this._onInteraction[e.type];\n  if (fn) fn.call(this,e);\n};\n/** Set attribute\n * @private\n */\nol.interaction.UndoRedo.prototype._onInteraction.setattributestart = function(e) {\n  this.blockStart();\n  var newp = Object.assign({}, e.properties);\n  e.features.forEach(function(f) {\n    var oldp = {};\n    for (var p in newp) {\n      oldp[p] = f.get(p);\n    }\n    this._undoStack.push({\n      type: 'changeattribute', \n      feature: f, \n      newProperties: newp,\n      oldProperties: oldp\n    });\n  }.bind(this));\n  this.blockEnd();\n};\nol.interaction.UndoRedo.prototype._onInteraction.rotatestart = \nol.interaction.UndoRedo.prototype._onInteraction.translatestart = \nol.interaction.UndoRedo.prototype._onInteraction.scalestart = \nol.interaction.UndoRedo.prototype._onInteraction.modifystart = function (e) {\n  this.blockStart();\n  e.features.forEach(function(m) {\n    this._undoStack.push({type: 'changefeature', feature: m, oldFeature: m.clone()  });\n  }.bind(this));\n  this.blockEnd();\n};\n/** Start an undo block\n * @api\n */\nol.interaction.UndoRedo.prototype.blockStart = function () {\n  this._undoStack.push({ type: 'blockstart' });\n  this._redoStack = [];\n};\n/** @private\n */\nol.interaction.UndoRedo.prototype._onInteraction.beforesplit =\nol.interaction.UndoRedo.prototype._onInteraction.deletestart =\nol.interaction.UndoRedo.prototype.blockStart;\n/** End an undo block\n * @api\n */\nol.interaction.UndoRedo.prototype.blockEnd = function () {\n  this._undoStack.push({ type: 'blockend' });\n};\n/** @private\n */\nol.interaction.UndoRedo.prototype._onInteraction.aftersplit =\nol.interaction.UndoRedo.prototype._onInteraction.deleteend =\nol.interaction.UndoRedo.prototype.blockEnd;\n/** handle undo/redo\n * @private\n */\nol.interaction.UndoRedo.prototype._handleDo = function(e, undo) {\n  // Not active\n  if (!this.getActive()) return;\n  // Stop recording while undoing\n  this._record = false;\n  switch (e.type) {\n    case 'addfeature': {\n      if (undo) e.source.removeFeature(e.feature);\n      else e.source.addFeature(e.feature);\n      break;\n    }\n    case 'removefeature': {\n      if (undo) e.source.addFeature(e.feature);\n      else e.source.removeFeature(e.feature);\n      break;\n    }\n    case 'changefeature': {\n      var geom = e.feature.getGeometry();\n      e.feature.setGeometry(e.oldFeature.getGeometry());\n      e.oldFeature.setGeometry(geom);\n      break;\n    }\n    case 'changeattribute': {\n      var newp = e.newProperties;\n      var oldp = e.oldProperties;\n      for (var p in oldp) {\n        if (oldp === undefined) e.feature.unset(p);\n        else e.feature.set(p, oldp[p]);\n      }\n      e.oldProperties = newp;\n      e.newProperties = oldp;\n      break;\n    }\n    case 'blockstart': {\n      this._block += undo ? -1 : 1;\n      break;\n    }\n    case 'blockend': {\n      this._block += undo ? 1 : -1;\n      break;\n    }\n    default: {\n      if (this._defs[e.type]) {\n        if (undo) this._defs[e.type].undo(e.prop);\n        else this._defs[e.type].redo(e.prop);\n      } else {\n        console.warn('[UndoRedoInteraction]: \"'+e.type.substr(1)+'\" is not defined.');\n      }\n    }\n  }\n  // Handle block\n  if (this._block<0) this._block = 0;\n  if (this._block) {\n    if (undo) this.undo();\n    else this.redo();\n  }\n  this._record = true;\n  // Dispatch event\n  this.dispatchEvent( { \n    type: undo ? 'undo' : 'redo',\n    action: e\n  });\n};\n/** Undo last operation\n * @api\n */\nol.interaction.UndoRedo.prototype.undo = function() {\n  var e = this._undoStack.pop();\n  if (!e) return;\n  this._redoStack.push(e);\n  this._handleDo(e, true);\n};\n/** Redo last operation\n * @api\n */\nol.interaction.UndoRedo.prototype.redo = function() {\n  var e = this._redoStack.pop();\n  if (!e) return;\n  this._undoStack.push(e);\n  this._handleDo(e, false);\n};\n/** Clear undo stack\n * @api\n */\nol.interaction.UndoRedo.prototype.clear = function() {\n  this._undoStack = [];\n  this._redoStack = [];\n};\n/** Check if undo is avaliable\n * @return {number} the number of undo \n * @api\n */\nol.interaction.UndoRedo.prototype.hasUndo = function() {\n  return this._undoStack.length;\n};\n/** Check if redo is avaliable\n * @return {number} the number of redo\n * @api\n */\nol.interaction.UndoRedo.prototype.hasRedo = function() {\n  return this._redoStack.length;\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Abstract base class; normally only used for creating subclasses. Bin collector for data\n * @constructor\n * @extends {ol.source.Vector}\n * @param {Object} options ol.source.VectorOptions + grid option\n *  @param {ol.source.Vector} options.source Source\n *  @param {boolean} options.listenChange listen changes (move) on source features to recalculate the bin, default true\n *  @param {(f: ol.Feature) => ol.geom.Point} [options.geometryFunction] Function that takes an ol.Feature as argument and returns an ol.geom.Point as feature's center.\n *  @param {(bin: ol.Feature, features: Array<ol.Feature>)} [options.flatAttributes] Function takes a bin and the features it contains and aggragate the features in the bin attributes when saving\n */\nol.source.BinBase = function (options) {\n  options = options || {};\n  this._bindModify = this._onModifyFeature.bind(this);\n  this._watch === true;\n  ol.source.Vector.call(this, options);\n  this._origin = options.source;\n  this._listen = (options.listenChange !== false);\n  // Geometry function\n  this._geomFn = options.geometryFunction || ol.coordinate.getFeatureCenter || function (f) { return f.getGeometry().getFirstCoordinate(); };\n  // Existing features\n  this.reset();\n  // Future features\n  this._origin.on('addfeature', this._onAddFeature.bind(this));\n  this._origin.on('removefeature', this._onRemoveFeature.bind(this));\n  this._origin.on('clearstart', this._onClearFeature.bind(this));\n  this._origin.on('clearend', this._onClearFeature.bind(this));\n  if (typeof (options.flatAttributes) === 'function') this._flatAttributes = options.flatAttributes;\n};\nol.ext.inherits(ol.source.BinBase, ol.source.Vector);\n/**\n * On add feature\n * @param {ol.events.Event} e\n * @param {ol.Feature} bin\n * @private\n */\nol.source.BinBase.prototype._onAddFeature = function (e, bin, listen) {\n  var f = e.feature || e.target;\n  bin = bin || this.getBinAt(this._geomFn(f), true);\n  if (bin) bin.get('features').push(f);\n  if (this._listen && listen!==false) f.on('change', this._bindModify);\n};\n/**\n *  On remove feature\n *  @param {ol.events.Event} e\n *  @param {ol.Feature} bin\n *  @private\n */\nol.source.BinBase.prototype._onRemoveFeature = function (e, bin, listen) {\n  if (!this._watch) return;\n  var f = e.feature || e.target;\n  bin = bin || this.getBinAt(this._geomFn(f));\n  if (bin) {\n    // Remove feature from bin\n    var features = bin.get('features');\n    for (var i=0, fi; fi=features[i]; i++) {\n      if (fi===f) {\n        features.splice(i, 1);\n        break;\n      }\n    }\n    // Remove bin if no features\n    if (!features.length) {\n      this.removeFeature(bin);\n    }\n  } else {\n    // console.log(\"[ERROR:Bin] remove feature: feature doesn't exists anymore.\");\n  }\n  if (this._listen && listen!==false) f.un('change', this._bindModify);\n};\n/** When clearing features remove the listener\n * @private\n */\nol.source.BinBase.prototype._onClearFeature = function (e) {\n  if (e.type==='clearstart') {\n    if (this._listen) {\n      this._origin.getFeatures().forEach(function (f) {\n        f.un('change', this._bindModify);\n      }.bind(this));\n    }\n    this.clear();\n    this._watch = false;\n  } else {\n    this._watch = true;\n  }\n};\n/**\n * Get the bin that contains a feature\n * @param {ol.Feature} f the feature\n * @return {ol.Feature} the bin or null it doesn't exit\n */\nol.source.BinBase.prototype.getBin = function (feature) {\n  var bins = this.getFeatures();\n  for (var i=0, b; b = bins[i]; i++) {\n    var features = b.get('features');\n    for (var j=0, f; f=features[j]; j++) {\n      if (f===feature) return b;\n    }\n  }\n  return null;\n}\n/** Get the grid geometry at the coord \n * @param {ol.Coordinate} coord\n * @param {Object} attributes add key/value to this object to add properties to the grid feature\n * @returns {ol.geom.Polygon} \n * @api\n */\nol.source.BinBase.prototype.getGridGeomAt = function (coord /*, attributes */) {\n  return new ol.geom.Polygon([coord]);\n};\n/** Get the bean at a coord\n * @param {ol.Coordinate} coord\n * @param {boolean} create true to create if doesn't exit\n * @return {ol.Feature} the bin or null it doesn't exit\n */\nol.source.BinBase.prototype.getBinAt = function (coord, create) {\n  var attributes = {};\n  var g = this.getGridGeomAt(coord, attributes);\n  if (!g) return null;\n  var center = g.getInteriorPoint ? g.getInteriorPoint().getCoordinates() : g.getInteriorPoints().getCoordinates()[0];// ol.extent.getCenter(g.getExtent());\n  var features = this.getFeaturesAtCoordinate( center );\n  var bin = features[0];\n  if (!bin && create) {\n    attributes.geometry = g;\n    attributes.features = [];\n    attributes.center = center;\n    bin = new ol.Feature(attributes);\n    this.addFeature(bin);\n  }\n  return bin || null;\n};\n/**\n *  A feature has been modified\n *  @param {ol.events.Event} e\n *  @private\n */\nol.source.BinBase.prototype._onModifyFeature = function (e) {\n  var bin = this.getBin(e.target);\n  var bin2 = this.getBinAt(this._geomFn(e.target), 'create');\n  if (bin !== bin2) {\n    // remove from the bin\n    if (bin) {\n      this._onRemoveFeature(e, bin, false);\n    }\n    // insert in the new bin\n    if (bin2) {\n      this._onAddFeature(e, bin2, false);\n    }\n  }\n  this.changed();\n};\n/** Clear all bins and generate a new one. \n */\nol.source.BinBase.prototype.reset = function () {\n  this.clear();\n  var features = this._origin.getFeatures();\n  for (var i = 0, f; f = features[i]; i++) {\n    this._onAddFeature({ feature: f });\n  }\n};\n/**\n * Get features without circular dependencies (vs. getFeatures)\n * @return {Array<ol.Feature>}\n */\nol.source.BinBase.prototype.getGridFeatures = function () {\n  var features = [];\n  this.getFeatures().forEach(function (f) {\n    var bin = new ol.Feature(f.getGeometry().clone());\n    for (var i in f.getProperties()) {\n      if (i!=='features' && i!=='geometry') {\n        bin.set(i, f.get(i));\n      }\n    }\n    bin.set('nb', f.get('features').length);\n    this._flatAttributes(bin, f.get('features'));\n    features.push(bin);\n  }.bind(this));\n  return features;\n};\n/** Create bin attributes using the features it contains when exporting \n * @param {ol.Feature} bin the bin to export\n * @param {Array<ol.Features>} features the features it contains\n */\nol.source.BinBase.prototype._flatAttributes = function(/*bin, features*/) {\n};\n/**\n * Get the orginal source\n * @return {ol.source.Vector}\n */\nol.source.BinBase.prototype.getSource = function () {\n  return this._origin;\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n  @classdesc\n  ol.source.DBPedia is a DBPedia layer source that load DBPedia located content in a vector layer.\n  olx.source.DBPedia: olx.source.Vector\n  {\turl: {string} Url for DBPedia SPARQL \n  }\n  Inherits from:\n  <ol.source.Vector>\n*/\n/**\n* @constructor ol.source.DBPedia\n* @extends {ol.source.Vector}\n* @param {olx.source.DBPedia=} opt_options\n*/\nol.source.DBPedia = function(opt_options) {\n  var options = opt_options || {};\n  options.loader = this._loaderFn;\n  /** Url for DBPedia SPARQL */\n  this._url = options.url || \"http://fr.dbpedia.org/sparql\";\n  /** Max resolution to load features  */\n  this._maxResolution = options.maxResolution || 100;\n  /** Result language */\n  this._lang = options.lang || \"fr\";\n  /** Query limit */\n  this._limit = options.limit || 1000;\n  /** Default attribution */\n  if (!options.attributions) options.attributions = [ \"&copy; <a href='http://dbpedia.org/'>DBpedia</a> CC-by-SA\" ];\n  // Bbox strategy : reload at each move\n    if (!options.strategy) options.strategy = ol.loadingstrategy.bbox;\n  ol.source.Vector.call (this, options);\n};\nol.inherits (ol.source.DBPedia, ol.source.Vector);\n/** Decode RDF attributes and choose to add feature to the layer\n* @param {feature} the feature\n* @param {attributes} RDF attributes\n* @param {lastfeature} last feature added (null if none)\n* @return {boolean} true: add the feature to the layer\n* @API stable\n*/\nol.source.DBPedia.prototype.readFeature = function (feature, attributes, lastfeature) {\n  // Copy RDF attributes values\n  for (var i in attributes) {\n    if (attributes[i].type==='uri') attributes[i].value = encodeURI(attributes[i].value);\n    feature.set (i, attributes[i].value);\n  }\n  // Prevent same feature with different type duplication\n  if (lastfeature && lastfeature.get(\"subject\") == attributes.subject.value) {\n    // Kepp dbpedia.org type ?\n    // if (bindings[i].type.match (\"dbpedia.org\") lastfeature.get(\"type\") = bindings[i].type.value;\n    // Concat types\n    lastfeature.set(\"type\", lastfeature.get(\"type\") +\"\\n\"+ attributes.type.value);\n    return false;\n  } else {\n    return true;\n  }\n};\n/** Set RDF query subject, default: select label, thumbnail, abstract and type\n* @API stable\n*/\nol.source.DBPedia.prototype.querySubject = function () {\n  return \"?subject rdfs:label ?label. \"\n    + \"OPTIONAL {?subject dbpedia-owl:thumbnail ?thumbnail}.\"\n    + \"OPTIONAL {?subject dbpedia-owl:abstract ?abstract} . \"\n    + \"OPTIONAL {?subject rdf:type ?type}\";\n}\n/** Set RDF query filter, default: select language\n* @API stable\n*/\nol.source.DBPedia.prototype.queryFilter = function () {\n  return\t \"lang(?label) = '\"+this._lang+\"' \"\n    + \"&& lang(?abstract) = '\"+this._lang+\"'\"\n  // Filter on type \n  //+ \"&& regex (?type, 'Monument|Sculpture|Museum', 'i')\"\n}\n/** Loader function used to load features.\n* @private\n*/\nol.source.DBPedia.prototype._loaderFn = function(extent, resolution, projection) {\n  if (resolution > this._maxResolution) return;\n  var self = this;\n  var bbox = ol.proj.transformExtent(extent, projection, \"EPSG:4326\");\n  // SPARQL request: for more info @see http://fr.dbpedia.org/\n  var query =\t\"PREFIX geo: <http://www.w3.org/2003/01/geo/wgs84_pos#> \"\n        + \"SELECT DISTINCT * WHERE { \"\n        + \"?subject geo:lat ?lat . \"\n        + \"?subject geo:long ?long . \"\n        + this.querySubject()+\" . \"\n        + \"FILTER(\"+this.queryFilter()+\") . \"\n        // Filter bbox\n        + \"FILTER(xsd:float(?lat) <= \" + bbox[3] + \" && \" + bbox[1] + \" <= xsd:float(?lat) \"\n        + \"&& xsd:float(?long) <= \" + bbox[2] + \" && \" + bbox[0] + \" <= xsd:float(?long) \"\n        + \") . \"\n        + \"} LIMIT \"+this._limit;\n  // Ajax request to get the tile\n  ol.ext.Ajax.get({\n    url: this._url,\n    data: { query: query, format:\"json\" },\n    success: function(data) {\n      var bindings = data.results.bindings;\n      var features = [];\n      var att, pt, feature, lastfeature = null;\n      for ( var i in bindings ) {\n        att = bindings[i];\n        pt = [Number(bindings[i].long.value), Number(bindings[i].lat.value)];\n        feature = new ol.Feature(new ol.geom.Point(ol.proj.transform (pt,\"EPSG:4326\",projection)));\n        if (self.readFeature(feature, att, lastfeature)) {\n          features.push(feature);\n          lastfeature = feature;\n        }\n      }\n      self.addFeatures(features);\n    }});\n};\nol.style.clearDBPediaStyleCache;\nol.style.dbPediaStyleFunction; \n(function(){\n// Style cache\nvar styleCache = {};\n/** Reset the cache (when fonts are loaded)\n*/\nol.style.clearDBPediaStyleCache = function() {\n  styleCache = {};\n}\n/** Get a default style function for dbpedia\n* @param {} options\n* @param {string|function|undefined} options.glyph a glyph name or a function that takes a feature and return a glyph\n* @param {number} options.radius radius of the symbol, default 8\n* @param {ol.style.Fill} options.fill style for fill, default navy\n* @param {ol.style.stroke} options.stroke style for stroke, default 2px white\n* @param {string} options.prefix a prefix if many style used for the same type\n*\n* @require ol.style.FontSymbol and FontAwesome defs are required for dbPediaStyleFunction()\n*/\nol.style.dbPediaStyleFunction = function(options) {\n  if (!options) options={};\n  // Get font function using dbPedia type\n  var getFont;\n  switch (typeof(options.glyph)) {\n    case \"function\": getFont = options.glyph; break;\n    case \"string\": getFont = function(){ return options.glyph; }; break;\n    default: {\n      getFont = function (f) {\n        var type = f.get(\"type\");\n        if (type) {\n          if (type.match(\"/Museum\")) return \"fa-camera\";\n          else if (type.match(\"/Monument\")) return \"fa-building\";\n          else if (type.match(\"/Sculpture\")) return \"fa-android\";\n          else if (type.match(\"/Religious\")) return \"fa-institution\";\n          else if (type.match(\"/Castle\")) return \"fa-key\";\n          else if (type.match(\"Water\")) return \"fa-tint\";\n          else if (type.match(\"Island\")) return \"fa-leaf\";\n          else if (type.match(\"/Event\")) return \"fa-heart\";\n          else if (type.match(\"/Artwork\")) return \"fa-asterisk\";\n          else if (type.match(\"/Stadium\")) return \"fa-futbol-o\";\n          else if (type.match(\"/Place\")) return \"fa-street-view\";\n        }\n        return \"fa-star\";\n      }\n      break;\n    }\n  }\n  // Default values\n  var radius = options.radius || 8;\n  var fill = options.fill || new ol.style.Fill({ color:\"navy\"});\n  var stroke = options.stroke || new ol.style.Stroke({ color: \"#fff\", width: 2 });\n  var prefix = options.prefix ? options.prefix+\"_\" : \"\";\n  // Vector style function\n  return function (feature) {\n    var glyph = getFont(feature);\n    var k = prefix + glyph;\n    var style = styleCache[k];\n    if (!style) {\n      styleCache[k] = style = new ol.style.Style ({\n        image: new ol.style.FontSymbol({\n          glyph: glyph, \n          radius: radius, \n          fill: fill,\n          stroke: stroke\n        })\n      });\n    }\n    return [style];\n  }\n};\n})();\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** DFCI source: a source to display the French DFCI grid on a map\n * @see http://ccffpeynier.free.fr/Files/dfci.pdf\n * @constructor ol.source.DFCI\n * @extends {ol/source/Vector}\n * @param {any} options Vector source options\n *  @param {Array<Number>} resolutions a list of resolution to change the drawing level, default [1000,100,20]\n */\nol.source.DFCI = function(options) {\n\toptions = options || {};\n\toptions.loader = this._calcGrid;\n  options.strategy =  function(extent, resolution) {\n    if (this.resolution && this.resolution != resolution){\n      this.clear();\n    }\n    return [extent];\n  }\n  this._bbox = [[0,1600000],[11*100000, 1600000+10*100000]];\n  ol.source.Vector.call (this, options);\n  this.set('resolutions', options.resolutions || [1000,100,20]);\n  // Add Lambert IIe proj \n  if (!proj4.defs[\"EPSG:27572\"]) proj4.defs(\"EPSG:27572\",\"+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs\");\n  ol.proj.proj4.register(proj4);\n};\nol.inherits (ol.source.DFCI, ol.source.Vector);\n/** Cacluate grid according extent/resolution\n */\nol.source.DFCI.prototype._calcGrid = function (extent, resolution, projection) {\n  // Show step 0\n  var f, ext, res = this.get('resolutions');\n  if (resolution > (res[0] || 1000)) {\n    if (this.resolution != resolution) {\n      if (!this._features0) {\n        ext = [this._bbox[0][0], this._bbox[0][1],this._bbox[1][0], this._bbox[1][1]];\n        this._features0 = this._getFeatures(0, ext, projection);\n      }\n      this.addFeatures(this._features0);\n    }\n  }\n  else if (resolution > (res[1] || 100)) {\n    this.clear();\n    ext = ol.proj.transformExtent(extent, projection, 'EPSG:27572');\n    f = this._getFeatures(1, ext, projection)\n    this.addFeatures(f);\n  }\n  else if (resolution > (res[2] || 0)) {\n    this.clear();\n    ext = ol.proj.transformExtent(extent, projection, 'EPSG:27572');\n    f = this._getFeatures(2, ext, projection)\n    this.addFeatures(f);\n  }\n  else {\n    this.clear();\n    ext = ol.proj.transformExtent(extent, projection, 'EPSG:27572');\n    f = this._getFeatures(3, ext, projection)\n    this.addFeatures(f);\n  }\n  // reset load\n  this.resolution = resolution;\n};\n/**\n * Get middle point\n * @private\n */\nol.source.DFCI.prototype._midPt = function(p1,p2) {\n  return [(p1[0]+p2[0])/2, (p1[1]+p2[1])/2];\n};\n/**\n * Get feature with geom\n * @private\n */\nol.source.DFCI.prototype._trFeature = function(geom, id, level, projection) {\n  var g  = new ol.geom.Polygon([geom]);\n  var f = new ol.Feature(g.transform('EPSG:27572', projection));\n  f.set('id', id);\n  f.set('level', level);\n  return f;\n};\n/** Get features\n * \n */\nol.source.DFCI.prototype._getFeatures = function (level, extent, projection) {\n  var features = [];\n  var i;\n  var step = 100000;\n  if (level>0) step /= 5;\n  if (level>1) step /= 10;\n  var p0 = [\n    Math.max(this._bbox[0][0], Math.floor(extent[0]/step)*step), \n    Math.max(this._bbox[0][1], Math.floor(extent[1]/step)*step)\n  ];\n  var p1 = [\n    Math.min(this._bbox[1][0]+99999, Math.floor(extent[2]/step)*step), \n    Math.min(this._bbox[1][1]+99999, Math.floor(extent[3]/step)*step)\n  ];\n  for (var x=p0[0]; x<=p1[0]; x += step) {\n    for (var y=p0[1]; y<=p1[1]; y += step) {\n      var p, geom = [ [x,y], [x+step, y], [x+step, y+step], [x , y+step], [x,y]];\n      if (level>2) {\n        var m = this._midPt(geom[0],geom[2]);\n        // .5\n        var g = [];\n        for (i=0; i<geom.length; i++) {\n          g.push(this._midPt(geom[i],m))\n        }\n        features.push(this._trFeature(g, ol.coordinate.toDFCI([x,y], 2)+'.5', level, projection));\n        // .1 > .4\n        for (i=0; i<4; i++) {\n          g = [];\n          g.push(geom[i]);\n          g.push(this._midPt(geom[i],geom[(i+1)%4]));\n          g.push(this._midPt(m,g[1]));\n          g.push(this._midPt(m,geom[i]));\n          p = this._midPt(geom[i],geom[(i+3)%4]);\n          g.push(this._midPt(m,p));\n          g.push(p);\n          g.push(geom[i]);\n          features.push(this._trFeature(g, ol.coordinate.toDFCI([x,y], 2)+'.'+(4-i), level, projection));\n        }\n      } else {\n        features.push(this._trFeature(geom, ol.coordinate.toDFCI([x,y], level), level, projection));\n      }\n    }\n  }\n  return features\n};\n/*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\n/** Delaunay source\n * Calculate a delaunay triangulation from points in a source\n * @param {*} options extend ol/source/Vector options\n *  @param {ol/source/Vector} options.source the source that contains the points\n */\nol.source.Delaunay = function(options) {\n  options = options || {};\n  this._nodes = options.source;\n  delete options.source;\n  ol.source.Vector.call (this, options);\n  // Convex hull\n  this.hull = [];\n  // A new node is added to the source node: calculate the new triangulation\n  this._nodes.on('addfeature', this._onAddNode.bind(this));\n  // A new node is removed from the source node: calculate the new triangulation\n  this._nodes.on('removefeature', this._onRemoveNode.bind(this));\n  this.set ('epsilon', options.epsilon || .0001)\n};\nol.inherits (ol.source.Delaunay, ol.source.Vector);\n/** Add a new triangle in the source\n * @param {Array<ol/coordinates>} pts\n */\nol.source.Delaunay.prototype._addTriangle = function(pts) {\n  var triangle = new ol.Feature(new ol.geom.Polygon([pts]));\n  this.addFeature(triangle);\n  this.flip.push(triangle);\n  return triangle;\n};\n/** Get nodes \n */\nol.source.Delaunay.prototype.getNodes = function () {\n  return this._nodes.getFeatures();\n};\n/** Get nodes source\n */\nol.source.Delaunay.prototype.getNodeSource = function () {\n  return this._nodes;\n};\n/**\n * A point has been removed\n * @param {ol/source/Vector.Event} evt \n */\nol.source.Delaunay.prototype._onRemoveNode = function(evt) {\n  // console.log(evt)\n  var pt = evt.feature.getGeometry().getCoordinates();\n  if (!pt) return;\n  // Still there (when removing duplicated points)\n  if (this.getNodesAt(pt).length) return;\n  // Get associated triangles\n  var triangles = this.getTrianglesAt(pt);\n  this.flip=[];\n  // Get hole\n  var i;\n  var edges = [];\n  while (triangles.length) {\n    var tr = triangles.pop()\n    this.removeFeature(tr);\n    tr = tr.getGeometry().getCoordinates()[0];\n    var pts = [];\n    for (i=0, p; p = tr[i]; i++) {\n      if (!ol.coordinate.equal(p,pt)) {\n        pts.push(p);\n      }\n    }\n    edges.push(pts);\n  }\n  pts = edges.pop();\nvar se = '';\nedges.forEach(function(e){\n  se += ' - '+this.listpt(e);\n}.bind(this));\nconsole.log('EDGES', se);\n  i = 0;\n  function testEdge(p0, p1, index) {\n    if (ol.coordinate.equal(p0, pts[index])) {\n      if (index) pts.push(p1);\n      else pts.unshift(p1);\n      return true\n    }\n    return false;\n  }\n  while (true) {\n    var e = edges[i];\n    if ( testEdge(e[0], e[1], 0) \n      || testEdge(e[1], e[0], 0)\n      || testEdge(e[0], e[1], pts.length-1)\n      || testEdge(e[1], e[0], pts.length-1)\n    ) {\n      edges.splice(i,1);\n      i = 0;\n    } else {\n      i++\n    }\n    if (!edges.length) break;\n    if (i>=edges.length) {\n      console.log(this.listpt(pts), this.listpt(edges));\n      throw '[DELAUNAY:removePoint] No edge found';\n    }\n  }\n  // Closed = interior\nconsole.log('PTS', this.listpt(pts))\n  var closed = ol.coordinate.equal(pts[0], pts[pts.length-1]);\n  if (closed) pts.pop();\n  // Update convex hull: remove pt + add new ones\n  var p;\n  for (i; p=this.hull[i]; i++) {\n    if (ol.coordinate.equal(pt,p)) {\n      this.hull.splice(i,1);\n      break;\n    }\n  }\n  this.hull = ol.coordinate.convexHull(this.hull.concat(pts));\n// select.getFeatures().clear();\n  // \n  var clockwise = function (t) {\n    var i1, s = 0;\n    for (var i=0; i<t.length; i++) {\n      i1 = (i+1) % t.length;\n      s += (t[i1][0] - t[i][0]) * (t[i1][1] + t[i][1]);\n    }\n    console.log(s)\n    return (s>=0 ? 1:-1)\n  };\n  // Add ears\n  // a l'interieur : Si surface ear et surface de l'objet ont meme signe\n  // extrieur ? ajoute le point et idem ? + ferme la \n  var clock;\nvar enveloppe = pts.slice();\n  if (closed) {\n    clock = clockwise(pts);\n  } else {\n    console.log('ouvert', pts, pts.slice().push(pt))\nenveloppe.push(pt);\n    clock = clockwise(enveloppe);\n  }\nconsole.log('S=',clock,'CLOSED',closed)\nconsole.log('E=',this.listpt(enveloppe))\n  for (i=0; i<=pts.length+1; i++) {\n    if (pts.length<3) break;\n    var t = [\n      pts[i % pts.length],\n      pts[(i+1) % pts.length],\n      pts[(i+2) % pts.length] \n    ];\n    if (clockwise(t)===clock) {\n      var ok = true;\n      for (var k=i+3; k<i+pts.length; k++) {\n        console.log('test '+k, this.listpt([pts[k % pts.length]]))\n        if (this.inCircle(pts[k % pts.length], t)) {\n          ok = false;\n          break;\n        }\n      }\n      if (ok) {\nconsole.log(this.listpt(t),'ok');\n        this._addTriangle(t);\n        // remove\n        pts.splice((i+1) % pts.length, 1);\n        // and restart\n        i = -1;\n      }\n    }\nelse console.log(this.listpt(t),'nok');\n  }\n/* DEBUG * /\nif (pts.length>3) console.log('oops');\nconsole.log('LEAV',this.listpt(pts));\nvar ul = $('ul.triangles').html('');\n$('<li>')\n.text('E:'+this.listpt(enveloppe)+' - '+clock+' - '+closed)\n.data('triangle', new ol.Feature(new ol.geom.Polygon([enveloppe])))\n.click(function(){\n  var t = $(this).data('triangle');\n  select.getFeatures().clear();\n  select.getFeatures().push(t);\n})\n.appendTo(ul);\nfor (var i=0; i<this.flip.length; i++) {\n  $('<li>')\n    .text(this.listpt(this.flip[i].getGeometry().getCoordinates()[0])\n        +' - ' + clockwise(this.flip[i].getGeometry().getCoordinates()[0]))\n    .data('triangle', this.flip[i])\n    .click(function(){\n      var t = $(this).data('triangle');\n      select.getFeatures().clear();\n      select.getFeatures().push(t);\n    })\n    .appendTo(ul);\n}\n/**/\n  // Flip?\n  this.flipTriangles();\n};\n/**\n * A new point has been added\n * @param {ol/source/VectorEvent} e \n */\nol.source.Delaunay.prototype._onAddNode = function(e) {\n  var finserted = e.feature;\n  var i, p;\n  // Not a point!\n  if (finserted.getGeometry().getType() !== 'Point') {\n    this._nodes.removeFeature(finserted);\n    return;\n  }\n  // Reset flip table\n  this.flip = [];\n  var nodes = this.getNodes();\n  // The point\n  var pt = finserted.getGeometry().getCoordinates();\n  // Test existing point\n  if (this.getNodesAt(pt).length > 1) {\n    console.log('remove duplicated points')\n    this._nodes.removeFeature(finserted);\n    return;\n  }\n  // Triangle needs at least 3 points\n  if (nodes.length <= 3) {\n    if (nodes.length===3) {\n      var pts = [];\n      for (i=0; i<3; i++) pts.push(nodes[i].getGeometry().getCoordinates());\n      this._addTriangle(pts);\n      this.hull = ol.coordinate.convexHull(pts);\n    }\n    return;\n  }\n  // Get the triangle\n  var t = this.getFeaturesAtCoordinate(pt)[0];\n  if (t) {\n    this.removeFeature(t);\n    t.set('del', true);\n    var c = t.getGeometry().getCoordinates()[0];\n    for (i=0; i<3; i++) {\n      this._addTriangle([ pt, c[i], c[(i+1)%3]]);\n    }\n  } else {\n    // Calculate new convex hull\n    var hull2 = this.hull.slice();\n    hull2.push(pt);\n    hull2 = ol.coordinate.convexHull(hull2);\n    // Search for points\n    for (i=0; p=hull2[i]; i++) {\n      if (ol.coordinate.equal(p,pt)) break;\n    }\n    i = (i!==0 ? i-1 : hull2.length-1);\n    var p0 = hull2[i];\n    var stop = hull2[(i+2) % hull2.length];\n    for (i=0; p=this.hull[i]; i++) {\n      if (ol.coordinate.equal(p,p0)) break;\n    }\n    // Connect to the hull\n    while (true) {\n      // DEBUG: prevent infinit loop\n      if (i>1000) {\n        console.error('[DELAUNAY:addPoint] Too many iterations')\n        break;\n      }\n      i++;\n      p = this.hull[i % this.hull.length];\n      this._addTriangle([pt, p, p0]);\n      p0 = p;\n      if (p[0] === stop[0] && p[1] === stop[1]) break;\n    }\n    this.hull = hull2;\n  }\n  this.flipTriangles();\n};\n/** Flipping algorithme: test new inserted triangle and flip\n */\nol.source.Delaunay.prototype.flipTriangles = function ()\t{\n  var count = 1000; // Count to prevent too many iterations\n  var pi;\n  while (this.flip.length) {\n    // DEBUG: prevent infinite loop\n    if (count--<0) {\n      console.error('[DELAUNAY:flipTriangles] Too many iterations')\n      break;\n    }\n    var tri = this.flip.pop();\n    if (tri.get('del')) continue;\n    var ti = tri.getGeometry().getCoordinates()[0];\n    for (var k=0; k<3; k++) {\n      // Get facing triangles\n      var mid = [(ti[(k+1)%3][0]+ti[k][0])/2, (ti[(k+1)%3][1]+ti[k][1])/2];\n      var triangles = this.getTrianglesAt(mid);\n      var pt1 = null;\n      // Get opposite point\n      if (triangles.length>1) {\n        var t0 = triangles[0].getGeometry().getCoordinates()[0];\n        var t1 = triangles[1].getGeometry().getCoordinates()[0];\n        for (pi=0; pi<t1.length; pi++) {\n          if (!this._ptInTriangle(t1[pi], t0)) {\n            pt1 = t1[pi];\n            break;\n          }\n        }\n      }\n      if (pt1) {\n        // Is in circle ?\n        if (this.inCircle(pt1, t0)) {\n          var pt2;\n          // Get opposite point\n          for (pi=0; pi<t0.length; pi++) {\n            if (!this._ptInTriangle(t0[pi], t1)) {\n              pt2 = t0.splice(pi,1)[0];\n              break;\n            }\n          }\n          // Flip triangles\n          if (this.intersectSegs([pt1, pt2], t0)) {\n            while (triangles.length) {\n              var tmp = triangles.pop();\n              tmp.set('del', true);\n              this.removeFeature(tmp);\n            }\n            this._addTriangle([pt1, pt2, t0[0]]);\n            this._addTriangle([pt1, pt2, t0[1]]);\n          }\n        }\n      }\n    }\n  }\n};\n/** Test intersection beetween 2 segs\n * @param {Array<ol.coordinates>} d1\n * @param {Array<ol.coordinates>} d2\n * @return {bbolean}\n */\nol.source.Delaunay.prototype.intersectSegs = function (d1, d2)\t{\n  var d1x = d1[1][0] - d1[0][0];\n  var d1y = d1[1][1] - d1[0][1];\n  var d2x = d2[1][0] - d2[0][0];\n  var d2y = d2[1][1] - d2[0][1];\n  var det = d1x * d2y - d1y * d2x;\n  if (det != 0) {\n    var k = (d1x * d1[0][1] - d1x * d2[0][1] - d1y * d1[0][0] + d1y * d2[0][0]) / det;\n    // Intersection: return [d2[0][0] + k*d2x, d2[0][1] + k*d2y];\n    return (0<k && k<1);\n  }\n  else return false;\n};\n/** Test pt is a triangle's node\n * @param {ol.coordinate} pt\n * @param {Array<ol.coordinate>} triangle\n * @return {boolean}\n */\nol.source.Delaunay.prototype._ptInTriangle = function(pt, triangle) {\n  for (var i=0, p; p=triangle[i]; i++) {\n    if (ol.coordinate.equal(pt,p)) return true;\n  }\n  return false;\n};\n/** List points in a triangle (assume points get an id) for debug purposes\n * @param {Array<ol.coordinate>} pts\n * @return {String} ids list\n */\nol.source.Delaunay.prototype.listpt = function (pts) {\n  var s = '';\n  for (var i=0, p; p = pts[i]; i++) {\n    var c = this._nodes.getClosestFeatureToCoordinate(p);\n    if (!ol.coordinate.equal(c.getGeometry().getCoordinates(), p)) c=null;\n    s += (s?', ':'') + (c ? c.get('id') : '?');\n  }\n  return s;\n};\n/** Test if coord is within triangle's circumcircle \n * @param {ol.coordinate} coord\n * @param {Array<ol.coordinate>} triangle\n * @return {boolean}\n */\nol.source.Delaunay.prototype.inCircle = function (coord, triangle) {\n  var c = this.getCircumCircle(triangle);\n  return ol.coordinate.dist2d(coord, c.center) < c.radius;\n}\n/** Calculate the circumcircle of a triangle\n * @param {Array<ol.coordinate>} triangle\n * @return {*}\n */\nol.source.Delaunay.prototype.getCircumCircle = function (triangle) {\n  var x1 = triangle[0][0];\n  var y1 = triangle[0][1];\n  var x2 = triangle[1][0];\n  var y2 = triangle[1][1];\n  var x3 = triangle[2][0];\n  var y3 = triangle[2][1];\n  var m1 = (x1-x2)/(y2-y1);\n  var m2 = (x1-x3)/(y3-y1);\n  var b1 = ((y1+y2)/2) - m1*(x1+x2)/2;\n  var b2 = ((y1+y3)/2) - m2*(x1+x3)/2;\n  var cx = (b2-b1)/(m1-m2);\n  var cy = m1*cx + b1;\n  var center = [cx, cy];\n  return  { \n    center: center, \n    radius: ol.coordinate.dist2d(center,triangle[0])\n  };\n};\n/** Get triangles at a point\n */\nol.source.Delaunay.prototype.getTrianglesAt = function(coord) {\n  var extent = ol.extent.buffer (ol.extent.boundingExtent([coord]), this.get('epsilon'));\n  var result = [];\n  this.forEachFeatureIntersectingExtent(extent, function(f){\n    result.push(f);\n  });\n  return result;\n};\n/** Get nodes at a point\n */\nol.source.Delaunay.prototype.getNodesAt = function(coord) {\n  var extent = ol.extent.buffer (ol.extent.boundingExtent([coord]), this.get('epsilon'));\n  return this._nodes.getFeaturesInExtent(extent);\n};\n\n  /*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A source for INSEE grid\n * @constructor\n * @extends {ol.source.Vector}\n * @param {Object} options ol.source.VectorOptions + grid option\n *  @param {ol.source.Vector} options.source Source\n *  @param {number} [options.size] size of the grid in meter, default 200m\n *  @param {(f: ol.Feature) => ol.geom.Point} [options.geometryFunction] Function that takes an ol.Feature as argument and returns an ol.geom.Point as feature's center.\n *  @param {(bin: ol.Feature, features: Array<ol.Feature>)} [options.flatAttributes] Function takes a bin and the features it contains and aggragate the features in the bin attributes when saving\n */\nol.source.FeatureBin = function (options) {\n  options = options || {};\n  this._sourceFeature = new ol.source.Vector ({ features: options.features || [] });\n  ol.source.BinBase.call(this, options);\n};\nol.ext.inherits(ol.source.FeatureBin, ol.source.BinBase);\n/** Set grid size\n * @param {ol.Feature} features\n */\nol.source.FeatureBin.prototype.setFeatures = function (features) {\n  this._sourceFeature.clear();\n  this._sourceFeature.addFeatures(features || []);\n  this.reset();\n};\n/** Get the grid geometry at the coord \n * @param {ol.Coordinate} coord\n * @returns {ol.geom.Polygon} \n * @api\n */\nol.source.FeatureBin.prototype.getGridGeomAt = function (coord, attributes) {\n  var f = this._sourceFeature.getFeaturesAtCoordinate(coord)[0];\n  if (!f) return null;\n  var a = f.getProperties();\n  for (var i in a) {\n    if (i!=='geometry') attributes[i] = a[i];\n  }\n  return f.getGeometry();\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n\tol.source.GeoImage is a layer source with georeferencement to place it on a map.\n\tolx.source.GeoImageOptions:\n\t{\turl: {string} url of the static image\n\t\timage: {image} the static image, if not provided, use url to load an image\n\t\timageCenter: {ol.Coordinate} of the center of the image\n\t\timageScale: {ol.Size|Number} [scalex, scaley] of the image\n\t\timageRotate: {number} angle of the image in radian, default 0\n\t\timageCrop: {ol.Extent} of the image to be show (in the image) default: [0,0,imageWidth,imageHeight]\n\t\timageMask: {Array.<ol.Coordinate>} - linestring to mask the image on the map\n\t}\n*/\n/** Layer source with georeferencement to place it on a map\n* @constructor \n* @extends {ol.source.ImageCanvas}\n* @param {olx.source.GeoImageOptions=} options\n*/\nol.source.GeoImage = function(opt_options)\n{\tvar options = { \n\t\tattributions: opt_options.attributions,\n\t\tlogo: opt_options.logo,\n\t\tprojection: opt_options.projection\n\t};\n\t// options.projection = opt_options.projection;\n\t// Coordinate of the image center \n\tthis.center = opt_options.imageCenter;\n\t// Scale of the image \n\tthis.scale = opt_options.imageScale;\n\t// Rotation of the image\n\tthis.rotate = opt_options.imageRotate ? opt_options.imageRotate : 0;\n\t// Crop of the image\n\tthis.crop = opt_options.imageCrop;\n\t// Mask of the image\n\tthis.mask = opt_options.imageMask;\n\t// Load Image\n\tthis._image = (opt_options.image ? opt_options.image : new Image );\n\tthis._image.crossOrigin = opt_options.crossOrigin; // 'anonymous';\n\t// Show image on load\n\tvar self = this;\n\tthis._image.onload = function()\n\t{\tself.setCrop (self.crop);\n\t\tself.changed();\n\t}\n\tif (!opt_options.image) this._image.src = opt_options.url;\n\t// Draw image on canvas\n\toptions.canvasFunction = function(extent, resolution, pixelRatio, size /*, projection*/ ) \n\t{\tvar canvas = document.createElement('canvas');\n\t\tcanvas.width = size[0];\n\t\tcanvas.height = size[1];\n\t\tvar ctx = canvas.getContext('2d');\n\t\tif (!this._imageSize) return canvas;\n\t\t// transform coords to pixel\n\t\tfunction tr(xy)\n\t\t{\treturn [(xy[0]-extent[0])/(extent[2]-extent[0]) * size[0],\n\t\t\t\t\t(xy[1]-extent[3])/(extent[1]-extent[3]) * size[1]\n\t\t\t\t\t];\n\t\t}\n\t\t// Clipping mask\n\t\tif (this.mask)\n\t\t{\tctx.beginPath();\n\t\t\tvar p = tr(this.mask[0]);\n\t\t\tctx.moveTo(p[0],p[1]);\n\t\t\tfor (var i=1; i<this.mask.length; i++) \n\t\t\t{\tp = tr(this.mask[i]);\n\t\t\t\tctx.lineTo(p[0],p[1]);\n\t\t\t}\n\t\t\tctx.clip();\n\t\t}\n\t\t// Draw\n\t\tvar pixel = tr(this.center);\n\t\tvar dx = (this._image.naturalWidth/2 - this.crop[0]) *this.scale[0] /resolution *pixelRatio;\n\t\tvar dy = (this._image.naturalHeight/2 - this.crop[1]) *this.scale[1] /resolution *pixelRatio;\n\t\tvar sx = this._imageSize[0]*this.scale[0]/resolution *pixelRatio;\n\t\tvar sy = this._imageSize[1]*this.scale[1]/resolution *pixelRatio;\n\t\tctx.translate(pixel[0],pixel[1]);\n\t\tif (this.rotate) ctx.rotate(this.rotate);\n\t\tctx.drawImage(this._image, this.crop[0], this.crop[1], this._imageSize[0], this._imageSize[1], -dx, -dy, sx,sy);\n\t\treturn canvas;\n\t}\n\tol.source.ImageCanvas.call (this, options);\t\n\tthis.setCrop (this.crop);\n};\nol.inherits (ol.source.GeoImage, ol.source.ImageCanvas);\n/**\n * Get coordinate of the image center.\n * @return {ol.Coordinate} coordinate of the image center.\n * @api stable\n */\nol.source.GeoImage.prototype.getCenter = function()\n{\treturn this.center;\n}\n/**\n * Set coordinate of the image center.\n * @param {ol.Coordinate} coordinate of the image center.\n * @api stable\n */\nol.source.GeoImage.prototype.setCenter = function(center)\n{\tthis.center = center;\n\tthis.changed();\n}\n/**\n * Get image scale.\n * @return {ol.size} image scale (along x and y axis).\n * @api stable\n */\nol.source.GeoImage.prototype.getScale = function()\n{\treturn this.scale;\n}\n/**\n * Set image scale.\n * @param {ol.size|Number} image scale (along x and y axis or both).\n * @api stable\n */\nol.source.GeoImage.prototype.setScale = function(scale)\n{\tswitch (typeof(scale))\n\t{\tcase 'number':\n\t\t\tscale = [scale,scale];\n\t\t\tbreak;\n\t\tcase 'object': \n\t\t\tif (scale.length != 2) return;\n\t\t\tbreak;\n\t\tdefault: return;\n\t}\n\tthis.scale = scale;\n\tthis.changed();\n};\n/**\n * Get image rotation.\n * @return {Number} rotation in degre.\n * @api stable\n */\nol.source.GeoImage.prototype.getRotation = function()\n{\treturn this.rotate;\n};\n/**\n * Set image rotation.\n * @param {Number} rotation in radian.\n * @api stable\n */\nol.source.GeoImage.prototype.setRotation = function(angle)\n{\tthis.rotate = angle;\n\tthis.changed();\n};\n/**\n * Get the image.\n * @api stable\n */\nol.source.GeoImage.prototype.getGeoImage = function()\n{\treturn this._image;\n};\n/**\n * Get image crop extent.\n * @return {ol.extent} image crop extent.\n * @api stable\n */\nol.source.GeoImage.prototype.getCrop = function()\n{\treturn this.crop;\n};\n/**\n * Set image mask.\n * @param {ol.geom.LineString} coords of the mask\n * @api stable\n */\nol.source.GeoImage.prototype.setMask = function(mask)\n{\tthis.mask = mask;\n\tthis.changed();\n};\n/**\n * Get image mask.\n * @return {ol.geom.LineString} coords of the mask\n * @api stable\n */\nol.source.GeoImage.prototype.getMask = function()\n{\treturn this.mask;\n};\n/**\n * Set image crop extent.\n * @param {ol.extent|Number} image crop extent or a number to crop from original size.\n * @api stable\n */\nol.source.GeoImage.prototype.setCrop = function(crop)\n{\t// Image not loaded => get it latter\n\tif (!this._image.naturalWidth) \n\t{\tthis.crop = crop;\n\t\treturn;\n\t}\n\tif (crop) \n\t{\tswitch (typeof(crop))\n\t\t{\tcase 'number':\n\t\t\t\tcrop = [crop,crop,this._image.naturalWidth-crop,this._image.naturalHeight-crop];\n\t\t\t\tbreak;\n\t\t\tcase 'object': \n\t\t\t\tif (crop.length != 4) return;\n\t\t\t\tbreak;\n\t\t\tdefault: return;\n\t\t}\n\t\tcrop = ol.extent.boundingExtent([ [crop[0],crop[1]], [crop[2],crop[3]] ]);\n\t\tthis.crop = [ Math.max(0,crop[0]), Math.max(0,crop[1]), Math.min(this._image.naturalWidth,crop[2]), Math.min(this._image.naturalHeight,crop[3]) ];\n\t}\n\telse this.crop = [0,0, this._image.naturalWidth,this._image.naturalHeight];\n\tif (this.crop[2]<=this.crop[0]) this.crop[2] = this.crop[0]+1;\n\tif (this.crop[3]<=this.crop[1]) this.crop[3] = this.crop[1]+1;\n\tthis._imageSize = [ this.crop[2]-this.crop[0], this.crop[3]-this.crop[1] ];\n\tthis.changed();\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A source for grid binning\n * @constructor\n * @extends {ol.source.Vector}\n * @param {Object} options ol.source.VectorOptions + grid option\n *  @param {ol.source.Vector} options.source Source\n *  @param {number} [options.size] size of the grid in meter, default 200m\n *  @param {(f: ol.Feature) => ol.geom.Point} [options.geometryFunction] Function that takes an ol.Feature as argument and returns an ol.geom.Point as feature's center.\n *  @param {(bin: ol.Feature, features: Array<ol.Feature>)} [options.flatAttributes] Function takes a bin and the features it contains and aggragate the features in the bin attributes when saving\n */\nol.source.GridBin = function (options) {\n  options = options || {};\n  ol.source.BinBase.call(this, options);\n  this.set('gridProjection', options.gridProjection || 'EPSG:4326');\n  this.set('size', options.size || 1);\n};\nol.ext.inherits(ol.source.GridBin, ol.source.BinBase);\n/** Set grid projection\n * @param {ol.ProjectionLike} proj\n */\nol.source.GridBin.prototype.setGridProjection = function (proj) {\n  this.set('gridProjection', proj);\n  this.reset();\n};\n/** Set grid size\n * @param {number} size\n */\nol.source.GridBin.prototype.setSize = function (size) {\n  this.set('size', size);\n  this.reset();\n};\n/** Get the grid geometry at the coord \n * @param {ol.Coordinate} coord\n * @returns {ol.geom.Polygon} \n * @api\n */\nol.source.GridBin.prototype.getGridGeomAt = function (coord) {\n  coord = ol.proj.transform (coord, this.getProjection() || 'EPSG:3857', this.get('gridProjection'));\n  var size = this.get('size');\n  var x = size * Math.floor(coord[0] / size);\n  var y = size * Math.floor(coord[1] / size);\n  var geom = new ol.geom.Polygon([[[x,y], [x+size,y], [x+size,y+size], [x,y+size], [x,y]]]);\n  return geom.transform(this.get('gridProjection'), this.getProjection() || 'EPSG:3857');\n};\n\n/*\tCopyright (c) 2017-2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A source for hexagonal binning\n * @constructor\n * @extends {ol.source.Vector}\n * @param {Object} options ol.source.VectorOptions + ol.HexGridOptions\n *  @param {ol.source.Vector} options.source Source\n *  @param {number} [options.size] size of the hexagon in map units, default 80000\n *  @param {ol.coordinate} [options.origin] origin of the grid, default [0,0]\n *  @param {import('../render/HexGrid').HexagonLayout} [options.layout] grid layout, default pointy\n *  @param {(f: ol.Feature) => ol.geom.Point} [options.geometryFunction] Function that takes an ol.Feature as argument and returns an ol.geom.Point as feature's center.\n *  @param {(bin: ol.Feature, features: Array<ol.Feature>)} [options.flatAttributes] Function takes a bin and the features it contains and aggragate the features in the bin attributes when saving\n */\nol.source.HexBin = function (options) {\n  options = options || {};\n  /** The HexGrid\n   * \t@type {ol.HexGrid}\n   */\n  this._hexgrid = new ol.HexGrid(options);\n  ol.source.BinBase.call(this, options);\n};\nol.inherits(ol.source.HexBin, ol.source.BinBase);\n/** Get the hexagon geometry at the coord \n * @param {ol.Coordinate} coord\n * @returns {ol.geom.Polygon} \n * @api\n */\nol.source.HexBin.prototype.getGridGeomAt = function (coord) {\n  var h = this._hexgrid.coord2hex(coord);\n  return new ol.geom.Polygon([this._hexgrid.getHexagon(h)])\n};\n/**\tSet the inner HexGrid size.\n * \t@param {number} newSize\n * \t@param {boolean} noreset If true, reset will not be called (It need to be called through)\n */\nol.source.HexBin.prototype.setSize = function (newSize, noreset) {\n  this._hexgrid.setSize(newSize);\n  if (!noreset) {\n    this.reset();\n  }\n}\n/**\tGet the inner HexGrid size.\n * \t@return {number}\n */\nol.source.HexBin.prototype.getSize = function () {\n  return this._hexgrid.getSize();\n}\n/**\tSet the inner HexGrid layout.\n * \t@param {import('../render/HexGrid').HexagonLayout} newLayout\n * \t@param {boolean} noreset If true, reset will not be called (It need to be called through)\n */\nol.source.HexBin.prototype.setLayout = function (newLayout, noreset) {\n  this._hexgrid.setLayout(newLayout);\n  if (!noreset) {\n    this.reset();\n  }\n}\n/**\tGet the inner HexGrid layout.\n * \t@return {import('../render/HexGrid').HexagonLayout}\n */\nol.source.HexBin.prototype.getLayout = function () {\n  return this._hexgrid.getLayout();\n}\n/**\tSet the inner HexGrid origin.\n * \t@param {ol.Coordinate} newLayout\n * \t@param {boolean} noreset If true, reset will not be called (It need to be called through)\n */\nol.source.HexBin.prototype.setOrigin = function (newLayout, noreset) {\n  this._hexgrid.setOrigin(newLayout);\n  if (!noreset) {\n    this.reset();\n  }\n}\n/**\tGet the inner HexGrid origin.\n * \t@return {ol.Coordinate}\n */\nol.source.HexBin.prototype.getOrigin = function () {\n  return this._hexgrid.getOrigin();\n}\n/**\n * Get hexagons without circular dependencies (vs. getFeatures)\n * @return {Array<ol.Feature>}\n */\nol.source.HexBin.prototype.getHexFeatures = function () {\n  return ol.source.BinBase.prototype.getGridFeatures.call(this);\n};\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO,\n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A source for INSEE grid\n * @constructor\n * @extends {ol.source.Vector}\n * @param {Object} options ol.source.VectorOptions + grid option\n *  @param {ol.source.Vector} options.source Source\n *  @param {number} [options.size] size of the grid in meter, default 200m\n *  @param {(f: ol.Feature) => ol.geom.Point} [options.geometryFunction] Function that takes an ol.Feature as argument and returns an ol.geom.Point as feature's center.\n *  @param {(bin: ol.Feature, features: Array<ol.Feature>)} [options.flatAttributes] Function takes a bin and the features it contains and aggragate the features in the bin attributes when saving\n */\nol.source.InseeBin = function (options) {\n  options = options || {};\n  this._grid = new ol.InseeGrid({ size: options.size });\n  ol.source.BinBase.call(this, options);\n};\nol.ext.inherits(ol.source.InseeBin, ol.source.BinBase);\n/** Set grid size\n * @param {number} size\n */\nol.source.InseeBin.prototype.setSize = function (size) {\n  if (this.getSize() !== size) {\n    this._grid.set('size', size);\n    this.reset();\n  }\n};\n/** Get grid size\n * @return {number} size\n */\nol.source.InseeBin.prototype.getSize = function () {\n  return this._grid.get('size');\n};\n/** Get the grid geometry at the coord \n * @param {ol.Coordinate} coord\n * @returns {ol.geom.Polygon} \n * @api\n */\nol.source.InseeBin.prototype.getGridGeomAt = function (coord) {\n  return this._grid.getGridAtCoordinate(coord, this.getProjection());\n};\n/** Get grid extent \n * @param {ol.ProjectionLike} proj\n * @return {ol.Extent}\n */\nol.source.InseeBin.prototype.getGridExtent = function (proj) {\n  return this._grid.getExtent(proj);\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n\t@classdesc\n\tol.source.Mapillary is a source that load Mapillary's geotagged photos in a vector layer.\n\tInherits from:\n\t<ol.source.Vector>\n*/\n/**\n* @constructor ol.source.Mapillary\n* @extends {ol.source.Vector}\n* @param {olx.source.Mapillary=} options\n*/\nol.source.Mapillary = function(opt_options)\n{\tvar options = opt_options || {};\n\toptions.loader = this._loaderFn;\n\t/** Max resolution to load features  */\n\tthis._maxResolution = options.maxResolution || 100;\n\t/** Query limit */\n\tthis._limit = options.limit || 100;\n\t/** Default attribution */\n\tif (!options.attributions) options.attributions = [ \"&copy; <a href='https://www.mapillary.com/'>Mapillary</a>\" ];\n\t// Bbox strategy : reload at each move\n    if (!options.strategy) options.strategy = ol.loadingstrategy.bbox;\n\t// Init parent\n\tol.source.Vector.call (this, options);\n\t// Client ID\n\t// this.set(\"clientId\", options.clientId);\n};\nol.inherits (ol.source.Mapillary, ol.source.Vector);\n/** Decode wiki attributes and choose to add feature to the layer\n* @param {feature} the feature\n* @param {attributes} wiki attributes\n* @return {boolean} true: add the feature to the layer\n* @API stable\n*/\nol.source.Mapillary.prototype.readFeature = function (/*feature, attributes*/)\n{\t// Allways read feature (no filter)\n\treturn true;\n};\n/** Loader function used to load features.\n* @private\n*/\nol.source.Mapillary.prototype._loaderFn = function(extent, resolution, projection)\n{\tif (resolution > this._maxResolution) return;\n\tvar bbox = ol.proj.transformExtent(extent, projection, \"EPSG:4326\");\n\t// Commons API: for more info @see https://www.mapillary.com/developer\n\tvar date = Date.now() - 6 * 30 * 24 * 60 * 60 * 1000;\n\tvar url = \"https://a.mapillary.com/v2/search/im?client_id=\"\n\t\t+ this.get('clientId')\n\t\t+ \"&max_lat=\" + bbox[3]\n\t\t+ \"&max_lon=\" + bbox[2]\n\t\t+ \"&min_lat=\" + bbox[1]\n\t\t+ \"&min_lon=\" + bbox[0]\n\t\t+ \"&limit=\"+(this._limit-1)\n\t\t+ \"&start_time=\" + date;\n\t// Ajax request to get the tile\n\tol.ext.Ajax.get(\n\t{\turl: url,\n\t\tdataType: 'jsonp', \n\t\tsuccess: function(data) \n\t\t{\tconsole.log(data);\n\t\t\t/*\n\t\t\tvar features = [];\n\t\t\tvar att, pt, feature, lastfeature = null;\n\t\t\tif (data.query && data.query.pages) return;\n\t\t\tfor ( var i in data.query.pages)\n\t\t\t{\tatt = data.query.pages[i];\n\t\t\t\tif (att.coordinates && att.coordinates.length ) \n\t\t\t\t{\tpt = [att.coordinates[0].lon, att.coordinates[0].lat];\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\tvar meta = att.imageinfo[0].metadata;\n\t\t\t\t\tif (!meta)\n\t\t\t\t\t{\t//console.log(att);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tpt = [];\n\t\t\t\t\tfor (var k=0; k<meta.length; k++)\n\t\t\t\t\t{\tif (meta[k].name==\"GPSLongitude\") pt[0] = meta[k].value;\n\t\t\t\t\t\tif (meta[k].name==\"GPSLatitude\") pt[1] = meta[k].value;\n\t\t\t\t\t}\n\t\t\t\t\tif (!pt.length) \n\t\t\t\t\t{\t//console.log(att);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfeature = new ol.Feature(new ol.geom.Point(ol.proj.transform (pt,\"EPSG:4326\",projection)));\n\t\t\t\tatt.imageinfo[0].title = att.title;\n\t\t\t\tif (self.readFeature(feature, att.imageinfo[0]))\n\t\t\t\t{\tfeatures.push(feature);\n\t\t\t\t}\n\t\t\t}\n\t\t\tself.addFeatures(features);\n\t\t\t*/\n    }});\n};\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * OSM layer using the Ovepass API\n * @constructor ol.source.Overpass\n * @extends {ol.source.Vector}\n * @param {any} options\n *  @param {string} options.url service url, default: https://overpass-api.de/api/interpreter\n *  @param {Array<string>} options.filter an array of tag filters, ie. [\"key\", \"key=value\", \"key~value\", ...]\n *  @param {boolean} options.node get nodes, default: true\n *  @param {boolean} options.way get ways, default: true\n *  @param {boolean} options.rel get relations, default: false\n *  @param {number} options.maxResolution maximum resolution to load features\n *  @param {string|ol.Attribution|Array<string>} options.attributions source attribution, default OSM attribution\n *  @param {ol.loadingstrategy} options.strategy loading strategy, default ol.loadingstrategy.bbox\n */\nol.source.Overpass = function(options) {\n\toptions = options || {};\n\toptions.loader = this._loaderFn;\n\t/** Ovepass API Url */\n\tthis._url = options.url || 'https://overpass-api.de/api/interpreter';\n\t/** Max resolution to load features  */\n\tthis._maxResolution = options.maxResolution || 100;\n\t/** Default attribution */\n\tif (!options.attributions) {\n    options.attributions = ol.source.OSM.ATTRIBUTION;\n  }\n\t// Bbox strategy : reload at each move\n  if (!options.strategy) options.strategy = ol.loadingstrategy.bbox;\n  ol.source.Vector.call (this, options);\n  this._types = {\n    node: options.node!==false,\n    way: options.way!==false,\n    rel: options.rel===true\n  };\n  this._filter = options.filter;\n};\nol.inherits (ol.source.Overpass, ol.source.Vector);\n/** Loader function used to load features.\n* @private\n*/\nol.source.Overpass.prototype._loaderFn = function(extent, resolution, projection) {\n  if (resolution > this._maxResolution) return;\n\tvar self = this;\n  var bbox = ol.proj.transformExtent(extent, projection, \"EPSG:4326\");\n  bbox = bbox[1] + ',' + bbox[0] + ',' + bbox[3] + ',' + bbox[2];\n  // Overpass QL\n  var query = '[bbox:'+bbox+'][out:xml][timeout:25];';\n  query += '(';\n  // Search attributes\n  for (var t in this._types) {\n    if (this._types[t]) {\n      query += t;\n      for (var n=0, filter; filter = this._filter[n]; n++) {\n        query += '['+filter+']';\n      }\n      query += ';'\n    }\n  }\n  query +=');out;>;out skel qt;'\n  var ajax = new XMLHttpRequest();\n\tajax.open('POST', this._url, true);\n\tajax.onload = function () {\n    var features = new ol.format.OSMXML().readFeatures(this.responseText,{featureProjection: projection});\n    var result = [];\n    // Remove duplicated features\n    for (var i=0, f; f=features[i]; i++) {\n      if (!self.hasFeature(f)) result.push(f);\n    }\n    self.addFeatures(result);\n\t};\n\tajax.onerror = function () {\n\t\tconsole.log(arguments);\n\t};\n  ajax.send('data='+query);\n};\n/**\n * Search if feature is allready loaded\n * @param {ol.Feature} feature\n * @return {boolean} \n * @private\n */\nol.source.Overpass.prototype.hasFeature = function(feature) {\n\tvar p = feature.getGeometry().getFirstCoordinate();\n\tvar id = feature.getId();\n\tvar existing = this.getFeaturesInExtent([p[0]-0.1, p[1]-0.1, p[0]+0.1, p[1]+0.1]);\n\tfor (var i=0, f; f=existing[i]; i++) {\n\t\tif (id===f.getId()) {\n      return true;\n    }\n\t}\n\treturn false;\n};\n\n(function () {\n  var clear = ol.source.Vector.prototype.clear;\n  /** Overwrite ol/source/Vector clear to fire clearstart / clearend event\n   */\n  ol.source.Vector.prototype.clear = function(opt_fast) {\n    this.dispatchEvent({ type: 'clearstart' });\n    clear.call(this, opt_fast)\n    this.dispatchEvent({ type: 'clearend' });\n  };\n})();\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n  @classdesc\n  ol.source.WikiCommons is a source that load Wikimedia Commons content in a vector layer.\n  Inherits from:\n  <ol.source.Vector>\n*/\n/**\n* @constructor ol.source.WikiCommons\n* @extends {ol.source.Vector}\n* @param {olx.source.WikiCommons=} options\n*/\nol.source.WikiCommons = function(opt_options) {\n  var options = opt_options || {};\n  options.loader = this._loaderFn;\n  /** Max resolution to load features  */\n  this._maxResolution = options.maxResolution || 100;\n  /** Result language */\n  this._lang = options.lang || \"fr\";\n  /** Query limit */\n  this._limit = options.limit || 100;\n  /** Default attribution */\n  if (!options.attributions) options.attributions = [ \"&copy; <a href='https://commons.wikimedia.org/'>Wikimedia Commons</a>\" ];\n  // Bbox strategy : reload at each move\n    if (!options.strategy) options.strategy = ol.loadingstrategy.bbox;\n  ol.source.Vector.call (this, options);\n};\nol.inherits (ol.source.WikiCommons, ol.source.Vector);\n/** Decode wiki attributes and choose to add feature to the layer\n* @param {feature} the feature\n* @param {attributes} wiki attributes\n* @return {boolean} true: add the feature to the layer\n* @API stable\n*/\nol.source.WikiCommons.prototype.readFeature = function (feature, attributes){\n  feature.set(\"descriptionurl\", attributes.descriptionurl);\n  feature.set(\"url\", attributes.url);\n  feature.set(\"title\", attributes.title.replace(/^file:|.jpg$/ig,\"\"));\n  feature.set(\"thumbnail\", attributes.url.replace(/^(.+wikipedia\\/commons)\\/([a-zA-Z0-9]\\/[a-zA-Z0-9]{2})\\/(.+)$/,\"$1/thumb/$2/$3/200px-$3\"));\n  feature.set(\"user\", attributes.user);\n  if (attributes.extmetadata && attributes.extmetadata.LicenseShortName) feature.set(\"copy\", attributes.extmetadata.LicenseShortName.value);\n  return true;\n};\n/** Loader function used to load features.\n* @private\n*/\nol.source.WikiCommons.prototype._loaderFn = function(extent, resolution, projection){\n  if (resolution > this._maxResolution) return;\n  var self = this;\n  var bbox = ol.proj.transformExtent(extent, projection, \"EPSG:4326\");\n  // Commons API: for more info @see https://commons.wikimedia.org/wiki/Commons:API/MediaWiki\n  var url = \"https://commons.wikimedia.org/w/api.php?action=query&format=json&origin=*&prop=coordinates|imageinfo\"\n    + \"&generator=geosearch&iiprop=timestamp|user|url|extmetadata|metadata|size&iiextmetadatafilter=LicenseShortName\"\n    + \"&ggsbbox=\" + bbox[3] + \"|\" + bbox[0] + \"|\" + bbox[1] + \"|\" + bbox[2]\n    + \"&ggslimit=\"+this._limit\n    + \"&iilimit=\"+(this._limit-1)\n    + \"&ggsnamespace=6\";\n  // Ajax request to get the tile\n  ol.ext.Ajax.get({\n    url: url,\n    success: function(data) {\n      //console.log(data);\n      var features = [];\n      var att, pt, feature;\n      if (!data.query || !data.query.pages) return;\n      for ( var i in data.query.pages){\n        att = data.query.pages[i];\n        if (att.coordinates && att.coordinates.length ) {\n          pt = [att.coordinates[0].lon, att.coordinates[0].lat];\n        } else {\n          var meta = att.imageinfo[0].metadata;\n          if (!meta) {\n            //console.log(att);\n            continue;\n          }\n          pt = [];\n          var found=0;\n          for (var k=0; k<meta.length; k++) {\n            if (meta[k].name==\"GPSLongitude\") {\n              pt[0] = meta[k].value;\n              found++;\n            }\n            if (meta[k].name==\"GPSLatitude\") {\n              pt[1] = meta[k].value;\n              found++;\n            }\n          }\n          if (found!=2) {\n            //console.log(att);\n            continue;\n          }\n        }\n        feature = new ol.Feature(new ol.geom.Point(ol.proj.transform (pt,\"EPSG:4326\",projection)));\n        att.imageinfo[0].title = att.title;\n        if (self.readFeature(feature, att.imageinfo[0])) {\n          features.push(feature);\n        }\n      }\n      self.addFeatures(features);\n  }});\n};\n\n/*\n\tCopyright (c) 2015 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (http://www.cecill.info/).\n\tol.layer.AnimatedCluster is a vector layer that animate cluster\n*/\n//\n/**\n *  A vector layer for animated cluster\n * @constructor \n * @extends {ol.layer.Vector}\n * @param {olx.layer.AnimatedClusterOptions=} options extend olx.layer.Options\n * \t@param {Number} options.animationDuration animation duration in ms, default is 700ms \n * \t@param {ol.easingFunction} animationMethod easing method to use, default ol.easing.easeOut\n */\nol.layer.AnimatedCluster = function(opt_options)\n{\tvar options = opt_options || {};\n\tol.layer.Vector.call (this, options);\n\tthis.oldcluster = new ol.source.Vector();\n\tthis.clusters = [];\n\tthis.animation={start:false};\n\tthis.set('animationDuration', typeof(options.animationDuration)=='number' ? options.animationDuration : 700);\n\tthis.set('animationMethod', options.animationMethod || ol.easing.easeOut);\n\t// Save cluster before change\n\tthis.getSource().on('change', this.saveCluster.bind(this));\n\t// Animate the cluster\n\tthis.on(['precompose','prerender'], this.animate.bind(this));\n\tthis.on(['postcompose','postrender'], this.postanimate.bind(this));\n};\nol.inherits (ol.layer.AnimatedCluster, ol.layer.Vector);\n/** save cluster features before change\n * @private\n */\nol.layer.AnimatedCluster.prototype.saveCluster = function() {\n\tif (this.oldcluster) {\n\t\tthis.oldcluster.clear();\n\t\tif (!this.get('animationDuration')) return;\n\t\tvar features = this.getSource().getFeatures();\n\t\tif (features.length && features[0].get('features'))\n\t\t{\tthis.oldcluster.addFeatures (this.clusters);\n\t\t\tthis.clusters = features.slice(0);\n\t\t\tthis.sourceChanged = true;\n\t\t}\n\t}\n};\n/** \n * Get the cluster that contains a feature\n * @private\n*/\nol.layer.AnimatedCluster.prototype.getClusterForFeature = function(f, cluster)\n{\tfor (var j=0, c; c=cluster[j]; j++)\n\t{\tvar features = c.get('features');\n\t\tif (features && features.length) \n\t\t{\tfor (var k=0, f2; f2=features[k]; k++)\n\t\t\t{\tif (f===f2) \n\t\t\t\t{\treturn c;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n};\n/** \n * Stop animation \n * @private \n */\nol.layer.AnimatedCluster.prototype.stopAnimation = function()\n{\tthis.animation.start = false;\n\tthis.animation.cA = [];\n\tthis.animation.cB = [];\n};\n/** \n * animate the cluster\n * @private\n */\nol.layer.AnimatedCluster.prototype.animate = function(e)\n{\tvar duration = this.get('animationDuration');\n\tif (!duration) return;\n\tvar resolution = e.frameState.viewState.resolution;\n\tvar i, c0, a = this.animation;\n\tvar time = e.frameState.time;\n\t// Start a new animation, if change resolution and source has changed\n\tif (a.resolution != resolution && this.sourceChanged)\n\t{\tvar extent = e.frameState.extent;\n\t\tif (a.resolution < resolution)\n\t\t{\textent = ol.extent.buffer(extent, 100*resolution);\n\t\t\ta.cA = this.oldcluster.getFeaturesInExtent(extent);\n\t\t\ta.cB = this.getSource().getFeaturesInExtent(extent);\n\t\t\ta.revers = false;\n\t\t}\n\t\telse\n\t\t{\textent = ol.extent.buffer(extent, 100*resolution);\n\t\t\ta.cA = this.getSource().getFeaturesInExtent(extent);\n\t\t\ta.cB = this.oldcluster.getFeaturesInExtent(extent);\n\t\t\ta.revers = true;\n\t\t}\n\t\ta.clusters = [];\n\t\tfor (i=0, c0; c0=a.cA[i]; i++)\n\t\t{\tvar f = c0.get('features');\n\t\t\tif (f && f.length) \n\t\t\t{\tvar c = this.getClusterForFeature (f[0], a.cB);\n\t\t\t\tif (c) a.clusters.push({ f:c0, pt:c.getGeometry().getCoordinates() });\n\t\t\t}\n\t\t}\n\t\t// Save state\n\t\ta.resolution = resolution;\n\t\tthis.sourceChanged = false;\n\t\t// No cluster or too much to animate\n\t\tif (!a.clusters.length || a.clusters.length>1000) \n\t\t{\tthis.stopAnimation();\n\t\t\treturn;\n\t\t}\n\t\t// Start animation from now\n\t\ttime = a.start = (new Date()).getTime();\n\t}\n\t// Run animation\n\tif (a.start) {\n\t\tvar vectorContext = e.vectorContext; // || ol.render.getVectorContext(e);\n\t\tconsole.log(vectorContext)\n\t\tvar d = (time - a.start) / duration;\n\t\t// Animation ends\n\t\tif (d > 1.0) \n\t\t{\tthis.stopAnimation();\n\t\t\td = 1;\n\t\t}\n\t\td = this.get('animationMethod')(d);\n\t\t// Animate\n\t\tvar style = this.getStyle();\n\t\tvar stylefn = (typeof(style) == 'function') ? style : style.length ? function(){ return style; } : function(){ return [style]; } ;\n\t\t// Layer opacity\n\t\te.context.save();\n\t\te.context.globalAlpha = this.getOpacity();\n\t\t// Retina device\n\t\tvar ratio = e.frameState.pixelRatio;\n\t\tfor (i=0, c; c=a.clusters[i]; i++)\n\t\t{\tvar pt = c.f.getGeometry().getCoordinates();\n\t\t\tvar dx = pt[0]-c.pt[0];\n\t\t\tvar dy = pt[1]-c.pt[1];\n\t\t\tif (a.revers)\n\t\t\t{\tpt[0] = c.pt[0] + d * dx;\n\t\t\t\tpt[1] = c.pt[1] + d * dy;\n\t\t\t}\n\t\t\telse\n\t\t\t{\tpt[0] = pt[0] - d * dx;\n\t\t\t\tpt[1] = pt[1] - d * dy;\n\t\t\t}\n\t\t\t// Draw feature\n\t\t\tvar st = stylefn(c.f, resolution, true);\n\t\t\t// Preserve pixel ration on retina\n\t\t\tvar geo = new ol.geom.Point(pt);\n\t\t\tfor (var k=0, s; s=st[k]; k++)\n\t\t\t{\tvar sc;\n\t\t\t\t// OL < v4.3 : setImageStyle doesn't check retina\n\t\t\t\tvar imgs = ol.Map.prototype.getFeaturesAtPixel ? false : s.getImage();\n\t\t\t\tif (imgs)\n\t\t\t\t{\tsc = imgs.getScale(); \n\t\t\t\t\timgs.setScale(sc*ratio); \n\t\t\t\t}\n\t\t\t\t// OL3 > v3.14\n\t\t\t\tif (vectorContext.setStyle)\n\t\t\t\t{\t// If one feature: draw the feature\n\t\t\t\t\tif (c.f.get(\"features\").length===1 && !dx && !dy) {\n\t\t\t\t\t\tvectorContext.drawFeature(c.f.get(\"features\")[0], s);\n\t\t\t\t\t}\n\t\t\t\t\t// else draw a point\n\t\t\t\t\telse {\n\t\t\t\t\t\tvectorContext.setStyle(s);\n\t\t\t\t\t\tvectorContext.drawGeometry(geo);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// older version\n\t\t\t\telse\n\t\t\t\t{\tvectorContext.setImageStyle(imgs);\n\t\t\t\t\tvectorContext.setTextStyle(s.getText());\n\t\t\t\t\tvectorContext.drawPointGeometry(geo);\n\t\t\t\t}\n\t\t\t\tif (imgs) imgs.setScale(sc);\n\t\t\t}\n\t\t}\n\t\te.context.restore();\n\t\t// tell OL3 to continue postcompose animation\n\t\te.frameState.animate = true;\n\t\t// Prevent layer drawing (clip with null rect)\n\t\te.context.save();\n\t\te.context.beginPath();\n\t\te.context.rect(0,0,0,0);\n\t\te.context.clip();\n\t\tthis.clip_ = true;\n\t}\n\treturn;\n};\n/**  \n * remove clipping after the layer is drawn\n * @private\n */\nol.layer.AnimatedCluster.prototype.postanimate = function(e)\n{\tif (this.clip_)\n\t{\te.context.restore();\n\t\tthis.clip_ = false;\n\t}\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * Return a preview image of the source.\n * @param {ol.Coordinate|undefined} lonlat The center of the preview.\n * @param {number} resolution of the preview.\n * @return {String} the preview url\n * @api\n */\nol.source.Source.prototype.getPreview = function(/*lonlat, resolution*/) {\n\treturn \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAk6QAAJOkBUCTn+AAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAANeSURBVHic7ZpPiE1RHMc/780MBhkik79JSUlIUbOxI+wkI2yRhYSUlJLNpJF/xcpiJBmZGBZsNM1CkmhKITGkGbH0/BuPmXnP4rxbb/TOn3fvOffeec6nfqvb/b7f93fveeec37ng8Xg8Ho/nf6Uu4d+fDswFssCvhHOJhaXAMeApMAQUyyIPPAdOAiuTStAVy4EHjDWsix5gdRLJ2mY34ulWYz6IEeA4kIk9awtkgTOEM/5vdAKT4k0/Ou3YMR/ELcbRm9AKFLBbgCJwNE4TYZkJfMG++SIwDCyLz0o4bI17WdyJz0r1TAZ+oDcxCBwAFgIzEIuhvcBbg3sLwOK4DFXLFvQGniCGSSUagS4DjUPOHESkA3XiOWCORqMR6Nfo9DjI3QqPUSd+ylBnv0Zn0GrWFvmIOvGNhjqrNDp/EAutyFgRKUM2tgO+Gur81FxvAKYZaimxXYBvmuuLDHWWaK4X0RfJCNsF6NdcbzXU2a65PohYFKWOc+jn8PUajbWIXaBKp9NB7lZYh34OzwFbFfd/NtDYYSth27urLGIm0M31AL3APWAAmIooymaDnPIl/Vz4NN1yHrd7gcvxWQnHAuA3bsyPop8hUsE13BSgK04TUViBeFo2zedJ8S6wElexW4D2eNOPTjNi6WvD/DtEr8E6tk6GGoAmxFY2iFHE9NZiQf8gogiB9gTEH23izAZuE77vHyU+ANucO1QwD3hD/MbLowAcdm20EmkwXx4n3NodS9rMB2HabYpEWs0HcRqHp0fNwAvJD+eBTZr7p6BvmQVxUaEzEbiruNfJekH15L8jtrEm7JJolEcOmKXRqQOuKDQuY7HZY8s8iNfzkSLxIuI43FTrkkLnOlBfRW4VsWk+oAX5weknxFAxJQNckGgVgZuIRVoomoGXEmGTMa+iQ6K7M4SW7k24QYgiuDQPYinbhugiF4H3RGtzZYCzyIvQXfpNI1ybLyeLpf5+iTbkRbiP2EcocTHm4+YI8iI8RFHwWjAfsA95Q+YZFU6wasl8wB7kReijtNbIILa0vcg/PRlGfPQwHmlCviDqAzaA+OREtzqr1ejOIDorxlNEjTGUBV4nnUWCvAJxGDlA8q9j3DEArAn2zvXAfOwfl6eVAmJrPpJ0Ih6Px+PxeJLjLwPul3vj5d0eAAAAAElFTkSuQmCC\";\n};\n/**\n * Return the tile image of the source.\n * @param {ol.Coordinate|undefined} lonlat The center of the preview.\n * @param {number} resolution of the preview.\n * @return {String} the preview url\n * @api\n */\nol.source.Tile.prototype.getPreview = function(lonlat, resolution)\n{\tif (!lonlat) lonlat = [21020, 6355964];\n\tif (!resolution) resolution = 150;\n\tvar coord = this.getTileGrid().getTileCoordForCoordAndResolution(lonlat, resolution);\n\tvar fn = this.getTileUrlFunction();\n\treturn fn.call(this, coord, this.getProjection());\n};\n/**\n * Return the tile image of the source.\n * @param {ol.Coordinate|undefined} lonlat The center of the preview.\n * @param {number} resolution of the preview.\n * @return {String} the preview url\n * @api\n */\nol.source.TileWMS.prototype.getPreview = function(lonlat, resolution)\n{\tif (!lonlat) lonlat = [21020, 6355964];\n\tif (!resolution) resolution = 150;\n/*\tNo way to acces tileUrlFunction...\n\tvar fn = this.getTileUrlFunction();\n\treturn fn.call(this, lonlat, this.getProjection());\n*/\n\t// Use getfeature info instead\n\tvar url = this.getGetFeatureInfoUrl(lonlat, resolution, this.getProjection() || 'EPSG:3857', {});\n\turl = url.replace(/getfeatureinfo/i,\"GetMap\");\n\treturn url;\n};\n/**\n * Return a preview for the layer.\n * @param {ol.Coordinate|undefined} lonlat The center of the preview.\n * @param {number} resolution of the preview.\n * @return {Array<String>} list of preview url\n * @api\n */\nol.layer.Base.prototype.getPreview = function(lonlat, resolution)\n{\tif (this.get(\"preview\")) return [ this.get(\"preview\") ];\n\tif (!resolution) resolution = 150;\n\t// Get middle resolution\n\tif (resolution < this.getMinResolution() || resolution > this.getMaxResolution()) \n\t{\tvar rmin = this.getMinResolution(),\n\t\t\trmax = this.getMaxResolution();\n\t\tif (rmax>100000) rmax = 156543;\t// min zoom : world\n\t\tif (rmin<0.15) rmin = 0.15;\t// max zoom \n\t\tresolution = rmax;\n\t\twhile (rmax>rmin) \n\t\t{\trmin *= 2;\n\t\t\trmax /= 2;\n\t\t\tresolution = rmin;\n\t\t}\n\t}\n\tvar e = this.getExtent();\n\tif (!lonlat) lonlat = [21020, 6355964];\t// Default lonlat\n\tif (e && !ol.extent.containsCoordinate(e,lonlat)) lonlat = [ (e[0]+e[2])/2, (e[1]+e[3])/2 ];\n\tif (this.getSource) return [ this.getSource().getPreview(lonlat, resolution) ];\n\treturn [];\n};\n/**\n * Return a preview for the layer.\n * @param {_ol_coordinate_|undefined} lonlat The center of the preview.\n * @param {number} resolution of the preview.\n * @return {Array<String>} list of preview url\n * @api\n */\nol.layer.Group.prototype.getPreview = function(lonlat, resolution)\n{\tif (this.get(\"preview\")) return [ this.get(\"preview\") ];\n\tvar t = [];\n\tif (this.getLayers) \n\t{\tvar l = this.getLayers().getArray();\n\t\tfor (var i=0; i<l.length; i++) \n\t\t{\tt = t.concat(l[i].getPreview(lonlat, resolution));\n\t\t}\n\t}\n\treturn t;\n};\n//NB: (Not confirmed)To use this module, you just have to :\n\t\t\t\t//   import('ol-ext/layer/getpreview')\n\n/** ol.layer.Vector.prototype.setRender3D\n * @extends {ol.layer.Vector}\n * @param {ol.render3D}\n */\nol.layer.Vector.prototype.setRender3D = function (r)\n{\tr.setLayer(this);\n}\n/** \n *\t@classdesc\n *\tol.render3D 3D vector layer rendering\n *\t@constructor\n *\t@param {olx.render3DOption}\n *\t\t- masResolution {number} max resolution to render 3D\n *\t\t- defaultHeight {number} default height if none is return by a propertie\n *\t\t- height {function|string|Number} a height function (return height giving a feature) or a popertie name for the height or a fixed value\n */\nol.render3D = function (options) {\n\toptions = options || {};\n\tthis.maxResolution_ = options.maxResolution || 100\n\tthis.defaultHeight_ = options.defaultHeight || 0;\n\tthis.height_ = this.getHfn (options.height);\n}\n/** Calculate 3D at potcompose\n*/\nol.render3D.prototype.onPostcompose_ = function(e)\n{\tvar res = e.frameState.viewState.resolution;\n\tif (res > this.maxResolution_) return;\n\tthis.res_ = res*400;\n\tif (this.animate_) \n\t{\tvar elapsed = e.frameState.time - this.animate_;\n\t\tif (elapsed < this.animateDuration_)\n\t\t{\tthis.elapsedRatio_ = this.easing_(elapsed / this.animateDuration_);\n\t\t\t// tell OL3 to continue postcompose animation\n\t\t\te.frameState.animate = true;\n\t\t}\n\t\telse\n\t\t{\tthis.animate_ = false;\n\t\t\tthis.height_ = this.toHeight_\n\t\t}\n\t}\n\tvar ratio = e.frameState.pixelRatio;\n\tvar ctx = e.context;\n\tvar m = this.matrix_ = e.frameState.coordinateToPixelTransform;\n\t// Old version (matrix)\n\tif (!m)\n\t{\tm = e.frameState.coordinateToPixelMatrix,\n\t\tm[2] = m[4];\n\t\tm[3] = m[5];\n\t\tm[4] = m[12];\n\t\tm[5] = m[13];\n\t}\n\tthis.center_ = [ctx.canvas.width/2/ratio, ctx.canvas.height/ratio];\n\tvar f = this.layer_.getSource().getFeaturesInExtent(e.frameState.extent);\n\tctx.save();\n\tctx.scale(ratio,ratio);\n\tctx.lineWidth = 1;\n\tctx.strokeStyle = \"red\";\n\tctx.fillStyle = \"rgba(0,0,255,0.5)\";\n\tvar builds = [];\n\tfor (var i=0; i<f.length; i++)\n\t{\tbuilds.push (this.getFeature3D_ (f[i], this.getFeatureHeight(f[i])));\n\t}\n\tthis.drawFeature3D_ (ctx, builds);\n\tctx.restore();\n}\n/** Set layer to render 3D\n*/\nol.render3D.prototype.setLayer = function(l) {\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis.layer_ = l;\n\tthis._listener = l.on ('postcompose', this.onPostcompose_.bind(this));\n}\n/** Create a function that return height of a feature\n*\t@param {function|string|number} h a height function or a popertie name or a fixed value\n*\t@return {function} function(f) return height of the feature f\n*/\nol.render3D.prototype.getHfn= function(h)\n{\tswitch (typeof(h))\n\t{\tcase 'function': return h;\n\t\tcase 'string': \n\t\t\t{\tvar dh = this.defaultHeight_;\n\t\t\t\treturn (function(f) \n\t\t\t\t{\treturn (Number(f.get(h)) || dh); \n\t\t\t\t});\n\t\t\t}\n\t\tcase 'number': return (function(/*f*/) { return h; });\n\t\tdefault: return (function(/*f*/) { return 10; });\n\t}\n}\n/** Animate rendering\n*\t@param {olx.render3D.animateOptions}\n*\t\t- height {string|function|number} an attribute name or a function returning height of a feature or a fixed value\n*\t\t- durtion {number} the duration of the animatioin ms, default 1000\n*\t\t- easing {ol.easing} an ol easing function\n*\t@api\n*/\nol.render3D.prototype.animate = function(options)\n{\toptions = options || {};\n\tthis.toHeight_ = this.getHfn(options.height);\n\tthis.animate_ = new Date().getTime();\n\tthis.animateDuration_ = options.duration ||1000;\n\tthis.easing_ = options.easing || ol.easing.easeOut;\n\t// Force redraw\n\tthis.layer_.changed();\n}\n/** Check if animation is on\n*\t@return {bool}\n*/\nol.render3D.prototype.animating = function()\n{\tif (this.animate_ && new Date().getTime() - this.animate_ > this.animateDuration_) \n\t{\tthis.animate_ = false;\n\t}\n\treturn !!this.animate_;\n}\n/** \n*/\nol.render3D.prototype.getFeatureHeight = function (f)\n{\tif (this.animate_)\n\t{\tvar h1 = this.height_(f);\n\t\tvar h2 = this.toHeight_(f);\n\t\treturn (h1*(1-this.elapsedRatio_)+this.elapsedRatio_*h2);\n\t}\n\telse return this.height_(f);\n}\n/**\n*/\nol.render3D.prototype.hvector_ = function (pt, h)\n{\tvar p0 = [\tpt[0]*this.matrix_[0] + pt[1]*this.matrix_[1] + this.matrix_[4],\n\t\t\tpt[0]*this.matrix_[2] + pt[1]*this.matrix_[3] + this.matrix_[5]\n\t\t];\n\tvar p1 = [\tp0[0] + h/this.res_*(p0[0]-this.center_[0]),\n\t\t\tp0[1] + h/this.res_*(p0[1]-this.center_[1])\n\t\t];\n\treturn {p0:p0, p1:p1};\n}\n/**\n*/\nol.render3D.prototype.getFeature3D_ = function (f, h)\n{\tvar c = f.getGeometry().getCoordinates();\n\tswitch (f.getGeometry().getType())\n\t{\tcase \"Polygon\":\n\t\t\tc = [c];\n\t\t// fallthrough\n\t\tcase \"MultiPolygon\":\n\t\t\tvar build = [];\n\t\t\tfor (var i=0; i<c.length; i++) \n\t\t\t{\tfor (var j=0; j<c[i].length; j++)\n\t\t\t\t{\tvar b = [];\n\t\t\t\t\tfor (var k=0; k<c[i][j].length; k++)\n\t\t\t\t\t{\tb.push( this.hvector_(c[i][j][k], h) );\n\t\t\t\t\t}\n\t\t\t\t\tbuild.push(b);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn { type:\"MultiPolygon\", feature:f, geom:build };\n\t\tcase \"Point\":\n\t\t\treturn { type:\"Point\", feature:f, geom:this.hvector_(c,h) };\n\t\tdefault: return {};\n\t}\n}\n/**\n*/\nol.render3D.prototype.drawFeature3D_ = function(ctx, build) {\n\tvar i,j, b, k;\n\t// Construct\n\tfor (i=0; i<build.length; i++) \n\t{\t\n\t\tswitch (build[i].type)\n\t\t{\tcase \"MultiPolygon\":\n\t\t\t\tfor (j=0; j<build[i].geom.length; j++)\n\t\t\t\t{\tb = build[i].geom[j];\n\t\t\t\t\tfor (k=0; k < b.length; k++)\n\t\t\t\t\t{\tctx.beginPath();\n\t\t\t\t\t\tctx.moveTo(b[k].p0[0], b[k].p0[1]);\n\t\t\t\t\t\tctx.lineTo(b[k].p1[0], b[k].p1[1]);\n\t\t\t\t\t\tctx.stroke();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"Point\":\n\t\t\t\t{\tvar g = build[i].geom;\n\t\t\t\t\tctx.beginPath();\n\t\t\t\t\tctx.moveTo(g.p0[0], g.p0[1]);\n\t\t\t\t\tctx.lineTo(g.p1[0], g.p1[1]);\n\t\t\t\t\tctx.stroke();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tdefault: break;\n\t\t}\n\t}\n\t// Roof\n\tfor (i=0; i<build.length; i++) \n\t{\tswitch (build[i].type)\n\t\t{\tcase \"MultiPolygon\":\n\t\t\t{\tctx.beginPath();\n\t\t\t\tfor (j=0; j<build[i].geom.length; j++)\n\t\t\t\t{\tb = build[i].geom[j];\n\t\t\t\t\tif (j==0)\n\t\t\t\t\t{\tctx.moveTo(b[0].p1[0], b[0].p1[1]);\n\t\t\t\t\t\tfor (k=1; k < b.length; k++)\n\t\t\t\t\t\t{\tctx.lineTo(b[k].p1[0], b[k].p1[1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\tctx.moveTo(b[0].p1[0], b[0].p1[1]);\n\t\t\t\t\t\tfor (k=b.length-2; k>=0; k--)\n\t\t\t\t\t\t{\tctx.lineTo(b[k].p1[0], b[k].p1[1]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tctx.closePath();\n\t\t\t\t}\n\t\t\t\tctx.fill(\"evenodd\");\n\t\t\t\tctx.stroke();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"Point\":\n\t\t\t{\tb = build[i];\n\t\t\t\tvar t = b.feature.get('label');\n\t\t\t\tvar p = b.geom.p1;\n\t\t\t\tvar f = ctx.fillStyle;\n\t\t\t\tctx.fillStyle = ctx.strokeStyle;\n\t\t\t\tctx.textAlign = 'center';\n\t\t\t\tctx.textBaseline = 'bottom';\n\t\t\t\tctx.fillText ( t, p[0], p[1] );\n\t\t\t\tvar m = ctx.measureText(t);\n\t\t\t\tvar h = Number (ctx.font.match(/\\d+(\\.\\d+)?/g).join([]));\n\t\t\t\tctx.fillStyle = \"rgba(255,255,255,0.5)\";\n\t\t\t\tctx.fillRect (p[0]-m.width/2 -5, p[1]-h -5, m.width +10, h +10)\n\t\t\t\tctx.strokeRect (p[0]-m.width/2 -5, p[1]-h -5, m.width +10, h +10)\n\t\t\t\tctx.fillStyle = f;\n\t\t\t\t//console.log(build[i].feature.getProperties())\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdefault: break;\n\t\t}\n\t}\n}\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc\n * A popup element to be displayed over the map and attached to a single map\n * location. The popup are customized using CSS.\n *\n * @example\nvar popup = new ol.Overlay.Popup();\nmap.addOverlay(popup);\npopup.show(coordinate, \"Hello!\");\npopup.hide();\n*\n* @constructor\n* @extends {ol.Overlay}\n* @param {} options Extend Overlay options \n*\t@param {String} options.popupClass the a class of the overlay to style the popup.\n*\t@param {bool} options.closeBox popup has a close box, default false.\n*\t@param {function|undefined} options.onclose: callback function when popup is closed\n*\t@param {function|undefined} options.onshow callback function when popup is shown\n*\t@param {Number|Array<number>} options.offsetBox an offset box\n*\t@param {ol.OverlayPositioning | string | undefined} options.positionning \n*\t\tthe 'auto' positioning var the popup choose its positioning to stay on the map.\n* @api stable\n*/\nol.Overlay.Popup = function (options) {\n  var self = this;\n  options = options || {};\n  if (typeof(options.offsetBox)==='number') this.offsetBox = [options.offsetBox,options.offsetBox,options.offsetBox,options.offsetBox];\n  else this.offsetBox = options.offsetBox;\n  // Popup div\n  var element = document.createElement(\"div\");\n  //element.classList.add('ol-overlaycontainer-stopevent');\n  options.element = element;\n  // Anchor div\n  var anchorElement = document.createElement(\"div\");\n  anchorElement.classList.add(\"anchor\");\n  element.appendChild(anchorElement);\n  // Content\n  this.content = ol.ext.element.create(\"div\", { \n    html: options.html || '',\n    className: \"content\",\n    parent: element\n  });\n  // Closebox\n  this.closeBox = options.closeBox;\n  this.onclose = options.onclose;\n  this.onshow = options.onshow;\n  var button = document.createElement(\"button\");\n  button.classList.add(\"closeBox\");\n  if (options.closeBox) button.classList.add('hasclosebox');\n  button.setAttribute('type', 'button');\n  element.insertBefore(button, anchorElement);\n  button.addEventListener(\"click\", function() {\n    self.hide();\n  });\n  // Stop event\n  if (options.stopEvent) {\n    element.addEventListener(\"mousedown\", function(e){ e.stopPropagation(); });\n    element.addEventListener(\"touchstart\", function(e){ e.stopPropagation(); });\n  }\n  ol.Overlay.call(this, options);\n  this._elt = this.element;\n  // call setPositioning first in constructor so getClassPositioning is called only once\n  this.setPositioning(options.positioning || 'auto');\n  this.setPopupClass(options.popupClass || options.className || 'default');\n  // Show popup on timeout (for animation purposes)\n  if (options.position) {\n    setTimeout(function(){ this.show(options.position); }.bind(this));\n  }\n};\nol.inherits(ol.Overlay.Popup, ol.Overlay);\n/**\n * Get CSS class of the popup according to its positioning.\n * @private\n */\nol.Overlay.Popup.prototype.getClassPositioning = function () {\n  var c = \"\";\n  var pos = this.getPositioning();\n  if (/bottom/.test(pos)) c += \"ol-popup-bottom \";\n  if (/top/.test(pos)) c += \"ol-popup-top \";\n  if (/left/.test(pos)) c += \"ol-popup-left \";\n  if (/right/.test(pos)) c += \"ol-popup-right \";\n  if (/^center/.test(pos)) c += \"ol-popup-middle \";\n  if (/center$/.test(pos)) c += \"ol-popup-center \";\n  return c;\n};\n/**\n * Set a close box to the popup.\n * @param {bool} b\n * @api stable\n */\nol.Overlay.Popup.prototype.setClosebox = function (b) {\n  this.closeBox = b;\n  if (b) this._elt.classList.add(\"hasclosebox\");\n  else this._elt.classList.remove(\"hasclosebox\");\n};\n/**\n * Set the CSS class of the popup.\n * @param {string} c class name.\n * @api stable\n */\nol.Overlay.Popup.prototype.setPopupClass = function (c) {\n  this._elt.className = \"\";\n    var classesPositioning = this.getClassPositioning().split(' ')\n      .filter(function(className) {\n        return className.length > 0;\n      });\n    var classes = [\"ol-popup\"];\n    if (c) {\n      c.split(' ').filter(function(className) {\n        return className.length > 0;\n      })\n      .forEach(function(className) {\n        classes.push(className);\n      });\n    } else {\n      classes.push(\"default\");\n    }\n      classesPositioning.forEach(function(className) {\n        classes.push(className);\n      });\n    if (this.closeBox) {\n      classes.push(\"hasclosebox\");\n    }\n    this._elt.classList.add.apply(this._elt.classList, classes);\n};\n/**\n * Add a CSS class to the popup.\n * @param {string} c class name.\n * @api stable\n */\nol.Overlay.Popup.prototype.addPopupClass = function (c) {\n  this._elt.classList.add(c);\n};\n/**\n * Remove a CSS class to the popup.\n * @param {string} c class name.\n * @api stable\n */\nol.Overlay.Popup.prototype.removePopupClass = function (c) {\n  this._elt.classList.remove(c);\n};\n/**\n * Set positionning of the popup\n * @param {ol.OverlayPositioning | string | undefined} pos an ol.OverlayPositioning \n * \t\tor 'auto' to var the popup choose the best position\n * @api stable\n */\nol.Overlay.Popup.prototype.setPositioning = function (pos) {\n  if (pos === undefined)\n    return;\n  if (/auto/.test(pos)) {\n    this.autoPositioning = pos.split('-');\n    if (this.autoPositioning.length==1) this.autoPositioning[1]=\"auto\";\n  }\n  else this.autoPositioning = false;\n  pos = pos.replace(/auto/g,\"center\");\n  if (pos==\"center\") pos = \"bottom-center\";\n  this.setPositioning_(pos);\n};\n/** @private\n * @param {ol.OverlayPositioning | string | undefined} pos\n */\nol.Overlay.Popup.prototype.setPositioning_ = function (pos) {\n  if (this._elt) {\n    ol.Overlay.prototype.setPositioning.call(this, pos);\n    this._elt.classList.remove(\"ol-popup-top\", \"ol-popup-bottom\", \"ol-popup-left\", \"ol-popup-right\", \"ol-popup-center\", \"ol-popup-middle\");\n    var classes = this.getClassPositioning().split(' ')\n      .filter(function(className) {\n        return className.length > 0;\n      });\n    this._elt.classList.add.apply(this._elt.classList, classes);\n  }\n};\n/** Check if popup is visible\n* @return {boolean}\n*/\nol.Overlay.Popup.prototype.getVisible = function () {\n  return this._elt.classList.contains(\"visible\");\n};\n/**\n * Set the position and the content of the popup.\n * @param {ol.Coordinate|string} coordinate the coordinate of the popup or the HTML content.\n * @param {string|undefined} html the HTML content (undefined = previous content).\n * @example\nvar popup = new ol.Overlay.Popup();\n// Show popup\npopup.show([166000, 5992000], \"Hello world!\");\n// Move popup at coord with the same info\npopup.show([167000, 5990000]);\n// set new info\npopup.show(\"New informations\");\n* @api stable\n*/\nol.Overlay.Popup.prototype.show = function (coordinate, html) {\n  if (!html && typeof(coordinate)=='string') {\n    html = coordinate; \n    coordinate = null;\n  }\n  if (coordinate===true) {\n    coordinate = this.getPosition();\n  }\n  var self = this;\n  var map = this.getMap();\n  if (!map) return;\n  if (html && html !== this.prevHTML) {\n    // Prevent flickering effect\n    this.prevHTML = html;\n    this.content.innerHTML = \"\";\n    if (html instanceof Element) {\n      this.content.appendChild(html);\n    } else {\n      this.content.insertAdjacentHTML('beforeend', html);\n    }\n    // Refresh when loaded (img)\n    Array.prototype.slice.call(this.content.querySelectorAll('img'))\n      .forEach(function(image) {\n        image.addEventListener(\"load\", function() {\n          map.renderSync();\n        });\n      });\n  }\n  if (coordinate) {\n    // Auto positionning\n    if (this.autoPositioning) {\n      var p = map.getPixelFromCoordinate(coordinate);\n      var s = map.getSize();\n      var pos=[];\n      if (this.autoPositioning[0]=='auto') {\n        pos[0] = (p[1]<s[1]/3) ? \"top\" : \"bottom\";\n      }\n      else pos[0] = this.autoPositioning[0];\n      pos[1] = (p[0]<2*s[0]/3) ? \"left\" : \"right\";\n      this.setPositioning_(pos[0]+\"-\"+pos[1]);\n      if (this.offsetBox) {\n        this.setOffset([this.offsetBox[pos[1]==\"left\"?2:0], this.offsetBox[pos[0]==\"top\"?3:1] ]);\n      }\n    } else {\n      if (this.offsetBox){\n        this.setOffset(this.offsetBox);\n      }\n    }\n    // Show\n    this.setPosition(coordinate);\n    // Set visible class (wait to compute the size/position first)\n    this._elt.parentElement.style.display = '';\n    if (typeof (this.onshow) == 'function') this.onshow();\n    this._tout = setTimeout (function() {\n      self._elt.classList.add(\"visible\"); \n    }, 0);\n  }\n};\n/**\n * Hide the popup\n * @api stable\n */\nol.Overlay.Popup.prototype.hide = function () {\n  if (this.getPosition() == undefined) return;\n  if (typeof (this.onclose) == 'function') this.onclose();\n  this.setPosition(undefined);\n  if (this._tout) clearTimeout(this._tout);\n  this._elt.classList.remove(\"visible\");\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc\n *\tThe Magnify overlay add a \"magnifying glass\" effect to an OL3 map that displays \n *\ta portion of the map in a different zoom (and actually display different content).\n *\n * @constructor\n * @extends {ol.Overlay}\n * @param {olx.OverlayOptions} options Overlay options \n * @api stable\n */\nol.Overlay.Magnify = function (options) {\n\tvar elt = document.createElement(\"div\");\n\t\t\telt.className = \"ol-magnify\";\n\tthis._elt = elt;\n\tol.Overlay.call(this,\n\t\t{\tpositioning: options.positioning || \"center-center\",\n\t\t\telement: this._elt,\n\t\t\tstopEvent: false\n\t\t});\n\t// Create magnify map\n\tthis.mgmap_ = new ol.Map(\n\t{\tcontrols: new ol.Collection(),\n\t\tinteractions: new ol.Collection(),\n\t\ttarget: options.target || this._elt,\n\t\tview: new ol.View({ projection: options.projection }),\n\t\tlayers: options.layers\n\t});\n\tthis.mgview_ = this.mgmap_.getView();\n\tthis.external_ = options.target?true:false;\n\tthis.set(\"zoomOffset\", options.zoomOffset||1);\n\tthis.set(\"active\", true);\n\tthis.on(\"propertychange\", this.setView_.bind(this));\n};\nol.inherits(ol.Overlay.Magnify, ol.Overlay);\n/**\n * Set the map instance the overlay is associated with.\n * @param {ol.Map} map The map instance.\n */\nol.Overlay.Magnify.prototype.setMap = function(map) {\n\tif (this.getMap()) {\n\t\tthis.getMap().getViewport().removeEventListener(\"mousemove\", this.onMouseMove_);\n\t}\n\tif (this._listener) ol.Observable.unByKey(this._listener);\n\tthis._listener = null;\n\tol.Overlay.prototype.setMap.call(this, map);\n\tmap.getViewport().addEventListener(\"mousemove\", this.onMouseMove_.bind(this));\n\tthis._listener = map.getView().on('propertychange', this.setView_.bind(this));\n\tthis.setView_();\n};\n/** Get the magnifier map\n*\t@return {_ol_Map_}\n*/\nol.Overlay.Magnify.prototype.getMagMap = function()\n{\treturn this.mgmap_;\n};\n/** Magnify is active\n*\t@return {boolean}\n*/\nol.Overlay.Magnify.prototype.getActive = function()\n{\treturn this.get(\"active\");\n};\n/** Activate or deactivate\n*\t@param {boolean} active\n*/\nol.Overlay.Magnify.prototype.setActive = function(active)\n{\treturn this.set(\"active\", active);\n};\n/** Mouse move\n * @private\n */\nol.Overlay.Magnify.prototype.onMouseMove_ = function(e)\n{\tvar self = this;\n\tif (!self.get(\"active\"))\n\t{\tself.setPosition();\n\t}\n\telse\n\t{\tvar px = self.getMap().getEventCoordinate(e);\n\t\tif (!self.external_) self.setPosition(px);\n\t\tself.mgview_.setCenter(px);\n\t\tif (self._elt.querySelector('canvas').style.display ==\"none\") self.mgmap_.updateSize();\n\t}\n};\n/** View has changed\n * @private\n */\nol.Overlay.Magnify.prototype.setView_ = function(e)\n{\tif (!this.get(\"active\"))\n\t{\tthis.setPosition();\n\t\treturn;\n\t}\n\tif (!e)\n\t{\t// refresh all\n\t\tthis.setView_({key:'rotation'});\n\t\tthis.setView_({key:'resolution'});\n\t\treturn;\n\t}\n\t// Set the view params\n\tswitch (e.key)\n\t{\tcase 'rotation':\n\t\t\tthis.mgview_.setRotation(this.getMap().getView().getRotation());\n\t\t\tbreak;\n\t\tcase 'zoomOffset':\n\t\tcase 'resolution':\n\t\t{\tvar z = Math.max(0,this.getMap().getView().getZoom()+Number(this.get(\"zoomOffset\")));\n\t\t\tthis.mgview_.setZoom(z);\n\t\t\tbreak;\n\t\t}\n\t\tdefault: break;\n\t}\n};\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc\n * A placemark element to be displayed over the map and attached to a single map\n * location. The placemarks are customized using CSS.\n *\n * @example\nvar popup = new ol.Overlay.Placemark();\nmap.addOverlay(popup);\npopup.show(coordinate);\npopup.hide();\n*\n* @constructor\n* @extends {ol.Overlay}\n* @param {} options Extend ol/Overlay/Popup options \n*\t@param {String} options.color placemark color\n*\t@param {String} options.backgroundColor placemark color\n*\t@param {String} options.contentColor placemark color\n*\t@param {Number} options.radius placemark radius in pixel\n*\t@param {String} options.popupClass the a class of the overlay to style the popup.\n*\t@param {function|undefined} options.onclose: callback function when popup is closed\n*\t@param {function|undefined} options.onshow callback function when popup is shown\n* @api stable\n*/\nol.Overlay.Placemark = function (options) {\n  options = options || {};\n  options.popupClass = (options.popupClass || '') + ' placemark anim'\n  options.positioning = 'bottom-center',\n  ol.Overlay.Popup.call(this, options);\n  this.setPositioning = function(){};\n  if (options.color) this.element.style.color = options.color;\n  if (options.backgroundColor ) this.element.style.backgroundColor  = options.backgroundColor ;\n  if (options.contentColor ) this.setContentColor(options.contentColor);\n  if (options.size) this.setRadius(options.size);\n};\nol.inherits(ol.Overlay.Placemark, ol.Overlay.Popup);\n/**\n * Set the position and the content of the placemark (hide it before to enable animation).\n * @param {ol.Coordinate|string} coordinate the coordinate of the popup or the HTML content.\n * @param {string|undefined} html the HTML content (undefined = previous content).\n */\nol.Overlay.Placemark.prototype.show = function(coordinate, html) {\n  if (coordinate===true) {\n    coordinate = this.getPosition();\n  }\n  this.hide();\n  ol.Overlay.Popup.prototype.show.apply(this, [coordinate, html]);\n};\n/**\n * Set the placemark color.\n * @param {string} color\n */\nol.Overlay.Placemark.prototype.setColor = function(color) {\n  this.element.style.color = color;\n};\n/**\n * Set the placemark background color.\n * @param {string} color\n */\nol.Overlay.Placemark.prototype.setBackgroundColor = function(color) {\n  this.element.style.backgroundColor = color;\n};\n/**\n * Set the placemark content color.\n * @param {string} color\n */\nol.Overlay.Placemark.prototype.setContentColor = function(color) {\n  this.element.getElementsByClassName('content')[0].style.color = color;\n};\n/**\n * Set the placemark class.\n * @param {string} name\n */\nol.Overlay.Placemark.prototype.setClassName = function(name) {\n  var oldclass = this.element.className;\n  this.element.className = 'ol-popup placemark ol-popup-bottom ol-popup-center ' \n    + (/visible/.test(oldclass) ? 'visible ' : '')\n    + (/anim/.test(oldclass) ? 'anim ' : '')\n    + name;\n};\n/**\n * Set the placemark radius.\n * @param {number} size size in pixel\n */\nol.Overlay.Placemark.prototype.setRadius = function(size) {\n  this.element.style.fontSize = size + 'px';\n};\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n* A popup element to be displayed on a feature.\n*\n* @constructor\n* @extends {ol.Overlay.Popup}\n* @param {} options Extend Popup options \n*\t@param {String} options.popupClass the a class of the overlay to style the popup.\n*\t@param {bool} options.closeBox popup has a close box, default false.\n*\t@param {function|undefined} options.onclose: callback function when popup is closed\n*\t@param {function|undefined} options.onshow callback function when popup is shown\n*\t@param {Number|Array<number>} options.offsetBox an offset box\n*\t@param {ol.OverlayPositioning | string | undefined} options.positionning \n*\t\tthe 'auto' positioning var the popup choose its positioning to stay on the map.\n* @param {*} options.template A template with a list of properties to use in the popup\n* @param boolean} options.canFix Enable popup to be fixed \n* @api stable\n*/\nol.Overlay.PopupFeature = function (options) {\n  options = options || {};\n  ol.Overlay.Popup.call(this, options);\n  this.setTemplate(options.template);\n  this.set('canFix', options.canFix)\n  // Bind with a select interaction\n  if (options.select && (typeof options.select.on ==='function')) {\n    this._select = options.select;\n    options.select.on('select', function(e){\n      if (!this._noselect) this.show(e.mapBrowserEvent.coordinate, options.select.getFeatures().getArray());\n    }.bind(this));\n  }\n};\nol.inherits(ol.Overlay.PopupFeature, ol.Overlay.Popup);\n/** Set the template\n * @param {*} template A template with a list of properties to use in the popup\n */\nol.Overlay.PopupFeature.prototype.setTemplate = function(template) {\n  this._template = template || {};\n  if (this._template.attributes instanceof Array) {\n    var att = {};\n    this._template.attributes.forEach(function (a) {\n      att[a] = true;\n    });\n    this._template.attributes = att;\n  }\n};\n/** Show the popup on the map\n * @param {ol.coordinate|undefined} coordinate Position of the popup\n * @param {ol.Feature|Array<ol.Feature>} features The features on the popup\n */\nol.Overlay.PopupFeature.prototype.show = function(coordinate, features) {\n  if (!(features instanceof Array)) features = [features];\n  this._features = features.slice();\n  if (!this._count) this._count = 1;\n  // Calculate html upon feaures attributes\n  this._count = 1;\n  var html = this._getHtml(features[0]);\n  this.hide();\n  if (html) {\n    if (!coordinate) {\n      coordinate = features[0].getGeometry().getFirstCoordinate();\n    }\n    ol.Overlay.Popup.prototype.show.call(this, coordinate, html);\n  }\n};\n/**\n * @private\n */\nol.Overlay.PopupFeature.prototype._getHtml = function(feature) {\n  if (!feature) return '';\n  var html = ol.ext.element.create('DIV', { className: 'ol-popupfeature' });\n  if (this.get('canFix')) {\n    ol.ext.element.create('I', { className:'ol-fix', parent: html })\n      .addEventListener('click', function(){\n        this.element.classList.toggle('ol-fixed');\n      }.bind(this));\n  }\n  if (this._template.title) {\n    var title;\n    if (typeof this._template.title === 'function') {\n      title = this._template.title(feature);\n    } else {\n      title = feature.get(this._template.title);\n    }\n    ol.ext.element.create('H1', { html:title, parent: html });\n  }\n  if (this._template.attributes) {\n    var tr, table = ol.ext.element.create('TABLE', { parent: html });\n    var atts = this._template.attributes;\n    for (var att in atts) {\n      var a = atts[att];\n      tr = ol.ext.element.create('TR', { parent: table });\n      ol.ext.element.create('TD', { html: a.title || att, parent: tr });\n      var val = feature.get(att);\n      ol.ext.element.create('TD', { \n        html: (a.before||'') + (a.format ? a.format(val) : val) + (a.after||''), \n        parent: tr \n      });\n    }\n  }\n  // Zoom button\n  ol.ext.element.create('BUTTON', { className: 'ol-zoombt', parent: html })\n    .addEventListener('click', function() {\n      this.getMap().getView().fit(feature.getGeometry().getExtent(), { duration:1000 });\n    }.bind(this));\n  // Counter\n  if (this._features.length > 1) {\n    var div = ol.ext.element.create('DIV', { className: 'ol-count', parent: html });\n    ol.ext.element.create('DIV', { className: 'ol-prev', parent: div })\n      .addEventListener('click', function() {\n        this._count--;\n        if (this._count<1) this._count = this._features.length;\n        html = this._getHtml(this._features[this._count-1]);\n        ol.Overlay.Popup.prototype.show.call(this, this.getPosition(), html);\n      }.bind(this));\n    ol.ext.element.create('TEXT', { html:this._count+'/'+this._features.length, parent: div });\n    ol.ext.element.create('DIV', { className: 'ol-next', parent: div })\n      .addEventListener('click', function() {\n        this._count++;\n        if (this._count>this._features.length) this._count = 1;\n        html = this._getHtml(this._features[this._count-1]);\n        ol.Overlay.Popup.prototype.show.call(this, this.getPosition(), html);\n      }.bind(this));\n  }\n  this._noselect = true;\n  this._select.getFeatures().clear();\n  this._select.getFeatures().push(feature);\n  this._noselect = false;\n  return html;\n};\n/** Get a function to use as format to get local string for an attribute\n * if the attribute is a number: Number.toLocaleString()\n * if the attribute is a date: Date.toLocaleString()\n * otherwise the attibute itself\n * @param {string} locales string with a BCP 47 language tag, or an array of such strings\n * @param {*} options Number or Date toLocaleString options\n * @return {function} a function that takes an attribute and return the formated attribute\n */\nol.Overlay.PopupFeature.localString = function (locales , options) {\n  return function (a) {\n    if (a && a.toLocaleString) {\n      return a.toLocaleString(locales , options);\n    } else {\n      // Try to get a date from a string\n      var date = new Date(a);\n      if (isNaN(date)) return a;\n      else return date.toLocaleString(locales , options);\n    }\n  };\n};\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** A tooltip element to be displayed over the map and attached on the cursor position.\n * @constructor\n * @extends {ol.Overlay.Popup}\n * @param {} options Extend Popup options \n *\t@param {String} options.popupClass the a class of the overlay to style the popup.\n *\t@param {Number|Array<number>} options.offsetBox an offset box\n *\t@param {ol.OverlayPositioning | string | undefined} options.positionning \n *\t\tthe 'auto' positioning var the popup choose its positioning to stay on the map.\n * @api stable\n */\nol.Overlay.Tooltip = function (options) {\n  options = options || {};\n  options.popupClass = options.popupClass || options.className || 'tooltips black';\n  options.positioning = options.positioning || 'center-left';\n\tol.Overlay.Popup.call(this, options);\n  this._interaction = new ol.interaction.Interaction({\n    handleEvent: function(e){\n      if (e.type==='pointermove' || e.type==='click') {\n        if (this.get('info')) {\n          this.show(e.coordinate, this.get('info'));\n        }\n        else this.hide();\n        this._coord = e.coordinate;\n      }\n      return true;\n    }.bind(this)\n  });\n};\nol.inherits(ol.Overlay.Tooltip, ol.Overlay.Popup);\n/**\n * Set the map instance the control is associated with\n * and add its controls associated to this map.\n * @param {_ol_Map_} map The map instance.\n */\nol.Overlay.Tooltip.prototype.setMap = function (map) {\n  if (this.getMap()) this.getMap().removeInteraction(this._interaction);\n  ol.Overlay.Popup.prototype.setMap.call(this, map);\n  if (this.getMap()) this.getMap().addInteraction(this._interaction);\n};\n/** Show the popup. If a feature has been passed to the \n * Tooltip the area/length will be added to the Tooltip\n * @param {ol.Coordinate|string} coordinate the coordinate of the popup or the HTML content.\n * @param {string|undefined} html the HTML content (undefined = previous content).\n */\nol.Overlay.Tooltip.prototype.show = function(coord, html) {\n  // Add measure\n  if (this.get('measure')) html = this.get('measure') +'<br/>'+ html;\n  // Show popup\n  ol.Overlay.Popup.prototype.show.call(this, coord, html);\n};\n/** Set the Tooltip info\n * If information is not null it will be set with a delay,\n * thus watever the information is inserted, the significant information will be set.\n * ie. ttip.setInformation('ok'); ttip.setInformation(null); will set 'ok' \n * ttip.set('info,'ok'); ttip.set('info', null); will set null\n * @param {string} what The information to display in the tooltip, default remove information\n */\nol.Overlay.Tooltip.prototype.setInfo = function(what) {\n  if (!what) {\n    this.set('info','');\n    this.hide();\n  }\n  else setTimeout(function() { \n    this.set('info', what); \n    this.show(this._coord, this.get('info'));\n  }.bind(this));\n};\n/** Set a feature associated with the tooltips\n * @param {ol.Feature} feature\n */\nol.Overlay.Tooltip.prototype.setFeature = function(feature) {\n  this._feature = feature;\n  if (this._listener) {\n    this._listener.forEach(function(l) {\n      ol.Observable.unByKey(l);\n    });\n  }\n  this._listener = [];\n  this.set('measure', '');\n  if (feature) {\n    this._listener.push(feature.getGeometry().on('change', function(e){ \n      var geom = e.target;\n      var measure;\n      if (geom.getArea) {\n        var area = ol.sphere.getArea(geom, { projection: this.getMap().getView().getProjection() });\n        area = Math.round(area*100) / 100;\n        if (area) {\n          if (area>10000) {\n            area = (area/1000000).toLocaleString(undefined, {maximumFractionDigits:2}) + ' km';\n          } else {\n            area = area.toLocaleString(undefined, {maximumFractionDigits:2}) + ' m';\n          }\n        }\n        measure = area;\n      } else if (geom.getLength) {\n        var length = ol.sphere.getLength(geom, { projection: this.getMap().getView().getProjection() });\n        length = Math.round(length*100) / 100;\n        if (length) {\n          if (length>100) {\n            length = (length/1000).toLocaleString(undefined, {maximumFractionDigits:2}) + ' km';\n          } else {\n            length = length.toLocaleString(undefined, {maximumFractionDigits:2}) + ' m';\n          }\n        }\n        measure = length;\n      }\n      this.set('measure', measure);\n    }.bind(this)));\n  }\n};\n\n/*\n\tCopyright (c) 2017 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (http://www.cecill.info/).\n\tol.coordinate.convexHull compute a convex hull using Andrew's Monotone Chain Algorithm.\n\t@see https://en.wikipedia.org/wiki/Convex_hull_algorithms\n*/\nol.coordinate.convexHull;\n(function(){\n/** Tests if a point is left or right of line (a,b).\n* @param {ol.coordinate} a point on the line\n* @param {ol.coordinate} b point on the line\n* @param {ol.coordinate} o\n* @return {bool} true if (a,b,o) turns clockwise\n*/\nvar clockwise = function (a, b, o) {\n  return ((a[0] - o[0]) * (b[1] - o[1]) - (a[1] - o[1]) * (b[0] - o[0]) <= 0);\n};\n/** Compute a convex hull using Andrew's Monotone Chain Algorithm\n * @param {Array<ol.geom.Point>} points an array of 2D points\n * @return {Array<ol.geom.Point>} the convex hull vertices\n */\nol.coordinate.convexHull = function (points) {\t// Sort by increasing x and then y coordinate\n  var i;\n  points.sort(function(a, b) {\n    return a[0] == b[0] ? a[1] - b[1] : a[0] - b[0];\n  });\n  // Compute the lower hull\n  var lower = [];\n  for (i = 0; i < points.length; i++) {\n    while (lower.length >= 2 && clockwise(lower[lower.length - 2], lower[lower.length - 1], points[i])) {\n      lower.pop();\n    }\n    lower.push(points[i]);\n  }\n  // Compute the upper hull\n  var upper = [];\n  for (i = points.length - 1; i >= 0; i--) {\n    while (upper.length >= 2 && clockwise(upper[upper.length - 2], upper[upper.length - 1], points[i])) {\n      upper.pop();\n    }\n    upper.push(points[i]);\n  }\n  upper.pop();\n  lower.pop();\n  return lower.concat(upper);\n};\n/* Get coordinates of a geometry */\nvar getCoordinates = function (geom) {\n  var i, p\n  var h = [];\n  switch (geom.getType()) {\n    case \"Point\":h.push(geom.getCoordinates());\n      break;\n    case \"LineString\":\n    case \"LinearRing\":\n    case \"MultiPoint\":h = geom.getCoordinates();\n      break;\n    case \"MultiLineString\":\n      p = geom.getLineStrings();\n      for (i = 0; i < p.length; i++) h.concat(getCoordinates(p[i]));\n      break;\n    case \"Polygon\":\n      h = getCoordinates(geom.getLinearRing(0));\n      break;\n    case \"MultiPolygon\":\n      p = geom.getPolygons();\n      for (i = 0; i < p.length; i++) h.concat(getCoordinates(p[i]));\n      break;\n    case \"GeometryCollection\":\n      p = geom.getGeometries();\n      for (i = 0; i < p.length; i++) h.concat(getCoordinates(p[i]));\n      break;\n    default:break;\n  }\n  return h;\n};\n/** Compute a convex hull on a geometry using Andrew's Monotone Chain Algorithm\n * @return {Array<ol.geom.Point>} the convex hull vertices\n */\nol.geom.Geometry.prototype.convexHull = function() {\n  return ol.coordinate.convexHull(getCoordinates(this));\n};\n})();\n\n/*\n\tCopyright (c) 2018 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (http://www.cecill.info/).\n*/\n/** Convert coordinate to French DFCI grid\n * @param {ol/coordinate} coord\n * @param {number} level [0-3]\n * @param {ol/proj/Projection} projection of the coord, default EPSG:27572\n * @return {String} the DFCI index\n */\nol.coordinate.toDFCI = function (coord, level, projection) {\n  if (!level && level !==0) level = 3;\n  if (projection) {\n    if (!ol.proj.get('EPSG:27572')) {\n      // Add Lambert IIe proj \n      if (!proj4.defs[\"EPSG:27572\"]) proj4.defs(\"EPSG:27572\",\"+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs\");\n      ol.proj.proj4.register(proj4);\n    }\n    coord = ol.proj.transform(coord, projection, 'EPSG:27572');\n  }\n  var x = coord[0];\n  var y = coord[1];\n  var s = '';\n  // Level 0\n  var step = 100000;\n  s += String.fromCharCode(65 + Math.floor((x<800000?x:x+200000)/step))\n    + String.fromCharCode(65 + Math.floor((y<2300000?y:y+200000)/step) - 1500000/step);\n  if (level === 0) return s;\n  // Level 1\n  var step1 = 100000/5;\n  s += 2*Math.floor((x%step)/step1);\n  s += 2*Math.floor((y%step)/step1);\n  if (level === 1) return s;\n  // Level 2\n  var step2 = step1 / 10;\n  var x0 = Math.floor((x%step1)/step2);\n  s += String.fromCharCode(65 + (x0<8 ? x0 : x0+2));\n  s += Math.floor((y%step1)/step2);\n  if (level === 2) return s;\n  // Level 3\n  var x3 = Math.floor((x%step2)/500);\n  var y3 = Math.floor((y%step2)/500);\n  if (x3<1) {\n    if (y3>1) s += '.1';\n    else s += '.4';\n  } else if (x3>2) {\n    if (y3>1) s += '.2';\n    else s += '.3';\n  } else if (y3>2) {\n    if (x3<2) s += '.1';\n    else s += '.2';\n  } else if (y3<1) {\n    if (x3<2) s += '.4';\n    else s += '.3';\n  } else {\n    s += '.5';\n  }\n  return s;\n};\n/** Get coordinate from French DFCI index\n * @param {String} index the DFCI index\n * @param {ol/proj/Projection} projection result projection, default EPSG:27572\n * @return {ol/coordinate} coord\n */\nol.coordinate.fromDFCI = function (index, projection) {\n  var coord;\n  // Level 0\n  var step = 100000;\n  var x = index.charCodeAt(0) - 65;\n  x = (x<8 ? x : x-2)*step;\n  var y = index.charCodeAt(1) - 65;\n  y = (y<8 ? y : y-2)*step + 1500000;\n  if (index.length===2) {\n    coord = [x+step/2, y+step/2];\n  } else {\n    // Level 1\n    step /= 5;\n    x += Number(index.charAt(2))/2*step;\n    y += Number(index.charAt(3))/2*step;\n    if (index.length===4) {\n      coord = [x+step/2, y+step/2];\n    } else {\n      // Level 2\n      step /= 10;\n      var x0 = index.charCodeAt(4) - 65;\n      x += (x0<8 ? x0 : x0-2)*step;\n      y += Number(index.charAt(5))*step;\n      if (index.length === 6) {\n        coord = [x+step/2, y+step/2];\n      } else {\n        // Level 3\n        switch (index.charAt(7)) {\n          case '1':\n            coord = [x+step/4, y+3*step/4];\n            break;\n          case '2':\n            coord = [x+3*step/4, y+3*step/4];\n            break;\n          case '3':\n            coord = [x+3*step/4, y+step/4];\n            break;\n          case '4':\n            coord = [x+step/4, y+step/4];\n            break;\n          default:\n            coord = [x+step/2, y+step/2];\n            break;\n        }\n      }\n    }\n  }\n  // Convert ?\n  if (projection) {\n    if (!ol.proj.get('EPSG:27572')) {\n      // Add Lambert IIe proj \n      if (!proj4.defs[\"EPSG:27572\"]) proj4.defs(\"EPSG:27572\",\"+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs\");\n      ol.proj.proj4.register(proj4);\n    }\n    coord = ol.proj.transform(coord, 'EPSG:27572', projection);\n  }\n  return coord;\n};\n/** The string is a valid DFCI index\n * @param {string} index DFCI index\n * @return {boolean}\n */\nol.coordinate.validDFCI = function (index) {\n  if (index.length<2 || index.length>8) return false;\n  if (/[^A-H|^K-N]/.test(index.substr(0,1))) return false;\n  if (/[^B-H|^K-N]/.test(index.substr(1,1))) return false;\n  if (index.length>2) {\n    if (index.length<4) return false;\n    if (/[^0,^2,^4,^6,^8]/.test(index.substr(2,1))) return false;\n    if (/[^0,^2,^4,^6,^8]/.test(index.substr(3,1))) return false;\n  }\n  if (index.length>4) {\n    if (index.length<6) return false;\n    if (/[^A-H|^K-L]/.test(index.substr(4,1))) return false;\n    if (/[^0-9]/.test(index.substr(5,1))) return false;\n  }\n  if (index.length>6) {\n    if (index.length<8) return false;\n    if (index.substr(6,1)!=='.') return false;\n    if (/[^1-5]/.test(index.substr(7,1))) return false;\n  }\n  return true;\n}\n/** Coordinate is valid for DFCI \n * @param {ol/coordinate} coord\n * @param {ol/proj/Projection} projection result projection, default EPSG:27572\n * @return {boolean}\n */\nol.coordinate.validDFCICoord = function (coord, projection) {\n  if (projection) {\n    if (!ol.proj.get('EPSG:27572')) {\n      // Add Lambert IIe proj \n      if (!proj4.defs[\"EPSG:27572\"]) proj4.defs(\"EPSG:27572\",\"+proj=lcc +lat_1=46.8 +lat_0=46.8 +lon_0=0 +k_0=0.99987742 +x_0=600000 +y_0=2200000 +a=6378249.2 +b=6356515 +towgs84=-168,-60,320,0,0,0,0 +pm=paris +units=m +no_defs\");\n      ol.proj.proj4.register(proj4);\n    }\n    coord = ol.proj.transform(coord, projection, 'EPSG:27572');\n  }\n  // Test extent\n  if (0 > coord[0] || coord[0] > 1200000 ) return false;\n  if (1600000 > coord[1] || coord[1] > 2700000 ) return false;\n  return true;\n};\n\n/*\n\tCopyright (c) 2018 Jean-Marc VIGLINO,\n\treleased under the CeCILL-B license (http://www.cecill.info/).\n*/\n/* Define namespace\n */\nol.graph = {};\n/** \n * @classdesc \n * Compute the shortest paths between nodes in a graph source\n * The source must only contains LinesString.\n * \n * It uses a A* optimisation.\n * You can overwrite methods to customize the result.\n * @see https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm\n * @constructor\n * @fires calculating \n * @fires start\n * @fires finish\n * @fires pause\n * @param {any} options\n *  @param {ol/source/Vector} options.source the source for the edges \n *  @param {integer} [options.maxIteration=20000] maximum iterations before a pause event is fired, default 20000\n *  @param {integer} [options.stepIteration=2000] number of iterations before a calculating event is fired, default 2000\n *  @param {number} [options.epsilon=1E-6] geometric precision (min distance beetween 2 points), default 1E-6\n */\nol.graph.Dijskra = function (options) {\n  options = options || {};\n  this.source = options.source;\n  this.nodes = new ol.source.Vector();\n  // Maximum iterations\n  this.maxIteration = options.maxIteration || 20000;\n  this.stepIteration = options.stepIteration || 2000;\n  // A* optimisation\n  this.astar = true;\n  this.candidat = [];\n  ol.Object.call (this);\n  this.set ('epsilon', options.epsilon || 1E-6);\n};\nol.inherits(ol.graph.Dijskra, ol.Object);\n/** Get the weighting of the edge, for example a speed factor\n * The function returns a value beetween ]0,1]\n * - 1   = no weighting\n * - 0.5 = goes twice more faster on this road\n * \n * If no feature is provided you must return the lower weighting you're using\n * @param {ol/Feature} feature\n * @return {number} a number beetween 0-1 \n * @api\n */\nol.graph.Dijskra.prototype.weight = function(/* feature */) {\n  return 1;\n};\n/** Get the edge direction\n * -  0 : the road is blocked\n * -  1 : direct way\n * - -1 : revers way\n * -  2 : both way\n * @param {ol/Feature} feature\n * @return {Number} 0: blocked, 1: direct way, -1: revers way, 2:both way \n * @api\n */\nol.graph.Dijskra.prototype.direction = function(/* feature */) {\n  return 2;\n};\n/** Calculate the length of an edge\n * @param {ol/Feature|ol/geom/LineString} geom\n * @return {number}\n * @api\n */\nol.graph.Dijskra.prototype.getLength = function(geom) {\n  if (geom.getGeometry) geom = geom.getGeometry();\n  return geom.getLength();\n};\n/** Get the nodes source concerned in the calculation\n * @return {ol/source/Vector}\n */\nol.graph.Dijskra.prototype.getNodeSource = function() {\n  return this.nodes;\n};\n/** Get all features at a coordinate\n * @param {ol/coordinate} coord\n * @return {Array<ol/Feature>}\n */\nol.graph.Dijskra.prototype.getEdges = function(coord) {\n  var extent = ol.extent.buffer (ol.extent.boundingExtent([coord]), this.get('epsilon'));\n  var result = [];\n  this.source.forEachFeatureIntersectingExtent(extent, function(f){\n    result.push(f);\n  });\n  return result;\n};\n/** Get a node at a coordinate\n * @param {ol/coordinate} coord\n * @return {ol/Feature} the node\n */\nol.graph.Dijskra.prototype.getNode = function(coord) {\n  var extent = ol.extent.buffer (ol.extent.boundingExtent([coord]), this.get('epsilon'));\n  var result = [];\n  this.nodes.forEachFeatureIntersectingExtent(extent, function(f){\n    result.push(f);\n  });\n  return result[0];\n};\n/** Add a node\n * @param {ol/coorindate} p\n * @param {number} wdist the distance to reach this node\n * @param {ol/Feature} from the feature used to come to this node\n * @param {ol/Feature} prev the previous node\n * @return {ol/Feature} the node\n * @private\n */\nol.graph.Dijskra.prototype.addNode = function(p, wdist, dist, from, prev) {\n  // Final condition\n  if (this.wdist && wdist > this.wdist) return false;\n  // Look for existing point\n  var node = this.getNode(p);\n  // Optimisation ?\n  var dtotal = wdist + this.getLength(new ol.geom.LineString([this.end, p])) * this.weight();\n  if (this.astar && this.wdist && dtotal > this.wdist) return false;\n  if (node) {\n    // Allready there\n    if (node!==this.arrival && node.get('wdist') <= wdist) return node;\n    // New candidat\n    node.set('dist', dist);\n    node.set('wdist', wdist);\n    node.set('dtotal', dtotal);\n    node.set('from', from);\n    node.set('prev', prev);\n    if (node===this.arrival) {\n      this.wdist = wdist;\n    }\n    this.candidat.push (node);\n  } else {\n    // New candidat\n    node =  new ol.Feature({\n      geometry: new ol.geom.Point(p),\n      from: from, \n      prev: prev, \n      dist: dist || 0, \n      wdist: wdist, \n      dtotal: dtotal, \n    });\n    if (wdist<0) {\n      node.set('wdist', false);\n    }\n    else this.candidat.push (node);\n    // Add it in the node source\n    this.nodes.addFeature(node);\n  }\n  return node;\n};\n/** Get the closest coordinate of a node in the graph source (an edge extremity)\n * @param {ol/coordinate} p\n * @return {ol/coordinate} \n * @private\n */\nol.graph.Dijskra.prototype.closestCoordinate = function(p) {\n  var e = this.source.getClosestFeatureToCoordinate(p);\n  var p0 = e.getGeometry().getFirstCoordinate();\n  var p1 = e.getGeometry().getLastCoordinate();\n  if (ol.coordinate.dist2d(p, p0) < ol.coordinate.dist2d(p, p1)) return p0;\n  else return p1;\n};\n/** Calculate a path beetween 2 points\n * @param {ol/coordinate} start\n * @param {ol/coordinate} end\n * @return {boolean|Array<ol/coordinate>} false if don't start (still running) or start and end nodes\n */\nol.graph.Dijskra.prototype.path = function(start, end) {\n  if (this.running) return false;\n  // Initialize\n  var self = this;\n  this.nodes.clear();\n  this.candidat = [];\n  this.wdist = 0;\n  this.running = true;\n  // Starting nodes\n  start = this.closestCoordinate(start);\n  this.end = this.closestCoordinate(end);\n  if (start[0]===this.end[0] \n    && start[1]===this.end[1]) {\n      this.dispatchEvent({\n        type: 'finish',\n        route: [],\n        distance: this.wdist\n      });\n      return false;\n    }\n  // Starting point\n  this.addNode(start, 0);\n  // Arrival\n  this.arrival = this.addNode(this.end, -1);\n  // Start\n  this.nb = 0;\n  this.dispatchEvent({\n    type: 'start'\n  });\n  setTimeout(function() { self._resume(); });\n  return [start, this.end];\n};\n/** Restart after pause\n */\nol.graph.Dijskra.prototype.resume = function() {\n  if (this.running) return;\n  if (this.candidat.length) {\n    this.running = true;\n    this.nb = 0;\n    this._resume();\n  }\n};\n/** Pause \n */\nol.graph.Dijskra.prototype.pause = function() {\n  if (!this.running) return;\n  this.nb = -1;\n};\n/** Get the current 'best way'.\n * This may be used to animate while calculating.\n * @return {Array<ol/Feature>}\n */\nol.graph.Dijskra.prototype.getBestWay = function() {\n  var node, max = -1;\n  for (var i=0, n; n = this.candidat[i]; i++) {\n    if (n.get('wdist') > max) {\n      node = n;\n      max = n.get('wdist');\n    }\n  }\n  // Calculate route to this node\n  return this.getRoute(node);\n};\n/** Go on searching new candidats\n * @private\n */\nol.graph.Dijskra.prototype._resume = function() {\n  if (!this.running) return;\n  while (this.candidat.length) {\n    // Sort by wdist\n    this.candidat.sort (function(a,b) {\n      return (a.get('dtotal') < b.get('dtotal') ? 1 : a.get('dtotal')===b.get('dtotal') ? 0 : -1);\n    });\n    // First candidate\n    var node = this.candidat.pop();\n    var p = node.getGeometry().getCoordinates();\n    // Find connected edges\n    var edges = this.getEdges(p);\n    for (var i=0, e; e=edges[i]; i++) {\n      if (node.get('from')!==e) {\n        var dist = this.getLength (e);\n        if (dist < 0) {\n          console.log ('distance < 0!');\n          // continue;\n        }\n        var wdist = node.get('wdist') + dist * this.weight(e);\n        dist = node.get('dist') + dist;\n        var pt1 = e.getGeometry().getFirstCoordinate();\n        var pt2 = e.getGeometry().getLastCoordinate();\n        var sens = this.direction(e);\n        if (sens!==0) {\n          if (p[0]===pt1[0] && p[1]===pt1[1] && sens!==-1) {\n            this.addNode(pt2, wdist, dist, e, node);\n          }\n          if (p[0]===pt2[0] && p[0]===pt2[0] && sens!==1) {\n            this.addNode(pt1, wdist, dist, e, node);\n          }\n        }\n      }\n      // Test overflow or pause\n      if (this.nb === -1 || this.nb++ > this.maxIteration) {\n        this.running = false;\n        this.dispatchEvent({\n          type: 'pause',\n          overflow: (this.nb !== -1)\n        });\n        return;\n      }\n      // Take time to do something\n      if (!(this.nb % this.stepIteration)){\n        var self = this;\n        window.setTimeout(function() { self._resume() }, 5);\n        this.dispatchEvent({\n          type: 'calculating'\n        });\n        return;\n      }\n    }\n  }\n  // Finish!\n  this.nodes.clear();\n  this.running = false;\n  this.dispatchEvent({\n    type: 'finish',\n    route: this.getRoute(this.arrival),\n    wDistance: this.wdist,\n    distance: this.arrival.get('dist')\n  });\n};\n/** Get the route to a node\n * @param {ol/Feature} node\n * @return {Array<ol/Feature>}\n * @private\n */\nol.graph.Dijskra.prototype.getRoute = function(node) {\n  var route = [];\n  while (node) {\n    route.unshift(node.get('from'));\n    node = node.get('prev');\n  }\n  route.shift();\n  return route;\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n\tUsefull function to handle geometric operations\n*/\n/** Distance beetween 2 points\n*\tUsefull geometric functions\n* @param {ol.Coordinate} p1 first point\n* @param {ol.Coordinate} p2 second point\n* @return {number} distance\n*/\nol.coordinate.dist2d = function(p1, p2)\n{\tvar dx = p1[0]-p2[0];\n\tvar dy = p1[1]-p2[1];\n\treturn Math.sqrt(dx*dx+dy*dy);\n}\n/** 2 points are equal\n*\tUsefull geometric functions\n* @param {ol.Coordinate} p1 first point\n* @param {ol.Coordinate} p2 second point\n* @return {boolean}\n*/\nol.coordinate.equal = function(p1, p2)\n{\treturn (p1[0]==p2[0] && p1[1]==p2[1]);\n}\n/** Get center coordinate of a feature\n* @param {ol.Feature} f\n* @return {ol.coordinate} the center\n*/\nol.coordinate.getFeatureCenter = function(f)\n{\treturn ol.coordinate.getGeomCenter (f.getGeometry());\n};\n/** Get center coordinate of a geometry\n* @param {ol.Feature} geom\n* @return {ol.Coordinate} the center\n*/\nol.coordinate.getGeomCenter = function(geom)\n{\tswitch (geom.getType())\n\t{\tcase 'Point': \n\t\t\treturn geom.getCoordinates();\n\t\tcase \"MultiPolygon\":\n            geom = geom.getPolygon(0);\n            // fallthrough\n\t\tcase \"Polygon\":\n\t\t\treturn geom.getInteriorPoint().getCoordinates();\n\t\tdefault:\n\t\t\treturn geom.getClosestPoint(ol.extent.getCenter(geom.getExtent()));\n\t}\n};\n/** Offset a polyline\n * @param {Array<ol.Coordinate>} coords\n * @param {number} offset\n * @return {Array<ol.Coordinate>} resulting coord\n * @see http://stackoverflow.com/a/11970006/796832\n * @see https://drive.google.com/viewerng/viewer?a=v&pid=sites&srcid=ZGVmYXVsdGRvbWFpbnxqa2dhZGdldHN0b3JlfGd4OjQ4MzI5M2Y0MjNmNzI2MjY\n */\nol.coordinate.offsetCoords = function (coords, offset) {\n    var path = [];\n    var N = coords.length-1;\n    var max = N;\n    var mi, mi1, li, li1, ri, ri1, si, si1, Xi1, Yi1;\n    var p0, p1, p2;\n    var isClosed = ol.coordinate.equal(coords[0],coords[N]);\n    if (!isClosed) {\n        p0 = coords[0];\n        p1 = coords[1];\n        p2 = [\n            p0[0] + (p1[1] - p0[1]) / ol.coordinate.dist2d(p0,p1) *offset,\n            p0[1] - (p1[0] - p0[0]) / ol.coordinate.dist2d(p0,p1) *offset\n        ];\n        path.push(p2);\n        coords.push(coords[N])\n        N++;\n        max--;\n    }\n    for (var i = 0; i < max; i++) {\n        p0 = coords[i];\n        p1 = coords[(i+1) % N];\n        p2 = coords[(i+2) % N];\n        mi = (p1[1] - p0[1])/(p1[0] - p0[0]);\n        mi1 = (p2[1] - p1[1])/(p2[0] - p1[0]);\n        // Prevent alignements\n        if (Math.abs(mi-mi1) > 1e-10) {\n            li = Math.sqrt((p1[0] - p0[0])*(p1[0] - p0[0])+(p1[1] - p0[1])*(p1[1] - p0[1]));\n            li1 = Math.sqrt((p2[0] - p1[0])*(p2[0] - p1[0])+(p2[1] - p1[1])*(p2[1] - p1[1]));\n            ri = p0[0] + offset*(p1[1] - p0[1])/li;\n            ri1 = p1[0] + offset*(p2[1] - p1[1])/li1;\n            si = p0[1] - offset*(p1[0] - p0[0])/li;\n            si1 = p1[1] - offset*(p2[0] - p1[0])/li1;\n            Xi1 = (mi1*ri1-mi*ri+si-si1) / (mi1-mi);\n            Yi1 = (mi*mi1*(ri1-ri)+mi1*si-mi*si1) / (mi1-mi);\n            // Correction for vertical lines\n            if(p1[0] - p0[0] == 0) {\n                Xi1 = p1[0] + offset*(p1[1] - p0[1])/Math.abs(p1[1] - p0[1]);\n                Yi1 = mi1*Xi1 - mi1*ri1 + si1;\n            }\n            if (p2[0] - p1[0] == 0 ) {\n                Xi1 = p2[0] + offset*(p2[1] - p1[1])/Math.abs(p2[1] - p1[1]);\n                Yi1 = mi*Xi1 - mi*ri + si;\n            }\n            path.push([Xi1, Yi1]);\n        }\n    }\n    if (isClosed) {\n        path.push(path[0]);\n    } else {\n        coords.pop();\n        p0 = coords[coords.length-1];\n        p1 = coords[coords.length-2];\n        p2 = [\n            p0[0] - (p1[1] - p0[1]) / ol.coordinate.dist2d(p0,p1) *offset,\n            p0[1] + (p1[0] - p0[0]) / ol.coordinate.dist2d(p0,p1) *offset\n        ];\n        path.push(p2);\n    }\n    return path;\n}\n/** Find the segment a point belongs to\n * @param {ol.Coordinate} pt\n * @param {Array<ol.Coordinate>} coords\n * @return {} the index (-1 if not found) and the segment\n */\nol.coordinate.findSegment = function (pt, coords) {\n    for (var i=0; i<coords.length-1; i++) {\n        var p0 = coords[i];\n        var p1 = coords[i+1];\n        if (ol.coordinate.equal(pt, p0) || ol.coordinate.equal(pt, p1)) {\n            return { index:1, segment: [p0,p1] };\n        } else {\n            var d0 = ol.coordinate.dist2d(p0,p1);\n            var v0 = [ (p1[0] - p0[0]) / d0, (p1[1] - p0[1]) / d0 ];\n            var d1 = ol.coordinate.dist2d(p0,pt);\n            var v1 = [ (pt[0] - p0[0]) / d1, (pt[1] - p0[1]) / d1 ];\n            if (Math.abs(v0[0]*v1[1] - v0[1]*v1[0]) < 1e-10) {\n                return { index:1, segment: [p0,p1] };\n            }\n        }\n    }\n    return { index: -1 };\n};\n/**\n * Split a Polygon geom with horizontal lines\n * @param {Array<ol.Coordinate>} geom\n * @param {number} y the y to split\n * @param {number} n contour index\n * @return {Array<Array<ol.Coordinate>>}\n */\nol.coordinate.splitH = function (geom, y, n) {\n    var x, abs;\n    var list = [];\n    for (var i=0; i<geom.length-1; i++) {\n        // Hole separator?\n        if (!geom[i].length || !geom[i+1].length) continue;\n        // Intersect\n        if (geom[i][1]<=y && geom[i+1][1]>y || geom[i][1]>=y && geom[i+1][1]<y) {\n            abs = (y-geom[i][1]) / (geom[i+1][1]-geom[i][1]);\n            x = abs * (geom[i+1][0]-geom[i][0]) + geom[i][0];\n            list.push ({ contour: n, index: i, pt: [x,y], abs: abs });\n        }\n    }\n    // Sort x\n    list.sort(function(a,b) { return a.pt[0] - b.pt[0] });\n    // Horizontal segement\n    var result = [];\n    for (var j=0; j<list.length-1; j += 2) {\n        result.push([list[j], list[j+1]])\n    }\n    return result;\n};\n\n/** Split a lineString by a point or a list of points\n *\tNB: points must be on the line, use getClosestPoint() to get one\n* @param {ol.Coordinate | Array<ol.Coordinate>} pt points to split the line\n* @param {Number} tol distance tolerance for 2 points to be equal\n*/\nol.geom.LineString.prototype.splitAt = function(pt, tol) {\n  var i;\n  if (!pt) return [this];\n    if (!tol) tol = 1e-10;\n    // Test if list of points\n    if (pt.length && pt[0].length) {\n      var result = [this];\n      for (i=0; i<pt.length; i++) {\n        var r = [];\n        for (var k=0; k<result.length; k++) {\n          var ri = result[k].splitAt(pt[i], tol);\n          r = r.concat(ri);\n        }\n        result = r;\n      }\n      return result;\n    }\n    // Nothing to do\n    if (ol.coordinate.equal(pt,this.getFirstCoordinate())\n    || ol.coordinate.equal(pt,this.getLastCoordinate())) {\n      return [this];\n    }\n    // Get\n    var c0 = this.getCoordinates();\n    var ci=[c0[0]];\n    var c = [];\n    for (i=0; i<c0.length-1; i++) {\n      // Filter equal points\n      if (ol.coordinate.equal(c0[i],c0[i+1])) continue;\n      // Extremity found\n      if (ol.coordinate.equal(pt,c0[i+1])) {\n        ci.push(c0[i+1]);\n        c.push(new ol.geom.LineString(ci));\n        ci = [];\n      }\n      // Test alignement\n      else if (!ol.coordinate.equal(pt,c0[i])) {\n        var d1, d2, split=false;\n        if (c0[i][0] == c0[i+1][0]) {\n          d1 = (c0[i][1]-pt[1]) / (c0[i][1]-c0[i+1][1]);\n          split = (c0[i][0] == pt[0]) && (0 < d1 && d1 <= 1)\n        } else if (c0[i][1] == c0[i+1][1]) {\n          d1 = (c0[i][0]-pt[0]) / (c0[i][0]-c0[i+1][0]);\n          split = (c0[i][1] == pt[1]) && (0 < d1 && d1 <= 1)\n        } else {\n          d1 = (c0[i][0]-pt[0]) / (c0[i][0]-c0[i+1][0]);\n          d2 = (c0[i][1]-pt[1]) / (c0[i][1]-c0[i+1][1]);\n          split = (Math.abs(d1-d2) <= tol && 0 < d1 && d1 <= 1)\n        }\n        // pt is inside the segment > split\n        if (split) {\n          ci.push(pt);\n          c.push (new ol.geom.LineString(ci));\n          ci = [pt];\n        }\n      }\n      ci.push(c0[i+1]);\n    }\n    if (ci.length>1) c.push (new ol.geom.LineString(ci));\n    if (c.length) return c;\n    else return [this];\n}\n// import('ol-ext/geom/LineStringSplitAt')\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n\tUsefull function to handle geometric operations\n*/\n/*eslint no-constant-condition: [\"error\", { \"checkLoops\": false }]*/\n/**\n * Calculate a MultiPolyline to fill a Polygon with a scribble effect that appears hand-made\n * @param {} options\n *  @param {Number} options.interval interval beetween lines\n *  @param {Number} options.angle hatch angle in radian, default PI/2\n * @return {ol.geom.MultiLineString|null} the resulting MultiLineString geometry or null if none\n */\nol.geom.MultiPolygon.prototype.scribbleFill = function (options) {\n  var scribbles = [];\n  var poly = this.getPolygons();\n  var i, p, s;\n  for (i=0; p=poly[i]; i++) {\n    var mls = p.scribbleFill(options);\n    if (mls) scribbles.push(mls);\n  } \n  if (!scribbles.length) return null;\n  // Merge scribbles\n  var scribble = scribbles[0];\n    var ls;\n    for (i = 0; s = scribbles[i]; i++) {\n        ls = s.getLineStrings();\n        for (var k = 0; k < ls.length; k++) {\n            scribble.appendLineString(ls[k]);\n        }\n    }\n  return scribble;\n};\n/**\n * Calculate a MultiPolyline to fill a Polygon with a scribble effect that appears hand-made\n * @param {} options\n *  @param {Number} options.interval interval beetween lines\n *  @param {Number} options.angle hatch angle in radian, default PI/2\n * @return {ol.geom.MultiLineString|null} the resulting MultiLineString geometry or null if none\n */\nol.geom.Polygon.prototype.scribbleFill = function (options) {\n\tvar step = options.interval;\n  var angle = options.angle || Math.PI/2;\n  var i, k,l;\n  // Geometry + rotate\n\tvar geom = this.clone();\n\tgeom.rotate(angle, [0,0]);\n  var coords = geom.getCoordinates();\n  // Merge holes\n  var coord = coords[0];\n  for (i=1; i<coords.length; i++) {\n    // Add a separator\n    coord.push([]);\n    // Add the hole\n    coord = coord.concat(coords[i]);\n  }\n  // Extent \n\tvar ext = geom.getExtent();\n\t// Split polygon with horizontal lines\n  var lines = [];\n\tfor (var y = (Math.floor(ext[1]/step)+1)*step; y<ext[3]; y += step) {\n    l = ol.coordinate.splitH(coord, y, i);\n    lines = lines.concat(l);\n  }\n  if (!lines.length) return null;\n  // Order lines on segment index\n  var mod = coord.length-1;\n\tvar first = lines[0][0].index;\n\tfor (k=0; l=lines[k]; k++) {\n\t\tlines[k][0].index = (lines[k][0].index-first+mod) % mod;\n\t\tlines[k][1].index = (lines[k][1].index-first+mod) % mod;\n\t}\n  var scribble = [];\n  while (true) {\n    for (k=0; l=lines[k]; k++) {\n      if (!l[0].done) break;\n    }\n    if (!l) break;\n    var scrib = [];\n    while (l) {\n      l[0].done = true;\n      scrib.push(l[0].pt);\n      scrib.push(l[1].pt);\n      var nexty = l[0].pt[1] + step;\n      var d0 = Infinity;\n      var l2 = null;\n      while (lines[k]) {\n        if (lines[k][0].pt[1] > nexty) break;\n        if (lines[k][0].pt[1] === nexty) {\n          var d = Math.min(\n            (lines[k][0].index - l[0].index + mod) % mod,\n            (l[0].index - lines[k][0].index + mod) % mod\n          );\n          var d2 = Math.min(\n            (l[1].index - l[0].index + mod) % mod,\n            (l[0].index - l[1].index + mod) % mod\n          );\n          if (d<d0 && d<d2) {\n            d0 = d;\n            if (!lines[k][0].done) l2 = lines[k];\n            else l2 = null;\n          }\n        }\n        k++;\n      }\n      l = l2;\n    }\n    if (scrib.length) {\n      scribble.push(scrib);\n    }\n  }\n  // Return the scribble as MultiLineString\n  if (!scribble.length) return null;\n  var mline = new ol.geom.MultiLineString(scribble);\n  mline.rotate(-angle,[0,0]);\n\treturn mline.cspline({ pointsPerSeg:8, tension:.9 });\n};\n// import('ol-ext/geom/Scribble')\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Pulse an extent on postcompose\n*\t@param {ol.coordinates} point to pulse\n*\t@param {ol.pulse.options} options pulse options param\n*\t  @param {ol.projectionLike|undefined} options.projection projection of coords, default no transform\n*\t  @param {Number} options.duration animation duration in ms, default 2000\n*\t  @param {ol.easing} options.easing easing function, default ol.easing.upAndDown\n*\t  @param {ol.style.Stroke} options.style stroke style, default 2px red\n*/\nol.Map.prototype.animExtent = function(extent, options)\n{\tvar listenerKey;\n\toptions = options || {};\n\t// Change to map's projection\n\tif (options.projection)\n\t{\textent = ol.proj.transformExtent (extent, options.projection, this.getView().getProjection());\n\t}\n\t// options\n\tvar start = new Date().getTime();\n\tvar duration = options.duration || 1000;\n\tvar easing = options.easing || ol.easing.upAndDown;\n\tvar width = options.style ? options.style.getWidth() || 2 : 2;\n\tvar color = options.style ? options.style.getColr() || 'red' : 'red';\n\t// Animate function\n\tfunction animate(event) \n\t{\tvar frameState = event.frameState;\n\t\tvar ratio = frameState.pixelRatio;\n\t\tvar elapsed = frameState.time - start;\n\t\tif (elapsed > duration) ol.Observable.unByKey(listenerKey);\n\t\telse\n\t\t{\tvar elapsedRatio = elapsed / duration;\n\t\t\tvar p0 = this.getPixelFromCoordinate([extent[0],extent[1]]);\n\t\t\tvar p1 = this.getPixelFromCoordinate([extent[2],extent[3]]);\n\t\t\tvar context = event.context;\n\t\t\tcontext.save();\n\t\t\tcontext.scale(ratio,ratio);\n\t\t\tcontext.beginPath();\n\t\t\t// var e = easing(elapsedRatio)\n\t\t\tcontext.globalAlpha = easing(1 - elapsedRatio);\n\t\t\tcontext.lineWidth = width;\n\t\t\tcontext.strokeStyle = color;\n\t\t\tcontext.rect(p0[0], p0[1], p1[0]-p0[0], p1[1]-p0[1]);\n\t\t\tcontext.stroke();\n\t\t\tcontext.restore();\n\t\t\t// tell OL3 to continue postcompose animation\n\t\t\tframeState.animate = true;\n\t\t}\n\t}\n\t// Launch animation\n\tlistenerKey = this.on('postcompose', animate.bind(this));\n\tthis.renderSync();\n}\n\n/** Create a cardinal spline version of this geometry.\n*\tOriginal https://github.com/epistemex/cardinal-spline-js\n*\t@see https://en.wikipedia.org/wiki/Cubic_Hermite_spline#Cardinal_spline\n*\n* @param {} options\n*\t@param {Number} options.tension a [0,1] number / can be interpreted as the \"length\" of the tangent, default 0.5\n*\t@param {Number} options.resolution size of segment to split\n*\t@param {Interger} options.pointsPerSeg number of points per segment to add if no resolution is provided, default add 10 points per segment\n*/\n/** Cache cspline calculation\n*/\nol.geom.Geometry.prototype.cspline = function(options)\n{\t// Calculate cspline\n\tif (this.calcCSpline_)\n\t{\tif (this.csplineGeometryRevision != this.getRevision() \n\t\t\t|| this.csplineOption != JSON.stringify(options))\n\t\t{\tthis.csplineGeometry_ = this.calcCSpline_(options)\n\t\t\tthis.csplineGeometryRevision = this.getRevision();\n\t\t\tthis.csplineOption = JSON.stringify(options);\n\t\t}\n\t\treturn this.csplineGeometry_;\n\t}\n\t// Default do nothing\n\telse\n\t{\treturn this;\n\t}\n}\nol.geom.GeometryCollection.prototype.calcCSpline_ = function(options)\n{\tvar g=[], g0=this.getGeometries();\n\tfor (var i=0; i<g0.length; i++)\n\t{\tg.push(g0[i].cspline(options));\n\t}\n\treturn new ol.geom.GeometryCollection(g);\n}\nol.geom.MultiLineString.prototype.calcCSpline_ = function(options)\n{\tvar g=[], lines = this.getLineStrings();\n\tfor (var i=0; i<lines.length; i++)\n\t{\tg.push(lines[i].cspline(options).getCoordinates());\n\t}\n\treturn new ol.geom.MultiLineString(g);\n}\nol.geom.Polygon.prototype.calcCSpline_ = function(options)\n{\tvar g=[], g0=this.getCoordinates();\n\tfor (var i=0; i<g0.length; i++)\n\t{\tg.push((new ol.geom.LineString(g0[i])).cspline(options).getCoordinates());\n\t}\n\treturn new ol.geom.Polygon(g);\n}\nol.geom.MultiPolygon.prototype.calcCSpline_ = function(options)\n{\tvar g=[], g0=this.getPolygons();\n\tfor (var i=0; i<g0.length; i++)\n\t{\tg.push(g0[i].cspline(options).getCoordinates());\n\t}\n\treturn new ol.geom.MultiPolygon(g);\n}\n/**\n*/\nol.geom.LineString.prototype.calcCSpline_ = function(options)\n {\tif (!options) options={};\n\tvar line = this.getCoordinates();\n\tvar tension = typeof options.tension === \"number\" ? options.tension : 0.5;\n\tvar resolution = options.resolution || (this.getLength() / line.length / (options.pointsPerSeg || 10));\n\tvar pts, res = [],\t\t\t// clone array\n\t\tx, y,\t\t\t\t\t// our x,y coords\n\t\tt1x, t2x, t1y, t2y,\t\t// tension vectors\n\t\tc1, c2, c3, c4,\t\t\t// cardinal points\n\t\tst, t, i;\t\t\t\t// steps based on num. of segments\n\t// clone array so we don't change the original\n\t//\n\tpts = line.slice(0);\n\t// The algorithm require a previous and next point to the actual point array.\n\t// Check if we will draw closed or open curve.\n\t// If closed, copy end points to beginning and first points to end\n\t// If open, duplicate first points to befinning, end points to end\n\tif (line.length>2 && line[0][0]==line[line.length-1][0] && line[0][1]==line[line.length-1][1]) \n\t{\tpts.unshift(line[line.length-2]);\n\t\tpts.push(line[1]);\n\t}\n\telse \n\t{\tpts.unshift(line[0]);\n\t\tpts.push(line[line.length-1]);\n\t}\n\t// ok, lets start..\n\tfunction dist2d(x1, y1, x2, y2)\n\t{\tvar dx = x2-x1;\n\t\tvar dy = y2-y1;\n\t\treturn Math.sqrt(dx*dx+dy*dy);\n\t}\n\t// 1. loop goes through point array\n\t// 2. loop goes through each segment between the 2 pts + 1e point before and after\n\tfor (i=1; i < (pts.length - 2); i++) \n\t{\tvar d1 = dist2d (pts[i][0], pts[i][1], pts[i+1][0], pts[i+1][1]);\n\t\tvar numOfSegments = Math.round(d1/resolution);\n\t\tvar d=1;\n\t\tif (options.normalize)\n\t\t{\td1 = dist2d (pts[i+1][0], pts[i+1][1], pts[i-1][0], pts[i-1][1]);\n\t\t\tvar d2 = dist2d (pts[i+2][0], pts[i+2][1], pts[i][0], pts[i][1]);\n\t\t\tif (d1<d2) d = d1/d2;\n\t\t\telse d = d2/d1;\n\t\t}\n\t\t// calc tension vectors\n\t\tt1x = (pts[i+1][0] - pts[i-1][0]) * tension *d;\n\t\tt2x = (pts[i+2][0] - pts[i][0]) * tension *d;\n\t\tt1y = (pts[i+1][1] - pts[i-1][1]) * tension *d;\n\t\tt2y = (pts[i+2][1] - pts[i][1]) * tension *d;\n\t\tfor (t=0; t <= numOfSegments; t++) \n\t\t{\t// calc step\n\t\t\tst = t / numOfSegments;\n\t\t\t// calc cardinals\n\t\t\tc1 =   2 * Math.pow(st, 3) \t- 3 * Math.pow(st, 2) + 1; \n\t\t\tc2 = -(2 * Math.pow(st, 3)) + 3 * Math.pow(st, 2); \n\t\t\tc3 = \t   Math.pow(st, 3)\t- 2 * Math.pow(st, 2) + st; \n\t\t\tc4 = \t   Math.pow(st, 3)\t- \t  Math.pow(st, 2);\n\t\t\t// calc x and y cords with common control vectors\n\t\t\tx = c1 * pts[i][0]\t+ c2 * pts[i+1][0] + c3 * t1x + c4 * t2x;\n\t\t\ty = c1 * pts[i][1]\t+ c2 * pts[i+1][1] + c3 * t1y + c4 * t2y;\n\t\t\t//store points in array\n\t\t\tif (x && y) res.push([x,y]);\n\t\t}\n\t}\n\treturn new ol.geom.LineString(res);\n}\n//NB: (Not confirmed)To use this module, you just have to :\n//   import('ol-ext/utils/cspline')\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** @typedef {'pointy' | 'flat'} HexagonLayout\n *  Layout of a Hexagon. Flat means the bottom part of the hexagon is flat.\n */\n/**\n* Hexagonal grids\n* @classdesc ol.HexGrid is a class to compute hexagonal grids\n* @see http://www.redblobgames.com/grids/hexagons\n*\n* @constructor ol.HexGrid\n* @extends {ol.Object}\n* @param {Object} [options]\n*\t@param {number} [options.size] size of the exagon in map units, default 80000\n*\t@param {ol.Coordinate} [options.origin] orgin of the grid, default [0,0]\n*\t@param {HexagonLayout} [options.layout] grid layout, default pointy\n*/\nol.HexGrid = function (options)\n{\toptions = options || {};\n\tol.Object.call (this, options);\n\t// Options\n\tthis.size_ = options.size||80000;\n\tthis.origin_ = options.origin || [0,0];\n\tthis.layout_ = this.layout[options.layout] || this.layout.pointy;\n};\nol.inherits (ol.HexGrid, ol.Object);\n/** Layout\n*/\nol.HexGrid.prototype.layout =\n{\tpointy: \n\t[\tMath.sqrt(3), Math.sqrt(3)/2, 0, 3/2, \n\t\tMath.sqrt(3)/3, -1/3, 0, 2/3, \n\t\t// corners\n\t\tMath.cos(Math.PI / 180 * (60 * 0 + 30)), Math.sin(Math.PI / 180 * (60 * 0 + 30)), \n\t\tMath.cos(Math.PI / 180 * (60 * 1 + 30)), Math.sin(Math.PI / 180 * (60 * 1 + 30)), \n\t\tMath.cos(Math.PI / 180 * (60 * 2 + 30)), Math.sin(Math.PI / 180 * (60 * 2 + 30)), \n\t\tMath.cos(Math.PI / 180 * (60 * 3 + 30)), Math.sin(Math.PI / 180 * (60 * 3 + 30)), \n\t\tMath.cos(Math.PI / 180 * (60 * 4 + 30)), Math.sin(Math.PI / 180 * (60 * 4 + 30)), \n\t\tMath.cos(Math.PI / 180 * (60 * 5 + 30)), Math.sin(Math.PI / 180 * (60 * 5 + 30))\n\t],\n\tflat: \n\t[\t3/2, 0, Math.sqrt(3)/2, Math.sqrt(3), 2/3, \n\t\t0, -1/3, Math.sqrt(3) / 3, \n\t\t// corners\n\t\tMath.cos(Math.PI / 180 * (60 * 0)), Math.sin(Math.PI / 180 * (60 * 0)), \n\t\tMath.cos(Math.PI / 180 * (60 * 1)), Math.sin(Math.PI / 180 * (60 * 1)), \n\t\tMath.cos(Math.PI / 180 * (60 * 2)), Math.sin(Math.PI / 180 * (60 * 2)), \n\t\tMath.cos(Math.PI / 180 * (60 * 3)), Math.sin(Math.PI / 180 * (60 * 3)), \n\t\tMath.cos(Math.PI / 180 * (60 * 4)), Math.sin(Math.PI / 180 * (60 * 4)), \n\t\tMath.cos(Math.PI / 180 * (60 * 5)), Math.sin(Math.PI / 180 * (60 * 5))\n\t]\n};\n/** Set layout\n* @param {HexagonLayout | undefined} layout name, default pointy\n*/\nol.HexGrid.prototype.setLayout = function (layout)\n{\tthis.layout_ = this.layout[layout] || this.layout.pointy;\n\tthis.changed();\n}\n/** Get layout\n* @return {HexagonLayout} layout name\n*/\nol.HexGrid.prototype.getLayout = function ()\n{\treturn (this.layout_[9]!=0 ? 'pointy' : 'flat');\n}\n/** Set hexagon origin\n* @param {ol.Coordinate} coord origin\n*/\nol.HexGrid.prototype.setOrigin = function (coord)\n{\tthis.origin_ = coord;\n\tthis.changed();\n}\n/** Get hexagon origin\n* @return {ol.Coordinate} coord origin\n*/\nol.HexGrid.prototype.getOrigin = function ()\n{\treturn this.origin_;\n}\n/** Set hexagon size\n* @param {number} hexagon size\n*/\nol.HexGrid.prototype.setSize = function (s) {\n\tthis.size_ = s || 80000;\n\tthis.changed();\n}\n/** Get hexagon size\n* @return {number} hexagon size\n*/\nol.HexGrid.prototype.getSize = function () {\n\treturn this.size_;\n}\n/** Convert cube to axial coords\n* @param {ol.Coordinate} c cube coordinate\n* @return {ol.Coordinate} axial coordinate\n*/\nol.HexGrid.prototype.cube2hex = function (c)\n{\treturn [c[0], c[2]];\n};\n/** Convert axial to cube coords\n* @param {ol.Coordinate} h axial coordinate\n* @return {ol.Coordinate} cube coordinate\n*/\nol.HexGrid.prototype.hex2cube = function(h)\n{\treturn [h[0], -h[0]-h[1], h[1]];\n};\n/** Convert offset to axial coords\n* @param {ol.Coordinate} h axial coordinate\n* @return {ol.Coordinate} offset coordinate\n*/\nol.HexGrid.prototype.hex2offset = function (h)\n{\tif (this.layout_[9]) return [ h[0] + (h[1] - (h[1]&1)) / 2, h[1] ];\n\telse return [ h[0], h[1] + (h[0] + (h[0]&1)) / 2 ];\n}\n/** Convert axial to offset coords\n* @param {ol.Coordinate} o offset coordinate\n* @return {ol.Coordinate} axial coordinate\n*/\nol.HexGrid.prototype.offset2hex = function(o)\n{\tif (this.layout_[9]) return [ o[0] - (o[1] - (o[1]&1)) / 2,  o[1] ];\n\telse return [ o[0], o[1] - (o[0] + (o[0]&1)) / 2 ];\n}\n/** Convert offset to cube coords\n* @param {ol.Coordinate} c cube coordinate\n* @return {ol.Coordinate} offset coordinate\n* /\nol.HexGrid.prototype.cube2offset = function(c)\n{\treturn hex2offset(cube2hex(c));\n};\n/** Convert cube to offset coords\n* @param {ol.Coordinate} o offset coordinate\n* @return {ol.Coordinate} cube coordinate\n* /\nol.HexGrid.prototype.offset2cube = function (o)\n{\treturn hex2cube(offset2Hex(o));\n};\n/** Round cube coords\n* @param {ol.Coordinate} h cube coordinate\n* @return {ol.Coordinate} rounded cube coordinate\n*/\nol.HexGrid.prototype.cube_round = function(h)\n{\tvar rx = Math.round(h[0])\n\tvar ry = Math.round(h[1])\n\tvar rz = Math.round(h[2])\n\tvar x_diff = Math.abs(rx - h[0])\n\tvar y_diff = Math.abs(ry - h[1])\n\tvar z_diff = Math.abs(rz - h[2])\n\tif (x_diff > y_diff && x_diff > z_diff) rx = -ry-rz\n\telse if (y_diff > z_diff) ry = -rx-rz\n\telse rz = -rx-ry\n\treturn [rx, ry, rz];\n};\n/** Round axial coords\n* @param {ol.Coordinate} h axial coordinate\n* @return {ol.Coordinate} rounded axial coordinate\n*/\nol.HexGrid.prototype.hex_round = function(h)\n{\treturn this.cube2hex( this.cube_round( this.hex2cube(h )) );\n};\n/** Get hexagon corners\n*/\nol.HexGrid.prototype.hex_corner = function(center, size, i)\n{\treturn [ center[0] + size * this.layout_[8+(2*(i%6))], center[1] + size * this.layout_[9+(2*(i%6))]];\n};\n/** Get hexagon coordinates at a coordinate\n* @param {ol.Coordinate} coord\n* @return {Arrary<ol.Coordinate>}\n*/\nol.HexGrid.prototype.getHexagonAtCoord = function (coord)\n{\treturn (this.getHexagon(this.coord2hex(coord)));\n};\n/** Get hexagon coordinates at hex\n* @param {ol.Coordinate} hex\n* @return {Arrary<ol.Coordinate>}\n*/\nol.HexGrid.prototype.getHexagon = function (hex)\n{\tvar p = [];\n\tvar c = this.hex2coord(hex);\n\tfor (var i=0; i<=7; i++)\n\t{\tp.push(this.hex_corner(c, this.size_, i, this.layout_[8]));\n\t}\n\treturn p;\n};\n/** Convert hex to coord\n* @param {ol.hex} hex\n* @return {ol.Coordinate}\n*/\nol.HexGrid.prototype.hex2coord = function (hex)\n{\treturn [\n\t\tthis.origin_[0] + this.size_ * (this.layout_[0] * hex[0] + this.layout_[1] * hex[1]), \n\t\tthis.origin_[1] + this.size_ * (this.layout_[2] * hex[0] + this.layout_[3] * hex[1])\n\t];\n};\n/** Convert coord to hex\n* @param {ol.Coordinate} coord\n* @return {ol.hex}\n*/\nol.HexGrid.prototype.coord2hex = function (coord)\n{\tvar c = [ (coord[0]-this.origin_[0]) / this.size_, (coord[1]-this.origin_[1]) / this.size_ ];\n\tvar q = this.layout_[4] * c[0] + this.layout_[5] * c[1];\n\tvar r = this.layout_[6] * c[0] + this.layout_[7] * c[1];\n\treturn this.hex_round([q, r]);\n};\n/** Calculate distance between to hexagon (number of cube)\n* @param {ol.Coordinate} a first cube coord\n* @param {ol.Coordinate} a second cube coord\n* @return {number} distance\n*/\nol.HexGrid.prototype.cube_distance = function (a, b)\n{\t//return ( (Math.abs(a[0] - b[0]) + Math.abs(a[1] - b[1]) + Math.abs(a[2] - b[2])) / 2 );\n\treturn ( Math.max (Math.abs(a[0] - b[0]), Math.abs(a[1] - b[1]), Math.abs(a[2] - b[2])) );\n};\n(function(){\n/** Line interpolation\n*/\nfunction lerp(a, b, t)\n{\t// for floats\n    return a + (b - a) * t;\n}\nfunction cube_lerp(a, b, t)\n{\t// for hexes\n    return [ \n\t\tlerp (a[0]+1e-6, b[0], t), \n\t\tlerp (a[1]+1e-6, b[1], t),\n\t\tlerp (a[2]+1e-6, b[2], t)\n\t];\n}\n/** Calculate line between to hexagon\n* @param {ol.Coordinate} a first cube coord\n* @param {ol.Coordinate} b second cube coord\n* @return {Array<ol.Coordinate>} array of cube coordinates\n*/\nol.HexGrid.prototype.cube_line = function (a, b)\n{\tvar d = this.cube_distance(a, b);\n\tif (!d) return [a];\n    var results = []\n    for (var i=0; i<=d; i++) \n\t{\tresults.push ( this.cube_round ( cube_lerp(a, b, i/d) ) );\n\t}\n    return results;\n};\n})();\nol.HexGrid.prototype.neighbors =\n{\t'cube':\t[ [+1, -1,  0], [+1,  0, -1], [0, +1, -1], [-1, +1,  0], [-1,  0, +1], [0, -1, +1] ],\n\t'hex':\t[ [+1, 0], [+1,  -1], [0, -1], [-1, 0], [-1, +1], [0, +1] ]\n};\n/** Get the neighbors for an hexagon\n* @param {ol.Coordinate} h axial coord\n* @param {number} direction\n* @return { ol.Coordinate | Array<ol.Coordinate> } neighbor || array of neighbors\n*/\nol.HexGrid.prototype.hex_neighbors = function (h, d)\n{\tif (d!==undefined)\n\t{\treturn [ h[0] + this.neighbors.hex[d%6][0], h[1]  + this.neighbors.hex[d%6][1] ];\n\t}\n\telse\n\t{\tvar n = [];\n\t\tfor (d=0; d<6; d++)\n\t\t{\tn.push ([ h[0] + this.neighbors.hex[d][0], h[1]  + this.neighbors.hex[d][1] ]);\n\t\t}\n\t\treturn n;\n\t}\n};\n/** Get the neighbors for an hexagon\n* @param {ol.Coordinate} c cube coord\n* @param {number} direction\n* @return { ol.Coordinate | Array<ol.Coordinate> } neighbor || array of neighbors\n*/\nol.HexGrid.prototype.cube_neighbors = function (c, d)\n{\tif (d!==undefined)\n\t{\treturn [ c[0] + this.neighbors.cube[d%6][0], c[1]  + this.neighbors.cube[d%6][1], c[2]  + this.neighbors.cube[d%6][2] ];\n\t}\n\telse\n\t{\tvar n = [];\n\t\tfor (d=0; d<6; d++)\n\t\t{\tn.push ([ c[0] + this.neighbors.cube[d][0], c[1]  + this.neighbors.cube[d][1], c[2]  + this.neighbors.cube[d][2] ]);\n\t\t}\n\t\tfor (d=0; d<6; d++) n[d] = this.cube2hex(n[d])\n\t\treturn n;\n\t}\n};\n\n/*\tCopyright (c) 2017 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * French INSEE grids\n * @classdesc a class to compute French INSEE grids, ie. fix area (200x200m) square grid, \n * based appon EPSG:3035\n *\n * @requires proj4\n * @constructor \n * @extends {ol.Object}\n * @param {Object} [options]\n *  @param {number} [options.size] size grid size in meter, default 200 (200x200m)\n */\nol.InseeGrid = function (options) {\n  options = options || {};\n  // Define EPSG:3035 if none\n  if (!proj4.defs[\"EPSG:3035\"]) {\n    proj4.defs(\"EPSG:3035\",\"+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs\");\n    ol.proj.proj4.register(proj4);\n  }\n  ol.Object.call (this, options);\n  // Options\n  var size = Math.max(200, Math.round((options.size||0)/200) * 200);\n  this.set('size', size);\n};\nol.ext.inherits (ol.InseeGrid, ol.Object);\n/** Grid extent (in EPSG:3035)\n */\nol.InseeGrid.extent = [3200000,2000000,4300000,3140000];\n/** Get the grid extent\n * @param {ol.proj.ProjLike} [proj='EPSG:3857']\n */\nol.InseeGrid.prototype.getExtent = function (proj) {\n  return ol.proj.transformExtent(ol.InseeGrid.extent, proj||'EPSG:3035', 'EPSG:3857')\n};\n/** Get grid geom at coord\n * @param {ol.Coordinate} coord\n * @param {ol.proj.ProjLike} [proj='EPSG:3857']\n */\nol.InseeGrid.prototype.getGridAtCoordinate = function (coord, proj) {\n  var c = ol.proj.transform(coord, proj||'EPSG:3857', 'EPSG:3035')\n  var s = this.get('size');\n  var x = Math.floor(c[0]/s) * s;\n  var y = Math.floor(c[1]/s) * s;\n  var geom = new ol.geom.Polygon([[[x,y],[x+s,y],[x+s,y+s],[x,y+s],[x,y]]]);\n  geom.transform('EPSG:3035', proj||'EPSG:3857');\n  return geom;\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Show a markup a point on postcompose\n*\t@deprecated use map.animateFeature instead\n*\t@param {ol.coordinates} point to pulse\n*\t@param {ol.markup.options} pulse options param\n*\t\t- projection {ol.projection|String|undefined} projection of coords, default none\n*\t\t- delay {Number} delay before mark fadeout\n*\t\t- maxZoom {Number} zoom when mark fadeout\n*\t\t- style {ol.style.Image|ol.style.Style|Array<ol.style.Style>} Image to draw as markup, default red circle\n*\t@return Unique key for the listener with a stop function to stop animation\n*/\nol.Map.prototype.markup = function(coords, options)\n{\tvar listenerKey;\n\tvar self = this;\n\toptions = options || {};\n\t// Change to map's projection\n\tif (options.projection)\n\t{\tcoords = ol.proj.transform(coords, options.projection, this.getView().getProjection());\n\t}\n\t// options\n\tvar start = new Date().getTime();\n\tvar delay = options.delay || 3000;\n\tvar duration = 1000;\n\tvar maxZoom = options.maxZoom || 100;\n\tvar easing = ol.easing.easeOut;\n\tvar style = options.style;\n\tif (!style) style = new ol.style.Circle({ radius:10, stroke:new ol.style.Stroke({color:'red', width:2 }) });\n\tif (style instanceof ol.style.Image) style = new ol.style.Style({ image: style });\n\tif (!(style instanceof Array)) style = [style];\n\t// Animate function\n\tfunction animate(event) \n\t{\tvar frameState = event.frameState;\n\t\tvar elapsed = frameState.time - start;\n\t\tif (elapsed > delay+duration) \n\t\t{\tol.Observable.unByKey(listenerKey);\n\t\t\tlistenerKey = null;\n\t\t}\n\t\telse \n\t\t{\tif (delay>elapsed && this.getView().getZoom()>maxZoom) delay = elapsed;\n\t\t\tvar ratio = frameState.pixelRatio;\n\t\t\tvar elapsedRatio = 0;\n\t\t\tif (elapsed > delay) elapsedRatio = (elapsed-delay) / duration;\n\t\t\tvar context = event.context;\n\t\t\tcontext.save();\n\t\t\tcontext.beginPath();\n\t\t\tcontext.globalAlpha = easing(1 - elapsedRatio);\n\t\t\tfor (var i=0; i<style.length; i++)\n\t\t\t{\tvar imgs = style[i].getImage();\n\t\t\t\tvar sc = imgs.getScale(); \n\t\t\t\timgs.setScale(sc*ratio);\n\t\t\t\tevent.vectorContext.setStyle(style[i]);\n\t\t\t\tevent.vectorContext.drawGeometry(new ol.geom.Point(coords));\n\t\t\t\timgs.setScale(sc);\n\t\t\t}\n\t\t\tcontext.restore();\n\t\t\t// tell OL3 to continue postcompose animation\n\t\t\tif (elapsed >= delay) frameState.animate = true;\n\t\t}\n\t}\n\tsetTimeout (function()\n\t\t{\tif (listenerKey) self.renderSync(); \n\t\t}, delay);\n\t// Launch animation\n\tlistenerKey = this.on('postcompose', animate.bind(this));\n\tthis.renderSync();\n\tlistenerKey.stop = function()\n\t{\tdelay = duration = 0;\n\t\tthis.target.renderSync();\n\t};\n\treturn listenerKey;\n}\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Ordering function for ol.layer.Vector renderOrder parameter\n*\tol.ordering.fn (options)\n*\tIt will return an ordering function (f0,f1)\n*\t@namespace\n*/\nol.ordering = {};\n/** y-Ordering\n*\t@return ordering function (f0,f1)\n*/\nol.ordering.yOrdering = function()\n{\treturn function(f0,f1)\n\t{\treturn f1.getGeometry().getExtent()[1] - f0.getGeometry().getExtent()[1] ;\n\t};\n};\n/** Order with a feature attribute\n * @param options\n *  @param {string} options.attribute ordering attribute, default zIndex\n *  @param {function} options.equalFn ordering function for equal values\n * @return ordering function (f0,f1)\n */\nol.ordering.zIndex = function(options)\n{\tif (!options) options = {};\n\tvar attr = options.attribute || 'zIndex';\n\tif (options.equalFn)\n\t{\treturn function(f0,f1)\n\t\t{\tif (f0.get(attr) == f1.get(attr)) return options.equalFn(f0,f1);\n\t\t\telse return f0.get(attr) < f1.get(attr) ? 1:-1;\n\t\t};\n\t}\n\telse\n\t{\treturn function(f0,f1)\n\t\t{\tif (f0.get(attr) == f1.get(attr)) return 0;\n\t\t\telse return f0.get(attr) < f1.get(attr) ? 1:-1;\n\t\t};\n\t}\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Pulse a point on postcompose\n*\t@deprecated use map.animateFeature instead\n*\t@param {ol.coordinates} point to pulse\n*\t@param {ol.pulse.options} pulse options param\n*\t\t- projection {ol.projection||String} projection of coords\n*\t\t- duration {Number} animation duration in ms, default 3000\n*\t\t- amplitude {Number} movement amplitude 0: none - 0.5: start at 0.5*radius of the image - 1: max, default 1\n*\t\t- easing {ol.easing} easing function, default ol.easing.easeOut\n*\t\t- style {ol.style.Image|ol.style.Style|Array<ol.style.Style>} Image to draw as markup, default red circle\n*/\nol.Map.prototype.pulse = function(coords, options)\n{\tvar listenerKey;\n\toptions = options || {};\n\t// Change to map's projection\n\tif (options.projection)\n\t{\tcoords = ol.proj.transform(coords, options.projection, this.getView().getProjection());\n\t}\n\t// options\n\tvar start = new Date().getTime();\n\tvar duration = options.duration || 3000;\n\tvar easing = options.easing || ol.easing.easeOut;\n\tvar style = options.style;\n\tif (!style) style = new ol.style.Circle({ radius:30, stroke:new ol.style.Stroke({color:'red', width:2 }) });\n\tif (style instanceof ol.style.Image) style = new ol.style.Style({ image: style });\n\tif (!(style instanceof Array)) style = [style];\n\tvar amplitude = options.amplitude || 1;\n\tif (amplitude<0) amplitude=0;\n\tvar maxRadius = options.radius || 15;\n\tif (maxRadius<0) maxRadius = 5;\n\t/*\n\tvar minRadius = maxRadius - (options.amplitude || maxRadius); //options.minRadius || 0;\n\tvar width = options.lineWidth || 2;\n\tvar color = options.color || 'red';\n\tconsole.log(\"pulse\")\n\t*/\n\t// Animate function\n\tfunction animate(event) \n\t{\tvar frameState = event.frameState;\n\t\tvar ratio = frameState.pixelRatio;\n\t\tvar elapsed = frameState.time - start;\n\t\tif (elapsed > duration) ol.Observable.unByKey(listenerKey);\n\t\telse\n\t\t{\tvar elapsedRatio = elapsed / duration;\n\t\t\tvar context = event.context;\n\t\t\tcontext.save();\n\t\t\tcontext.beginPath();\n\t\t\tvar e = easing(elapsedRatio)\n\t\t\tcontext.globalAlpha = easing(1 - elapsedRatio);\n\t\t\tconsole.log(\"anim\")\n\t\t\tfor (var i=0; i<style.length; i++)\n\t\t\t{\tvar imgs = style[i].getImage();\n\t\t\t\tvar sc = imgs.getScale(); \n\t\t\t\timgs.setScale(ratio*sc*(1+amplitude*(e-1)));\n\t\t\t\tevent.vectorContext.setStyle(style[i]);\n\t\t\t\tevent.vectorContext.drawGeometry(new ol.geom.Point(coords));\n\t\t\t\timgs.setScale(sc);\n\t\t\t}\n\t\t\tcontext.restore();\n\t\t\t// tell OL3 to continue postcompose animation\n\t\t\tframeState.animate = true;\n\t\t}\n\t}\n\t// Launch animation\n\tlistenerKey = this.on('postcompose', animate.bind(this));\n\tthis.renderSync();\n}\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*\n*  Add a chart style to display charts (pies or bars) on a map \n*/\n/**\n * @requires ol.style.Circle\n * @requires ol.structs.IHasChecksum\n */\n/**\n * @classdesc\n * Set chart style for vector features.\n *\n * @constructor\n * @param {} options\n *\t@param {String} options.type Chart type: pie,pie3D, donut or bar\n *\t@param {number} options.radius Chart radius/size, default 20\n *\t@param {number} options.rotation Rotation in radians (positive rotation clockwise). Default is 0.\n *\t@param {bool} options.snapToPixel use integral numbers of pixels, default true\n *\t@param {_ol_style_Stroke_} options.stroke stroke style\n *\t@param {String|Array<ol.color>} options.colors predefined color set \"classic\",\"dark\",\"pale\",\"pastel\",\"neon\" / array of color string, default classic\n *\t@param {number} options.offsetX X offset in px\n *\t@param {number} options.offsetY Y offset in px\n *\t@param {number} options.animation step in an animation sequence [0,1]\n *\t@param {number} options.max maximum value for bar chart\n * @see [Statistic charts example](../../examples/map.style.chart.html)\n * @extends {ol.style.RegularShape}\n * @implements {ol.structs.IHasChecksum}\n * @api\n */\nol.style.Chart = function(opt_options)\n{\tvar options = opt_options || {};\n\tvar strokeWidth = 0;\n\tif (opt_options.stroke) strokeWidth = opt_options.stroke.getWidth();\n\tol.style.RegularShape.call (this,\n\t\t{\tradius: options.radius + strokeWidth, \n\t\t\tfill: new ol.style.Fill({color: [0,0,0]}),\n\t\t\trotation: options.rotation,\n\t\t\tsnapToPixel: options.snapToPixel\n\t\t});\n\tif (options.scale) this.setScale(options.scale);\n\tthis.stroke_ = options.stroke;\n\tthis.radius_ = options.radius || 20;\n\tthis.donutratio_ = options.donutRatio || 0.5;\n\tthis.type_ = options.type;\n\tthis.offset_ = [options.offsetX ? options.offsetX : 0, options.offsetY ? options.offsetY : 0];\n\tthis.animation_ = (typeof(options.animation) == 'number') ? { animate:true, step:options.animation } : this.animation_ = { animate:false, step:1 };\n\tthis.max_ = options.max;\n\tthis.data_ = options.data;\n\tif (options.colors instanceof Array)\n\t{\tthis.colors_ = options.colors;\n\t}\n\telse \n\t{\tthis.colors_ = ol.style.Chart.colors[options.colors];\n\t\tif(!this.colors_) this.colors_ = ol.style.Chart.colors.classic;\n\t}\n\tthis.renderChart_();\n};\nol.inherits(ol.style.Chart, ol.style.RegularShape);\n/** Default color set: classic, dark, pale, pastel, neon\n*/\nol.style.Chart.colors =\n{\t\"classic\":\t[\"#ffa500\",\"blue\",\"red\",\"green\",\"cyan\",\"magenta\",\"yellow\",\"#0f0\"],\n\t\"dark\":\t\t[\"#960\",\"#003\",\"#900\",\"#060\",\"#099\",\"#909\",\"#990\",\"#090\"],\n\t\"pale\":\t\t[\"#fd0\",\"#369\",\"#f64\",\"#3b7\",\"#880\",\"#b5d\",\"#666\"],\n\t\"pastel\":\t[\"#fb4\",\"#79c\",\"#f66\",\"#7d7\",\"#acc\",\"#fdd\",\"#ff9\",\"#b9b\"], \n\t\"neon\":\t\t[\"#ff0\",\"#0ff\",\"#0f0\",\"#f0f\",\"#f00\",\"#00f\"]\n}\n/**\n * Clones the style. \n * @return {ol.style.Chart}\n */\nol.style.Chart.prototype.clone = function()\n{\tvar s = new ol.style.Chart(\n\t{\ttype: this.type_,\n\t\tradius: this.radius_,\n\t\trotation: this.getRotation(),\n\t\tscale: this.getScale(),\n\t\tdata: this.getData(),\n\t\tsnapToPixel: this.getSnapToPixel(),\n\t\tstroke: this.stroke_,\n\t\tcolors: this.colors_,\n\t\toffsetX: this.offset_[0],\n\t\toffsetY: this.offset_[1],\n\t\tanimation: this.animation_\n\t});\n\ts.setScale(this.getScale());\n\ts.setOpacity(this.getOpacity());\n\treturn s;\n};\n/** Get data associatied with the chart\n*/\nol.style.Chart.prototype.getData = function()\n{\treturn this.data_;\n}\n/** Set data associatied with the chart\n*\t@param {Array<number>}\n*/\nol.style.Chart.prototype.setData = function(data)\n{\tthis.data_ = data;\n\tthis.renderChart_();\n}\n/** Get symbol radius\n*/\nol.style.Chart.prototype.getRadius = function()\n{\treturn this.radius_;\n}\n/** Set symbol radius\n*\t@param {number} symbol radius\n*\t@param {number} donut ratio\n*/\nol.style.Chart.prototype.setRadius = function(radius, ratio)\n{\tthis.radius_ = radius;\n\tthis.donuratio_ = ratio || this.donuratio_;\n\tthis.renderChart_();\n}\n/** Set animation step \n*\t@param {false|number} false to stop animation or the step of the animation [0,1]\n*/\nol.style.Chart.prototype.setAnimation = function(step)\n{\tif (step===false) \n\t{\tif (this.animation_.animate == false) return;\n\t\tthis.animation_.animate = false;\n\t}\n\telse\n\t{\tif (this.animation_.step == step) return;\n\t\tthis.animation_.animate = true;\n\t\tthis.animation_.step = step;\n\t}\n\tthis.renderChart_();\n}\n/** @private\n*/\nol.style.Chart.prototype.renderChart_ = function()\n{\tvar strokeStyle;\n\tvar strokeWidth = 0;\n\tif (this.stroke_) \n\t{\tstrokeStyle = ol.color.asString(this.stroke_.getColor());\n\t\tstrokeWidth = this.stroke_.getWidth();\n\t}\n\t// no atlas manager is used, create a new canvas\n\tvar canvas = this.getImage();\n\t// draw the circle on the canvas\n\tvar context = (canvas.getContext('2d'));\n\tcontext.clearRect(0, 0, canvas.width, canvas.height);\n\tcontext.lineJoin = 'round';\n\tvar sum=0;\n\tvar i, c;\n\tfor (i=0; i<this.data_.length; i++)\n\t\tsum += this.data_[i];\n\t// reset transform\n\tcontext.setTransform(1, 0, 0, 1, 0, 0);\n\t// then move to (x, y)\n\tcontext.translate(0,0);\n\tvar step = this.animation_.animate ? this.animation_.step : 1;\n\t//console.log(this.animation_.step)\n\t// Draw pie\n\tswitch (this.type_)\n\t{\tcase \"donut\":\n\t\tcase \"pie3D\":\n\t\tcase \"pie\":\n\t\t{\tvar a, a0 = Math.PI * (step-1.5);\n\t\t\tc = canvas.width/2;\n\t\t\tcontext.strokeStyle = strokeStyle;\n\t\t\tcontext.lineWidth = strokeWidth;\n\t\t\tcontext.save();\n\t\t\tif (this.type_==\"pie3D\") \n\t\t\t{\tcontext.translate(0, c*0.3);\n\t\t\t\tcontext.scale(1, 0.7);\n\t\t\t\tcontext.beginPath();\n\t\t\t\tcontext.fillStyle = \"#369\";\n\t\t\t\tcontext.arc ( c, c*1.4, this.radius_ *step, 0, 2*Math.PI);\n\t\t\t\tcontext.fill();\n\t\t\t\tcontext.stroke();\n\t\t\t}\n\t\t\tif (this.type_==\"donut\")\n\t\t\t{\tcontext.save();\n\t\t\t\tcontext.beginPath();\n\t\t\t\tcontext.rect ( 0,0,2*c,2*c );\n\t\t\t\tcontext.arc ( c, c, this.radius_ *step *this.donutratio_, 0, 2*Math.PI);\n\t\t\t\tcontext.clip(\"evenodd\");\n\t\t\t}\n\t\t\tfor (i=0; i<this.data_.length; i++)\n\t\t\t{\tcontext.beginPath();\n\t\t\t\tcontext.moveTo(c,c);\n\t\t\t\tcontext.fillStyle = this.colors_[i%this.colors_.length];\n\t\t\t\ta = a0 + 2*Math.PI*this.data_[i]/sum *step;\n\t\t\t\tcontext.arc ( c, c, this.radius_ *step, a0, a);\n\t\t\t\tcontext.closePath();\n\t\t\t\tcontext.fill();\n\t\t\t\tcontext.stroke();\n\t\t\t\ta0 = a;\n\t\t\t}\n\t\t\tif (this.type_==\"donut\")\n\t\t\t{\tcontext.restore();\n\t\t\t\tcontext.beginPath();\n\t\t\t\tcontext.strokeStyle = strokeStyle;\n\t\t\t\tcontext.lineWidth = strokeWidth;\n\t\t\t\tcontext.arc ( c, c, this.radius_ *step *this.donutratio_, Math.PI * (step-1.5), a0);\n\t\t\t\tcontext.stroke();\n\t\t\t}\n\t\t\tcontext.restore();\n\t\t\tbreak;\n\t\t}\n\t\tcase \"bar\":\n\t\tdefault:\n\t\t{\tvar max=0;\n\t\t\tif (this.max_){\n\t\t\t\tmax = this.max_;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tfor (i=0; i<this.data_.length; i++)\n\t\t\t\t{\tif (max < this.data_[i]) max = this.data_[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar s = Math.min(5,2*this.radius_/this.data_.length);\n\t\t\tc = canvas.width/2;\n\t\t\tvar b = canvas.width - strokeWidth;\n\t\t\tvar x, x0 = c - this.data_.length*s/2\n\t\t\tcontext.strokeStyle = strokeStyle;\n\t\t\tcontext.lineWidth = strokeWidth;\n\t\t\tfor (i=0; i<this.data_.length; i++)\n\t\t\t{\tcontext.beginPath();\n\t\t\t\tcontext.fillStyle = this.colors_[i%this.colors_.length];\n\t\t\t\tx = x0 + s;\n\t\t\t\tvar h = this.data_[i]/max*2*this.radius_ *step;\n\t\t\t\tcontext.rect ( x0, b-h, s, h);\n\t\t\t\t//console.log ( x0+\", \"+(b-this.data_[i]/max*2*this.radius_)+\", \"+x+\", \"+b);\n\t\t\t\tcontext.closePath();\n\t\t\t\tcontext.fill();\n\t\t\t\tcontext.stroke();\n\t\t\t\tx0 = x;\n\t\t\t}\n\t\t}\n\t}\n\t// Set Anchor\n\tvar anchor = this.getAnchor();\n\tanchor[0] = c - this.offset_[0];\n\tanchor[1] = c - this.offset_[1];\n};\n/**\n * @inheritDoc\n */\nol.style.Chart.prototype.getChecksum = function()\n{\n\tvar strokeChecksum = (this.stroke_!==null) ?\n\t\tthis.stroke_.getChecksum() : '-';\n\tvar fillChecksum;\n\tvar recalculate = (this.checksums_===null) ||\n\t\t(strokeChecksum != this.checksums_[1] ||\n\t\tfillChecksum != this.checksums_[2] ||\n\t\tthis.radius_ != this.checksums_[3] ||\n\t\tthis.data_.join('|') != this.checksums_[4]);\n\tif (recalculate) {\n\t\tvar checksum = 'c' + strokeChecksum + fillChecksum \n\t\t\t+ ((this.radius_ !== void 0) ? this.radius_.toString() : '-')\n\t\t\t+ this.data_.join('|');\n\t\tthis.checksums_ = [checksum, strokeChecksum, fillChecksum, this.radius_, this.data_.join('|')];\n\t}\n\treturn this.checksums_[0];\n};\n\n/*\tCopyright (c) 2016 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc\n * Fill style with named pattern\n *\n * @constructor\n * @param {olx.style.FillPatternOption=}  options\n *\t@param {ol.style.Image|undefined} options.image an image pattern, image must be preloaded to draw on first call\n *\t@param {number|undefined} options.opacity opacity with image pattern, default:1\n *\t@param {olx.style.fillPattern} options.pattern pattern name (override by image option)\n *\t@param {ol.color} options.color pattern color\n *\t@param {ol.style.Fill} options.fill fill color (background)\n *\t@param {number} options.offset pattern offset for hash/dot/circle/cross pattern\n *\t@param {number} options.size line size for hash/dot/circle/cross pattern\n *\t@param {number} options.spacing spacing for hash/dot/circle/cross pattern\n *\t@param {number|bool} options.angle angle for hash pattern / true for 45deg dot/circle/cross\n *\t@param {number} options.scale pattern scale \n * @extends {ol.style.Fill}\n * @implements {ol.structs.IHasChecksum}\n * @api\n */\nol.style.FillPattern = function(options)\n{\tif (!options) options = {};\n\tvar pattern;\n\tvar canvas = this.canvas_ = document.createElement('canvas');\n\tvar scale = Number(options.scale)>0 ? Number(options.scale) : 1;\n\tvar ratio = scale*ol.has.DEVICE_PIXEL_RATIO || ol.has.DEVICE_PIXEL_RATIO;\n\tvar ctx = canvas.getContext('2d');\n\tif (options.image)\n\t{\toptions.image.load();\n\t\tvar i;\n\t\tvar img = options.image.getImage();\n\t\tif (img.width)\n\t\t{\tcanvas.width = Math.round(img.width *ratio);\n\t\t\tcanvas.height = Math.round(img.height *ratio);\n\t\t\tctx.globalAlpha = typeof(options.opacity) == 'number' ? options.opacity:1;\n\t\t\tctx.drawImage(img, 0,0, img.width, img.height, 0, 0, canvas.width, canvas.height);\n\t\t\tpattern = ctx.createPattern(canvas, 'repeat');\n\t\t}\n\t\telse \n\t\t{\tvar self = this;\n\t\t\tpattern = [0,0,0,0];\n\t\t\timg.onload = function ()\n\t\t\t{\tcanvas.width = Math.round(img.width *ratio);\n\t\t\t\tcanvas.height = Math.round(img.height *ratio);\n\t\t\t\tctx.globalAlpha = typeof(options.opacity) == 'number' ? options.opacity:1;\n\t\t\t\tctx.drawImage(img, 0,0, img.width, img.height, 0, 0, canvas.width, canvas.height);\n\t\t\t\tpattern = ctx.createPattern(canvas, 'repeat');\n\t\t\t\tself.setColor(pattern);\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\tvar pat = this.getPattern_(options);\n\t\tcanvas.width = Math.round(pat.width *ratio);\n\t\tcanvas.height = Math.round(pat.height *ratio);\n\t\tctx.beginPath();\n\t\tif (options.fill) \n\t\t{\tctx.fillStyle = ol.color.asString(options.fill.getColor());\n\t\t\tctx.fillRect(0,0, canvas.width, canvas.height);\n\t\t}\n\t\tctx.scale(ratio,ratio);\n\t\tctx.lineCap = \"round\";\n\t\tctx.lineWidth = pat.stroke || 1;\n\t\tctx.fillStyle = ol.color.asString(options.color||\"#000\");\n\t\tctx.strokeStyle = ol.color.asString(options.color||\"#000\");\n\t\tif (pat.circles) for (i=0; i<pat.circles.length; i++)\n\t\t{\tvar ci = pat.circles[i]; \n\t\t\tctx.beginPath();\n\t\t\tctx.arc(ci[0], ci[1], ci[2], 0,2*Math.PI);\n\t\t\tif (pat.fill) ctx.fill();\n\t\t\tif (pat.stroke) ctx.stroke();\n\t\t}\n\t\tif (!pat.repeat) pat.repeat=[[0,0]];\n\t\tif (pat.char)\n\t\t{\tctx.font = pat.font || (pat.width)+\"px Arial\";\n\t\t\tctx.textAlign = 'center';\n\t\t\tctx.textBaseline = 'middle';\n\t\t\tif (pat.angle) \n\t\t\t{\tctx.fillText(pat.char, pat.width/4, pat.height/4);\n\t\t\t\tctx.fillText(pat.char, 5*pat.width/4, 5*pat.height/4);\n\t\t\t\tctx.fillText(pat.char, pat.width/4, 5*pat.height/4);\n\t\t\t\tctx.fillText(pat.char, 5*pat.width/4, pat.height/4);\n\t\t\t\tctx.fillText(pat.char, 3*pat.width/4, 3*pat.height/4);\n\t\t\t\tctx.fillText(pat.char, -pat.width/4, -pat.height/4);\n\t\t\t\tctx.fillText(pat.char, 3*pat.width/4, -pat.height/4);\n\t\t\t\tctx.fillText(pat.char, -pat.width/4, 3*pat.height/4);\n\t\t\t}\n\t\t\telse ctx.fillText(pat.char, pat.width/2, pat.height/2);\n\t\t}\n\t\tif (pat.lines) for (i=0; i<pat.lines.length; i++) for (var r=0; r<pat.repeat.length; r++)\n\t\t{\tvar li = pat.lines[i];\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(li[0]+pat.repeat[r][0],li[1]+pat.repeat[r][1]);\n\t\t\tfor (var k=2; k<li.length; k+=2)\n\t\t\t{\tctx.lineTo(li[k]+pat.repeat[r][0],li[k+1]+pat.repeat[r][1]);\n\t\t\t}\n\t\t\tif (pat.fill) ctx.fill();\n\t\t\tif (pat.stroke) ctx.stroke();\n\t\t\tctx.save()\n\t\t\tctx.strokeStyle = 'red';\n\t\t\tctx.strokeWidth = 0.1;\n\t\t\t//ctx.strokeRect(0,0,canvas.width,canvas.height);\n\t\t\tctx.restore()\n\t\t}\n\t\tpattern = ctx.createPattern(canvas, 'repeat');\n\t\tif (options.offset)\n\t\t{\tvar offset = options.offset;\n\t\t\tif (typeof(offset) == \"number\") offset = [offset,offset];\n\t\t\tif (offset instanceof Array) \n\t\t\t{\tvar dx = Math.round((offset[0]*ratio));\n\t\t\t\tvar dy = Math.round((offset[1]*ratio));\n\t\t\t\t// New pattern\n\t\t\t\tctx.scale(1/ratio,1/ratio)\n\t\t\t\tctx.clearRect(0,0,canvas.width,canvas.height);\n\t\t\t\tctx.translate(dx,dy);\n\t\t\t\tctx.fillStyle = pattern;\n\t\t\t\tctx.fillRect(-dx, -dy, canvas.width,canvas.height);\n\t\t\t\tpattern = ctx.createPattern(canvas, 'repeat');\n\t\t\t}\n\t\t}\n\t}\n\tol.style.Fill.call (this, { color: pattern });\n};\nol.inherits(ol.style.FillPattern, ol.style.Fill);\n/**\n * Clones the style. \n * @return {ol.style.FillPattern}\n */\nol.style.FillPattern.prototype.clone = function()\n{\tvar s = ol.style.Fill.prototype.clone.call(this);\n\ts.canvas_ = this.canvas_;\n\treturn s;\n};\n/** Get canvas used as pattern\n*\t@return {canvas}\n*/\nol.style.FillPattern.prototype.getImage = function()\n{\treturn this.canvas_;\n}\n/** Get pattern\n*\t@param {olx.style.FillPatternOption}\n*/\nol.style.FillPattern.prototype.getPattern_ = function(options)\n{\tvar pat = ol.style.FillPattern.prototype.patterns[options.pattern]\n\t\t|| ol.style.FillPattern.prototype.patterns.dot;\n\tvar d = Math.round(options.spacing)||10;\n\tvar size;\n\tswitch (options.pattern)\n\t{\tcase 'dot':\n\t\tcase 'circle':\n\t\t{\tsize = options.size===0 ? 0 : options.size/2 || 2;\n\t\t\tif (!options.angle)\n\t\t\t{\tpat.width = pat.height = d;\n\t\t\t\tpat.circles = [[ d/2, d/2, size ]]\n\t\t\t\tif (options.pattern=='circle')\n\t\t\t\t{\tpat.circles = pat.circles.concat([\n\t\t\t\t\t\t[ d/2+d, d/2, size ],\n\t\t\t\t\t\t[ d/2-d, d/2, size ],\n\t\t\t\t\t\t[ d/2, d/2+d, size ],\n\t\t\t\t\t\t[ d/2, d/2-d, size ],\n\t\t\t\t\t\t[ d/2+d, d/2+d, size ],\n\t\t\t\t\t\t[ d/2+d, d/2-d, size ],\n\t\t\t\t\t\t[ d/2-d, d/2+d, size ],\n\t\t\t\t\t\t[ d/2-d, d/2-d, size ] ])\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\td = pat.width = pat.height = Math.round(d*1.4);\n\t\t\t\tpat.circles = [[ d/4, d/4, size ], [ 3*d/4, 3*d/4, size ]];\n\t\t\t\tif (options.pattern=='circle')\n\t\t\t\t{\tpat.circles = pat.circles.concat([\n\t\t\t\t\t\t[ d/4+d, d/4, size ],\n\t\t\t\t\t\t[ d/4, d/4+d, size ],\n\t\t\t\t\t\t[ 3*d/4-d, 3*d/4, size ],\n\t\t\t\t\t\t[ 3*d/4, 3*d/4-d, size ],\n\t\t\t\t\t\t[ d/4+d, d/4+d, size ], \n\t\t\t\t\t\t[ 3*d/4-d, 3*d/4-d, size ] ]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tcase 'tile':\n\t\tcase 'square':\n\t\t{\tsize = options.size===0 ? 0 : options.size/2 || 2;\n\t\t\tif (!options.angle)\n\t\t\t{\tpat.width = pat.height = d;\n\t\t\t\tpat.lines = [[ d/2-size, d/2-size, d/2+size, d/2-size, d/2+size, d/2+size, d/2-size,d/2+size, d/2-size, d/2-size ]]\n\t\t\t}\n\t\t\telse\n\t\t\t{\tpat.width = pat.height = d;\n\t\t\t\t//size *= Math.sqrt(2);\n\t\t\t\tpat.lines = [[ d/2-size,d/2, d/2,d/2-size, d/2+size,d/2, d/2,d/2+size, d/2-size,d/2 ]]\n\t\t\t}\n\t\t\tif (options.pattern=='square') pat.repeat = [[0,0], [0,d], [d,0], [0,-d], [-d,0], [-d,-d], [d,d], [-d,d], [d,-d] ]\n\t\t\tbreak;\n\t\t}\n\t\tcase 'cross':\n\t\t{\t// Limit angle to 0 | 45\n\t\t\tif (options.angle) options.angle = 45;\n\t\t}\n\t\t// fallsthrough\n\t\tcase 'hatch':\n\t\t{\tvar a = Math.round(((options.angle||0)-90)%360);\n\t\t\tif (a>180) a -= 360;\n\t\t\ta *= Math.PI/180;\n\t\t\tvar cos = Math.cos(a);\n\t\t\tvar sin = Math.sin(a);\n\t\t\tif (Math.abs(sin)<0.0001)\n\t\t\t{\tpat.width = pat.height = d;\t\n\t\t\t\tpat.lines = [ [ 0,0.5, d, 0.5 ] ];\n\t\t\t\tpat.repeat = [ [0,0], [0,d] ];\n\t\t\t}\n\t\t\telse  if (Math.abs(cos)<0.0001)\n\t\t\t{\tpat.width = pat.height = d;\t\n\t\t\t\tpat.lines = [ [ 0.5,0, 0.5, d] ];\n\t\t\t\tpat.repeat = [ [0,0], [d,0] ];\n\t\t\t\tif (options.pattern=='cross') \n\t\t\t\t{\tpat.lines.push ([ 0,0.5, d, 0.5 ]);\n\t\t\t\t\tpat.repeat.push([0,d]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\tvar w = pat.width = Math.round(Math.abs(d/sin)) || 1;\n\t\t\t\tvar h = pat.height = Math.round(Math.abs(d/cos)) || 1;\n\t\t\t\tif (options.pattern=='cross')\n\t\t\t\t{\tpat.lines = [ [-w,-h, 2*w,2*h], [2*w,-h, -w,2*h] ];\n\t\t\t\t\tpat.repeat = [ [0,0] ];\n\t\t\t\t}\n\t\t\t\telse if (cos*sin>0) \n\t\t\t\t{\tpat.lines = [ [-w,-h, 2*w,2*h] ];\n\t\t\t\t\tpat.repeat = [ [0,0], [w,0], [0,h] ];\n\t\t\t\t}\n\t\t\t\telse \n\t\t\t\t{\tpat.lines = [ [2*w,-h, -w,2*h] ];\n\t\t\t\t\tpat.repeat = [ [0,0], [-w,0], [0,h] ];\n\t\t\t\t}\n\t\t\t}\n\t\t\tpat.stroke = options.size===0 ? 0 : options.size||4;\n\t\t\tbreak;\n\t\t}\n\t\tdefault: break;\n\t}\n\treturn pat\n}\n/** Static fuction to add char patterns\n*\t@param {title} \n*\t@param {olx.fillpattern.Option}\n*\t\t- size {integer} default 10\n*\t\t- width {integer} default 10\n*\t\t- height {integer} default 10\n*\t\t- circles {Array<circles>}\n*\t\t- lines: {Array<pointlist>}\n*\t\t- stroke {integer}\n*\t\t- fill {bool}\n*\t\t- char {char}\n*\t\t- font {string} default \"10px Arial\"\n*/\nol.style.FillPattern.addPattern = function (title, options)\n{\tif (!options) options={};\n\tol.style.FillPattern.prototype.patterns[title || options.char] =\n\t{\twidth: options.width || options.size || 10,\n\t\theight: options.height || options.size || 10,\n\t\tfont: options.font,\n\t\tchar: options.char,\n\t\tcircles: options.circles,\n\t\tlines: options.lines,\n\t\trepeat: options.repeat,\n\t\tstroke: options.stroke,\n\t\tangle: options.angle,\n\t\tfill: options.fill\n\t}\n}\n/** Patterns definitions\n\tExamples : http://seig.ensg.ign.fr/fichchap.php?NOFICHE=FP31&NOCHEM=CHEMS009&NOLISTE=1&N=8\n*/\nol.style.FillPattern.prototype.patterns =\n{\n\t\"hatch\":\n\t{\twidth:5,\n\t\theight:5,\n\t\tlines:[[0,2.5,5,2.5]],\n\t\tstroke:1\n\t},\n\t\"cross\":\n\t{\twidth:7,\n\t\theight:7,\n\t\tlines:[[0,3,10,3],[3,0,3,10]],\n\t\tstroke:1\n\t},\n\t\"dot\":\n\t{\twidth:8,\n\t\theight:8,\n\t\tcircles:[[5,5,2]],\n\t\tstroke:false,\n\t\tfill:true,\n\t},\n\t\"circle\":\n\t{\twidth:10,\n\t\theight:10,\n\t\tcircles:[[5,5,2]],\n\t\tstroke:1,\n\t\tfill:false,\n\t},\n\t\"square\":\n\t{\twidth:10,\n\t\theight:10,\n\t\tlines:[[3,3, 3,8, 8,8, 8,3, 3,3]],\n\t\tstroke:1,\n\t\tfill:false,\n\t},\n\t\"tile\":\n\t{\twidth:10,\n\t\theight:10,\n\t\tlines:[[3,3, 3,8, 8,8, 8,3, 3,3]],\n\t\tfill:true,\n\t},\n\t\"woven\":\n\t{\twidth: 12,\n\t\theight: 12,\n\t\tlines: [[ 3,3, 9,9 ],[0,12, 3,9], [9,3, 12,0], [-1,1,1,-1], [13,11,11,13]],\n\t\tstroke: 1\n\t},\n\t\"crosses\":\n\t{\twidth: 8,\n\t\theight: 8,\n\t\tlines: [[ 2,2, 6,6 ],[2,6,6,2]],\n\t\tstroke: 1\n\t},\n\t\"caps\":\n\t{\twidth: 8,\n\t\theight: 8,\n\t\tlines: [[ 2,6, 4,2, 6,6 ]],\n\t\tstroke: 1\n\t},\n\t\"nylon\":\n\t{\twidth: 20,\n\t\theight: 20,\n//\t\tlines: [[ 0,5, 0,0, 5,0 ],[ 5,10, 10,10, 10,5 ], [ 10,15, 10,20, 15,20 ],[ 15,10, 20,10, 20,15 ]],\n//\t\trepeat: [[0,0], [20,0], [0,20], [-20,0], [0,-20], [-20,-20]],\n\t\tlines: [[ 1,6, 1,1, 6,1 ],[ 6,11, 11,11, 11,6 ], [ 11,16, 11,21, 16,21 ],[ 16,11, 21,11, 21,16 ]],\n\t\trepeat: [[0,0], [-20,0], [0,-20] ],\n\t\tstroke: 1\n\t},\n\t\"hexagon\":\n\t{\twidth: 20,\n\t\theight: 12,\n\t\tlines: [[ 0,10, 4,4, 10,4, 14,10, 10,16, 4,16, 0,10 ]],\n\t\tstroke:1,\n\t\trepeat:[[0,0],[10,6],[10,-6],[-10,-6]]\n\t},\n\t\"cemetry\":\n\t{\twidth:15,\n\t\theight:19,\n\t\tlines:[[0,3.5,7,3.5],[3.5,0,3.5,10],\n\t\t\t//[7,12.5,14,12.5],[10.5,9,10.5,19]\n\t\t\t],\n\t\tstroke:1,\n\t\trepeat:[[0,0],[7,9]]\n\t},\n\t\"sand\":\n\t{\twidth:20,\n\t\theight:20,\n\t\tcircles:[[1,2,1],[9,3,1],[2,16,1],\n\t\t\t\t[7,8,1],[6,14,1],[4,19,1],\n\t\t\t\t[14,2,1],[12,10,1],[14,18,1],\n\t\t\t\t[18,8,1],[18,14,1]],\n\t\tfill:1\n\t},\n\t\"conglomerate\":\n\t{\twidth:30,\n\t\theight:20,\n\t\tcircles:[[2,4,1],[17,3,1],[26,18,1],[12,17,1],[5,17,2],[28,11,2]],\n\t\tlines:[[7,5, 6,7, 9,9, 11,8, 11,6, 9,5, 7,5], \n\t\t\t[16,10, 15,13, 16,14, 19,15, 21,13, 22,9, 20,8, 19,8, 16,10], \n\t\t\t[24,6, 26,7, 27,5, 26,4, 24,4, 24,6]],\n\t\tstroke:1\n\t},\n\t\"gravel\":\n\t{\twidth:15,\n\t\theight:10,\n\t\tcircles:[[4,2,1],[5,9,1],[1,7,1]],//[9,9,1],,[15,2,1]],\n\t\tlines:[[7,5, 6,6, 7,7, 8,7, 9,7, 10,5, 9,4, 7,5], [11,2, 14,4, 14,1, 12,1, 11,2]],\n\t\tstroke:1\n\t},\n\t\"brick\":\n\t{\twidth:18,\n\t\theight:16,\n\t\tlines:[\t[0,1,18,1],[0,10,18,10], [6,1,6,10],[12,10,12,18],[12,0,12,1]],\n\t\tstroke:1\n\t},\n\t\"dolomite\":\n\t{\twidth:20,\n\t\theight:16,\n\t\tlines:[[0,1,20,1],[0,9,20,9],[1,9,6,1],[11,9,14,16],[14,0,14.4,1]],\n\t\tstroke:1\n\t},\n\t\"coal\":\n\t{\twidth:20,\n\t\theight:16,\n\t\tlines:[[1,5, 7,1, 7,7], [11,10, 12,5, 18,9], [5,10, 2,15, 9,15,], [15,16, 15,13, 20,16], [15,0, 15,2, 20,0]],\n\t\tfill:1\n\t},\n\t\"breccia\":\n\t{\twidth:20,\n\t\theight:16,\n\t\tlines:[[1,5, 7,1, 7,7, 1,5], [11,10, 12,5, 18,9, 11,10], [5,10, 2,15, 9,15, 5,10], [15,16, 15,13, 22,18], [15,0, 15,2, 20,0] ],\n\t\tstroke:1,\n\t},\n\t\"clay\":\n\t{\twidth:20,\n\t\theight:20,\n\t\tlines:[[0,0, 3,11, 0,20], [11,0, 10,3, 13,13, 11,20], [0,0, 10,3, 20,0], [0,12, 3,11, 13,13, 20,12]],\n\t\tstroke:1\n\t},\n\t\"flooded\":\n\t{\twidth:15,\n\t\theight:10,\n\t\tlines:[\t[0,1,10,1],[0,6,5,6], [10,6,15,6]],\n\t\tstroke:1\n\t},\n\t\"chaos\":\n\t{\twidth:40,\n\t\theight:40,\n\t\tlines:[[40,2, 40,0, 38,0, 40,2], \n\t\t\t[4,0, 3,2, 2,5, 0,0, 0,3, 2,7, 5,6, 7,7, 8,10, 9,12, 9,13, 9,14, 8,14, 6,15, 2,15, 0,20, 0,22, 2,20, 5,19, \n\t\t\t\t8,15, 10,14, 11,12.25, 10,12, 10,10, 12,9, 13,7, 12,6, 13,4, 16,7, 17,4, 20,0, 18,0, 15,3, 14,2, 14,0,\n\t\t\t\t12,1, 11,0, 10,1, 11,4, 10,7, 9,8, 8,5, 6,4, 5,3, 5,1, 5,0, 4,0],\n\t\t\t[7,1, 7,3, 8,3, 8,2, 7,1], [4,3, 5,5, 4,5, 4,3], [34,5, 33,7, 38,10, 38,8, 36,5, 34,5], \n\t\t\t[ 27,0, 23,2, 21,8, 30,0, 27,0], \n\t\t\t[25,8, 26,12, 26,16, 22.71875,15.375, 20,13, 18,15, 17,18, 13,22, 17,21, 19,22, 21,20, 19,18, 22,17, 30,25, \n\t\t\t26,26, 24,28, 21.75,33.34375, 20,36, 18,40, 20,40, 24,37, 25,32, 27,31, 26,38, 27,37, 30,32, 32,35, 36,37, \n\t\t\t38,40, 38,39, 40,40, 37,36, 34,32, 37,31, 36,29, 33,27, 34,24, 39,21, 40,21, 40,16, 37,20, 31,22, 32,25, \n\t\t\t27,20, 29,15, 30,20, 32,20, 34,18, 33,12, 31,11, 29,14, 26,9, 25,8], [39,24, 37,26, 40,28, 39,24], \n\t\t\t[13,15, 9,19, 14,18, 13,15], [18,23, 14,27, 16,27, 17,25, 20,26, 18,23], \n\t\t\t[6,24, 2,26, 1,28, 2,30, 5,28, 12,30, 16,32, 18,30, 15,30, 12,28, 9,25, 7,27, 6,24], \n\t\t\t[29,27, 32,28, 33,31, 30,29, 27,28, 29,27], \n\t\t\t[5,35, 1,33, 3,36, 13,38, 15,35, 10,36, 5,35]],\n\t\tfill:1,\n\t},\n\t\"grass\":\n\t{\twidth:27,\n\t\theight:22,\n\t\tlines: [[0,10.5,13,10.5], [2.5,10,1.5,7], [4.5,10, 4.5,5, 3.5,4 ], [7,10, 7.5,6, 8.5,3], [10,10,11,6]],\n\t\trepeat: [[0,0],[14,10]],\n\t\tstroke:1\n\t},\n\t\"swamp\":\n\t{\twidth:24,\n\t\theight:23,\n\t\tlines:[ [0,10.5,9.5,10.5], [2.5,10,2.5,7], [4.5,10,4.5,4], [6.5,10,6.5,6], [3,12.5,7,12.5] ],\n\t\trepeat: [[0,0],[14,10]],\n\t\tstroke:1\n\t},\n\t\"wave\":\n\t{\twidth:10,\n\t\theight:8,\n\t\tlines:[ [0,0, 5,4, 10,0] ],\n\t\tstroke:1\n\t},\n\t\"vine\":\n\t{\twidth:13,\n\t\theight:13,\n\t\tlines:[[3,0,3,6],[9,7,9,13]],\n\t\tstroke:1.0\n\t},\n\t\"forest\":\n\t{\twidth:55,\n\t\theight:30,\n\t\tcircles:[[7,7,3.5],[20,20,1.5],[42,22,3.5],[35,5,1.5]],\n\t\tstroke:1\n\t},\n\t\"scrub\":\n\t{\twidth:26,\n\t\theight:20,\n\t\tlines:[ [1,4, 4,8, 6,4] ],\n\t\tcircles:[[20,13,1.5]],\n\t\tstroke:1,\n\t},\n\t\"tree\":\n\t{\twidth:30,\n\t\theight:30,\n\t\tlines:[[7.78,10.61,4.95,10.61,4.95,7.78,3.54,7.78,2.12,6.36,0.71,6.36,0,4.24,0.71,2.12,4.24,0,7.78,0.71,9.19,3.54,7.78,4.95,7.07,7.07,4.95,7.78]],\n\t\trepeat: [[3,1],[18,16]],\n\t\tstroke:1\n\t},\n\t\"pine\":\n\t{\twidth:30,\n\t\theight:30,\n\t\tlines:[[5.66,11.31,2.83,11.31,2.83,8.49,0,8.49,2.83,0,5.66,8.49,2.83,8.49]],\n\t\trepeat:[[3,1],[18,16]],\n\t\tstroke:1\n\t},\n\t\"pines\":\n\t{\twidth:22,\n\t\theight:20,\n\t\tlines:[[1,4,3.5,1,6,4],[1,8,3.5,5,6,8],[3.5,1,3.5,11],[12,14.5,14.5,14,17,14.5],[12,18,17,18],[14.5,12,14.5,18]],\n\t\trepeat: [[2,1]],\n\t\tstroke:1\n\t},\n\t\"rock\":\n\t{\twidth:20,\n\t\theight:20,\n\t\tlines:[\t[1,0,1,9],[4,0,4,9],[7,0,7,9], \n\t\t\t\t[10,1,19,1],[10,4,19,4],[10,7,19,7],\n\t\t\t\t[0,11,9,11],[0,14,9,14],[0,17,9,17], \n\t\t\t\t[12,10,12,19],[15,10,15,19],[18,10,18,19] ],\n\t\trepeat:[[0.5,0.5]],\n\t\tstroke:1\n\t},\n\t\"rocks\":\n\t{\twidth:20,\n\t\theight:20,\n\t\tlines:[\t[5,0, 3,0, 5,4, 4,6, 0,3, 0,5, 3,6, 5,9, 3.75,10, 2.5,10, 0,9, 0,10, 4,11, 5,14, 4,15, 0,13,\n\t\t\t0,13, 0,13, 0,14, 0,14, 5,16, 5,18, 3,19, 0,19, -0.25,19.9375, 5,20, 10,19, 10,20, 11,20, 12,19,\n\t\t\t14,20, 15,20, 17,19, 20,20, 20,19, 19,16, 20,15, 20,11, 20,10, 19,8, 20,5, 20,0, 19,0, 20,2, 19,4,\n\t\t\t17,4, 16,3, 15,0, 14,0, 15,4, 11,5, 10,4, 11,0, 10,0, 9,4, 6,5, 5,0,],\n\t\t\t[18,5, 19,6, 18,10, 16,10, 14,9, 16,5, 18,5], \n\t\t\t[5,6, 9,5, 10,6, 10,9, 6,10, 5,6], \n\t\t\t[14,5, 14,8, 13,9, 12,9, 11,7, 12,5, 14,5], \n\t\t\t[ 5,11, 8,10, 9,11, 10,14, 6,15, 6,15, 5,11], \n\t\t\t[13,10, 14,11, 15,14, 15,14, 15,14, 11,15, 10,11, 11,10, 13,10], \n\t\t\t[15,12, 16,11, 19,11, 19,15, 16,14, 16,14, 15,12], \n\t\t\t[6,16, 9,15, 10,18, 5,19, 6,16], \n\t\t\t[10,16, 14,16, 14,18, 13,19, 11,18, 10,16], \n\t\t\t[15,15, 18,16, 18,18, 16,19, 15,18, 15,15]],\n\t\tstroke:1\n\t}\n}\n/**\n * /\nol.style.FillPattern.prototype.getChecksum = function()\n{\n\tvar strokeChecksum = (this.stroke_!==null) ?\n\t\tthis.stroke_.getChecksum() : '-';\n\tvar fillChecksum = (this.fill_!==null) ?\n\t\tthis.fill_.getChecksum() : '-';\n\tvar recalculate = (this.checksums_===null) ||\n\t\t(strokeChecksum != this.checksums_[1] ||\n\t\tfillChecksum != this.checksums_[2] ||\n\t\tthis.radius_ != this.checksums_[3] ||\n\t\tthis.form_+\"-\"+this.glyphs_ != this.checksums_[4]);\n\tif (recalculate) {\n\t\tvar checksum = 'c' + strokeChecksum + fillChecksum \n\t\t\t+ ((this.radius_ !== void 0) ? this.radius_.toString() : '-')\n\t\t\t+ this.form_+\"-\"+this.glyphs_;\n\t\tthis.checksums_ = [checksum, strokeChecksum, fillChecksum, this.radius_, this.form_+\"-\"+this.glyphs_];\n\t}\n\treturn this.checksums_[0];\n};\n/**/\n\n/*\tCopyright (c) 2019 Jean-Marc VIGLINO, \n  released under the CeCILL-B license (French BSD license)\n  (http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/** Flow line style\n * Draw LineString with a variable color / width\n *\n * @extends {ol.style.Style}\n * @constructor\n * @param {Object} options\n *  @param {boolean} options.visible draw only the visible part of the line, default true\n *  @param {number|function} options.width Stroke width or a function that gets a feature and the position (beetween [0,1]) and returns current width\n *  @param {number} options.width2 Final stroke width\n *  @param {ol.colorLike|function} options.color Stroke color or a function that gets a feature and the position (beetween [0,1]) and returns current color\n *  @param {ol.colorLike} options.color2 Final sroke color\n */\nol.style.FlowLine = function(options) {\n  if (!options) options = {};\n  ol.style.Style.call (this, { \n    renderer: this._render.bind(this),\n    geometry: options.geometry\n  });\n  // Draw only visible\n  this._visible = (options.visible !== false);\n  // Width\n  if (typeof options.width === 'function') {\n    this._widthFn = options.width;\n  } else {\n    this.setWidth(options.width);\n  }\n  this.setWidth2(options.width2);\n  // Color\n  if (typeof options.color === 'function') {\n    this._colorFn = options.color;\n  } else {\n    this.setColor(options.color);\n  }\n  this.setColor2(options.color2);\n  // LineCap\n  this.setLineCap(options.lineCap);\n};\nol.inherits(ol.style.FlowLine, ol.style.Style);\n/** Set the initial width\n * @param {number} width width, default 0\n */\nol.style.FlowLine.prototype.setWidth = function(width) {\n  this._width = width || 0;\n};\n/** Set the final width\n * @param {number} width width, default 0\n */\nol.style.FlowLine.prototype.setWidth2 = function(width) {\n  this._width2 = width;\n};\n/** Set the LineCap\n * @param {steing} cap LineCap (round or mitter), default mitter\n */\nol.style.FlowLine.prototype.setLineCap = function(cap) {\n  this._lineCap = (cap==='round' ? 'round' : 'mitter');\n};\n/** Get the current width at step\n * @param {ol.feature} feature\n * @param {number} step current drawing step beetween [0,1] \n * @return {number} \n */\nol.style.FlowLine.prototype.getWidth = function(feature, step) {\n  if (this._widthFn) return this._widthFn(feature, step);\n  var w2 = (typeof(this._width2) === 'number') ? this._width2 : this._width;\n  return this._width + (w2-this._width) * step;\n};\n/** Set the initial color\n * @param {ol.colorLike} color\n */\nol.style.FlowLine.prototype.setColor = function(color) {\n  try{\n    this._color = ol.color.asArray(color);\n  } catch(e) {\n    this._color = [0,0,0,1];\n  }\n};\n/** Set the final color\n * @param {ol.colorLike} color\n */\nol.style.FlowLine.prototype.setColor2 = function(color) {\n  try {\n    this._color2 = ol.color.asArray(color);\n  } catch(e) {\n    this._color2 = null;    \n  }\n};\n/** Get the current color at step\n * @param {ol.feature} feature\n * @param {number} step current drawing step beetween [0,1] \n * @return {string} \n */\nol.style.FlowLine.prototype.getColor = function(feature, step) {\n  if (this._colorFn) return ol.color.asString(this._colorFn(feature, step));\n  var color = this._color;\n  var color2 = this._color2 || this._color\n  return 'rgba('+\n          + Math.round(color[0] + (color2[0]-color[0]) * step) +','\n          + Math.round(color[1] + (color2[1]-color[1]) * step) +','\n          + Math.round(color[2] + (color2[2]-color[2]) * step) +','\n          + (color[3] + (color2[3]-color[3]) * step)\n          +')';\n};\n/** Renderer function\n * @param {Array<ol.coordinate>} geom The pixel coordinates of the geometry in GeoJSON notation\n * @param {ol.render.State} e The olx.render.State of the layer renderer\n */\nol.style.FlowLine.prototype._render = function(geom, e) {\n  if (e.geometry.getType()==='LineString') {\n    var i, p, ctx = e.context;\n    // Get geometry used at drawing\n    if (!this._visible) {\n      var a = e.pixelRatio / e.resolution;\n      var g = e.geometry.getCoordinates();\n      var dx = geom[0][0] - g[0][0] * a;\n      var dy = geom[0][1] + g[0][1] * a;\n      geom = [];\n      for (i=0; p=g[i]; i++) {\n        geom[i] = [ dx + p[0] * a, dy - p[1] * a];\n      }\n    }\n    // Split into\n    var geoms = this._splitInto(geom, 255, 2);\n    var k = 0;\n    var nb = geoms.length;\n    // Draw\n    ctx.save();\n      ctx.lineJoin = 'round';\n      ctx.lineCap = this._lineCap || 'mitter';\n      geoms.forEach((g) => {\n        var step = k++/nb;\n        ctx.lineWidth = this.getWidth(e.feature, step) * e.pixelRatio;\n        ctx.strokeStyle = this.getColor(e.feature, step);\n        ctx.beginPath();\n        ctx.moveTo(g[0][0],g[0][1]);\n        for (i=1; p=g[i]; i++) {\n          ctx.lineTo(p[0],p[1]);\n          ctx.stroke();\n        }\n      });\n    ctx.restore();\n  }\n};\n/** Split line geometry into equal length geometries\n * @param {Array<ol.coordinate>} geom\n * @param {number} nb number of resulting geometries, default 255\n * @param {number} nim minimum length of the resulting geometries, default 1\n */\nol.style.FlowLine.prototype._splitInto = function(geom, nb, min) {\n  var i, p;\n  // Split geom into equal length geoms\n  var geoms = [];\n  var dl, l = 0;\n  for (i=1; p=geom[i]; i++) {\n    l += ol.coordinate.dist2d(geom[i-1], p);\n  }\n  var length = Math.max (min||2, l/(nb||255));\n  var p0 = geom[0];\n  l = 0;\n  var g = [p0];\n  i = 1;\n  p = geom[1];\n  while (i < geom.length) {\n    var dx = p[0]-p0[0];\n    var dy = p[1]-p0[1];\n    dl = Math.sqrt(dx*dx + dy*dy);\n    if (l+dl > length) {\n      var d = (length-l) / dl;\n      g.push([ \n        p0[0] + dx * d,  \n        p0[1] + dy * d \n      ]);\n      geoms.push(g);\n      p0 =[ \n        p0[0] + dx * d*.9,  \n        p0[1] + dy * d*.9\n      ];\n      g = [p0];\n      l = 0;\n    } else {\n      l += dl;\n      p0 = p;\n      g.push(p0);\n      i++;\n      p = geom[i];\n    }\n  }\n  geoms.push(g);\n  return geoms;\n}\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc\n * A marker style to use with font symbols.\n *\n * @constructor\n * @param {} options Options.\n *  @param {number} options.glyph the glyph name or a char to display as symbol. \n * \t\tThe name must be added using the {@link ol.style.FontSymbol.addDefs} function.\n *  @param {string} options.form \n * \t\tnone|circle|poi|bubble|marker|coma|shield|blazon|bookmark|hexagon|diamond|triangle|sign|ban|lozenge|square\n * \t\ta form that will enclose the glyph, default none\n *  @param {number} options.radius\n *  @param {number} options.rotation\n *  @param {number} options.rotateWithView\n *  @param {number} options.opacity\n *  @param {number} options.fontSize, default 1\n *  @param {string} options.fontStyle the font style (bold, italic, bold italic, etc), default none\n *  @param {boolean} options.gradient true to display a gradient on the symbol\n *  @param {_ol_style_Fill_} options.fill\n *  @param {_ol_style_Stroke_} options.stroke\n * @extends {ol.style.RegularShape}\n * @implements {ol.structs.IHasChecksum}\n * @api\n */\nol.style.FontSymbol = function(options)\n{\toptions = options || {};\n\tvar strokeWidth = 0;\n\tif (options.stroke) strokeWidth = options.stroke.getWidth();\n\tol.style.RegularShape.call (this,{ radius: options.radius, fill:options.fill,\n\t\t\t\t\t\t\t\t\trotation:options.rotation, rotateWithView: options.rotateWithView });\n\tif (typeof(options.opacity)==\"number\") this.setOpacity(options.opacity);\n\tthis.color_ = options.color;\n\tthis.fontSize_ = options.fontSize || 1;\n\tthis.fontStyle_ = options.fontStyle || '';\n\tthis.stroke_ = options.stroke;\n\tthis.fill_ = options.fill;\n\tthis.radius_ = options.radius -strokeWidth;\n\tthis.form_ = options.form || \"none\";\n\tthis.gradient_ = options.gradient;\n\tthis.offset_ = [options.offsetX ? options.offsetX :0, options.offsetY ? options.offsetY :0];\n\tthis.glyph_ = this.getGlyph(options.glyph) || \"\";\n\tthis.renderMarker_();\n};\nol.inherits(ol.style.FontSymbol, ol.style.RegularShape);\n/** Cool stuff to get the image symbol for a style\n*/\nol.style.Image.prototype.getImagePNG = function()\n{\tvar canvas = this.getImage();\n\tif (canvas) \n\t{\ttry { return canvas.toDataURL(\"image/png\"); }\n\t\tcatch(e) { return false; }\n\t}\n\telse return false;\n}\n/** \n *\tFont defs\n */\nol.style.FontSymbol.prototype.defs = { 'fonts':{}, 'glyphs':{} };\n/** Static function : add new font defs \n * @param {String|Object} font the font desciption\n * @param {} glyphs a key / value list of glyph definitions. \n * \t\tEach key is the name of the glyph, \n * \t\tthe value is an object that code the font, the caracter code, \n * \t\tthe name and a search string for the glyph.\n */\n ol.style.FontSymbol.addDefs = function(font, glyphs)\n {\tvar thefont = font;\n\tif (typeof(font) == \"string\") thefont = {\"font\":font, \"name\":font, \"copyright\":\"\" };\n\tif (!thefont.font || typeof(thefont.font) != \"string\") \n\t{\tconsole.log(\"bad font def\");\n\t\treturn;\n\t}\n\tvar fontname = thefont.font;\n\tol.style.FontSymbol.prototype.defs.fonts[fontname] = thefont;\n\tfor (var i in glyphs)\n\t{\tvar g = glyphs[i];\n\t\tif (typeof(g) == \"string\" && g.length==1) g = { char: g };\n\t\tol.style.FontSymbol.prototype.defs.glyphs[i] =\n\t\t\t{\tfont: thefont.font,\n\t\t\t\tchar: g.char || \"\"+String.fromCharCode(g.code) || \"\",\n\t\t\t\ttheme: g.theme || thefont.name,\n\t\t\t\tname: g.name || i,\n\t\t\t\tsearch: g.search || \"\"\n\t\t\t};\n\t}\n };\n/**\n * Clones the style. \n * @return {ol.style.FontSymbol}\n */\nol.style.FontSymbol.prototype.clone = function()\n{\tvar g = new ol.style.FontSymbol(\n\t{\tglyph: \"\",\n\t\tcolor: this.color_,\n\t\tfontSize: this.fontSize_,\n\t\tfontStyle: this.fontStyle_,\n\t\tstroke: this.stroke_,\n\t\tfill: this.fill_,\n\t\tradius: this.radius_ + (this.stroke_ ? this.stroke_.getWidth():0),\n\t\tform: this.form_,\n\t\tgradient: this.gradient_,\n\t\toffsetX: this.offset_[0],\n\t\toffsetY: this.offset_[1],\n\t\topacity: this.getOpacity(),\n\t\trotation: this.getRotation(),\n\t\trotateWithView: this.getRotateWithView()\n\t});\n\tg.setScale(this.getScale());\n\tg.glyph_ = this.glyph_;\n\tg.renderMarker_();\n\treturn g;\n};\n/**\n * Get the fill style for the symbol.\n * @return {ol.style.Fill} Fill style.\n * @api\n */\nol.style.FontSymbol.prototype.getFill = function() {\n  return this.fill_;\n};\n/**\n * Get the stroke style for the symbol.\n * @return {_ol_style_Stroke_} Stroke style.\n * @api\n */\nol.style.FontSymbol.prototype.getStroke = function() {\n  return this.stroke_;\n};\n/**\n * Get the glyph definition for the symbol.\n * @param {string|undefined} name a glyph name to get the definition, default return the glyph definition for the style.\n * @return {_ol_style_Stroke_} Stroke style.\n * @api\n */\nol.style.FontSymbol.prototype.getGlyph = function(name)\n{\tif (name) return ol.style.FontSymbol.prototype.defs.glyphs[name] || { \"font\":\"none\",\"char\":name.charAt(0),\"theme\":\"none\",\"name\":\"none\", \"search\":\"\"};\n\telse return this.glyph_;\n};\n/**\n * Get the glyph name.\n * @return {string} the name\n * @api\n */\nol.style.FontSymbol.prototype.getGlyphName = function()\n{\tfor (var i in ol.style.FontSymbol.prototype.defs.glyphs)\n\t{\tif (ol.style.FontSymbol.prototype.defs.glyphs[i] === this.glyph_) return i;\n\t}\n\treturn \"\";\n};\n/**\n * Get the stroke style for the symbol.\n * @return {_ol_style_Stroke_} Stroke style.\n * @api\n */\nol.style.FontSymbol.prototype.getFontInfo = function(glyph)\n{\treturn ol.style.FontSymbol.prototype.defs.fonts[glyph.font];\n}\n/** @private\n */\nol.style.FontSymbol.prototype.renderMarker_ = function()\n{\n\tvar strokeStyle;\n\tvar strokeWidth = 0;\n\tif (this.stroke_) \n\t{\tstrokeStyle = ol.color.asString(this.stroke_.getColor());\n\t\tstrokeWidth = this.stroke_.getWidth();\n\t}\n\t// no atlas manager is used, create a new canvas\n\tvar canvas = this.getImage();\n\t//console.log(this.getImage().width+\" / \"+(2 * (this.radius_ + strokeWidth) + 1));\n\t/** @type {ol.style.FontSymbol.RenderOptions} */\n\tvar renderOptions = {\n\t\tstrokeStyle: strokeStyle,\n\t\tstrokeWidth: strokeWidth,\n\t\tsize: canvas.width,\n\t};\n\t// draw the circle on the canvas\n\tvar context = (canvas.getContext('2d'));\n\tcontext.clearRect(0, 0, canvas.width, canvas.height);\n\tthis.drawMarker_(renderOptions, context, 0, 0);\n\t// Set Anchor\n\tvar a = this.getAnchor();\n\ta[0] = canvas.width / 2 - this.offset_[0];\n\ta[1] = canvas.width / 2 - this.offset_[1];\n\t//this.createMarkerHitDetectionCanvas_(renderOptions);\n};\n/**\n * @private\n * @param {ol.style.FontSymbol.RenderOptions} renderOptions\n * @param {CanvasRenderingContext2D} context\n */\nol.style.FontSymbol.prototype.drawPath_ = function(renderOptions, context)\n{\n\tvar s = 2*this.radius_+renderOptions.strokeWidth+1;\n\tvar w = renderOptions.strokeWidth/2;\n\tvar c = renderOptions.size / 2;\n\t// Transfo to place the glyph at the right place\n\tvar transfo = { fac:1, posX:renderOptions.size / 2, posY:renderOptions.size / 2 };\n\tcontext.lineJoin = 'round';\n\tcontext.beginPath();\n\t// Draw the path with the form\n\tswitch (this.form_)\n\t{\tcase \"none\": transfo.fac=1;  break;\n\t\tcase \"circle\":\n\t\tcase \"ban\":\n\t\t\tcontext.arc ( c, c, s/2, 0, 2 * Math.PI, true);\n\t\t\tbreak;\n\t\tcase \"poi\":\n\t\t\tcontext.arc ( c, c -0.4*this.radius_, 0.6*this.radius_, 0.15*Math.PI, 0.85*Math.PI, true);\n\t\t\tcontext.lineTo ( c-0.89*0.05*s, (0.95+0.45*0.05)*s+w);\n\t\t\tcontext.arc ( c, 0.95*s+w, 0.05*s, 0.85*Math.PI, 0.15*Math.PI, true);\n\t\t\ttransfo = { fac:0.45, posX:c, posY:c -0.35*this.radius_ };\n\t\t\tbreak;\n\t\tcase \"bubble\":\n\t\t\tcontext.arc ( c, c -0.2*this.radius_, 0.8*this.radius_, 0.4*Math.PI, 0.6*Math.PI, true);\n\t\t\tcontext.lineTo ( 0.5*s+w, s+w);\n\t\t\ttransfo = { fac:0.7, posX:c, posY:c -0.2*this.radius_ };\n\t\t\tbreak;\n\t\tcase \"marker\":\n\t\t\tcontext.arc ( c, c -0.2*this.radius_, 0.8*this.radius_, 0.25*Math.PI, 0.75*Math.PI, true);\n\t\t\tcontext.lineTo ( 0.5*s+w, s+w);\n\t\t\ttransfo = { fac:0.7, posX: c, posY: c -0.2*this.radius_ };\n\t\t\tbreak;\n\t\tcase \"coma\":\n\t\t/*\n\t\t\tcontext.arc( renderOptions.size / 2, renderOptions.size / 2 +0.2*this.radius_, 0.8*this.radius_, 0.5*Math.PI, 0, true);\n\t\t\tcontext.arc( renderOptions.size / 2, renderOptions.size / 2 -0.2*this.radius_, 0.8*this.radius_, 0, 0.5*Math.PI, true);\n\t\t*/\n\t\t\tcontext.moveTo ( c + 0.8*this.radius_, c -0.2*this.radius_);\n\t\t\tcontext.quadraticCurveTo ( 0.95*s+w, 0.75*s+w, 0.5*s+w, s+w);\n\t\t\tcontext.arc ( c, c -0.2*this.radius_, 0.8*this.radius_, 0.45*Math.PI, 0, false);\n\t\t\ttransfo = { fac:0.7, posX: c, posY: c -0.2*this.radius_ };\n\t\t\tbreak;\n\t\tdefault:\n\t\t{\tvar pts;\n\t\t\tswitch (this.form_)\n\t\t\t{\tcase \"shield\": \n\t\t\t\t\tpts = [ 0.05,0, 0.95,0, 0.95,0.8, 0.5,1, 0.05,0.8, 0.05,0 ]; \n\t\t\t\t\ttransfo.posY = 0.45*s+w ;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"blazon\": \n\t\t\t\t\tpts = [ 0.1,0, 0.9,0, 0.9,0.8, 0.6,0.8, 0.5,1, 0.4,0.8, 0.1,0.8, 0.1,0 ]; \n\t\t\t\t\ttransfo.fac = 0.8;\n\t\t\t\t\ttransfo.posY = 0.4*s+w ;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"bookmark\": \n\t\t\t\t\tpts = [ 0.05,0, 0.95,0, 0.95,1, 0.5,0.8, 0.05,1, 0.05,0 ]; \n\t\t\t\t\ttransfo.fac = 0.9;\n\t\t\t\t\ttransfo.posY = 0.4*s+w ;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"hexagon\": \n\t\t\t\t\tpts = [ 0.05,0.2, 0.5,0, 0.95,0.2, 0.95,0.8, 0.5,1, 0.05,0.8, 0.05,0.2 ]; \n\t\t\t\t\ttransfo.fac = 0.9;\n\t\t\t\t\ttransfo.posY = 0.5*s+w ;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"diamond\": \n\t\t\t\t\tpts = [ 0.25,0, 0.75,0, 1,0.2, 1,0.4, 0.5,1, 0,0.4, 0,0.2, 0.25,0 ]; \n\t\t\t\t\ttransfo.fac = 0.75 ;\n\t\t\t\t\ttransfo.posY = 0.35*s+w ;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"triangle\": \n\t\t\t\t\tpts = [ 0,0, 1,0, 0.5,1, 0,0 ]; \n\t\t\t\t\ttransfo.fac = 0.6 ;\n\t\t\t\t\ttransfo.posY = 0.3*s+w ;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"sign\": \n\t\t\t\t\tpts = [ 0.5,0.05, 1,0.95, 0,0.95, 0.5,0.05 ]; \n\t\t\t\t\ttransfo.fac = 0.7 ;\n\t\t\t\t\ttransfo.posY = 0.65*s+w ;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"lozenge\": \n\t\t\t\t\tpts = [ 0.5,0, 1,0.5, 0.5,1, 0,0.5, 0.5,0 ]; \n\t\t\t\t\ttransfo.fac = 0.7;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"square\": \n\t\t\t\tdefault: \n\t\t\t\t\tpts = [ 0,0, 1,0, 1,1, 0,1, 0,0 ]; break;\n\t\t\t}\n\t\t\tfor (var i=0; i<pts.length; i+=2) context.lineTo ( pts[i]*s+w, pts[i+1]*s+w);\n\t\t}\n\t}\n\tcontext.closePath();\n\treturn transfo;\n}\n/**\n * @private\n * @param {ol.style.FontSymbol.RenderOptions} renderOptions\n * @param {CanvasRenderingContext2D} context\n * @param {number} x The origin for the symbol (x).\n * @param {number} y The origin for the symbol (y).\n */\nol.style.FontSymbol.prototype.drawMarker_ = function(renderOptions, context, x, y)\n{\tvar fcolor = this.fill_ ? this.fill_.getColor() : \"#000\";\n\tvar scolor = this.stroke_ ? this.stroke_.getColor() : \"#000\";\n\tif (this.form_ == \"none\" && this.stroke_ && this.fill_)\n\t{\tscolor = this.fill_.getColor();\n\t\tfcolor = this.stroke_.getColor();\n\t}\n\t// reset transform\n\tcontext.setTransform(1, 0, 0, 1, 0, 0);\n\t// then move to (x, y)\n\tcontext.translate(x, y);\n\tvar tr = this.drawPath_(renderOptions, context);\n\tif (this.fill_) \n\t{\tif (this.gradient_ && this.form_!=\"none\")\n\t\t{\tvar grd = context.createLinearGradient(0,0,renderOptions.size/2,renderOptions.size);\n\t\t\tgrd.addColorStop (1, ol.color.asString(fcolor));\n\t\t\tgrd.addColorStop (0, ol.color.asString(scolor));\n\t\t\tcontext.fillStyle = grd;\n\t\t}\n\t\telse context.fillStyle = ol.color.asString(fcolor);\n\t\tcontext.fill();\n\t}\n\tif (this.stroke_ && renderOptions.strokeWidth) {\n\t\tcontext.strokeStyle = renderOptions.strokeStyle;\n\t\tcontext.lineWidth = renderOptions.strokeWidth;\n\t\tcontext.stroke();\n\t}\n\t// Draw the symbol\n\tif (this.glyph_.char)\n\t{\tcontext.font = this.fontStyle_ +' '\n\t\t\t\t+ (2*tr.fac*(this.radius_)*this.fontSize_)+\"px \"\n\t\t\t\t+ this.glyph_.font;\n\t\tcontext.strokeStyle = context.fillStyle;\n\t\tcontext.lineWidth = renderOptions.strokeWidth * (this.form_ == \"none\" ? 2:1);\n\t\tcontext.fillStyle = ol.color.asString(this.color_ || scolor);\n\t\tcontext.textAlign = \"center\";\n\t\tcontext.textBaseline = \"middle\";\n\t\tvar t = this.glyph_.char;\n\t\tif (renderOptions.strokeWidth && scolor!=\"transparent\") context.strokeText(t, tr.posX, tr.posY);\n\t\tcontext.fillText(t, tr.posX, tr.posY);\n\t}\n\tif (this.form_==\"ban\" && this.stroke_ && renderOptions.strokeWidth) \n\t{\tcontext.strokeStyle = renderOptions.strokeStyle;\n\t\tcontext.lineWidth = renderOptions.strokeWidth;\n\t\tvar r = this.radius_ + renderOptions.strokeWidth;\n\t\tvar d = this.radius_ * Math.cos(Math.PI/4);\n\t\tcontext.moveTo(r + d, r - d);\n\t\tcontext.lineTo(r - d, r + d);\n\t\tcontext.stroke();\n\t}\n};\n/**\n * @inheritDoc\n */\nol.style.FontSymbol.prototype.getChecksum = function()\n{\n\tvar strokeChecksum = (this.stroke_!==null) ?\n\t\tthis.stroke_.getChecksum() : '-';\n\tvar fillChecksum = (this.fill_!==null) ?\n\t\tthis.fill_.getChecksum() : '-';\n\tvar recalculate = (this.checksums_===null) ||\n\t\t(strokeChecksum != this.checksums_[1] ||\n\t\tfillChecksum != this.checksums_[2] ||\n\t\tthis.radius_ != this.checksums_[3] ||\n\t\tthis.form_+\"-\"+this.glyphs_ != this.checksums_[4]);\n\tif (recalculate) {\n\t\tvar checksum = 'c' + strokeChecksum + fillChecksum \n\t\t\t+ ((this.radius_ !== void 0) ? this.radius_.toString() : '-')\n\t\t\t+ this.form_+\"-\"+this.glyphs_;\n\t\tthis.checksums_ = [checksum, strokeChecksum, fillChecksum, this.radius_, this.form_+\"-\"+this.glyphs_];\n\t}\n\treturn this.checksums_[0];\n};\n\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*\n*  Photo style for vector features\n*/\n/**\n * @requires ol.style.RegularShape\n * @requires ol.structs.IHasChecksum\n */\n/**\n * @classdesc\n * Set Photo style for vector features.\n *\n * @constructor\n * @param {} options\n *  @param { default | square | round | anchored | folio } options.kind\n *  @param {boolean} options.crop crop within square, default is false\n *  @param {Number} options.radius symbol size\n *  @param {boolean} options.shadow drop a shadow\n *  @param {ol.style.Stroke} options.stroke\n *  @param {String} options.src image src\n *  @param {String} options.crossOrigin The crossOrigin attribute for loaded images. Note that you must provide a crossOrigin value if you want to access pixel data with the Canvas renderer.\n *  @param {Number} options.offsetX Horizontal offset in pixels. Default is 0.\n *  @param {Number} options.offsetY Vertical offset in pixels. Default is 0.\n *  @param {function} options.onload callback when image is loaded (to redraw the layer)\n * @extends {ol.style.RegularShape}\n * @implements {ol.structs.IHasChecksum}\n * @api\n */\nol.style.Photo = function(options)\n{\toptions = options || {};\n\tthis.sanchor_ = options.kind==\"anchored\" ? 8:0;\n\tthis.shadow_ = Number(options.shadow) || 0;\n\tif (!options.stroke) \n\t{\toptions.stroke = new ol.style.Stroke({ width: 0, color: \"#000\"})\n\t}\n\tvar strokeWidth = options.stroke.getWidth();\n\tif (strokeWidth<0) strokeWidth = 0;\n\tif (options.kind=='folio') strokeWidth += 6;\n\toptions.stroke.setWidth(strokeWidth);\n\tol.style.RegularShape.call (this,\n\t{\tradius: options.radius + strokeWidth + this.sanchor_/2 + this.shadow_/2, \n\t\tpoints:0\n\t//\tfill:new ol.style.Fill({color:\"red\"}) // No fill to create a hit detection Image\n\t});\n\t// Hack to get the hit detection Image (no API exported)\n\tif (!this.hitDetectionCanvas_)\n\t{\tvar img = this.getImage();\n\t\tfor (var i in this)\n\t\t{\tif (this[i] && this[i].getContext && this[i]!==img)\n\t\t\t{\tthis.hitDetectionCanvas_ = this[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tthis.stroke_ = options.stroke;\n\tthis.fill_ = options.fill;\n\tthis.crop_ = options.crop;\n\tthis.crossOrigin_ = options.crossOrigin;\n\tthis.kind_ = options.kind || \"default\";\n\tthis.radius_ = options.radius;\n\tthis.src_ = options.src;\n\tthis.offset_ = [options.offsetX ? options.offsetX :0, options.offsetY ? options.offsetY :0];\n\tthis.onload_ = options.onload;\n\tif (typeof(options.opacity)=='number') this.setOpacity(options.opacity);\n\tif (typeof(options.rotation)=='number') this.setRotation(options.rotation);\n\tthis.renderPhoto_();\n};\nol.inherits(ol.style.Photo, ol.style.RegularShape);\n/**\n * Clones the style. \n * @return {ol.style.Photo}\n */\nol.style.Photo.prototype.clone = function()\n{\treturn new ol.style.Photo(\n\t{\tstroke: this.stroke_,\n\t\tfill: this.fill_,\n\t\tshadow: this.shadow_,\n\t\tcrop: this.crop_,\n\t\tcrossOrigin: this.crossOrigin_,\n\t\tkind: this.kind_,\n\t\tradius: this.radius_,\n\t\tsrc: this.src_,\n\t\toffsetX: this.offset_[0],\n\t\toffsetY: this.offset_[1],\n\t\topacity: this.getOpacity(),\n\t\trotation: this.getRotation()\n\t});\n};\n/**\n * Draws a rounded rectangle using the current state of the canvas. \n * Draw a rectangle if the radius is null.\n * @param {Number} x The top left x coordinate\n * @param {Number} y The top left y coordinate \n * @param {Number} width The width of the rectangle \n * @param {Number} height The height of the rectangle\n * @param {Number} radius The corner radius.\n */\nCanvasRenderingContext2D.prototype.roundRect = function (x, y, w, h, r) \n{\tif (!r) this.rect(x,y,w,h);\n\telse\n\t{\tif (w < 2 * r) r = w / 2;\n\t\tif (h < 2 * r) r = h / 2;\n\t\tthis.beginPath();\n\t\tthis.moveTo(x+r, y);\n\t\tthis.arcTo(x+w, y, x+w, y+h, r);\n\t\tthis.arcTo(x+w, y+h, x, y+h, r);\n\t\tthis.arcTo(x, y+h, x, y, r);\n\t\tthis.arcTo(x, y, x+w, y, r);\n\t\tthis.closePath();\n\t}\n\treturn this;\n}\n/**\n * Draw the form without the image\n * @private\n */\nol.style.Photo.prototype.drawBack_ = function(context, color, strokeWidth)\n{\tvar canvas = context.canvas;\n\tcontext.beginPath();\n    context.fillStyle = color;\n\tcontext.clearRect(0, 0, canvas.width, canvas.height);\n\tswitch (this.kind_)\n\t{\tcase 'square':\n\t\t\tcontext.rect(0,0,canvas.width-this.shadow_, canvas.height-this.shadow_);\n\t\t\tbreak;\n\t\tcase 'circle':\n\t\t\tcontext.arc(this.radius_+strokeWidth, this.radius_+strokeWidth, this.radius_+strokeWidth, 0, 2 * Math.PI, false);\n\t\t\tbreak;\n\t\tcase 'folio':\n\t\t\tvar offset = 6;\n\t\t\tstrokeWidth -= offset;\n\t\t\tcontext.strokeStyle = 'rgba(0,0,0,0.5)';\n\t\t\tvar w = canvas.width-this.shadow_-2*offset;\n\t\t\tvar a = Math.atan(6/w);\n\t\t\tcontext.save();\n\t\t\tcontext.rotate(-a);\n\t\t\tcontext.translate(-6,2);\n\t\t\tcontext.beginPath();\n\t\t\tcontext.rect(offset,offset,w,w);\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t\tcontext.restore();\n\t\t\tcontext.save();\n\t\t\tcontext.translate(6,-1);\n\t\t\tcontext.rotate(a);\n\t\t\tcontext.beginPath();\n\t\t\tcontext.rect(offset,offset,w,w);\n\t\t\tcontext.stroke();\n\t\t\tcontext.fill();\n\t\t\tcontext.restore();\n\t\t\tcontext.beginPath();\n\t\t\tcontext.rect(offset,offset,w,w);\n\t\t\tcontext.stroke();\n\t\t\tbreak;\n\t\tcase 'anchored':\n\t\t\tcontext.roundRect(this.sanchor_/2,0,canvas.width-this.sanchor_-this.shadow_, canvas.height-this.sanchor_-this.shadow_, strokeWidth);\n\t\t\tcontext.moveTo(canvas.width/2-this.sanchor_-this.shadow_/2,canvas.height-this.sanchor_-this.shadow_);\n\t\t\tcontext.lineTo(canvas.width/2+this.sanchor_-this.shadow_/2,canvas.height-this.sanchor_-this.shadow_);\n\t\t\tcontext.lineTo(canvas.width/2-this.shadow_/2,canvas.height-this.shadow_);break;\n\t\tdefault: /* roundrect */\n\t\t\tcontext.roundRect(0,0,canvas.width-this.shadow_, canvas.height-this.shadow_, strokeWidth);\n\t\t\tbreak;\n\t}\n\tcontext.closePath();\n}\n/**\n * @private\n */\nol.style.Photo.prototype.renderPhoto_ = function()\n{\n\tvar strokeStyle;\n\tvar strokeWidth = 0;\n\tif (this.stroke_) \n\t{\tstrokeStyle = ol.color.asString(this.stroke_.getColor());\n\t\tstrokeWidth = this.stroke_.getWidth();\n\t}\n\tvar canvas = this.getImage();\n\t// Draw hitdetection image\n\tvar context = this.hitDetectionCanvas_.getContext('2d');\n\tthis.drawBack_(context,\"#000\",strokeWidth);\n    context.fill();\n\t// Draw the image\n\tcontext = canvas.getContext('2d');\n\tthis.drawBack_(context,strokeStyle,strokeWidth);\n\t// Draw a shadow\n\tif (this.shadow_)\n\t{\tcontext.shadowColor = 'rgba(0,0,0,0.5)';\n\t\tcontext.shadowBlur = this.shadow_/2;\n\t\tcontext.shadowOffsetX = this.shadow_/2;\n\t\tcontext.shadowOffsetY = this.shadow_/2;\n\t}\n    context.fill();\n\tcontext.shadowColor = 'transparent';\n\tvar self = this;\n\tvar img = this.img_ = new Image();\n\tif (this.crossOrigin_) img.crossOrigin = this.crossOrigin_;\n\timg.src = this.src_;\n\t// Draw image\n\tif (img.width) self.drawImage_(img);\n\telse img.onload = function()\n\t{\tself.drawImage_(img);\n\t\t// Force change (?!)\n\t\t// self.setScale(1);\n\t\tif (self.onload_) self.onload_();\n\t};\n\t// Set anchor\n\tvar a = this.getAnchor();\n\ta[0] = (canvas.width - this.shadow_)/2;\n\ta[1] = (canvas.height - this.shadow_)/2;\n\tif (this.sanchor_)\n\t{\ta[1] = canvas.height - this.shadow_;\n\t}\n}\n/**\n * Draw an timage when loaded\n * @private\n */\nol.style.Photo.prototype.drawImage_ = function(img)\n{\tvar canvas = this.getImage();\n\t// Remove the circle on the canvas\n\tvar context = (canvas.getContext('2d'));\n\tvar strokeWidth = 0;\n\tif (this.stroke_) strokeWidth = this.stroke_.getWidth();\n\tvar size = 2*this.radius_;\n\tcontext.save();\n\tif (this.kind_=='circle')\n\t{\tcontext.beginPath();\n\t\tcontext.arc(this.radius_+strokeWidth, this.radius_+strokeWidth, this.radius_, 0, 2 * Math.PI, false);\n\t\tcontext.clip();\n\t}\n\tvar s, x, y, w, h, sx, sy, sw, sh;\n\t// Crop the image to a square vignette\n\tif (this.crop_) \n\t{\ts = Math.min (img.width/size, img.height/size);\n\t\tsw = sh = s*size;\n\t\tsx = (img.width-sw)/2;\n\t\tsy = (img.height-sh)/2;\n\t\tx = y = 0;\n\t\tw = h = size+1;\n\t}\n\t// Fit the image to the size\n\telse \n\t{\ts = Math.min (size/img.width, size/img.height);\n\t\tsx = sy = 0;\n\t\tsw = img.width;\n\t\tsh = img.height;\n\t\tw = s*sw;\n\t\th = s*sh;\n\t\tx = (size-w)/2;\n\t\ty = (size-h)/2;\n\t}\n\tx += strokeWidth + this.sanchor_/2;\n\ty += strokeWidth;\n\tcontext.drawImage(img, sx, sy, sw, sh, x, y, w, h);\n\tcontext.restore();\n\t// Draw a circle to avoid aliasing on clip\n\tif (this.kind_=='circle' && strokeWidth)\n\t{\tcontext.beginPath();\n\t\tcontext.strokeStyle = ol.color.asString(this.stroke_.getColor());\n\t\tcontext.lineWidth = strokeWidth/4;\n\t\tcontext.arc(this.radius_+strokeWidth, this.radius_+strokeWidth, this.radius_, 0, 2 * Math.PI, false);\n\t\tcontext.stroke();\n\t}\n}\n/**\n * @inheritDoc\n */\nol.style.Photo.prototype.getChecksum = function()\n{\n\tvar strokeChecksum = (this.stroke_!==null) ?\n\t\tthis.stroke_.getChecksum() : '-';\n\tvar fillChecksum = (this.fill_!==null) ?\n\t\tthis.fill_.getChecksum() : '-';\n\tvar recalculate = (this.checksums_===null) ||\n\t\t(strokeChecksum != this.checksums_[1] ||\n\t\tfillChecksum != this.checksums_[2] ||\n\t\tthis.radius_ != this.checksums_[3]);\n\tif (recalculate) {\n\t\tvar checksum = 'c' + strokeChecksum + fillChecksum \n\t\t\t+ ((this.radius_ !== void 0) ? this.radius_.toString() : '-');\n\t\tthis.checksums_ = [checksum, strokeChecksum, fillChecksum, this.radius_];\n\t}\n\treturn this.checksums_[0];\n};\n\n/** Add a setTextPath style to draw text along linestrings\n@toto letterpadding/spacing, wordpadding/spacing\n*/\n(function()\n{\n/** Internal drawing function called on postcompose\n* @param {ol.eventPoscompose} e postcompose event\n*/\nfunction drawTextPath (e)\n{\t// Prent drawing at large resolution\n\tif (e.frameState.viewState.resolution > this.textPathMaxResolution_) return;\n\tvar extent = e.frameState.extent;\n\tvar c2p = e.frameState.coordinateToPixelTransform;\n\t// Get pixel path with coordinates\n\tvar k;\n\tfunction getPath(c, readable)\n\t{\tvar path1 = [];\n\t\tfor (k=0; k<c.length; k++) \n\t\t{\tpath1.push(c2p[0]*c[k][0]+c2p[1]*c[k][1]+c2p[4]);\n\t\t\tpath1.push(c2p[2]*c[k][0]+c2p[3]*c[k][1]+c2p[5]);\n\t\t}\n\t\t// Revert line ?\n\t\tif (readable && path1[0]>path1[path1.length-2])\n\t\t{\tvar path2 = [];\n\t\t\tfor (k=path1.length-2; k>=0; k-=2)\n\t\t\t{\tpath2.push(path1[k]);\n\t\t\t\tpath2.push(path1[k+1]);\n\t\t\t}\n\t\t\treturn path2;\n\t\t}\n\t\telse return path1;\n\t}\n\tvar ctx = e.context;\n\tctx.save();\n\tctx.scale(e.frameState.pixelRatio,e.frameState.pixelRatio);\n\tvar features = this.getSource().getFeaturesInExtent(extent);\n\tfor (var i=0, f; f=features[i]; i++)\n\t{\t{\tvar style = this.textPathStyle_(f,e.frameState.viewState.resolution);\n\t\t\tfor (var s,j=0; s=style[j]; j++)\n\t\t\t{\t\n\t\t\t\tvar g = s.getGeometry() || f.getGeometry();\n\t\t\t\tvar c;\n\t\t\t\tswitch (g.getType())\n\t\t\t\t{\tcase \"LineString\": c = g.getCoordinates(); break;\n\t\t\t\t\tcase \"MultiLineString\": c = g.getLineString(0).getCoordinates(); break;\n\t\t\t\t\tdefault: continue;\n\t\t\t\t}\n\t\t\t\tvar st = s.getText();\n\t\t\t\tvar path = getPath(c, st.getRotateWithView() );\n\t\t\t\tctx.font = st.getFont();\n\t\t\t\tctx.textBaseline = st.getTextBaseline();\n\t\t\t\tctx.textAlign = st.getTextAlign();\n\t\t\t\tctx.lineWidth = st.getStroke() ? (st.getStroke().getWidth()||0) : 0;\n\t\t\t\tctx.strokeStyle = st.getStroke() ? (st.getStroke().getColor()||\"#fff\") : \"#fff\";\n\t\t\t\tctx.fillStyle = st.getFill() ? st.getFill().getColor()||\"#000\" : \"#000\";\n\t\t\t\t// New params\n\t\t\t\tctx.textJustify = st.getTextAlign()==\"justify\";\n\t\t\t\tctx.textOverflow = st.getTextOverflow ? st.getTextOverflow():\"\";\n\t\t\t\tctx.minWidth = st.getMinWidth ? st.getMinWidth():0;\n\t\t\t\t// Draw textpath\n\t\t\t\tctx.textPath(st.getText()||f.get(\"name\"), path);\n\t\t\t}\n\t\t}\n\t}\n\tctx.restore();\n}\n/** Set the style for features. \n*\tThis can be a single style object, an array of styles, or a function that takes a feature and resolution and \n*\treturns an array of styles. If it is undefined the default style is used. \n*\tIf it is null the layer has no style (a null style). \n*\tSee ol.style for information on the default style.\n*\t@param {ol.style.Style|Array.<ol.style.Style>|ol.StyleFunction} style\n*\t@param {Number} maxResolution to display text, default: 0\n*/\nol.layer.Vector.prototype.setTextPathStyle = function(style, maxResolution)\n{\n\t// Remove existing style\n\tif (style===null)\n\t{\tif (this.textPath_) this.unByKey(this.textPath_);\n\t\tthis.textPath_ = null;\n\t\tthis.changed();\n\t\treturn;\n\t}\n\t// New postcompose\n\tif (!this.textPath_)\n\t{\tthis.textPath_ = this.on(['postcompose','postrender'], drawTextPath.bind(this));\n\t}\n\t// Set textPathStyle\n\tif (style===undefined)\n\t{\tstyle = [ new ol.style.Style({ text: new ol.style.Text()}) ];\n\t}\n\tif (typeof(style) == \"function\") this.textPathStyle_ = style;\n\telse this.textPathStyle_ = function() { return style; };\n\tthis.textPathMaxResolution_ = Number(maxResolution) || Number.MAX_VALUE;\n\t// Force redraw\n\tthis.changed();\n}\n/** Add new properties to ol.style.Text\n* to use with ol.layer.Vector.prototype.setTextPathStyle\n* @constructor\n* @param {} options\n*\t@param {visible|ellipsis|string} textOverflow\n*\t@param {number} minWidth minimum width (px) to draw text, default 0\n*/\nol.style.TextPath = function(options)\n{\tif (!options) options={};\n\tol.style.Text.call (this, options);\n\tthis.textOverflow_ = typeof(options.textOverflow)!=\"undefined\" ?  options.textOverflow : \"visible\";\n\tthis.minWidth_ = options.minWidth || 0;\n}\nol.inherits(ol.style.TextPath, ol.style.Text);\nol.style.TextPath.prototype.getTextOverflow = function()\n{\treturn this.textOverflow_; \n};\nol.style.TextPath.prototype.getMinWidth = function()\n{\treturn this.minWidth_; \n};\n/**/\n})();\n/** CanvasRenderingContext2D: draw text along path\n* @param {string} text\n* @param {Array<Number>} path\n*/\nCanvasRenderingContext2D.prototype.textPath = function (text, path)\n{\n\tvar ctx = this;\n\tfunction dist2D(x1,y1,x2,y2)\n\t{\tvar dx = x2-x1;\n\t\tvar dy = y2-y1;\n\t\treturn Math.sqrt(dx*dx+dy*dy);\n\t}\n\tvar di, dpos=0;\n\tvar pos=2;\n\tfunction getPoint(path, dl)\n\t{\tif (!di || dpos+di<dl)\n\t\t{ for (; pos<path.length; )\n\t\t\t{\tdi = dist2D(path[pos-2],path[pos-1],path[pos],path[pos+1]);\n\t\t\t\tif (dpos+di>dl) break;\n\t\t\t\tpos += 2;\n\t\t\t\tif (pos>=path.length) break;\n\t\t\t\tdpos += di;\n\t\t\t}\n\t\t}\n\t\tvar x, y, a, dt = dl-dpos;\n\t\tif (pos>=path.length) \n\t\t{\tpos = path.length-2;\n\t\t}\n\t\tif (!dt) \n\t\t{\tx = path[pos-2];\n\t\t\ty = path[pos-1];\n\t\t\ta = Math.atan2(path[pos+1]-path[pos-1], path[pos]-path[pos-2]);\n\t\t}\n\t\telse\n\t\t{\tx = path[pos-2]+ (path[pos]-path[pos-2])*dt/di;\n\t\t\ty = path[pos-1]+(path[pos+1]-path[pos-1])*dt/di;\n\t\t\ta = Math.atan2(path[pos+1]-path[pos-1], path[pos]-path[pos-2]);\n\t\t}\n\t\treturn [x,y,a];\n\t}\n\tvar letterPadding = ctx.measureText(\" \").width *0.25;\n\tvar start = 0;\n\tvar d = 0;\n\tfor (var i=2; i<path.length; i+=2)\n\t{\td += dist2D(path[i-2],path[i-1],path[i],path[i+1])\n\t}\n\tif (d < ctx.minWidth) return;\n\tvar nbspace = text.split(\" \").length -1;\n\t// Remove char for overflow\n\tif (ctx.textOverflow != \"visible\")\n\t{\tif (d < ctx.measureText(text).width + (text.length-1 + nbspace) * letterPadding)\n\t\t{\tvar overflow = (ctx.textOverflow==\"ellipsis\") ? '\\u2026' : ctx.textOverflow;\n\t\t\tdo\n\t\t\t{\tnbspace = text.split(\" \").length -1;\n\t\t\t\ttext = text.slice(0,text.length-1);\n\t\t\t} while (text && d < ctx.measureText(text+overflow).width + (text.length + overflow.length-1 + nbspace) * letterPadding)\n\t\t\ttext += overflow;\n\t\t}\n\t}\n\tswitch (ctx.textJustify || ctx.textAlign)\n\t{\tcase true: // justify\n\t\tcase \"center\":\n\t\tcase \"end\":\n\t\tcase \"right\":\n\t\t{\t// Text align\n\t\t\tif (ctx.textJustify) \n\t\t\t{\tstart = 0;\n\t\t\t\tletterPadding = (d - ctx.measureText(text).width) / (text.length-1 + nbspace);\n\t\t\t}\n\t\t\telse\n\t\t\t{\tstart = d - ctx.measureText(text).width - (text.length + nbspace) * letterPadding;\n\t\t\t\tif (ctx.textAlign == \"center\") start /= 2;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tdefault: break;\n\t}\n\tfor (var t=0; t<text.length; t++)\n\t{\tvar letter = text[t];\n\t\tvar wl = ctx.measureText(letter).width;\n\t\tvar p = getPoint(path, start+wl/2);\n\t\tctx.save();\n\t\tctx.textAlign = \"center\";\n\t\tctx.translate(p[0], p[1]);\n\t\tctx.rotate(p[2]);\n\t\tif (ctx.lineWidth) ctx.strokeText(letter,0,0);\n\t\tctx.fillText(letter,0,0);\n\t\tctx.restore();\n\t\tstart += wl+letterPadding*(letter==\" \"?2:1);\n\t}\n};\n//NB: (Not confirmed)To use this module, you just have to :\n//   import('ol-ext/layer/getpreview')\n/*\tCopyright (c) 2015 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*\n*  Shadow image style for point vector features\n*/\n/**\n * @requires ol.style.Circle\n * @requires ol.structs.IHasChecksum\n */\n/**\n * @classdesc\n * Set Shadow style for point vector features.\n *\n * @constructor\n * @param {} options Options.\n *   @param {ol.style.Fill | undefined} options.fill fill style, default rgba(0,0,0,0.5)\n *   @param {number} options.radius point radius\n * \t @param {number} options.blur lur radius, default radius/3\n * \t @param {number} options.offsetX x offset, default 0\n * \t @param {number} options.offsetY y offset, default 0\n * @extends {ol.style.RegularShape}\n * @implements {ol.structs.IHasChecksum}\n * @api\n */\nol.style.Shadow = function(options)\n{\toptions = options || {};\n\tif (!options.fill) options.fill = new ol.style.Fill({ color: \"rgba(0,0,0,0.5)\" });\n\tol.style.RegularShape.call (this,{ radius: options.radius, fill: options.fill });\n\tthis.fill_ = options.fill;\n\tthis.radius_ = options.radius;\n\tthis.blur_ = options.blur===0 ? 0 : options.blur || options.radius/3;\n\tthis.offset_ = [options.offsetX ? options.offsetX : 0, options.offsetY ? options.offsetY : 0];\n\tthis.renderShadow_();\n};\nol.inherits(ol.style.Shadow, ol.style.RegularShape);\n/**\n * Clones the style. \n * @return {ol.style.Shadow}\n */\nol.style.Shadow.prototype.clone = function()\n{\tvar s = new ol.style.Shadow(\n\t{\tfill: this.fill_,\n\t\tradius: this.radius_,\n\t\tblur: this.blur_,\n\t\toffsetX: this.offset_[0],\n\t\toffsetY: this.offset_[1]\n\t});\n\ts.setScale(this.getScale());\n\ts.setOpacity(this.getOpacity());\n\treturn s;\n};\n/**\n * @private\n */\nol.style.Shadow.prototype.renderShadow_ = function()\n{\t\n\tvar radius = this.radius_;\n\tvar canvas = this.getImage();\n\tvar s = [canvas.width, canvas.height];\n\ts[1] = radius;\n\t// Remove the circle on the canvas\n\tvar context = (canvas.getContext('2d'));\n\tcontext.beginPath();\n\tcontext.clearRect(0, 0, canvas.width, canvas.height);\n\tcontext.scale(1,0.5);\n\tcontext.arc(radius, -radius, radius-this.blur_, 0, 2 * Math.PI, false);\n    context.fillStyle = '#000';\n\tcontext.shadowColor = this.fill_.getColor();\n\tcontext.shadowBlur = 0.7*this.blur_;\n\tcontext.shadowOffsetX = 0;\n\tcontext.shadowOffsetY = 1.5*radius;\n\tcontext.closePath();\n    context.fill();\n\tcontext.shadowColor = 'transparent';\n\t// Set anchor\n\tvar a = this.getAnchor();\n\ta[0] = canvas.width /2 -this.offset_[0];\n\ta[1] = canvas.height/2 -this.offset_[1];\n}\n/**\n * @inheritDoc\n */\nol.style.Shadow.prototype.getChecksum = function()\n{\n\tvar strokeChecksum = (this.stroke_!==null) ?\n\t\tthis.stroke_.getChecksum() : '-';\n\tvar fillChecksum = (this.fill_!==null) ?\n\t\tthis.fill_.getChecksum() : '-';\n\tvar recalculate = (this.checksums_===null) ||\n\t\t(strokeChecksum != this.checksums_[1] ||\n\t\tfillChecksum != this.checksums_[2] ||\n\t\tthis.radius_ != this.checksums_[3] ||\n\t\tthis.form_+\"-\"+this.glyphs_ != this.checksums_[4]);\n\tif (recalculate) {\n\t\tvar checksum = 'c' + strokeChecksum + fillChecksum \n\t\t\t+ ((this.radius_ !== void 0) ? this.radius_.toString() : '-')\n\t\t\t+ this.form_+\"-\"+this.glyphs_;\n\t\tthis.checksums_ = [checksum, strokeChecksum, fillChecksum, this.radius_, this.form_+\"-\"+this.glyphs_];\n\t}\n\treturn this.checksums_[0];\n};\n\n/*\tCopyright (c) 2018 Jean-Marc VIGLINO, \n\treleased under the CeCILL-B license (French BSD license)\n\t(http://www.cecill.info/licences/Licence_CeCILL-B_V1-en.txt).\n*/\n/**\n * @classdesc\n * Stroke style with named pattern\n *\n * @constructor\n * @param {any}  options\n *\t@param {ol.style.Image|undefined} options.image an image pattern, image must be preloaded to draw on first call\n *\t@param {number|undefined} options.opacity opacity with image pattern, default:1\n *\t@param {olx.style.fillPattern} options.pattern pattern name (override by image option)\n *\t@param {ol.colorLike} options.color pattern color\n *\t@param {ol.style.Fill} options.fill fill color (background)\n *\t@param {number} options.offset pattern offset for hash/dot/circle/cross pattern\n *\t@param {number} options.size line size for hash/dot/circle/cross pattern\n *\t@param {number} options.spacing spacing for hash/dot/circle/cross pattern\n *\t@param {number|bool} options.angle angle for hash pattern / true for 45deg dot/circle/cross\n *\t@param {number} options.scale pattern scale \n * @extends {ol.style.Fill}\n * @implements {ol.structs.IHasChecksum}\n * @api\n */\nol.style.StrokePattern = function(options)\n{\tif (!options) options = {};\n\tvar pattern, i;\n\tvar canvas = this.canvas_ = document.createElement('canvas');\n\tvar scale = Number(options.scale)>0 ? Number(options.scale) : 1;\n\tvar ratio = scale*ol.has.DEVICE_PIXEL_RATIO || ol.has.DEVICE_PIXEL_RATIO;\n\tvar ctx = canvas.getContext('2d');\n\tif (options.image)\n\t{\toptions.image.load();\n\t\tvar img = options.image.getImage();\n\t\tif (img.width)\n\t\t{\tcanvas.width = Math.round(img.width *ratio);\n\t\t\tcanvas.height = Math.round(img.height *ratio);\n\t\t\tctx.globalAlpha = typeof(options.opacity) == 'number' ? options.opacity:1;\n\t\t\tctx.drawImage(img, 0,0, img.width, img.height, 0, 0, canvas.width, canvas.height);\n\t\t\tpattern = ctx.createPattern(canvas, 'repeat');\n\t\t}\n\t\telse \n\t\t{\tvar self = this;\n\t\t\tpattern = [0,0,0,0];\n\t\t\timg.onload = function ()\n\t\t\t{\tcanvas.width = Math.round(img.width *ratio);\n\t\t\t\tcanvas.height = Math.round(img.height *ratio);\n\t\t\t\tctx.globalAlpha = typeof(options.opacity) == 'number' ? options.opacity:1;\n\t\t\t\tctx.drawImage(img, 0,0, img.width, img.height, 0, 0, canvas.width, canvas.height);\n\t\t\t\tpattern = ctx.createPattern(canvas, 'repeat');\n\t\t\t\tself.setColor(pattern);\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\tvar pat = this.getPattern_(options);\n\t\tcanvas.width = Math.round(pat.width *ratio);\n\t\tcanvas.height = Math.round(pat.height *ratio);\n\t\tctx.beginPath();\n\t\tif (options.fill) \n\t\t{\tctx.fillStyle = ol.color.asString(options.fill.getColor());\n\t\t\tctx.fillRect(0,0, canvas.width, canvas.height);\n\t\t}\n\t\tctx.scale(ratio,ratio);\n\t\tctx.lineCap = \"round\";\n\t\tctx.lineWidth = pat.stroke || 1;\n\t\tctx.fillStyle = ol.color.asString(options.color||\"#000\");\n\t\tctx.strokeStyle = ol.color.asString(options.color||\"#000\");\n\t\tif (pat.circles) for (i=0; i<pat.circles.length; i++)\n\t\t{\tvar ci = pat.circles[i]; \n\t\t\tctx.beginPath();\n\t\t\tctx.arc(ci[0], ci[1], ci[2], 0,2*Math.PI);\n\t\t\tif (pat.fill) ctx.fill();\n\t\t\tif (pat.stroke) ctx.stroke();\n\t\t}\n\t\tif (!pat.repeat) pat.repeat=[[0,0]];\n\t\tif (pat.char)\n\t\t{\tctx.font = pat.font || (pat.width)+\"px Arial\";\n\t\t\tctx.textAlign = 'center';\n\t\t\tctx.textBaseline = 'middle';\n\t\t\tif (pat.angle) \n\t\t\t{\tctx.fillText(pat.char, pat.width/4, pat.height/4);\n\t\t\t\tctx.fillText(pat.char, 5*pat.width/4, 5*pat.height/4);\n\t\t\t\tctx.fillText(pat.char, pat.width/4, 5*pat.height/4);\n\t\t\t\tctx.fillText(pat.char, 5*pat.width/4, pat.height/4);\n\t\t\t\tctx.fillText(pat.char, 3*pat.width/4, 3*pat.height/4);\n\t\t\t\tctx.fillText(pat.char, -pat.width/4, -pat.height/4);\n\t\t\t\tctx.fillText(pat.char, 3*pat.width/4, -pat.height/4);\n\t\t\t\tctx.fillText(pat.char, -pat.width/4, 3*pat.height/4);\n\t\t\t}\n\t\t\telse ctx.fillText(pat.char, pat.width/2, pat.height/2);\n\t\t}\n\t\tif (pat.lines) for (i=0; i<pat.lines.length; i++) for (var r=0; r<pat.repeat.length; r++)\n\t\t{\tvar li = pat.lines[i];\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(li[0]+pat.repeat[r][0],li[1]+pat.repeat[r][1]);\n\t\t\tfor (var k=2; k<li.length; k+=2)\n\t\t\t{\tctx.lineTo(li[k]+pat.repeat[r][0],li[k+1]+pat.repeat[r][1]);\n\t\t\t}\n\t\t\tif (pat.fill) ctx.fill();\n\t\t\tif (pat.stroke) ctx.stroke();\n\t\t\tctx.save()\n\t\t\tctx.strokeStyle = 'red';\n\t\t\tctx.strokeWidth = 0.1;\n\t\t\t//ctx.strokeRect(0,0,canvas.width,canvas.height);\n\t\t\tctx.restore()\n\t\t}\n\t\tpattern = ctx.createPattern(canvas, 'repeat');\n\t\tif (options.offset)\n\t\t{\tvar offset = options.offset;\n\t\t\tif (typeof(offset) == \"number\") offset = [offset,offset];\n\t\t\tif (offset instanceof Array) \n\t\t\t{\tvar dx = Math.round((offset[0]*ratio));\n\t\t\t\tvar dy = Math.round((offset[1]*ratio));\n\t\t\t\t// New pattern\n\t\t\t\tctx.scale(1/ratio,1/ratio)\n\t\t\t\tctx.clearRect(0,0,canvas.width,canvas.height);\n\t\t\t\tctx.translate(dx,dy);\n\t\t\t\tctx.fillStyle = pattern;\n\t\t\t\tctx.fillRect(-dx, -dy, canvas.width,canvas.height);\n\t\t\t\tpattern = ctx.createPattern(canvas, 'repeat');\n\t\t\t}\n\t\t}\n\t}\n\toptions.color = pattern;\n\tol.style.Stroke.call (this, options);\n};\nol.inherits(ol.style.StrokePattern, ol.style.Stroke);\n/**\n * Clones the style. \n * @return {ol.style.StrokePattern}\n */\nol.style.StrokePattern.prototype.clone = function() {\n\tvar s = ol.style.Fill.prototype.clone.call(this);\n\ts.canvas_ = this.canvas_;\n\treturn s;\n};\n/** Get canvas used as pattern\n*\t@return {canvas}\n*/\nol.style.StrokePattern.prototype.getImage = function()\n{\treturn this.canvas_;\n}\n/** Get pattern\n*\t@param {olx.style.FillPatternOption}\n*/\nol.style.StrokePattern.prototype.getPattern_ = function(options)\n{\tvar pat = ol.style.FillPattern.prototype.patterns[options.pattern]\n\t\t|| ol.style.FillPattern.prototype.patterns.dot;\n\tvar d = Math.round(options.spacing)||10;\n\tvar size;\n//\tvar d2 = Math.round(d/2)+0.5;\n\tswitch (options.pattern)\n\t{\tcase 'dot':\n\t\tcase 'circle':\n\t\t{\tsize = options.size===0 ? 0 : options.size/2 || 2;\n\t\t\tif (!options.angle)\n\t\t\t{\tpat.width = pat.height = d;\n\t\t\t\tpat.circles = [[ d/2, d/2, size ]]\n\t\t\t\tif (options.pattern=='circle')\n\t\t\t\t{\tpat.circles = pat.circles.concat([\n\t\t\t\t\t\t[ d/2+d, d/2, size ],\n\t\t\t\t\t\t[ d/2-d, d/2, size ],\n\t\t\t\t\t\t[ d/2, d/2+d, size ],\n\t\t\t\t\t\t[ d/2, d/2-d, size ],\n\t\t\t\t\t\t[ d/2+d, d/2+d, size ],\n\t\t\t\t\t\t[ d/2+d, d/2-d, size ],\n\t\t\t\t\t\t[ d/2-d, d/2+d, size ],\n\t\t\t\t\t\t[ d/2-d, d/2-d, size ] ])\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\td = pat.width = pat.height = Math.round(d*1.4);\n\t\t\t\tpat.circles = [[ d/4, d/4, size ], [ 3*d/4, 3*d/4, size ]];\n\t\t\t\tif (options.pattern=='circle')\n\t\t\t\t{\tpat.circles = pat.circles.concat([\n\t\t\t\t\t\t[ d/4+d, d/4, size ],\n\t\t\t\t\t\t[ d/4, d/4+d, size ],\n\t\t\t\t\t\t[ 3*d/4-d, 3*d/4, size ],\n\t\t\t\t\t\t[ 3*d/4, 3*d/4-d, size ],\n\t\t\t\t\t\t[ d/4+d, d/4+d, size ], \n\t\t\t\t\t\t[ 3*d/4-d, 3*d/4-d, size ] ]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\tcase 'tile':\n\t\tcase 'square':\n\t\t{\tsize = options.size===0 ? 0 : options.size/2 || 2;\n\t\t\tif (!options.angle)\n\t\t\t{\tpat.width = pat.height = d;\n\t\t\t\tpat.lines = [[ d/2-size, d/2-size, d/2+size, d/2-size, d/2+size, d/2+size, d/2-size,d/2+size, d/2-size, d/2-size ]]\n\t\t\t}\n\t\t\telse\n\t\t\t{\tpat.width = pat.height = d;\n\t\t\t\t//size *= Math.sqrt(2);\n\t\t\t\tpat.lines = [[ d/2-size,d/2, d/2,d/2-size, d/2+size,d/2, d/2,d/2+size, d/2-size,d/2 ]]\n\t\t\t}\n\t\t\tif (options.pattern=='square') pat.repeat = [[0,0], [0,d], [d,0], [0,-d], [-d,0], [-d,-d], [d,d], [-d,d], [d,-d] ]\n\t\t\tbreak;\n\t\t}\n\t\tcase 'cross':\n\t\t{\t// Limit angle to 0 | 45\n\t\t\tif (options.angle) options.angle = 45;\n\t\t}\n\t\t// fallthrough\n\t\tcase 'hatch':\n\t\t{\tvar a = Math.round(((options.angle||0)-90)%360);\n\t\t\tif (a>180) a -= 360;\n\t\t\ta *= Math.PI/180;\n\t\t\tvar cos = Math.cos(a);\n\t\t\tvar sin = Math.sin(a);\n\t\t\tif (Math.abs(sin)<0.0001)\n\t\t\t{\tpat.width = pat.height = d;\t\n\t\t\t\tpat.lines = [ [ 0,0.5, d, 0.5 ] ];\n\t\t\t\tpat.repeat = [ [0,0], [0,d] ];\n\t\t\t}\n\t\t\telse  if (Math.abs(cos)<0.0001)\n\t\t\t{\tpat.width = pat.height = d;\t\n\t\t\t\tpat.lines = [ [ 0.5,0, 0.5, d] ];\n\t\t\t\tpat.repeat = [ [0,0], [d,0] ];\n\t\t\t\tif (options.pattern=='cross') \n\t\t\t\t{\tpat.lines.push ([ 0,0.5, d, 0.5 ]);\n\t\t\t\t\tpat.repeat.push([0,d]);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\tvar w = pat.width = Math.round(Math.abs(d/sin)) || 1;\n\t\t\t\tvar h = pat.height = Math.round(Math.abs(d/cos)) || 1;\n\t\t\t\tif (options.pattern=='cross')\n\t\t\t\t{\tpat.lines = [ [-w,-h, 2*w,2*h], [2*w,-h, -w,2*h] ];\n\t\t\t\t\tpat.repeat = [ [0,0] ];\n\t\t\t\t}\n\t\t\t\telse if (cos*sin>0) \n\t\t\t\t{\tpat.lines = [ [-w,-h, 2*w,2*h] ];\n\t\t\t\t\tpat.repeat = [ [0,0], [w,0], [0,h] ];\n\t\t\t\t}\n\t\t\t\telse \n\t\t\t\t{\tpat.lines = [ [2*w,-h, -w,2*h] ];\n\t\t\t\t\tpat.repeat = [ [0,0], [-w,0], [0,h] ];\n\t\t\t\t}\n\t\t\t}\n\t\t\tpat.stroke = options.size===0 ? 0 : options.size||4;\n\t\t\tbreak;\n\t\t}\n\t\tdefault: {\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn pat\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/openlayers-ext/dist/ol-ext.js\n// module id = 9\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/flatpickr/dist/themes/airbnb.css\n// module id = 10\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./plugins/plg_cartografia_historica/src/facade/assets/css/plg_cartografia_historica.css\n// module id = 11\n// module chunks = 0","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/@fortawesome/fontawesome-free/css/all.css\n// module id = 12\n// module chunks = 0"],"sourceRoot":""}